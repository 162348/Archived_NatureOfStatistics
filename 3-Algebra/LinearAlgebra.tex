\documentclass[uplatex, dvipdfmx]{jsreport}
\title{線型代数学}
\author{司馬博文}
\date{\today}
\pagestyle{headings} \setcounter{secnumdepth}{4}
\input{/Users/Hirofumi Shiba/NatureOfStatistics/preamble_no_fonts.tex}
%\input{/Users/hirofumi.shiba48/NatureOfStatistics/preamble_no_fonts.tex}
\usepackage[math]{anttor}
\begin{document}
\tableofcontents

\chapter{有限次元線型空間とその射}


\begin{notation}\mbox{}
    \begin{enumerate}
        \item $\brac{x_i}_{i\in I}$で族$\{x_i\}\subset V$が生成する線型部分空間を表す．
        \item $\S(V)$で$V$の部分空間の全体を表す．
        \item 半双線型形式の全体：$\Ses(V)=\{V\text{上の半双線型形式}V\times V\to K\}$とし，$\Ses_\sa(V):=\{V\text{上のHermite形式}h:V\times V\to\C\}$とする．
        \item スカラー倍写像：$K\mono\End_K(V)$を$a\mapsto a\cdot\id_V$で同一視する．
    \end{enumerate}
\end{notation}

\section{線型空間の定義と分類}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    \begin{enumerate}
        \item 有限次元線型空間を基底の概念を用いて分類し，線型写像を基底によって表示する．
        \item 像と核を用いて線型写像の全射・単射性を特徴付けたのち，完全系列によっても特徴付ける．
        \item 全射と単射が射影と包含によることがわかった．その合成のクラスが射影として特徴付けられる．これを調べ，線型空間の分解の仕方を調べる．
    \end{enumerate}
\end{tcolorbox}

\subsection{線型空間の定義と例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    Abel群$V$に対して，群の作用$G\to\Aut(V)$を備えたものを表現，環の作用$R\to\Aut(V)$を備えたものが加群，
    体の作用$K\to\Aut(V)$を備えたものが線型空間である．
\end{tcolorbox}

\begin{definition}[commutative ring, commutative field, characteristic]\mbox{}
    \begin{enumerate}
        \item Abel群$R$が乗法中立元$1\in R$を持つ結合的な双線型写像$R\times R\to R$も備えるとき，(単位的)\textbf{環}という．
        以降，環は可換とする．
        \item $R^\times=R\setminus\{0\}$が成り立つ可換環$R$を体という．
        \item 体$K$が$\Q$を（部分体として）含むとき，体の\textbf{標数}は$0$であるという．
        体$K$が有限体$\F_p$を（部分体として）含むとき，体の標数は$p$であるという．
    \end{enumerate}
\end{definition}

\begin{definition}[module, linear space, algebra]
    $R$を可換環とする．
    \begin{enumerate}
        \item \textbf{$R$-加群}とは，環の作用$R\to\Aut(V)$を受けるAbel群$R\times V\to V$をいう．
        \item $R$が体でもあるとき，特に\textbf{$R$-線型空間}という．
        \item また，$R$-加群が双線型写像$g:V\otimes V\to V$も備えるとき，\textbf{$R$-代数}という．
    \end{enumerate}
\end{definition}

\begin{example}[多項式の空間]
    環$R$に対して，
    $R[X]$は$R$-代数になる．
    \begin{enumerate}
        \item $R[X]$は加群である．$R[X,Y]:=(R[X])[Y]$とみなせる．
        \item $W_f:=\Brace{g\in K[X]\mid\deg g< \deg f}$とすると，$K[X]=(f)\oplus W_f$と分解できる．すなわち，$f=qg+r\mapsto(q,r)$は全単射である．
        \item 補空間$W_f$は商空間として$W_f\iso K[X]/(f)$の表示を持つ．$f$が一次式のとき，$K[X]/(f)\simeq K$となり，評価写像が準同型を与える．因数定理と呼ばれる．
        \item $f=X^n+a_1X^{n-1}+\cdots+a_{n-1}X+a_n$と表示出来るとき，$W_f=K[X]/(f)$の基底として$\o{1},\o{X},\cdots,\o{X^{n-1}}$が取れる．これについての$X$倍写像$F_X:K[X]\to K[X]$の行列表示を，\textbf{$f$の同伴行列}という．$W_f$は$\o{1}$が生成する$F_X$-安定部分空間である．
    \end{enumerate}
\end{example}

\subsection{線型独立の概念}

\begin{definition}[basis, linearly independent]\mbox{}
    \begin{enumerate}
        \item 族$(x_i)_{i\in I}$が$V\in\Vect_K$の\textbf{基底}であるとは，写像$K^{(I)}\to V;(a_i)_{i\in I}\mapsto\sum_{i\in I}a_ix_i$が全単射を定めることをいう．
        \item 族$\{x_i\}\subset V$が\textbf{線型独立}であるとは，$\brac{x_i}_{i\in I}$の基底であることをいう．
    \end{enumerate}
\end{definition}

\begin{proposition}[基底の特徴付け]
    任意の$x:=(x_i)_{i\in[n]}\subset V$について，次の3条件は同値：
    \begin{enumerate}
        \item $(x_i)$は基底である．
        \item 対応$\varphi_x:K^n\to V;a\mapsto x^\top a$は全単射を定める．
        \item $(x_i)$は生成系であり，かつ，次を満たす：$\forall_{b_1,\cdots,b_n\in K}\;b_1x_1+\cdots+b_nx_n=0\Rightarrow b_1=\cdots=b_n=0$．
    \end{enumerate}
\end{proposition}

\begin{proposition}[線型独立性の特徴付け：一次独立系の拡大法]\label{prop-linear-system-expansion}
    $x_1,\cdots,x_n\in V\in\Vect_K$に対して，次の2条件は同値．
    \begin{enumerate}
        \item $x_1,\cdots,x_n$は線型独立である．
        \item $x_1,\cdots,x_{n-1}$が線型独立，かつ，$x_n\notin\langle x_1,\cdots,x_{n-1}\rangle$．
    \end{enumerate}
\end{proposition}

\subsection{基底による線型写像の構成}

\begin{proposition}\label{prop-linear-map-via-basis}
    $V,W\in\Vect_K$とする．
    \begin{enumerate}
        \item $V$の基底$x_1,\cdots,x_n$と$W$の元$y_1,\cdots,y_n$とに対して，条件$f(x_1)=y_1,\cdots,f(x_n)=y_n$は線型写像$f\in\Hom(V,W)$を一意に定める．
        \item 集合$X\in\Set$に対して，$G:\Hom_K(K^{(X)},W)\to\Map(X,W)$は可逆である．
    \end{enumerate}
\end{proposition}

\subsection{線型空間の直和と補空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    ノルム空間においては「代数的直和」とも呼ばれる概念で，その名の通り自由加群に当たる極めて基本的な概念である．
    なお，代数的直和が
    ノルム空間の直和($l^1$-直和)となるためには，さらにここから完備化が必要．
\end{tcolorbox}

\begin{definition}[direct sum of vector spaces]\mbox{}
    \begin{enumerate}
        \item $V,W\in\Vect_K$の\textbf{直和}$V\oplus W$を，集合$V\times W$上に自然な線型空間の構造を入れたものとする．しばしば「外部」や「抽象的な」などの接頭語をつける．
        \item 特に$V^{\otimes r}$は$V^r$と略記する．
        \item 線型空間の族$(V_i)_{i\in I}$について，その\textbf{直和}とは，
        \[ \bigoplus_{i\in I}V_i:=\Brace{(x_i)_{i\in I}\in\prod_{i\in I}V_i\;\middle|\; x_i=0\;\fe} \]
        と定める
    \end{enumerate}
\end{definition}

\begin{proposition}[内部直和の概念：部分空間が互いに素であることの直和による特徴付け]\label{prop-characterization-of-direct-sum-2}
    $V\in\Vect_K$の部分空間$W,W'$について，次の２条件は同値である．
    \begin{enumerate}
        \item $W\cap W'=0$．
        \item 自然な全単射$\varphi:W\oplus W'\to W+W'$が存在する．
    \end{enumerate}
    このとき，埋め込み$W\oplus W'\mono V$によって記号を混用する．
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 全射であるのは明らか．単射性は，$x+y=x'+y'$ならば$x-x'=y-y'\in W\cap W'=0$より従う．
        \item[(2)$\Rightarrow$(1)] 任意の$x\in W\cap W'$を取ると，$\varphi(x,0)=\varphi(0,x)=x$．$\varphi$の単射性から$(x,0)=(0,x)$より従う．
    \end{description}
\end{Proof}

\begin{proposition}[補空間の存在]
    $V\in\Vect_K,W\subset V$を部分空間とする．$V$の部分空間$W'$であって，$V=W\oplus W'$となるものが存在する．
\end{proposition}
\begin{Proof}
    $W$の基底が取れる．
    その個数は$\dim V$より少なく，足りない分を延長することで$V$の基底を得る算譜が存在する．
    これを用いて$W'$を構成出来る．
\end{Proof}
\begin{remarks}
    FinVectでは，任意の部分空間は直和因子である．
\end{remarks}

\subsection{線型空間の次元による分類}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    FinVectでは，全ての対象が係数体$K$のある代数的直和と同型になる．
\end{tcolorbox}

\begin{theorem}[FinVectの分類定理 (Ernst Steinitz)]\label{thm-dimention}
    $V$を$K$-線型空間とする．$(x_i)_{i\in [m]}$と$(y_i)_{i\in [n]}$がいずれも$V$の基底であるならば，$n=m$である．
\end{theorem}
\begin{Proof}
    互いに逆写像である写像$f:[m]\to[n]$と$g:[n]\to[m]$を構成する事により，$|X|=|Y|$を証明する．

    部分空間の列$\{V_i:=\langle x_1,\cdots,x_i\rangle\}_{i=0,1,\cdots,m},\{W_j:=\langle y_1,\cdots,y_j\rangle\}_{j=0,1,\cdots,n}$を定める．
    これに対して，$f(i)=j$を，$x_i\in V_{i-1}+W_j$を満たす最小の$j$として定義し，$g$も対称に定義する．
    この時に，$f(i)=j\Leftrightarrow g(j)=i$と示せれば，定理の主張を得る．

    まず$f:[m]\to[n]$を定義する，各$i=1,\cdots,m$に対して，部分空間の増大列
    \[ V_{i-1}=V_{i-1}+W_0\subset V_{i-1}+W_1\subset\cdots\subset V_{i-1}+W_n=V \]
    を考えると，$x_i\notin V_{i-1}+W_0$と$x_i\in V_{i-1}+W_n$とより，$x_i\in V_{i-1}+W_j$を満たす最小の$1\le j\le n$が定まる（この時，部分空間の増大列が無限に長い場合，選択公理が必要となる）．
    この$j$をして，$f(i)=j$と定める．同様にして，$g:[n]\to[m]$を定める．

    この時，$f(i)=j\Leftrightarrow g(j)=i$，即ち$f\circ g=\id,g\circ f=\id$は次の補題に一般化される．
\end{Proof}

\begin{definition}[(Hamel / algebraic) dimention]\label{def-dimention}
    $n\in\N$に対し，$V$に有限な基底$(x_i)_{i\in[n]}$が存在するならば，$V$は\textbf{有限次元}であるといい，$n=:\dim V$を$V$の\textbf{次元}という．
    有限次元でない線型空間を\textbf{無限次元}であるという．
\end{definition}

\subsection{線型写像の直和と行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    空間の直和の間に，線型写像の直和も生じる．
    ここで，直和の概念こそ基底を特徴付けたことを思い出せば，直和あるところに行列あり，である．
\end{tcolorbox}

\begin{definition}[線型写像の直和]\mbox{}
    \begin{enumerate}
        \item $f_1:V_1\to W,f_2:V_2\to W$を線型写像とする．これらの\textbf{直和}$f_1\oplus f_2:V_1\oplus V_2\to W$を
        \[(f_1\oplus f_2)(x_1,x_2)=f_1(x_1)+f_2(x_2)\]
        と定める．
        \item $W=W_1\oplus W_2$とする．$f_1:V\to W_1,f_2:V\to W_2$の\textbf{直和}$f_1\oplus f_2:V_1\oplus V_2\to W_1\oplus W_2$を
        \[(f_1\oplus f_2)(x)=(f_1(x),f_2(x))\]
        と定める．
        \item $f_{11}\oplus f_{12}:V_1\oplus V_2\to W_1,f_{21}\oplus f_{22}:V_1\oplus V_2\to W_2$に対して，$f:V_1\oplus V_2\to W_1\oplus W_2$を$f(x_1,x_2)=(f_{11}(x_1)+f_{12}(x_2),f_{21}(x_1)+f_{22}(x_2))$は線型写像を定める．これを
        \[ f=\begin{pmatrix}f_{11}&f_{12}\\f_{21}&f_{22}\end{pmatrix} \]
        と表す．次が成り立つからである：
        \[ \begin{pmatrix}y_1\\y_2\end{pmatrix}=\begin{pmatrix}f_{11}&f_{12}\\f_{21}&f_{22}\end{pmatrix}\begin{pmatrix}x_1\\x_2\end{pmatrix}. \]
        \item 次の$f_1,f_2$の直和の特別な場合を特に「直和」と呼ぶこともある：
        \[ f=\begin{pmatrix}f_{1}&0\\0&f_{2}\end{pmatrix} \]
    \end{enumerate}
\end{definition}

\begin{example}\mbox{}
    \begin{enumerate}
        \item 第一射影は$\pr_1=\id_{V_1}\oplus 0:V_1\oplus V_2\to V_1\oplus 0\simeq V_1$である．この言葉を用いて，$f_1\oplus f_2=f_1\circ\pr_1+f_2\circ\pr_2$である．
        \item $V_1=V_2=W$で，$f_1=f_2=\id$である時，$\id\oplus\id:W\oplus W\to W$は$W$の加法である．
        \item $i_1:W_1\to W,i_2:W_2\to W$を直和が定める標準的単射とすれば，$f_1\oplus f_2=i_1\circ f_1+i_2\circ f_2$と表せる．
    \end{enumerate}
\end{example}

\begin{definition}[行列の直和]
    基底$x_1,\cdots,x_n$を$r$個に分割してそれぞれが生成する部分空間の間に定まる射$(f_i)_{i=1,\cdots,r}$の直和$f_1\oplus\cdots\oplus f_r:V\to W$の行列表示は，
    \[ A_1\oplus\cdots\oplus A_r:=\begin{pmatrix}A_1&0&\cdots&0\\0&A_2&\ddots&\vdots\\\vdots&\ddots&\ddots&0\\0&\cdots&0&A_r\end{pmatrix} \]
    となる．$A_1=\cdots=A_r=A$の時，行列の冪と区別して$A^{\oplus r}$と表す．
\end{definition}

\begin{example}[部分空間と行列表示]
    $V,W$の部分空間を，それぞれの基底$x_1,\cdots,x_n,y_1,\cdots,y_m$について，$V'=\langle x_1,\cdots,x_{n'}\rangle,W'=\langle y_1,\cdots,y_{m'}\rangle$と
    取った時，線型写像$f:V\to W$の表現行列が
    \[ A=\begin{pmatrix}A_{11}&A_{12}\\A_{21}&A_{22}\end{pmatrix} \]
    という形になる．この時$V'$の像がすっぽりハマる$f(V')\subset W'$の条件は$A_{21}=0$である．
    この時$f|_{V'}:V'\to W'$の行列表示が$A_{11}$である．
    このように$0$がたくさん出現する行列表示を見つけるのが目標として立つ．
\end{example}

\subsection{線型写像の行列表示}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    \begin{enumerate}
        \item $f\in\Hom_K(V,W)$の$\b{x}\in V^n,\b{y}\in W^m$-行列表示とは，$f(\b{x})^\top=\b{y}^\top A$を満たす$A\in M_{mn}(K)$をいう．
        \item 基底$\b{x},\b{y}\in V^n$の変換行列とは，$\b{y}^\top=\b{x}^\top P$を満たす$P\in\GL_n(K)$をいう．
    \end{enumerate}
    この考え方は，標準的な方法によるペアリング$\brac{-,-}:V^n\times K^n\to W$を考えていることに当たる．
\end{tcolorbox}

\begin{definition}
    $V,W\in\FinVect_K$の基底を$\b{x}=(x_1,\cdots,x_n)^\top\in V^n,\b{y}=(y_1,\cdots,y_m)^\top\in W^m$とする．
    \begin{enumerate}
        \item 元$x\in V$の\textbf{ベクトル表示}$a\in\R^n$とは，$\b{x}^\top a=x$を満たす元$a\in\R^n$をいう．
        \item 左作用$\b{x}^\top:\R^n\to V$を\textbf{基底$\b{x}\in V^n$が定める同型}という．
        \item 線型写像$f\in\Hom_K(V,W)$の\textbf{行列表示}$A\in M_{mn}(K)$とは，$f(\b{x})^\top=\b{y}^\top A$を満たすものをいう．
    \end{enumerate}
\end{definition}
\begin{remarks}[始基底の行き先の終基底による表示を列ベクトルとした行列]\mbox{}
    \begin{enumerate}
        \item 行列表示$A=(a_1\cdots a_n)$の第$j$行$a_j\in\R^m$は，元$f(x_j)\in W$の$\b{y}$に関するベクトル表示になっている：$f(x_j)=\b{x}^\top a_j$．
        \item 特に，$\b{x}$から$\b{y}$への底の変換行列$P$の第$j$行は，$y_j$の$\b{x}$に関するベクトル表示に等しい．
    \end{enumerate}
\end{remarks}

\begin{proposition}[線型写像と行列表示の対応]
    定義の設定下で，$v\in V$のベクトル表示を$a\in\R^n$，$w:=f(v)\in W$のベクトル表示を$b\in\R^m$とする：
    \[\begin{cases}
        v=\b{x}^\top a,\\
        w:=f(v)=\b{y}^\top b.
    \end{cases}\]
    このとき，$b=Aa$が成り立つ．
\end{proposition}
\begin{Proof}
    $f$の行列表示$A$は$f(\b{x})^\top =\b{y}^\top A$を満たすから，これと$f$の線型性から
    \[\b{y}^\top b=w=f(v)=f(\b{x}^\top a)=(f(\b{x}))^\top a\]
    より，$\b{y}^\top b=\b{y}^\top Aa$を得る．$\b{y}$は$W$の基底だから，$b=Aa$が必要．
\end{Proof}

\begin{theorem}[正方行列表示の変換]
    $V=W$とし，$\varphi\in\Aut_K(V)$を$\b{x}$を$\b{y}$に写す線型同型，$P$をその$\b{x}$に関する行列表示とする：$\varphi(\b{x})^\top=\b{y}^\top=\b{x}^\top P$．
    \begin{enumerate}
        \item $P$は$\id_V$の$\b{y},\b{x}$に関する行列表示に等しい．
        \item 任意の$f\in\End_K(V)$の$\b{x}$に関する行列表示$A$に対して，$P^{-1}AP$が$\b{y}$に関する行列表示を与える．
    \end{enumerate}
    この$P$を，$\b{x}$から$\b{y}$への\textbf{底の変換行列}という．
\end{theorem}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 定義から明らかである．
        \item $A$は$\b{x}$に関する行列表示だから$f(\b{x})^\top=\b{x}^\top A$．これと$f$の線型性より，
        \[f(\b{y})^\top=f(\b{x})^\top P=\b{x}^\top AP=\b{y}^\top P^{-1}AP.\]
    \end{enumerate}
\end{Proof}

\begin{corollary}[一般の行列表示の変換]
    $V$の基底$\b{x},\b{y}$と$V'$の基底$\b{x}',\b{y}'$とを考え，それぞれの底の変換行列を$P,Q$とする：
    \[\b{y}^\top=\b{x}^\top P,\quad \b{y}'^\top=\b{x}'^\top Q.\]
    このとき，任意の$f\in\Hom_K(V,V')$の$\b{x},\b{x}'$-行列表示$A$と$\b{y},\b{y}'$-行列表示$A'$とについて，$A'=Q^{-1}AP$の関係がある．
\end{corollary}
\begin{Proof}
    $f=f\circ\id_V=\id_W\circ f$に注目すると，この$\b{y},\b{x}'$-行列表示が$AP,QA'$と二通りで得られるから，$AP=QA'$が必要．
\end{Proof}
\begin{remarks}[基底の変換行列は係数ベクトルには反変に作用する]
    定理の(1)で，底の変換行列を$\id_V$の行列表示に読み替えたが，これは定義式$y^\top=x^\top A$が，
    任意のベクトル$a\in K^n$については$x^\top a=y^\top P^{-1}a\in V$の関係を満たすことを意味している．
\end{remarks}

\subsection{像・核と全射・単射}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    群論の半直積と違って，
    $V=W_1\oplus W_2$を判定するための強力な必要十分条件がある(準同型定理\ref{prop-pre-homomorphism-thm})．
\end{tcolorbox}

\begin{proposition}[部分空間の像・逆像も部分空間]
    $V,W\in\Vect_K$，$f:V\to W$を線型写像とする．
    \begin{enumerate}
        \item $V'\in S(V)$ならば，$f(V')\in S(W)$．
        \item $W'\in S(W)$ならば，$f^{-1}(W')\in S(V)$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $f$の線形性より，$0\in f(V')$かつ$af(x)+bf(y)=f(ax+by)\in f(V')$．
        \item $f$の線形性より，$0\in f^{-1}(W')$かつ$af(x)+bf(y)=f(ax+by)\in W'$から従う．
    \end{enumerate}
\end{Proof}

\begin{proposition}[単射の特徴付け]\label{prop-characterization-of-monos-in-terms-of-Kernel}
    $V,W\in\Vect_K$，$f:V\to W$を線型写像とする．次の２条件は同値である．
    \begin{enumerate}
        \item $f$は単射．
        \item $\Ker f=0$．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    $f$が単射なら，$f^{-1}(0)$はただ一つの元を持つ．$f(0)=0$より$\Ker f=0$．

    $\Ker f=0$ならば，$f(x)=f(x')$の仮定の下で$f(x-x')=0$が必ず成り立つから，$x=x'$が従う．
\end{Proof}

\begin{corollary}[可逆性と全単射は同値]\label{cor-invertible-if-全単射}
    $V,W\in\Vect_K$，$f:V\to W$を線型写像とする．次の３条件は同値である．
    \begin{enumerate}
        \item $f$は同型．
        \item $f$は全単射．
        \item $\Im f=W\land\Ker f=0$．
    \end{enumerate}
\end{corollary}

\begin{proposition}[準同型定理：核の補空間の特徴付け]\label{prop-pre-homomorphism-thm}
    $V,W\in\Vect_K$，
    $f:V\to W$を全射な線型写像とする．$V$の部分空間$V'$について，次の２条件は同値である．
    \begin{enumerate}
        \item $V=V'\oplus\Ker f$．
        \item $f|_{V'}:V'\to W$は可逆．
    \end{enumerate}
    すなわち，この2条件を満たす$V'\in\S(V)$は$V'\simeq V/\Ker f\simeq\Coim f$を満たす．
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] $f|_{V'}$は全射かつ単射であるため．
        \item[(2)$\Rightarrow$(1)] $V'\cap\Ker f=0$かつ$V=V'+\Ker f$を示せば良い．前者は$f|_{V'}$が同型であることから．
        後者について，任意の$x\in V$を取ると，$x':=f|_{V'}^{-1}(f(x))$とすると，$x-x'\in\Ker f$より，$x=x'+(x-x')\in V'+\Ker f$を得る．
    \end{description}
\end{Proof}

\begin{corollary}[全射の特徴付け]
    $V,W\in\Vect_K$，
    線型写像$f:V\to W$について，次の２条件は同値である．
    \begin{enumerate}
        \item $f$は全射である．
        \item $V$の部分空間$V'$であって，$f|_{V'}:V'\to W$が可逆となるものが存在する．
    \end{enumerate}
\end{corollary}
\begin{Proof}
    (1)$\Rightarrow$(2)は命題による．(2)$\Rightarrow$(1)は$f(V)\supset f(V')=W$より明らか．
\end{Proof}

\subsection{次元定理}

\begin{proposition}[線型写像の階数]
    $\dim V=n,\dim W=m,f:V\to W$について，次は同値：
    \begin{enumerate}
        \item $\rank f=r$．
        \item 基底$(x_1,\cdots,x_n)\in V^n,(y_1,\cdots,y_m)\in W^m$で，$f(x_i)=y_i1_{[r]}(i)\;(i\in[n])$を満たすものが存在する．
        \item $f$は$\diag(1_r,0_{n-r})$を行列表示に持つ．
    \end{enumerate}
\end{proposition}

\begin{corollary}[次元定理]\label{cor-rank-nullity-theorem}
    \[\dim V=\dim(\Ker f)=\rank f.\]
\end{corollary}

\subsection{完全系列と全射・単射}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=線形写像の全射は極めて奇妙な性質を持つ]
    準同型定理より，任意の全射$f:V\epi W$に対して，$V/\Ker f\simeq W$が誘導される．$V/\Ker f$を構成せずとも，これは補空間に同型になるから，これをみつけて定義域から排除することができれば，全射線型写像から同型を得られる．
    次元定理$\dim V=\dim\Ker f+\rank f$の消息を最もうまく運ぶ形式が完全系列である．
    線型空間の直和分解を，核と像によって与える．
\end{tcolorbox}

\begin{definition}[exact sequence]
    $f:U\to V,g:V\to W$に対し，$\Ker g=\Im f$が成り立つ時，図式
    \[ U\xrightarrow{f}V\xrightarrow{g}W \]
    を\textbf{完全系列}という．または，組$(f,g)$が\textbf{$V$で完全}ともいう．
\end{definition}

\begin{lemma}[図式が完全であることの部分空間と直和の言葉による特徴付け]
    線型写像の列
    \[ U\xrightarrow{f}V\xrightarrow{g}W \]
    について，
    \begin{enumerate}
        \item 次の条件は同値である．
        \begin{enumerate}[(1)]
            \item $g\circ f=0$である（$\Im f\subset\Ker g$）．
            \item 直和分解$U=U_1\oplus U_2,V=V_1\oplus V_2\oplus V_3, W=W_1\oplus W_2$が存在して，
            $U_1=\Ker f,V_1=\Im f,V_1\oplus V_3=\Ker g,W_1=\Im g$が成り立つ．
        \end{enumerate}
        \item 次の条件は同値である．
        \begin{enumerate}[(1)]
            \item 図式$U\xrightarrow{f}V\xrightarrow{g}W$が完全である．
            \item 1.の(2)で$V_3=0$としたものが成り立つ．
        \end{enumerate}
    \end{enumerate}
\end{lemma}

\begin{corollary}[全射・単射の図式による特徴付け]
    線型写像$f:V\to W$について，次の条件は同値である．
    \begin{enumerate}
        \item \begin{enumerate}[(1)]
            \item $f$は単射である．
            \item $0\to V\xrightarrow{f}W$が完全である．
            \item (monic) $r\circ f=1_V$を満たす線型写像$r:W\to V$が存在する．
        \end{enumerate}
        \item \begin{enumerate}[(1)]
            \item $f$は全射である．
            \item $V\xrightarrow{f}W\to 0$が完全である．
            \item (epic) $f\circ s=1_W$を満たす線型写像$s:W\to V$が存在する．
        \end{enumerate}
    \end{enumerate}
\end{corollary}

\subsection{直和分解と射影子の一対一対応}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=線型空間の直和分解は冪等子と一対一対応する]
    任意の部分空間には補空間が取れる．
    これは，射影と部分空間とが1対1対応することを考えれば，$\id_V-e$によって補空間の定める射影が得られることによる．
\end{tcolorbox}

\begin{proposition}[冪等自己準同型と直和分解の一対一対応]\mbox{}
    \begin{enumerate}
        \item 線型写像$e:V\to V$が$e^2=e$を満たすならば，$V=\Im e\oplus\Ker e$である．
        \item 次の写像$F$は可逆である：
        \[\xymatrix@R-2pc{
            {\{e\in\End(V)\mid e^2=e\}}\ar[r]^-F&{\{V=W\oplus W'を満たすVの部分空間の組(W,W')\}}\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            e\ar@{|->}[r]&{(\Im e,\Ker e)}
        }\]
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $e|_{\Im e}=\id_{\Im e}$は同型であるため，準同型定理\ref{prop-pre-homomorphism-thm}から．
        \item 次の写像$G$が逆写像となっていることを示せば良い：
        \[\xymatrix@R-2pc{
            {\{V=W\oplus W'を満たすVの部分空間の組(W,W')\}}\ar[r]^-F&{\{e\in\End(V)\mid e^2=e\}}\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (W_1,W_2)\ar@{|->}[r]&e:=i_{W_1}\circ\pr_{W_1}
        }\]
        $e^2=e$が成り立ち，$G$がwell-definedであることは言を俟たない．
        \begin{description}
            \item[$G\circ F=\id$] 冪等自己準同型$e^2=e$に対して，$i:\Im e\mono V,p:V\epi\Im e$とすると，確かに$e=i\circ p$である．
            \item[$F\circ G=\id$] $e:=i_{W_1}\circ\pr_{W_1}$に対して，$\Im e=W_1,\Ker e=W_2$が成り立っている．
        \end{description}
    \end{enumerate}
\end{Proof}

\begin{definition}[projector]\mbox{}
    \begin{enumerate}
        \item $e^2=e$を満たす自己準同型$e\in\End_K(V)$を$V$の\textbf{射影子}という．
        \item この時$V=\Im e\oplus\Ker e$を\textbf{射影子$e$が定める直和分解}という．
        \item 射影子が定める直和分解が直交分解でもあるとき，\textbf{正射影}ともいう．
    \end{enumerate} 
\end{definition}

\subsection{射影子の特徴付け}

\begin{proposition}[冪等自己準同型の特徴付け]\label{prop-characterization-of-projector}
    $V\in\Vect_K$，$e\in\End(V)$に対して，次の2条件は同値：
    \begin{enumerate}
        \item $e$は射影子である．
        \item $\rank e+\rank(\id_V-e)=n$．
        \item $V=\Im e\oplus\Im(\id_V-e)$．
        \item $\Ker e=\Im(\id_V-e)$．
        \item $\Sp(A)\subset 2$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] $e^2=e$のとき$V=\Im e\oplus\Ker e$であるため．
        \item[(2)$\Rightarrow$(3)] $\Im e+\Im(\id_V-e)=V$を示せば十分であるが，これは任意の$x\in V$について$e(x)+(x-e(x))\in\Im e+\Im(\id_V-e)$であることによる．
        \item[(3)$\Rightarrow$(1)] 実はこのとき$e(\id_V-e)=(\id_V-e)e$が成り立っていることが，$\id=e+(\id-e)$の両辺に$e$を乗じることからわかる．
        この左辺は$\Im e$の元で右辺は$\Im(\id_V-e)$の元であるから，$=0$であることから従う．
        \item[(1)$\Rightarrow$(4)] $\Ker e\subset\Im(\id_V-e)$は明らか．逆は，任意の$x\in\Im(\id_V-e)$について，ある$y\in V$が存在して$y-e(y)=x$であるが，$e(x)=e(y)-e^2(y)=0$である．
        \item[(4)$\Rightarrow$(1)] $e(\id_V-e)=0$より．
        \item[(1)$\Leftrightarrow$(5)] $e$の最小多項式$x^2-x=(x-1)x$の根は$x\in 2=\{0,1\}$である．
    \end{description}
\end{Proof}

\begin{proposition}[1を分解する射影子]
    $1$を分解する自己準同型
    \[\id_V=e_1+\cdots+e_n,\qquad e_1,\cdots,e_n\in\End(V)\]
    について，次は同値：
    \begin{enumerate}
        \item $e_1,\cdots,e_n$はいずれも射影子である．
        \item $\forall_{i\ne j}\;e_ie_j=e_je_i=0$．
        \item $\rank e_1+\cdots+\rank e_n=n$．
        \item $V=\Im e_1\oplus\cdots\oplus\Im e_n$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(1)$\Leftrightarrow$(2)$\Leftrightarrow$(3)] $e_1,e_2+\cdots+e_n$の２つの自己準同型に関する主張とみれば，
        $e_2+\cdots+e_n=\id_V-e_1$であるから，
        上の3条件が同値であることが従う．よって帰納法による．
        \item[(1)$\Leftrightarrow$(4)] $e_1,e_2+e_3+\cdots+e_n$はいずれも射影子だから，$V=\Im e_1\oplus\Im(e_2+\cdots+e_n)$が成り立つ．これを繰り返す．
    \end{description}
\end{Proof}

\subsection{射影子と可換性}

\begin{proposition}
    $e$を射影子，$f:V\to V$を線型写像とする．次は同値：
    \begin{enumerate}
        \item $fe=ef$．
        \item $f(\Im e)\subset\Im e$かつ$f(\Ker e)\subset\Ker e$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 任意の$x\in V$に対して$f(e(x))=e(f(x))$で，左辺は$f(\Im e)$上を走るため．
        また，任意の$x\in\Ker e$について，$e(f(x))=f(e(x))=0$より，$f(x)\in\Ker e$．
        \item[(2)$\Rightarrow$(1)] 射影子$e$は$\Im e$上恒等写像であることに注意すると，任意の$(x,y)\in\Im e\oplus\Ker e=V$について，$f(e(x,y))=f(x,0)=(f(x),0)$かつ$e(f(x,y))=e(f(x),f(y))=(f(x),0)$．
    \end{description}
\end{Proof}

\subsection{射影行列の性質}

\begin{corollary}[冪等行列の標準形]
    $A\in M_n(\R)$は冪等行列で，$\rank A=r$とすると，
    \[\Delta_r:=\diag(\underbrace{1,\cdots,1}_{r\text{個}},0,\cdots,0)\]
    に相似である．
\end{corollary}
\begin{Proof}
    冪等であることと$\Sp(A)\in\{0,1\}$であることとが同値であるため\ref{prop-characterization-of-projector}．
\end{Proof}

\begin{corollary}
    $A\in M_n(\R)$が冪等であるとする．次が成り立つ：
    \begin{enumerate}
        \item $\rank A=\Tr(A)$．
        \item 特に，$A\in M_2(\R)$が冪等ならば，対角行列であるか，行列の跡が1であるか，零であるかである．
        \item 特に，単位行列でない冪等行列は特異である．
    \end{enumerate}
\end{corollary}

\subsection{対称行列と正射影}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Gram行列は半正定値対称であるが，これは基本的に射影を表す．
\end{tcolorbox}

\begin{definition}
    内積空間$V$上の
    射影子$e\in\End(V)$がさらに自己共役$e^*=e$であるとき，
    これを\textbf{直交射影}または\textbf{正射影}という．
\end{definition}

\begin{proposition}[直交射影の特徴付け]
    射影子$e\in\End(V)$について，次は同値：
    \begin{enumerate}
        \item $e$は直交射影である：$e^*=e$．
        \item $\Im e\perp \Ker e$．
        \item $V$がノルム空間でもあるとき，$e$はノルム減少的である\cite{柳井-竹内-一般逆行列}定理2.22．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    転置とは線型写像$f:V\to W$の双対$f^*:W^*\to V^*$を考えることであった．
    (1)$\Leftrightarrow$(2)は双対写像の像・核を零化空間によって表す一般論\ref{prop-dual-map-in-terms-of-annihilator}による．
\end{Proof}

\begin{proposition}[部分空間の演算の正射影の演算への対応]
    $V\in\FVS_K,W_1,W_2$を部分空間，$P_1,P_2$を対応する正射影とする．
    \begin{enumerate}
        \item $W_1\perp W_2$と$P_1P_2=P_2P_1=0$とは同値．
        \item $W_1\subset W_2$と$P_1P_2=P_2P_1=P_1$とは同値．
        \item $P_1P_2=P_2P_1$と$W_1=W_1\cap W_2+W_1\cap W_2^\perp$と$W_2=W_1\cap W_2+W_1^\perp\cap W_2$とは同値．このとき，$A_1A_2=A_2A_1$は$W_1\cap W_2$への正射影である．
    \end{enumerate}
\end{proposition}

\begin{proposition}[直交射影行列の表示]
    $A=(a_1\;\cdots\;a_m)\in M_{mn}(\R)$は$\rank A=m\le n$を満たすとする．
    $A(A^\top A)^{-1}A^\top$は$A$の列空間$\Im A$への直交射影である．
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 任意に$x=:A\al\in\Im A$を取ると，
        \[A(A^\top A)^{-1}A^\top x=A(A^\top A)^{-1}(A^\top A)\al=A\al=x.\]
        任意に$x\in(\Im A)^\perp$を取ると，$A^\top x=0$であるから，特に$A(A^\top A)^{-1}A^\top x=0$．
    \end{enumerate}
\end{Proof}

\begin{example}[直線への正射影を表す行列]
    $x\in\R^n$の生成する部分空間$\R x$への正射影は，
    $x^\top x=\norm{x}^2$に注意すれば，
    \[\frac{1}{\norm{x}^2}xx^\top=\frac{1}{\norm{x}^2}\begin{pmatrix}x_1x_1&x_1x_2&\cdots&x_1x_n\\x_2x_1&x_2x_2&\cdots&x_2x_n\\\vdots&\ddots&\ddots&\vdots\\x_nx_1&x_nx_2&\cdots&x_nx_n\end{pmatrix}\]
    で表される．
\end{example}

\section{線型写像と構成}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    任意の線型写像は完全系列に分解出来る．
    この理論を得るには，商の普遍構成が必要になる．
    すると，テンソル積の言葉が得られて，ペアリングというさらなる構成が拓かれる．
\end{tcolorbox}

\subsection{商の定義と基底}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    商空間$V/W$の基底は，$W$の基底を$V$に延長したものの像$0,\cdots,0,\overline{x_{m+1}},\cdots,\overline{x_n}$として得られる．
\end{tcolorbox}

\begin{proposition}[quotient space, canonical surjection, class]
    $V\in\Vect_K$とし，$W$を部分空間とする．部分集合$x+W$を\textbf{類}と呼び，これらを集めた集合$V/W$を\textbf{商空間}という．類への対応を$p:V\to V/W$とする．
    \begin{enumerate}
        \item $p:V\to V/W$は全射であり，$p(x)=p(y)$は$x-y\in W$と同値である．
        \item 写像$+:V/W\times V/W\to V/W$と$\cdot:K\times V/W\to V/W$で，それぞれ次の図式を可換にするようなものが唯一つ存在する．
        \[\xymatrix{
            V\times V\ar[r]^-+\ar[d]_-{p\times p}&V\ar[d]^-p&K\times V\ar[r]^-{\cdot}\ar[d]_-{\id_K\times p}&V\ar[d]^-p\\
            V/W\times V/W\ar[r]^-+&V/W&K\times V/W\ar[r]^-{\cdot}&V/W
        }\]
        これを$V/W$上の加法とスカラー倍と定めると，代数法則$\overline{x}+\overline{y}:=\overline{x+y},a\overline{x}=\overline{ax}$が成り立つ．
        \item $V/W$はこの加法とスカラー倍について線型空間となる．
        \item 全射$p:V\to V/W$は線型写像である．これを\textbf{標準全射}という．
        \item 標準全射$p:V\to V/W$の核は$W$である．
    \end{enumerate}
\end{proposition}

\begin{corollary}[商空間の基底は，延長したものの像]
    $x_1,\cdots,x_n$を$V$の基底，$x_1,\cdots,x_m$を$W$の基底とすると，
    $\overline{x_{m+1}},\cdots,\overline{x_n}$が$V/W$の基底である．
    従って，$\dim V/W=\dim V-\dim W$．
\end{corollary}

\subsection{商空間の普遍性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    これは竟に，\textbf{補空間に普遍的な名前がついた}のである．
\end{tcolorbox}

\begin{proposition}[全ての補空間は商空間に同型]
    $p:V\epi V/W$を商写像とする．
    部分空間$V'\subset V$が$V=W\oplus V'$を満たすならば，$p|_{V'}:V'\to V/W$は同型を与える．
\end{proposition}
\begin{Proof}
    $V=\Ker p\oplus V'$と$p|_{V'}:V'\to V/W$が可逆であることとは同値であるため\ref{prop-pre-homomorphism-thm}．
\end{Proof}

\begin{proposition}[商空間の普遍性]\label{prop-universality-of-quotient-spaces}
    $V,V'\in\Vect_K$とし，$W$を$V$の部分空間とし，$f:V\to V'$を線型写像とする．
    次の２条件は同値である．
    \begin{enumerate}
        \item $g\circ p=f$を満たす線型写像$g:V/W\to V'$が唯一つ存在する．
        \item $f(W)=0$である．
    \end{enumerate}
    \[\xymatrix{
        V\ar@{->>}[r]^-p\ar[dr]_-f&V/W\ar@{.>}[d]^-g\\
        &V'
    }\]
\end{proposition}
\begin{remarks}
    $f\in\End(V)$と$f$-安定部分空間$W\in S(V)$について，$V/W$上に線型写像$f_1$が$f_1(x)=f(x)\;\on V/W$で定まる．$f_1:V/W\to V$も\textbf{引き起こされた写像}という．
\end{remarks}

\subsection{線型写像の標準分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=線型写像の準同型定理は，任意の線型写像を完全系列に分解する]
    Vectでは，単射は$\Ker f$の退化（命題\ref{prop-characterization-of-monos-in-terms-of-Kernel}），全射は余核$V'\setminus\Im f$の退化（命題\ref{prop-pre-homomorphism-thm}）で表される．
    これは，完全系列の言葉で観るとわかりやすいことを確認した．
    ここで，任意の線型写像は完全系列に分解出来る．
\end{tcolorbox}

\begin{proposition}[fundamental theorem on homomorphisms, canonical decomposition]\label{prop-homomorphism-thm}
    $V,V'\in\Vect_K$とし，$f:V\to V'$を$K$-線型写像とする．$f$が引き起こす線型写像$\overline{f}:V/\Ker f\to\Im f$は同型である．
    \[\xymatrix{
        V\ar[r]^-f\ar[d]_-p&V'\\
        V/\Ker f\ar[r]^-{\overline{f}}&\Im f\ar[u]_-i
    }\]
\end{proposition}
\begin{Proof}
    任意の$f(x)\in\Im f$に対して，$\overline{x}\in\overline{f}^{-1}(f(x))$であるから，$\overline{f}$は全射である．次に$\Ker\overline{f}=0$を示す．
    任意に$\overline{x}\in\Ker\overline{f}$を取ると$\overline{f}(\overline{x})=0$である．すると，$f(x)=0$である．
\end{Proof}

\begin{corollary}
    特に，$V=\Im f\oplus\Ker f$が成り立つ．
\end{corollary}
\begin{Proof}
    準同型定理より$V/\Ker f\simeq\Im f$．命題\ref{prop-pre-homomorphism-thm}より，
    $V\simeq V/\Ker f\oplus\Ker f\oplus\Im f\oplus\Ker f$．
\end{Proof}

\begin{remarks}[Gilbert Strangによってfundamental theorem of linear algebraとしても教育されている]
    各行列$A\in M_{mn}(K)$によって，次が定まる．

    \begin{center}
        \begin{tabular}{l|l|l}
            像&$\Im(A)$&列空間\\
            核&$\Ker(A)$&零空間\\
            余像&$\Coim(A)=\Im({}^t\!A)$&行空間\\
            余核&$\Coker(A)=\Ker({}^t\!A)$&
        \end{tabular}
    \end{center}
    
    線型写像$f:V\to W$について，
    \begin{align*}
        V&=\Ker f\oplus\Coim f,&W&=\Im f\oplus\Coker f
    \end{align*}
    が成り立つ．核と余核，像と余像の次元は等しいから，
    これは次元定理(rank-nullity theorem)\ref{cor-rank-nullity-theorem}
    $\dim V=\dim\Ker f+\rank f$を含意する．
    また，この分解は基底に依らない標準的な分解で，ただの補空間ではなく，$K^n$の標準的な内積に関する直交補空間である：
    \begin{align*}
        \Ker A=(\Coim {}^t\!A)^\bot,\quad\Im A=(\Coker {}^t\!A)^\bot
    \end{align*}
\end{remarks}

\begin{corollary}[第二・第三同型定理]
    $W,W'$を$V$の部分空間とする．
    \begin{enumerate}
        \item 包含写像$i:W'\to W+W'$が引き起こす写像$W'/(W\cap W')\to(W+W')/W$は同型である．
        \item $W\supset W'$とする．標準写像$V/W'\to V/W$は同型$(V/W')/(W/W')\to V/W$を引き起こす．
    \end{enumerate}
\end{corollary}

\subsection{テンソル積の定義と普遍性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    直和の普遍性は$\Hom(V\oplus W,V')\to\Hom(V,V')\times\Hom(W,V')$が全単射であることである．

\end{tcolorbox}

\begin{definition}[tensor product (Whitney 1938)]
    $V,W\in\Vect_K$の\textbf{テンソル積}とは，代数的直和の空間
    \[K^{(V\times W)}:=\Brace{f\in\Map(V_1\times V_2,K)\mid f(x,y)=0\;\fe\; (x,y)\in V\times W}=\bigoplus_{i\in K}V\times W\]
    の次の部分空間$R$に関する商空間$V\otimes_KW:=K^{(V\times W)}/R$である：
    \begin{enumerate}
        \item $R_1:=\Brac{1_{(x+x',y)}-1_{(x,y)}-1_{(x',y)}}_{x,x'\in V,y\in W}$．
        \item $R_2:=\Brac{1_{(x,y+y')}-1_{(x,y)}-1_{(x,y')}}_{x\in V,y,y'\in W}$．
        \item $R_3:=\Brac{1_{(ax,y)}-a1_{(x,y)},\;1_{(x,ay)}-a1_{(x,y)}}_{a\in K,x\in V,y\in W}$．
        \item $R:=R_1+R_2+R_3$．
    \end{enumerate}
\end{definition}

\begin{proposition}[普遍双線型写像]\label{prop-universality-of-tensor-product}
    写像
    \[\xymatrix@R-2pc{
        \otimes:V\times W\ar@{->>}[r]&V\otimes W\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x,y)\ar@{|->}[r]&x\otimes y:=\o{1_{(x,y)}}
    }\]
    について，
    \begin{enumerate}
        \item 双線型写像である．
        \item 任意の$V'\in\Vect_K$に対して，これが引き起こす対応$\otimes^*:\Hom(V\otimes W,V')\to\Brace{b:V\times W\to V'\mid b\text{は双線型写像}}$は全単射である：
        \[\xymatrix{
            V\otimes W\ar[d]_-f&V\times W\ar[l]_-{\otimes}\ar@{-->}[dl]^-{b_f}\\
            V'
        }\]
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 構成法から明らかである．
        $R_1$でも割ってることより，$(x+x')\otimes y=x\otimes y+x'\otimes y$．
        $R_2$でも割ってることより，$x\otimes(y+y')=x\otimes y+x\otimes y'$．
        $R_3$で割っていることより，$ax\otimes y=x\otimes ay=a(x\otimes y)$．
        \item 命題\ref{prop-linear-map-via-basis}による線型写像と基底の行き先の対応を$F$とすると，次の図式が成り立っている：
        \[\xymatrix{
            \Hom(K^{(V\times W)},V')\ar[r]^-F&\Map(V\times W,V')\\
            \Hom(K^{(V\times W)}/R,V')\ar[u]^-{p^*}&\{b:V\times W\to V'\mid b\text{bilinear}\}\ar@{^{(}->}[u]
        }\]
        この大回りの一周が$\otimes^*$に当たり，これが全単射であることを示せば良い．
        $p^*$は単射であり，像は
        \[\Im p^*=\Brace{h\in\Hom(K^{(V\times W)},V')\mid h(R)=0}.\]
        である．すると，$g\in F(\Im p^*)$と$g:V\times W\to V'$が双線型であることとが同値であることを示せば良いが，これは(1)と同様な議論である．
    \end{enumerate}
\end{Proof}

\subsection{テンソルの具体的な扱い}

\begin{proposition}
    $V,W\in\Vect_K$について，
    \begin{enumerate}
        \item $\dim W=1$とする．$V\simeq V\otimes W$．
        \item $\dim V=1$とする．$W\simeq V\otimes W$．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    $W$の基底を$y$とし，$f:V\to V\otimes W$を$x\mapsto x\otimes y$と定めるとこれは線型写像である．
    $g:V\otimes W\to V$を双線型写像$(x,ay)\mapsto ax$が定める線型写像とする．
    すると，これらは互いに逆である．
\end{Proof}
\begin{remarks}
    実は線型空間$V\in\Vect_K$のスカラー倍$V\otimes K\to V$は同型を与えている．
\end{remarks}

\begin{proposition}[テンソル積の分配法則]\label{prop-distributive-law-in-categorical-sense}
    $V,W\in\Vect$とする．
    \begin{enumerate}
        \item $V=V_1\oplus V_2$の時，次の線型写像は同型である．
        \[\xymatrix@R-2pc{
            f:V\otimes W\ar[r]&(V_1\otimes W)\oplus(V_2\otimes W)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x_1+x_2\otimes y\ar@{|->}[r]&(x_1\otimes y,x_2\otimes y)
        }\]
        \item $W=W_1\oplus W_2$の時，次の線型写像は同型である．
        \[\xymatrix@R-2pc{
            f:V\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x\otimes (y_1,y_2)\ar@{|->}[r]&(x\otimes y_1,x\otimes y_2)
        }\]
    \end{enumerate}
\end{proposition}
\begin{Proof}
    次の２つの線型写像$g_1,g_2$の和を$g_1+g_2=:g:(V_1\otimes W)\oplus(V_2\otimes W)\to V\otimes W$とすると，これが$f$の逆を与えることを示す．
    \[\xymatrix@R-2pc{
        g_1:V_1\otimes W\ar[r]&V\otimes W&g_2:V_2\otimes W\ar[r]&V\otimes W,\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x_1\otimes y\ar@{|->}[r]&(x_1,0)\otimes y&x_2\otimes y\ar@{|->}[r]&(0,x_2)\otimes y
    }\]
    \[\xymatrix{
        V_1\otimes W\ar@{^{(}->}[dr]^-{g_1}\ar@{^{(}->}[d]_-{i_1}\\
        (V_1\otimes W)\oplus(V_2\otimes W)\ar[r]^-g&(V_1\oplus V_2)\otimes W\\
        V_2\otimes W\ar@{^{(}->}[u]^-{i_2}\ar@{^{(}->}[ur]_-{g_2}
    }\]
    \begin{description}
        \item[$g\circ f=\id_{(V_1\oplus V_2)\otimes W}$] $x_1\in V_1,x_2\in V_2,y\in W$を任意に取る．
        \[g(f(x_1+x_2\otimes y))=g(x_1\otimes y,x_2\otimes y)=x_1\otimes y+x_2\otimes y=(x_1+ x_2)\otimes y.\]
        \item[$f\circ g=\id_{(V\otimes W_1)\oplus(V\otimes W_2)}$] $x_1\in V_1,x_2\in V_2,y\in W$を任意に取る．
        $f(g(x_1\otimes y,0))=f((x_1,0)\otimes y)=(x_1\otimes y,0)$．第二成分についても同じ．
    \end{description}
\end{Proof}

\begin{corollary}[テンソル空間の基底は基底のテンソル積]\label{cor-the-basis-of-tensor-product}
    $x_1,\cdots,x_n$が$V$の基底で，$y_1,\cdots,y_m$が$W$の基底ならば，$x_1\otimes y_1,\cdots,x_n\otimes y_1,\cdots,x_1\otimes y_m,\cdots,x_n\otimes y_m$は$V\otimes W$の基底である．
    従って，$\dim(V\times W)=\dim V\cdot\dim W$．
\end{corollary}
\begin{Proof}
    $W=Ky_1\oplus\cdots\oplus Ky_m$より，命題\ref{prop-distributive-law-in-categorical-sense}より，
    直和分解$V\times W=(V\otimes Ky_1)\oplus\cdots\oplus(V\otimes Ky_m)$が得られる．
    各$j\in[m]$に対して，$x_1\otimes y_j,\cdots,x_n\otimes y$は$V\otimes Ky_j$の基底である．
    よって，これを並べると，$V\otimes W$の基底を得る．
\end{Proof}

\begin{remarks}[ベクトル束のテンソル]
    ベクトル束のテンソルとは，各ファイバー毎にテンソル積を取った束に自然に位相を入れて得られるもので，テンソル束
    $T(a,b):=T(M)^{\otimes a}\otimes T^*(M)^{\otimes b}$を\textbf{反変$a$次，共変$b$次のテンソルバンドル}という．この切断を，反変$a$次，共変$b$次のテンソル場という．
\end{remarks}

\subsection{基本テンソル}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    テンソル積の自由加群の商としての構成から明らかに，単純テンソルが基底であるが，
    唯一の落とし穴は，見かけが違うだけで他の単純テンソルと同じ剰余類に属する可能性がある(テンソル積の基底は基底のテンソル積)．
    基本テンソルを行列表示$x\otimes y:=(x_i\otimes y_j)_{i\in[m],j\in[n]}$すると，任意の元を$A\in M_{nm}(K)$を用いて${}^t\!(x\otimes y)A\in V\otimes W$と表せる．
\end{tcolorbox}

\begin{definition}[simple / decomposable tensor]
    テンソル積$V_1\otimes\cdots\otimes V_k$の元$x$が\textbf{単純テンソル}であるとは，
    次を満たすことをいう：
    \[\exists_{k\in\N}\;\exists_{v_i\in V_i}\;x=v_1\otimes\cdots\otimes v_k.\]
\end{definition}

\begin{proposition}[単純テンソルの行き先が定まればテンソル積からの線型写像が定まる]\label{prop-linear-map-from-tensor-product-is-determined-by-basis-destination}
    $V,W,V'\in\Vect_K$とする．線型写像$f,g:V\otimes W\to V'$に対して，次の２条件は同値．
    \begin{enumerate}
        \item $f=g$．
        \item $\forall_{x\in V,y\in W}\;f(x\otimes y)=g(x\otimes y)$．
    \end{enumerate}
    \[\xymatrix{
        V\times W\ar[r]^-{\otimes}\ar@{.>}[dr]&V\otimes W\ar[d]^-{f,g}\\
        &V'
    }\]
\end{proposition}
\begin{Proof}
    (2)$\Rightarrow$(1)を示せば良い．$b_f:=f\circ\otimes,b_g:=g\circ\otimes$とするとこれは双線型写像である．
    (2)の条件は$b_f=b_g$を意味する．テンソル積の普遍性から，これは$f=g$と同値．
\end{Proof}

\begin{proposition}[テンソルの非可換条件]
    $x,y\in V$について，次の条件は同値である．
    \begin{enumerate}
        \item $x,y\in V$は一次独立．
        \item $x\otimes y\ne y\otimes x\in V\otimes V$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] $x\otimes y=y\otimes x$とすると，命題\ref{prop-tensors}より，$y=ax\land x=a^{-1}y$を得るが，これは$x,y$が一次独立であることに矛盾．よって，$x\otimes y\ne y\otimes x$．
        あるいは直接的には，$x,y$が一次独立の時，$\langle x,y\rangle\otimes\langle x,y\rangle$の基底が$x\otimes x,x\otimes y,y\otimes x,y\otimes y$であるため．
        \item[(2)$\Rightarrow$(1)] 対偶を示す．$x,y$が一次独立の時，$\exists k\in K,\; y=kx$であるから，$x\otimes y=kx\otimes x=y\otimes x$．
    \end{description}
\end{Proof}

\begin{proposition}[テンソルの変換]\label{prop-basis-change-of-tensor}
    $x_1,\cdots,x_m\in V$と$x'_1,\cdots,x'_m\in V$を$V$の基底とし，$y_1,\cdots,y_n\in W$と$y'_1,\cdots,y'_n\in W$を$W$の基底とする．
    \begin{itemize}
        \item $P\in\GL_m(K)$を$x_1,\cdots,x_m$から$x'_1,\cdots,x'_m$への底の変換行列とし，
        \item $Q\in\GL_n(K)$を$y_1,\cdots,y_n$から$y'_1,\cdots,y'_n$への底の変換行列とする．
    \end{itemize}
    係数行列$A=(a_{ij}),B=(b_{ij})\in M_{mn}(K)$に対し，次の２条件は同値であることを示せ．
    \begin{enumerate}
        \item $\sum^m_{i=1}\sum^n_{j=1}a_{ij}x_i\otimes y_j=\sum^m_{i=1}\sum^n_{j=1}b_{ij}x'_i\otimes y'_j$．
        \item $A=PB{}^t\!Q$．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    $V\otimes W$の基本ベクトルのなす行列を$x\otimes y:=(x_i\otimes y_j)_{i\in[m],j\in[n]}$とすると，
    基底の変換行列$P,Q$は，
    \[{}^t\!(x\otimes y)P={}^t\!(x'\otimes y),\quad (x'\otimes y)Q=x'\otimes y'\]
    と変換されるから，${}^t\!Q{}^t\!(x\otimes y)P={}^t\!(x'\otimes y')$と変換される．
    $(V\otimes W)^{nm}$の元に右から作用することは，$M_{m,n}(K)$の元に左から作用することに当たるから，
    $PB{}^t\!Q=A$．
\end{Proof}
\begin{remarks}
    次の点に間違いがあった．(1)の等式は${}^t\!(x\otimes y)A={}^t\!(x'\otimes y')B$と表せるわけではない．このままでは$M_n(K)$上の等式になっている．
    テンソル上では，従来のペアリング$\brac{-,-}:V^n\times K^n\to V$が功を奏さない．
\end{remarks}

\subsection{線型写像のテンソル積}

\begin{definition}[tensor product / Kronecker product]
    $f:V\to V',g:W\to W'$に対して，次の線型写像を$f$と$g$の\textbf{テンソル積}$f\otimes g$という：
    \[\xymatrix@R-2pc{
        V\otimes W\ar[r]&V'\otimes W'\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x\otimes y\ar@{|->}[r]&f(x)\otimes g(y)
    }\]
    行列については\textbf{Kronecker積}ともいう．
\end{definition}

\begin{proposition}[テンソル積の行列表示]\label{prop-tensor-product-of-matrices}
    $V,V',W,W'\in\Vect_K$，$f:V\to V',g:W\to W'$を線型写像とする．
    \begin{enumerate}
        \item $\Ker(f\otimes g)=(\Ker f\otimes W)+(V\otimes\Ker g)$である．
        \item $\Im(f\otimes g)=(\Im f)\otimes(\Im g)$である．$\Im f,\Im g$が有限次元ならば，$\Im(f\otimes g)$も有限次元で，$\rank(f\otimes g)=\rank f\cdot\rank g$である．
        \item $V,V',W,W'$を有限次元とし，$f:V\to V'$の基底$x_1,\cdots,x_n\in V$と$y_1,\cdots,y_m\in V'$に関する行列表示を$A\in M_{mn}(K)$とし，$g:W\to W'$の基底$x'_1,\cdots,x'_{n'}\in W$と$y'_1,\cdots,y'_{m'}\in W'$に関する行列表示を$B\in M_{m'n'}(K)$とする．
        この時，$f\otimes g:V\otimes W\to V'\otimes W'$の，基底$x_1\otimes x'_1,\cdots,x_n\otimes x'_1,\cdots,x_1\otimes x'_{n'},\cdots,x_n\otimes x'_{n'}$と$y_1\otimes y'_1,\cdots,y_m\otimes y'_1,\cdots,y_1\otimes y'_{m'},\cdots,y_m\otimes y'_{m'}$に関する行列表示は，行列のテンソル積
        \[A\otimes B=\begin{pmatrix}Ab_{11}&\cdots&Ab_{1n'}\\\vdots&\ddots&\vdots\\Ab_{m'1}&\cdots&Ab_{m'b'}\end{pmatrix}\in M_{(mm')(nn')}(K)\]
        である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1,2.] 
        線型写像$f,g$による空間の標準分解$V=\Ker f\oplus V_1,W=\Ker g\oplus W_1$を考え，$\o{f}:V_1\to\Im f,\o{g}:W_1\to\Im g$をそれぞれが定める同型とする．
        これについて，テンソル積の基底からの特徴づけ\ref{prop-distributive-law-in-categorical-sense}より，
        \[V\otimes W=(\Ker f\otimes\Ker g)\oplus(\Ker f\otimes W_1)\oplus(V_1\otimes\Ker g)\oplus(V_1\otimes W_1)\]
        と分解できる．この前半３項$(\Ker f\otimes\Ker g)\oplus(\Ker f\otimes W_1)\oplus(V_1\otimes\Ker g)=(\Ker f\otimes W)+(V\otimes\Ker g)$への$f\otimes g$の制限は，$x\otimes y\;(x=0\lor y=0)$より，$0$である．
        一方で，$V_1\otimes W_1$への制限は同型$\o{f}\otimes\o{g}$となる（積写像$f\times g$が同型な双線型写像を定めるので，$f\otimes g=\otimes^*(f\times g)$も同型）．
        よって，標準分解\ref{prop-homomorphism-thm}より，
        \begin{align*}
            \Ker(f\otimes g)&=(\Ker f\otimes W)+(V\otimes\Ker g),\\
            \Im (f\otimes g)&=(\Im f)\otimes(\Im g).
        \end{align*}
        \item[3.]
        $f\otimes g$による基底$x_j\otimes x'_{j'}$の行き先が$A\otimes B$の$jj'$成分であるから，
        \begin{align*}
            f(x_j)&=\sum^m_{i=1}a_{ij}y_i,&f(x_{j'})&=\sum^{m'}_{i'=1}b_{i'j'}y'_{i'},
        \end{align*}
        であるから，
        \begin{align*}
            (f\otimes g)(x_j\otimes x'_{j'})&=f(x_j)\otimes g(x'_{j'})=\paren{\sum^m_{i=1}a_{ij}y_i}\otimes\paren{\sum^{m'}_{i'=1}b_{ii'j'}y'_{i'}}\\
            &=\sum^m_{i=1}\sum^{m'}_{i'=1}a_{ij}b_{i'j'}(y_i\otimes y'_{i'})=\sum^{m}_{i=1}a_{ij}(b_{1j'}y_i\otimes y'_1+\cdots+b_{m'j'}y_i\otimes y'_{m'})
        \end{align*}
        より，この$y_1\otimes y'_1,\cdots,y_m\otimes y'_1,\cdots,y_1\otimes y'_{m'},\cdots,y_m\otimes y'_{m'}$の係数を順に縦に並べると，$A$の列ベクトルを右の添字だけを残して$a_j=\begin{pmatrix}a_{1j}\\\vdots\\a_{mj}\end{pmatrix}$と表すと，
        \[\begin{pmatrix}a_jb_{1j'}\\\vdots\\a_jb_{m'j'}\end{pmatrix}\in M_{(mm')1}\]
        となる．よって結論を得る．
    \end{description}
\end{Proof}

\begin{corollary}[単射・全射性の保存]\label{cor-tensor-product-of-linear-maps}\mbox{}
    \begin{enumerate}
        \item $f:V\to V',g:W\to W'$が全射(resp. 単射)ならば，$f\otimes g:V\otimes W\to V'\otimes W'$も全射(resp. 単射)である．
        \item $V'\subset V,W'\subset W$を部分空間とする．商空間への標準全射のテンソル積$V\otimes W\to(V/V')\otimes(W/W')$は，同型\[\o{p\otimes p'}:(V\otimes W)/(V'\otimes W+V\otimes W')\to (V/V')\otimes(W/W')\]を引き起こす．
        \item $V,W\in\FVS_K$とし，$f\in\End_K(V),g\in\End_K(W)$とする．$\Tr(f\otimes g)=\Tr g\cdot\Tr g,\det(f\otimes g)=(\det f)^{\dim W}(\det g)^{\dim V}$である．
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $\Im(f\otimes g)=\Im f\otimes\Im g$より，$f,g$が全射であることと$f\otimes G$が全射であることとは同値．$\Ker(f\otimes g)=(\Ker f\otimes W)+(V\otimes\Ker g)$より単射性も同様．
        \item 標準全射のテンソル積は再び全射である．これに準同型定理を用いることによる．
        \item いずれも，テンソル積の行列表示より．
    \end{enumerate}
\end{Proof}

\begin{example}[線型写像の空間の基底]
    $V,W\in\FVS_K$とする．
    \begin{enumerate}
        \item $V$の基底を$x_1,\cdots,x_n$とし，$f_1,\cdots,f_n\in V^*$を対応する双対基底とする．$y_1,\cdots,y_m$を$W$の基底とする．
        $f:V\to W$を線型写像とし，その$x_1,\cdots,x_n$と$y_1,\cdots,y_m$に関する行列表示を$A=(a_{ij})\in M_{mn}(K)$とすると，$f=\sum^m_{i=1}\sum^n_{j=1}a_{ij}f_j(-)\otimes y_i$が成り立つ．
        \item 
        $x_1,\cdots,x_m\in V,y_1,\cdots,y_n\in W$を基底とし，$f_1,\cdots,f_m\in V^*,g_1,\cdots,g_n\in W^*$をそれらの双対基底とする．
        $b:V\times W\to K$を双線型形式とし，その$x_1,\cdots,x_m$と$y_1,\cdots,y_n$に関する行列表示を$A=(a_{ij})\in M_{mn}(K)$とする．$b$が定める線型写像$V\otimes W\to K$とは，$\sum^m_{i=1}\sum^n_{j=1}a_{ij}f_i\otimes g_j$である．
    \end{enumerate}
\end{example}

\subsection{テンソル積の対応}

\begin{proposition}[テンソル積による完全系列の特徴付け]
    線型写像の列$V'\xrightarrow{f}V\xrightarrow{g}V''$について，次の３条件は同値．
    \begin{enumerate}
        \item $V'\xrightarrow{f}V\xrightarrow{g}V''$は完全系列である．
        \item 任意の$W\in\Vect_K$に対し，$V'\otimes W\xrightarrow{f\otimes 1}V\otimes W\xrightarrow{g\otimes 1}V''\otimes W$は完全系列である．
        \item 任意の$W\in\Vect_K$に対し，$W\otimes V'\xrightarrow{1\otimes f}W\otimes V\xrightarrow{1\otimes g}W\otimes V''$は完全系列である．
    \end{enumerate}
\end{proposition}

\begin{proposition}
    写像
    \[\xymatrix@R-2pc{
        \otimes:\Hom(V,V')\times\Hom(W,W')\ar[r]&\Hom(V\otimes V',W\otimes W')\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (f,g)\ar@{|->}[r]&f\otimes g
    }\]
    について，
    \begin{enumerate}
        \item $-\otimes-$は双線型写像．
        \item 線型写像$\Hom(V,V')\otimes\Hom(W,W')\to\Hom(V\otimes V',W\otimes W')$を引き起こす．
    \end{enumerate}
\end{proposition}

\subsection{複素化}

\begin{definition}[conjugate, complexification]\mbox{}
    \begin{enumerate}
        \item 複素線型空間$V\in\Vect_\C$について，スカラー倍$\rho:\C\times V\to V$を$\rho^*:\C\times V\to V;\rho^*(a,v):=\o{a}v$に取り替えたもの
        がなす線型空間を$V'\in\Vect_\C$で現し，\textbf{共役}という．
        \item $V\in\Vect_\R$上の自己同型$J\in\Aut(V)$で$J^2=-\id$を満たすものを\textbf{複素構造}という．
        \item 作用$\C\times V\to V$が，この$J\in\Aut(V)$を$i\in\C$に対応づけることで$(a+bi)x:=ax+bJx$によって定まる．
        実際，$J^2=-\id$としたから，$\forall_{z,w\in\C}\;(zw)x=z(wx)$は明らかである．
        これがなす線型空間を$V_\C\in\Vect_\C$で現し，\textbf{複素化}という．
    \end{enumerate}
\end{definition}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 線型写像$f:V\to W$の共役$f':V'\to W'$の行列表示は，元の複素共役$\o{A}$になる．
        \item $x=Jx\Rightarrow x=0$より，$V_\C\simeq_\R V\oplus V$とみなせる．
        \item また，スカラー倍$\C\times V\to V_\C$自身が，同型$\C\otimes_\R V\iso V_\C$を引き起こす\ref{prop-universality-of-tensor-product}．
    \end{enumerate}
\end{remarks}

\section{行列の代数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    行列の代数的な特徴を調べ，行列式の構造に集約される様子を見る．
    その次に，可換性と固有値の関係を調べ，Gram行列(複素数の絶対値$\al\o{\al}=\abs{\al}^2$に当たる)という極めて安定な構造に帰着させる．
\end{tcolorbox}

\subsection{2次元行列のJordan標準形}

\begin{proposition}
    $M_2(\R)$は(1),(2),(3)のいずれかと共役になり，(1),(2),(3)のいずれも互いに共役でない．
    $M_2(\C)$は(1),(2)のいずれかと共役になり，(3)は対角化可能になる．
    \begin{enumerate}
        \item 対角行列：$\diag(a,b)$．
        \item 冪零成分を持つ行列：$\begin{pmatrix}a&1\\0&a\end{pmatrix}$．
        \item 回転行列：$\begin{pmatrix}a&-b\\b&a\end{pmatrix}$．
    \end{enumerate}
    (1)と(3)の区別が存在するのは，$\R$が代数的閉体でないことに起因する．
\end{proposition}
\begin{remarks}
    冪零成分とはどういうことかの観察に向いている．
    $(1,a)^\top$の成分は，どのように基底をとっても部分空間$\bF(1,0)$に干渉してしまう．
    この成分を抜くと対角にできて，この成分はいずれ消える冪零成分である．
\end{remarks}

\subsection{交代化と対称化}

\begin{notation}[Levi-Civita, Einstein]
    $\Brace{i_1,\cdots,i_r},\Brace{j_1,\cdots,j_r}\subset[n]$について，
    \begin{enumerate}
        \item $\Brace{i_1,\cdots,i_r}\ne\Brace{j_1,\cdots,j_r}$のとき，$\ep^{i_1,\cdots,i_r}_{j_1,\cdots,j_r}=0$とする．
        \item そうでないとき，$\sigma(i_k)=j_k$の置換の符号を$\ep^{i_1,\cdots,i_r}_{j_1,\cdots,j_r}$とする．
    \end{enumerate}
    これを\textbf{Levi-Civita記号}という．
    $v\in M_{1n}(K),e\in M_{n1}(K)$について，
    \[v_ie^i:=\sum_{i\in[n]}v_ie^i\]
    を\textbf{Einsteinの縮約記法}という．
\end{notation}

\begin{definition}
    任意の量$F_{i_1,\cdots,i_r}$に対して，
    \begin{enumerate}
        \item 次の量を\textbf{交代化}という：
        \[F_{[i_1,\cdots,i_r]}:=\frac{1}{r!}\sum_{j_1\in[n]}\cdots\sum_{j_r\in[n]}\ep^{j_1\cdots j_r}_{i_1\cdots i_r}F_{j_1\cdots j_r}.\]
        \item 次の量を\textbf{対称化}という：
        \[F_{(i_1,\cdots,i_r)}:=\frac{1}{r!}\sum_{j_1\in[n]}\cdots\sum_{i_r\in[n]}F_{j_1\cdots j_r}.\]
    \end{enumerate}
\end{definition}
\begin{remarks}
    これは$F_{i_1,\cdots,i_r}$の，標本$(i_1,\cdots,i_r)$の全ての並び替えについて平均を取ったリサンプリングともみなせる．
\end{remarks}

\subsection{行列式}

\begin{definition}[minor, principal minor, leading principal minor]
    行列$A\in M_{mn}(K)$について，
    \begin{enumerate}
        \item 正方部分行列の行列式を\textbf{小行列式}という．
        \item 特に$\abs{A}^{i_1,\cdots,i_r}_{i_1,\cdots,i_r}$という形のものを\textbf{主小行列式}という．
        \item 特に$\abs{A}^{12\cdots r}_{12\cdots r}$という形のものを\textbf{首座小行列式}という．
    \end{enumerate}
\end{definition}

\begin{definition}
    $A\in M_n(K)$について，
    \begin{enumerate}
        \item $a_{ij}$の\textbf{余因子}とは，
        \[\De_{ij}:=(-1)^{i+j}\abs{A}^{1,\cdots,i-1,i+1,\cdots,n}_{1,\cdots,j-1,j+1,\cdots, n}\]
        をいう．
        \item \textbf{余因子行列}または\textbf{随伴行列}とは，
        \[\Adj A:=(\De_{ji})\]
        で定める．
    \end{enumerate}
\end{definition}

\begin{proposition}[Laplace expansion]
    $\det A$は$A$のある行$i_0$の各要素に，その余因子をかけて加えたものに等しい：
    \[\det A=\sum_{j=1}^na_{i_0j}\De_{i_0j}.\]
    特に，$A(\Adj A)=(\det A)O_n$が成り立つ．
\end{proposition}

\begin{proposition}[Cauchy-Binetの公式]
    \[\det(AB)=\sum_{S\subset[n],\abs{S}=m}\det(A_S)\det(B^S).\]
\end{proposition}

\begin{proposition}[Pfaffian]
    $A\in M_n(K)$は反対称=交代行列であるとする：${}^t\!A=-A$．
    \begin{enumerate}
        \item $n$が奇数ならば，$\det A=0$．
        \item $n$が偶数ならば，
        \[\det A=\paren{\frac{n!}{\paren{\frac{n}{2}}!2^{n/2}}a_{[12}a_{34}\cdots a_{n-1,n]}}^2=\paren{\frac{1}{2^nn!}a_{i_1j_1}\cdots a_{i_nj_n}\ep^{12\cdots (2n-1)2n}_{i_1j_1\cdots i_nj_n}}^2.\]
        括弧の中身を$\Pf A$とおく．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 次が必要：
        \[\det M=\det(-M^\top)=\det(-M)=(-1)^n\det M.\]
    \end{enumerate}
\end{Proof}
\begin{example}
    反対称行列$A\in M_4(K)$を
    \[A:=\begin{pmatrix}0&a_{12}&a_{13}&a_{14}\\0&0&a_{23}&a_{24}\\0&0&0&a_{34}\\0&0&0&0\end{pmatrix}-\begin{pmatrix}0&a_{12}&a_{13}&a_{14}\\0&0&a_{23}&a_{24}\\0&0&0&a_{34}\\0&0&0&0\end{pmatrix}^\top\]
    について，$\Pf A=a_{12}a_{34}-a_{13}a_{24}+a_{14}a_{23}$．
\end{example}

\subsection{小行列式}

\begin{proposition}[Grassmann-Plucker]
    横長行列$A\in M_{mn}(K)\;(m\le n)$の$m$次の小行列式$v_{j_1\cdots j_m}:=\abs{A}^{1\cdots m}_{j_1\cdots j_m}$について，
    \[v_{[j_1\cdots j_m}v_{i_1]i_2\cdots i_m}=0.\]
\end{proposition}

\subsection{逆行列}

\begin{proposition}
    $A\in \GL_n(K),D\in \GL_m(K),B\in M_{nm}(K),C\in M_{mn}(K)$かつ$D^{-1}-CA^{-1}B\in\GL_m(K)$とする．
    \begin{enumerate}
        \item (Woodbury) 次が成り立つ：
        \begin{align*}
            (A+BDC)^{-1}&=A^{-1}-A^{-1}B(D^{-1}+CA^{-1}B)^{-1}CA^{-1}\\
            &=A^{-1}-A^{-1}BD(D+DCA^{-1}BD)^{-1}DCA^{-1}.
        \end{align*}
        \item (Sherman-Morrison) 特に$m=1,B=\b{b},C=\b{c}^\top,D=1$のとき，
        \[(A+\b{b}\b{c}^\top)^{-1}=A^{-1}-\frac{(A^{-1}\b{b}(\b{c}^\top A^{-1}))}{1+\b{c}^\top A^{-1}\b{b}}.\]
    \end{enumerate}
\end{proposition}
\begin{remarks}
    $A\in\GL_n(K)$の摂動$+BDC$が再び可逆であるための条件を与えていると見れる．
\end{remarks}

\subsection{可換性と固有値}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    可換性の難しさは，直交の概念，すなわち計量の構造と深く関わることによる．
\end{tcolorbox}

\begin{theorem}
    $A,B\in M_n(\C)$について，
    \begin{enumerate}
        \item $AB$と$BA$の固有値は重複度を込めて一致する．
        \item $AB=BA$のとき，$A,B$は共通の固有ベクトルを持つ．
    \end{enumerate}
\end{theorem}

\subsection{Gram行列と特異値}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $A=(a_i)$のGram行列は標準内積に関する内積構造$G=((a_i|a_j))_{ij}$に他ならないためである．
\end{tcolorbox}

\begin{definition}[Gram matrix]
    一般の行列$A\in M_{mn}(K)$の\textbf{グラム行列}とは，正方行列$G:=A^*A\in M_{n}(K)$をいう．
\end{definition}

\begin{proposition}[Gram行列の性質]
    任意の$A\in M_{mn}(\C)$について，
    \begin{enumerate}
        \item Gram行列は半正定値なHermite行列である．
        特に正規であり，特に固有値は全て非負実数であり，
        半正定値な行列$\sqrt{A^*A}\ge0$が唯一存在して，$(\sqrt{A^*A})^2=A^*A$を満たす．
        \item また，任意の半正定値行列は，ある行列$B\in M_{mn}(\C)$のGram行列である\cite{柳井-竹内-一般逆行列}(定理1.12)．
        \item 次の3条件は同値：
        \begin{enumerate}
            \item Gram行列$G=A^*A$は正定値でもある．
            \item $n=m$かつ$A$は正則．
            \item $A^*A$は正則．
        \end{enumerate}
    \end{enumerate}
\end{proposition}

\subsection{特異値の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    固有値は正方行列についてのみ定義される量であった．
    一般の行列についてもGram行列を通じて，幾何平均として特異値を定義することができる．
\end{tcolorbox}

\begin{definition}[singular value]\mbox{}
    \begin{enumerate}
        \item 一般の行列$A\in M_{mn}(K)$について，Gram行列の固有値の非負の平方根
        $\sigma_i(A):=\sqrt{\lambda_i(A^*A)}$を\textbf{特異値}といい，その全体を$\Sg(A)\subset\R$で表す．
    \end{enumerate}
\end{definition}

\begin{proposition}[特異値の性質]
    正方行列$A\in M_n(\R)$について，
    \begin{enumerate}
        \item $A$が正規行列ならば，特異値とは固有値の絶対値である：$\sigma_i(A)=\abs{\lambda_i(A)}$．
        \item $A$が半正定値Hermite行列ならば，特異値とは固有値に等しい．
    \end{enumerate}
\end{proposition}

\section{空間の分解と自己共役行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    正定値関数とはFourier変換の値域になるクラスでもある．
    $B(H)_\sa$はイデアル，$B(H)_+$はその正錐になる．
\end{tcolorbox}

\subsection{定値性とGram行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    実はGram行列の全体は半正定値行列と同じクラスをなす．
    これを詳しく見る．
\end{tcolorbox}

\begin{theorem}[Sylvester]
    Hermite行列$A\in M_n(\C)$について，次は同値．
    \begin{enumerate}
        \item $A$は正定値である：$\forall_{z\in\C^n\setminus\{0\}}\;z^*Az>0$．
        \item $n$個の首座小行列式は正である．
        \item 全ての固有値は正である：$\Sp(A)\subset\R^+$．
        \item $(x|y):=y^*Ax$は内積を定める．
        \item ある$B\in \GL_{n}(\C)$のGram行列である：$A=B^*B$．
        \item 一意なCholesky分解を持つ：正実数を対角成分に持つ下三角行列$L$が存在して，$A=LL^*$と表せる．
    \end{enumerate}
    また$A\in M_n(\R)$のとき，$\forall_{x\in\R^n\setminus\{0\}}\;x^\top Ax>0$に同値．
\end{theorem}

\begin{definition}
    正定値Hermite行列$A$のCholesky分解に登場する正実数を対角成分に持つ下三角行列$L$を\textbf{三角平方根}といい，$A_{1/2}$と表す．
\end{definition}

\begin{theorem}
    Hermite行列$A\in M_n(\C)$について，次は同値．
    \begin{enumerate}
        \item $A$は半正定値である：
        \item $\begin{pmatrix}m\\k\end{pmatrix}\cdot \begin{pmatrix}n\\k\end{pmatrix}$個の主小行列式は非負である．
        \item 全ての固有値は非負である：$\Sp(A)\subset\R_+$．
        \item ある$B\in M_{nk}(\C),k:=\rank A$のGram行列である：$A=BB^*$．
    \end{enumerate}
\end{theorem}

\subsection{定値性が定める順序関係}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item $A\ge B>0$ならば，$\det A\ge\det B$かつ$B^{-1}\ge A^{-1}$である．
        \item $A\in M_{mn}(\R),B\in M_{mq}(\R)$について，$\rank B=q$ならば，$A^\top A\ge A^\top B(B^\top B)^{-1}B^\top A$．
    \end{enumerate}
\end{proposition}

\subsection{一般逆行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    一意な逆を持たない行列の場合，単射な上では逆を定めているような行列の総体を一般逆行列という．
    このような候補の総体は全て有用であることがわかっている．
\end{tcolorbox}

\begin{definition}[generalized inverse \cite{CRRao62-GeneralizedInverse}]
    $A\in M_{nm}(\R)$の\textbf{一般逆行列}とは，
    任意の可解な方程式$Ax=b\in\Im(A)$に対して，$x:=A^{-}y$が解を与えるような線型変換$A^-\in M_{mn}(\R)$をいう．
    ただし，$b\in\Im(A)$は方程式の可解性を保証していない点に注意．
\end{definition}
\begin{proposition}[一般逆行列の特徴付け]
    $A\in M_{nm}(\R)$について，次は同値：
    \begin{enumerate}
        \item $A^-\in M_{mn}(\R)$は一般化逆である．
        \item $AA^-A=A$．
    \end{enumerate}
\end{proposition}

\begin{theorem}[一般逆行列のGram行列は射影を定める]
    $A\in M_{nm}(\R)$の像$\Im A$の任意の補空間$W\subset\R^m$に対して，
    ある一般逆行列$A^-$が存在して，$W=\Im(I_n-AA^-)$と表せる．
\end{theorem}

\begin{theorem}
    可解な方程式$Ax=b\in\Im(A)$に対して，解は任意の$z\in\R^m$に対して，
    \[x=A^-b+(I_m-A^-A)z\]
    と表せる．
\end{theorem}

\subsection{Moore-Penrose逆行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
    title=]
    射影作用素は有界連続な冪等作用素，
    直交射影作用素は，自己共役な射影作用素のことであるが，
    有限次元では単に冪等行列と自己共役射影行列とに退化する．
\end{tcolorbox}

\begin{definition}[Moore (1935), Penrose (55)]
    $A\in M_{mn}(\R)$について，次の2条件を満たす行列$A^+\in M_{nm}(\R)$は一意的に定まる(\cite{柳井-竹内-一般逆行列}ではKalman 1972の証明を引いている)．
    これを\textbf{Moore-Penroseの逆行列}という：
    \begin{enumerate}[(a)]
        \item 反射型一般可逆行列：$AA^+A=A,A^+AA^+=A^+$．
        \item 最小ノルム型：$A^+A$は自己共役である：$(A^+A)^\top=A^+A$．
        \item 最小誤差型：$AA^+$も自己共役である：$(AA^+)^\top=AA^+$．
    \end{enumerate}
\end{definition}
\begin{remarks}
    条件(a)は冪等性の要件を一般化した形であり，$\Im A$の補空間，$\Ker A$の補空間がそれぞれ一意に定まった場合に，$A^+$が一意に定まるための条件であり，(b),(c)でそれぞれを指定している．
    (b)は$\Ker A$の補空間は直交補空間として取ること，(c)は$\Im A$の補空間は直交補空間として取ることを指定している．
    よって，Moore-Penrose逆について，Gram行列$A^+A,AA^+$はいずれも直交射影を定める．
\end{remarks}

\begin{proposition}[\cite{柳井-竹内-一般逆行列}定理3.19]
    任意の$b\in\R^m$に対して，
    \begin{enumerate}
        \item $\norm{Ax-b}^{2}$を最小にする$x=A^-b$は(c)さえ満たせば一般の一般逆行列が満たす
        \item これがさらに$\norm{x}^2$を最小にすることと，$A^-=A^+$であることは同値．
    \end{enumerate}
\end{proposition}

\begin{example}\mbox{}
    \begin{enumerate}
        \item (非零)ベクトルの一般可逆行列は，$\norm{x}^2$でスケーリングした随伴ベクトルとなる：$x^+=(x^*x)^{-1}x^*$．
        \item 二次の正方行列\[A=\begin{pmatrix}
            a&b\\c&d
        \end{pmatrix}\in M_2(\C)\]
        の一般化逆行列は，可逆なときは逆行列に一致し，特異かつ非零であるときは
        \[A^+=\frac{1}{\abs{a}^2+\abs{b}^2+\abs{c}^2+\abs{d}^2}\begin{pmatrix}\o{a}&\o{c}\\\o{b}&\o{d}\end{pmatrix}.\]
        $A=O$のときは$A^+=O$である．
    \end{enumerate}
\end{example}

\begin{proposition}[Moore-Penrose逆の計算法１]\mbox{}
    \begin{enumerate}
        \item ${}^+:M_{mn}(\R)\to M_{nm}(\R)$は転置と可換，行列積に対して反共変的な対合である．
        \item $A^+=(A^\top A)^+A^\top=A^\top(AA^\top)^+$．
        \item 横長行列$A\in M_{mn}(\C)\;(m\le n)$が最大階数であるとき，$AA^*\in M_m(\C)$は可逆で，$A^+=A^*(AA^*)^{-1}$．特に，右逆元である$AA^+=I_m$．
        \item 縦長行列$A\in M_{mn}(\C)\;(m\ge n)$が最大階数であるとき，$A^*A\in M_n(\C)$は可逆で，$A^+=(A^*A)^{-1}A^*$．特に，左逆元である$A^+A=I_n$．
    \end{enumerate}
\end{proposition}

\begin{proposition}[Moore-Penrose逆の計算法２]\mbox{}
    \begin{enumerate}
        \item (特異値分解による計算法) $A$の特異値分解を$A=U\Sigma V^\top$とすると，$A^+=U\Sigma^+V^\top$と表せる．
        \item またこのとき，$\Sigma^+=\diag(\sigma_{ii}^+)$とすると，$\sigma_{ii}^+=\sigma_{ii}^{-1}$の関係がある．
        \item (最小二乗解としての特徴付け) $A\in M_{mn}(\R)$の定める1次方程式$Ax=b$の解空間は\[x=A^+b+(I_n-A^+A)k\;(k\in\R)\]で表される．
        特に，$A$が正則であるとき解は一意的である．
        ノルムが最小の解は$k=0$のときの$A^+b$で，解を持たない場合でもこれは最小二乗誤差$\norm{Ax-b}^2$を与える．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    逆行列を，1次方程式の解を与える対応だとするならば，これを「最小自乗解を与える対応」と一般化したものが一般可逆行列となっている．
\end{remarks}

\subsection{Moore-Penrose逆による射影の表現}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    もともとMoore (35)は$AA^+,A^+A$の射影としての性質を通じて，逆$A^+$を定義していた．
\end{tcolorbox}

\begin{theorem}[直交射影の一般化逆行列による表示]
    $X\in M_{np}(\R)$について，$\Im X$への直交射影の標準基底に関する行列表示を$P_X$で表す．このとき，
    $X$のGram行列の任意の一般化逆$(X^*X)^-$について，
    $P_X=X(X^*X)^-X^*$．
\end{theorem}

\begin{notation}
    $X\in M_{np}(\R),H\in M_{pq}(\R)$は$\Im H\subset\Im X^*,\rank H=q$を満たすとする．
    $X$の$\Im H$の直交補空間上への制限の像を
    \[\Im(X|H):=X(\Ker H^*)=X((\Im H)^\perp)\]
    とする．$\Im(X|H)$への標準内積に関する直交射影を$P_{X|H}$で表し，$r:=\rank X$とする．
\end{notation}

\begin{theorem}[直交射影の制限の一般化逆行列による表示]
    任意のGram行列$X^*X$の一般化逆$(X^*X)^-$について，$G:=(X^*X)^-H$とする．
    このとき，
    \begin{enumerate}
        \item $G^*X^*XG\in \GL_q(\R)$．
        \item $P_{X|H}=P_X-XG(G^*X^*XG)^{-1}G^*X^*$．
        \item $\rank P_{X|H}=r-q$．
    \end{enumerate}
\end{theorem}

\subsection{特異値分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    特異値分解は，自己準同型の対角化を，一般の準同型$A:K^n\to K^m$に一般化した結果を言う．
\end{tcolorbox}

\begin{proposition}[特異値分解 (Autonne 1915)]
    任意の縦長行列$A\in M_{m,n}(\R)$について，直交行列の縦長剪断$U\in O_{mn}(\R)$と通常の直交行列$V\in O_n(\R)$が存在して，$r:=\rank(A)$とすると
    \[A=U\Sigma V^\top,\qquad\Sigma=\begin{bmatrix}D&O_{r,n-r}\\O_{m-r,r}&O_{m-r,n-r}\end{bmatrix},\quad D=\diag(\sigma_1,\cdots,\sigma_r),\;(\sigma_1\ge\cdots\ge\sigma_r>0)\]
    と表せる．
\end{proposition}
\begin{remarks}
    中心化された(あるいは標準化された)確率行列を特異値分解する問題は\textbf{主成分分析}と呼ばれる．
\end{remarks}

\begin{corollary}\mbox{}
    \begin{enumerate}
        \item $A^\top A=V\Sigma^\top\Sigma V$，$AA^\top=U\Sigma\Sigma^\top U^\top$．
        \item $A$の特異値は$A^\top A$の非零固有値の正の平方根に等しい．
        \item $V$の列ベクトルは$A^\top A$の固有ベクトルであり，$U$の列ベクトルは$AA^\top$の固有ベクトルである．
    \end{enumerate}
\end{corollary}

\begin{theorem}[Moore-Penroseの一般化逆行列の公式 \cite{柳井-竹内-一般逆行列}定理5.6]
    任意の$A\in M_{m,n}(\R)$について，
    特異値分解を$A=U\Sigma V^\top\;(U\in\r{O}_m(\R),V\in\r{O}_n(\R),\Sigma=\diag(\Delta_r,0))$とする．
    このとき，
    \[A^+=V\mtrx{\Delta_r^{-1}}{O}{O}{O}U^\top.\]
\end{theorem}
\begin{remarks}
    すなわち，特異値の逆を対角に並べたものを，逆相似変換すれば良い．
\end{remarks}

\subsection{正定値Hermite行列の成分の消息}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    \begin{enumerate}
        \item 絶対値最大の要素は対角要素であるという意味で対角優位な行列である．
        \item 正定値Hermite行列の行列式は対角成分の積で抑えられる．
    \end{enumerate}
\end{tcolorbox}

\begin{theorem}
    一般のHermite行列$A\in M_n(\C)_\sa$について，
    任意の対角要素は数域に含まれる：$\forall_{i\in[n]}\;a_{ii}\in W(A)$．
\end{theorem}

\begin{proposition}
    $A\in M_n(\C)$を正定値エルミート行列とする．
    \begin{enumerate}
        \item 任意の対角要素は正である：$\forall_{i\in[n]}\;a_{ii}>0$．
        \item $\forall_{i,j\in[n]}\;i\ne j\Rightarrow\abs{a_{ij}}^2<a_{ii}a_{jj}$．
        \item 要素の絶対値$\abs{a_{ij}}$の最大値を達成するならば，それは対角要素である．
    \end{enumerate}
\end{proposition}

\begin{proposition}[Hadamard]
    行列$A=(a_1,\cdots,a_n)\in M_{mn}(\C)$について，
    \begin{enumerate}
        \item $\abs{\det(A)}\le\prod_{i=1}^n\norm{a_i}$．
        \item 特に，$\abs{\det(A)}\le\norm{A}_{l^\infty([nm])}^nn^{n/2}$．
        \item $A$が半正定値Hermite行列ならば，$\det(A)=\prod_{i=1}^na_{ii}$．等号成立条件は$A$が対角行列であるとき．
    \end{enumerate}
\end{proposition}

\subsection{確率変数の変換}

\begin{proposition}[平均と分散]
    $A\in M_n(\R)$を対称，$(\theta,\Sigma)\sim X\in L^2(\Om)$を確率変数とする．
    \begin{enumerate}
        \item $E[X^\top AX]=\tr(A)\Sigma+\theta^\top A\theta$．
        \item $a:=\diag(A)\in\R^n,\mu_k$を$X$の中心積率として，
        \[\Var[X^\top AX]=(\mu_4-3\mu_2^2)a^\top a+2\mu_2^2\Tr(A)^2+4\mu_2\theta^\top A^2\theta+4\mu_3\theta^\top A\theta.\]
    \end{enumerate}
\end{proposition}

\begin{proposition}[多変量正規分布の変換]
    多変量正規確率変数$X\sim (\mu,\Sigma)$について，
    \begin{enumerate}
        \item $\forall_{C\in M_{pn}(\R)}\;\forall_{\lambda\in\R^p}\;CX+\lambda\sim N(C\mu+\lambda,C\Sigma C^\top)$．
        \item ある直交行列$P\in O_n(\R)$が存在して，$P(X-\mu)\sim N(0,\Lambda)$と変換出来る．ただし，$\Lambda=P\Sigma P^\top$は$\Sigma$の対角化である．
        \item ある三角行列$L\in M_n(\R)$が存在して，$L(X-\mu)\sim N(0,I_n)$と変換出来る．
        \item $\mu=0,\Sigma=I_n$ならば，任意の直交行列$P\in O_n(\R)$に対して，$X\overset{d}{=}PX$．
    \end{enumerate}
\end{proposition}

\subsection{正規変数の二次形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    (非心率$0$の)自由度$k$の$\chi^2$-分布$\chi^2(k)$の特性関数は$\varphi(u)=(1-2iu)^{-k/2}$と表せる．
\end{tcolorbox}

\begin{theorem}[正規確率変数の二次形式]
    $A\in M_n(\R)$が対称行列，$X\sim N(0,\Sigma)$のとき，$Y:=X^\top AX$の積率母関数と特性関数は
    \[\M_Y(u)=\det{I-2\theta A\Sigma}^{-1/2}=\prod_{\lambda\in\Sp(A\Sigma)}(1-2\theta\lambda)^{-1/2},\quad\varphi_Y(u)=\exp\paren{\M_Y(iu)}.\]
    と表せる．
\end{theorem}
\begin{remarks}
    これが$\chi^2$-分布の積率母関数と一致するためには，$\lambda\in2$が必要十分であり，$1$の数だけ$\chi^2$-分布の自由度が増える．
\end{remarks}

\begin{corollary}[$\chi^2$-分布の特徴付け]
    対称行列$A\in M_n(\R)$，$X\sim N(0,\Sigma)$と$Y:=X^\top AX$について，次は同値：
    \begin{enumerate}
        \item $Y\sim \chi^2(k)$．
        \item $\rank A=k$かつ$(\Sigma_{1/2})^\top A\Sigma_{1/2}$は冪等である．
    \end{enumerate}
    ただし，$\Sigma_{1/2}$とは三角平方根，すなわち，Cholesky分解$\Sigma_{1/2}=\Sigma_{1/2}\Sigma_{1/2}^\top$を与える正実数を対角成分にもつ下三角行列である．
\end{corollary}

\begin{proposition}[非心$\chi^2$-分布の特徴付け]
    対称行列$A\in M_n(\R)$，$X\sim N(\mu,\Sigma)$と$Y:=X^\top AX$について，次は同値：
    \begin{enumerate}
        \item $Y\sim\chi^2(k,\mu^\top A\mu)$．
        \item $\rank A=k$かつ$(\Sigma_{1/2})^\top A\Sigma_{1/2}$は冪等である．
    \end{enumerate}
\end{proposition}

\subsection{Cochranの定理}

\begin{theorem}[Cochran]
    $X\sim N(0,I_n)$とすると，自乗和$X^\top X$は$\chi^2(n)$に従う．
    この自乗和の分解\[X^\top X=X^\top(A_1+\cdots+A_k)X=:\sum_{i=1}^iQ_i\quad Q_i=X^\top A_iX,\rank A_i=:n_i\]について，
    次は同値：
    \begin{enumerate}
        \item 各$Q_i$が$\chi^2(n_i)$に従う．
        \item 各$A_i$は冪等である．
        \item $n=\sum_{i\in[k]}n_i$．
        \item 各$Q_i$が独立に$\chi^2(n_i)$に従う．
    \end{enumerate}
\end{theorem}

\begin{proposition}
    $X\sim N(0,I_n)$，$A_1,A_2$をそれぞれ階数$p,q$の射影とする：$X^\top A_1X\sim\chi^2(p),X^\top A_2X\sim\chi^2(q)$．
    次の二条件は同値：
    \begin{enumerate}
        \item $X^\top A_1X\indep X^\top A_2X$．
        \item $A_1A_2=0$．
    \end{enumerate}
    これは射影でない一般の$A_1,A_2$についても成り立つ．
\end{proposition}

\begin{proposition}
    $X\sim N(0,I_n)$，$A\in M_n(\R)$を射影とする．このとき，次は同値：
    \begin{enumerate}
        \item $X^\top AX\indep b^\top X$．
        \item $Ab=0$．
    \end{enumerate}
\end{proposition}

\section{行列の解析}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    ($\R^n$を$l^2$-ノルムについてHilbert空間と見ると)行列の作用素ノルムはスペクトルノルム$\norm{A}^2=\rho(A^*A)$に等しく，これはHermite行列であるときにスペクトル半径に等しい．
\end{tcolorbox}

\subsection{行列の冪級数}

\begin{theorem}[行列の冪級数の収束半径]
    $X\in M_n(\C)$について，
    数列$\{a_n\}\subset\C$の定める冪級数$\sum_{p\in\N}a_px^p$の収束半径を$\rho:=\paren{\limsup_{n\to\infty}\sqrt[n]{\abs{a_n}}}^{-1}$とおく．
    $\sum_{p\in\N}a_pX^p$を考える．
    \begin{enumerate}
        \item $\rho(X)<\rho$ならば収束する．
        \item $\rho(X)>\rho$ならば発散する．
        \item $\sum_{p\in\N}\abs{a_p}\norm{A}^p$が収束するならば収束する．ノルムは，$l^1,l^2$またはスペクトルノルムを考える．
    \end{enumerate}
\end{theorem}

\begin{theorem}
    $X$をBanach空間，
    $A\in B(X)$とする．
    このとき，$\norm{A}<1$ならば，
    \[(I-A)^{-1}=I+A+A^2+\cdots=\sum_{n\in\N}A^n.\]
\end{theorem}

\subsection{行列のノルム}

\begin{definition}
    $A\in M_{mn}(\C)$について，
    \begin{enumerate}
        \item $\norm{A}_{l^2([mn])}:=\sqrt{\sum_{i\in[m],j\in[n]}a_{ij}^2}=\sqrt{\Tr(A^*A)}$を\textbf{Frobeniusノルム}または\textbf{Hilbert-Schmidtノルム}という．
        \item $\norm{A}_{l^1}:=\sum_{i\in[m],j\in[n]}\abs{a_{ij}}$．
        \item $\R^n,\R^m$の$l^p$-ノルムに関する作用素ノルムを$\norm{A}_p$で表す．
    \end{enumerate}
\end{definition}
\begin{remark}
    最大ノルム$\norm{A}_{l^\infty}:=\max_{i,j}\abs{a_{ij}}$は劣乗法性を満たさない．
\end{remark}
\begin{remarks}
    $B^2(H):=\Brace{T\in B_0(H)\mid\Tr(T)<\infty}$は，$(S|T):=\Tr(T^*S)$を内積としてHilbert空間をなす．
    $B^1(H):=\Span\Brace{T\in B_0(H)\mid T\ge0,\Tr(T)<\infty}$は，トレースノルムについてBanach代数をなす．
\end{remarks}

\begin{proposition}[ノルムの同値性]
    $l^1$-ノルム，$l^2$-ノルム，スペクトルノルムは同値である：
    \[\norm{A}_{l^1}\ge\norm{A}_{l^2}\ge\norm{A}_2\ge\frac{1}{n^2}\norm{A}_{l^1}.\]
    すなわち，いずれも$\R^{n+m}\simeq M_{mn}(\R)$の位相を定める．
\end{proposition}

\begin{proposition}[作用素ノルムの表示]
    $A\in M_n(\C)$について，
    \begin{enumerate}
        \item $\norm{A}_1=\max_{j\in[n]}\sum_{i\in[n]}\abs{a_{ij}}$．
        \item $\norm{A}_\infty=\max_{i\in[n]}\sum_{j\in[n]}\abs{a_{ij}}$．
    \end{enumerate}
\end{proposition}

\subsection{Schattenノルム}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Euclidノルムが定める行列の作用素ノルムは，最大の特異値に等しい．
    これは，$A^*A=\abs{A}^2$が実数のような役割を果たしているためである．
    また，Frobeniusノルムは特異値の自乗和(=$A^*A$の固有値の和)に等しい．
\end{tcolorbox}

\begin{definition}
    $A\in M_{mn}(\C)$について，$\abs{A}=\sqrt{A^*A}$の特異値の増大列を$\{s_i\}_{i\in[n]}=\Sg(A)$とする．
    \begin{enumerate}
        \item $\norm{A}_{l^p(\Sg(A))}:=\paren{\sum_{i=1}^{m\land n}s_i^p}^{1/p}$を\textbf{Schattenノルム}という．
        \item $p=1$のとき，\textbf{トレースノルム}という：$\norm{A}:=\Tr(\sqrt{A^*A})$．
        \item $p=\infty$のとき，\textbf{スペクトルノルム}という．
    \end{enumerate}
\end{definition}

\begin{proposition}
    $A\in M_{mn}(\C)$について，
    \begin{enumerate}
        \item Frobeniusノルムは2-Schattenノルムに等しい：$\norm{A}_{l^2(A)}^2=\norm{A}_{l^2(\Sg(A))}^2=\sum_{a\in\Sp(A^*A)}a$．
        \item $l^2$-作用素ノルムはスペクトルノルムに等しい：$\norm{A}_{2}^2=\rho(A^*A)=\rho(AA^*)=\norm{A}_{l^\infty(\Sg(A))}$．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    $A$がHermite行列ならば，$\norm{A}_2=\rho(A)$としてスペクトル半径に一致する．
\end{remarks}

\subsection{作用素ノルムと固有値}

\begin{definition}[condition number]
    $A\in\GL_n(K)$とノルム$\norm{-}$とについて，
    $\cond A:=\norm{A}\cdot\norm{A^{-1}}$を\textbf{条件数}という．
\end{definition}

\begin{lemma}
    \[\forall_{p\in[1,\infty]}\quad\max_{x\in\C^n\setminus\{0\}}\frac{\norm{Ax}_p}{\norm{x}_p}=\max_{x\in\R^n\setminus\{0\}}\frac{\norm{Ax}_p}{\norm{x}_p}\]
\end{lemma}

\begin{theorem}[スペクトル半径と作用素ノルム]\mbox{}
    \begin{enumerate}
        \item 行列の任意の作用素ノルムは，スペクトル半径よりも大きい：$\rho(A)\le\norm{A}$．
        \item 極限においては$\lim_{r\to\infty}\norm{A^r}^{1/r}=\rho(A)$が成り立つ．
    \end{enumerate}
\end{theorem}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 劣乗法性を満たすなら必ず満たすべき不等式なのである．実際，任意の固有値$\lambda\in\Sp(A)$とこれに属する固有ベクトル$x\in\C^n$について，
        \[\abs{\lambda}\norm{x}=\norm{Ax}\le\norm{A}\norm{x}.\]
    \end{enumerate}
\end{Proof}

\begin{theorem}[行列ノルムの稠密性?]
    任意の$A\in M_n(\C)$と$\ep>0$に対して，ある$\C^n$のノルムに関する行列の作用素ノルム$\norm{-}$が存在して，
    \[\norm{A}\le\rho(A)+\ep.\]
\end{theorem}

\begin{corollary}
    任意の$A\in M_n(\C)$について，次は同値：
    \begin{enumerate}
        \item $\lim_{n\to\infty}A^n=O$．
        \item $\rho(A)<1$．
    \end{enumerate}
\end{corollary}

\begin{theorem}[作用素ノルムの同値性]
    任意の$A\in M_n(\C)$と行列の作用素ノルム$\norm{-}$に関して，
    \[\exists_{C,C'>0}\quad C'\norm{A}\le\norm{A}_{l^\infty([n]^2)}\le C\norm{A}.\]
\end{theorem}

\begin{corollary}
    $A_n,A\in M_n(\C)$について，次は同値：
    \begin{enumerate}
        \item $\lim_{n\to\infty}A_n=A$．
        \item ある行列ノルムが存在して$\lim_{n\to\infty}\norm{A_n-A}=0$．
    \end{enumerate}
\end{corollary}

\subsection{Rayleigh商と数域半径}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Rayleigh商$R_A:\C^n\to\C$はある種，固有空間から固有値への射影となっている．
\end{tcolorbox}

\begin{definition}
    $A\in M_n(\C)$について，
    \begin{enumerate}
        \item 次の関数$R_A:\C^n\setminus\{0\}\to\C$を\textbf{Rayleigh商}という：
        \[R_A(x):=\frac{(Ax|x)}{(x|x)}\]
        \item この値域を\textbf{数域}といい，$W(A)$で表す．
        \item $r(A):=\sup_{\lambda\in W(A)}\abs{\lambda}$を\textbf{数域半径}という．
    \end{enumerate}
\end{definition}

\begin{lemma}
    $A\in M_n(\C)$について，
    \begin{enumerate}
        \item 任意の固有値$\lambda\in\Sp(A)$とこれに属する固有ベクトル$v\ne0$について，$R_A(v)=\lambda$．
        \item $R_A$は固有ベクトルの付近で停留する：$R_A(v)=\lambda+O(\norm{\ep}^2)$．
        \item $\forall_{\al\in\C\setminus\{0\}}\;R_A(\al x)=R(x)$．
        \item $A$がHermiteならば，$R_A(x)\in\R$．
        \item $R_A:\C^n\setminus\{0\}\to\C$は連続である．
        \item 数域半径$r:M_n(\C)\to\R_+$はノルムを定め，作用素ノルムと同値になる．
    \end{enumerate}
\end{lemma}

\begin{theorem}
    $A$を正規行列とする．数域$W(A)$は$\Sp(A)$の凸包である：$W(A)=\Conv(\Sp(A))$．
\end{theorem}
\begin{example}
    $A\in M_2(\C)$の数域$W(A)$は2つの固有値を焦点とする楕円になる．
\end{example}
\begin{remark}
    一般のコンパクト作用素については，$\Conv(\Sp(T))=\o{W(A)}$である．
\end{remark}

\subsection{Hermite行列の固有値}

\begin{theorem}
    $A\in M_n(\C)_\sa$をHermite行列，$\lambda_1\le\cdots\le\lambda_n$を固有値とする．
\end{theorem}

\begin{theorem}[Courant-Fisher-Weylのmin-max定理]
    $A\in M_n(\C)_\sa$をHermite行列，$\lambda_1\le\cdots\le\lambda_n$を固有値とする．
    \begin{enumerate}
        \item $\forall_{k\in[n]}\;\lambda_k=\min_{V_k\in\S_k(V)}\max_{x\in V_k}R_A(x)$．
        \item $\forall_{k\in[n]}\;\lambda_{n-k+1}=\max_{V_k\in\S_k(V)}\min_{x\in V_k}R_A(x)$．
    \end{enumerate}
    特に，$A$の最大の固有値・最小の固有値は，$R_A$の最大値・最小値に一致する．
\end{theorem}


\begin{theorem}[摂動定理]
    $A,B\in M_n(\C)_\sa$をHermite行列，$\lambda_1\le\cdots\le\lambda_n,\mu_1\le\cdots\le\mu_n$をそれぞれの固有値とする．
    任意の行列の作用素ノルム$\norm{-}$について，
    \[\forall_{k\in[n]}\;\abs{\lambda_k-\mu_k}\le\norm{A-B}\]
\end{theorem}

\subsection{固有値不等式}

\begin{proposition}
    $A,B\in M_n(\C),U$をユニタリ行列とする．
    \begin{enumerate}
        \item $U^{-1}AU=B$ならば，$\Tr(A^*A)=\Tr(B^*B)$．
        \item $A=:(a_{ij})$の固有値$\al_1,\cdots,\al_n$について，$\sum_{i\in[n]}\abs{a_i}^2\le\sum_{i,j\in[n]}\abs{a_{ij}}^n$．
        \item 等号成立条件は，$A$が正規であることである．
    \end{enumerate}
\end{proposition}

\begin{proposition}
    $A=(a_{ij})$をHermite行列とし，$[\beta,\al]\subset\R$を数域とする．
    \begin{enumerate}
        \item $\forall_{i\in[n]}\;a_{ii}\in[\beta,\al]$．
        \item $A$が正定値ならば，$\det A\le a_{11}a_{22}\cdots a_{nn}$．等号成立条件は$A$が対角行列であるとき．
    \end{enumerate}
\end{proposition}

\section{行列の分解と固有値}

\subsection{Gram-Schmidtの直交化と行列の分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    LU分解，Cholesky分解，QR分解はいずれも数値計算では欠かせない．また，
    固有値問題の数値解法では，ユニタリ変換を反復適用して上三角行列に収束させることが多いが，その背景にはSchur分解がある．
\end{tcolorbox}

\begin{definition}[LU, LDU, Cholesky, QR]
    $A\in M_{mn}(\R)$を，
    \begin{enumerate}
        \item 下三角行列$L$と上三角行列$U$の積$A=LU$に分解することを\textbf{LU分解}または\textbf{Gauss分解}という．
        \item $m=n$かつ$A$が対称であるとき，$D$を対角行列，$L$を単位(=対角要素1の)下三角行列として$A=LDL^\top$と分解出来る．これを\textbf{Cholesky分解}という．
        \item 直交行列$Q\in M_m(\R)$と上三角行列$R\in M_{mn}(\R)$を用いて$A=QR$に分解することを\textbf{QR分解}という．
        \item QR分解の一般の半単純群$G$に対して一般化したものを岩澤分解という．
    \end{enumerate}
\end{definition}


\begin{proposition}[Gram-Schmidtの直交化]
    任意の正則行列$A\in\GL_n(\bF)$は，ユニタリ行列$U$と上三角行列$T$とを用いて，$A=UT$と表せる．
\end{proposition}
\begin{remarks}
    こうして，理論上はQR分解の存在はGram-Schmidt算譜が保証しているが，応用上は殆ど用いられず，Householder変換などが使われる．
\end{remarks}

\begin{proposition}[$LU$-分解]
    $A\in M_{mn}(\R)\;(m\le n)$を横長行列とする．
    \begin{enumerate}
        \item $A$がフルランクならば，置換行列$P\in M_n(\R)$が存在して，$AP=LU$と，ピボット選択における任意性の部分を除いて一意的に表せる．
        \item 置換行列$P_1,P_2$が存在して，単位(=対角要素1の)上下三角行列$U,L$について$P_1AP_2=LDU$と，ピボット選択における任意性の部分を除いて一意的に表せる．
    \end{enumerate}
\end{proposition}
    
\begin{theorem}[Schur decomposition]\mbox{}
    \begin{enumerate}
        \item 任意の複素行列$A\in M_n(\C)$に対して，
        ユニタリ行列$U$が存在して$U^*AU$は上三角行列になる．
        なお，一意性は保証されない．
        \item $A$が正規ならば，$U^*AU$は対角行列に出来る．
    \end{enumerate}
\end{theorem}
\begin{remarks}
    正規行列の固有ベクトルの中から$\C^n$の正規直交基底を選び出せる．
\end{remarks}

\subsection{Gershgorinの定理}

\begin{definition}
    $A\in M_n(\C)$に対して，
    \[r_i:=\sum_{j\in[n]\setminus\Brace{i}}\abs{a_{ij}},\quad G_i:=\Brace{z\in\C\mid\abs{z-a_{ii}}\le r_i}\]
    を\textbf{Gershgorinの円}という．
\end{definition}

\begin{theorem}[Gershgorin]
    \[\forall_{A\in M_n(\C)}\;\Sp(A)\subset \bigcup_{i\in[n]}G_i.\]
\end{theorem}

\begin{proposition}
    $A\in M_n(\C)$の固有値は，$\cup_{i\in[n]}G_i$の各連結成分の中に，それを構成する円の個数に等しい個数ずつ含まれる．
\end{proposition}

\subsection{ブロック行列とその逆行列}

\begin{notation}[Schur complement]
    $A\in M_{p},B\in M_{pq},C\in M_{qp},D\in M_q$とし，
    \[M:=\begin{pmatrix}A&B\\C&D\end{pmatrix}\in M_{(p+q)}(\R)\]
    と定める．
    \begin{enumerate}
        \item $D\in\GL_q(\R)$のとき，$F:=A-BD^{-1}C\in M_{p}(\R)$とする．
        \item $A\in\GL_p(\R)$のとき，$G:=D-CA^{-1}B\in M_q(\R)$とする．
    \end{enumerate}
    $F,G$は\textbf{Schur補行列}といい，$M/D,M/A$とも表す．
\end{notation}

\begin{theorem}[ブロック行列の逆行列の表現]\mbox{}
    \begin{enumerate}
        \item $D\in\GL_q(\R)$のとき，行列式は$\abs{M}=\abs{F}\abs{D}$で計算できる．
        特に，$D,M$がいずれも正則であることは，$D,F$がいずれも正則であることに同値．
        \item $D,M$がいずれも正則のとき，
        \[M=\begin{pmatrix}F^{-1}&-F^{-1}BD^{-1}\\-D^{-1}CF^{-1}&D^{-1}+D^{-1}CF^{-1}BD^{-1}\end{pmatrix}\]
        と表せる．
        \item $A\in\GL_p(\R)$のとき，行列式は$\abs{M}=\abs{A}\abs{G}$で表せる．特に，$A,M$がいずれも正則であることと，$A,G$がいずれも正則であることは同値．
        \item $A,M$がいずれも正則であるとき，
        \[M=\begin{pmatrix}A^{-1}+A^{-1}BG^{-1}CA^{-1}&-A^{-1}BG^{-1}\\-G^{-1}CA^{-1}&G^{-1}\end{pmatrix}\]
        と表せる．
    \end{enumerate}
\end{theorem}

\begin{proposition}
    $M$が対称行列$N=\begin{pmatrix}A&B\\B^\top&D\end{pmatrix}$である場合を考え，一般化逆行列によって
    \[F:=A-BD^-B^\top,\quad G:=D-B^\top A^-B\]
    と定める．
    \begin{enumerate}
        \item $\Im(B^\top)=(\Ker B)^\perp\subset\Im(D)$のとき，次は$N$の一般化逆を与える．
        \[N^-=\begin{pmatrix}F^-&-F^-BD^-\\-D^-B^\top F^-&D^-+D^-B^\top F^-BD^-\end{pmatrix}\]
        \item $\Im(B)\subset\Im(A)$のとき，次は$N$の一般化逆を与える．
        \[N^-=\begin{pmatrix}A^-+A^-BG^-B^\top A^-&-A^-BG^-\\-G^-B^\top A^-&G^-\end{pmatrix}\]
    \end{enumerate}
\end{proposition}

\subsection{正規変数の条件付き分布}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Schur補行列が，正規確率変数の条件付き分布の共分散を与える．
    ここに条件付き期待値が線形変換になっていることが正規分布を特徴づける．
\end{tcolorbox}

\begin{proposition}
    $X=(X_1,X_2)\sim(\nu,\Sigma)$は正規変数とし，分割に応じて$\mu=(\mu_1,\mu_2),\Sigma=(\Sigma_{11},\Sigma_{12};\Sigma_{21},\Sigma_{22})$と対応するとする．このとき，
    \begin{enumerate}
        \item $P[X_2|X_1]\sim N(\mu_2+\Sigma_{21}\Sigma_{11}^\top(X-\mu_1),\Sigma/\Sigma_{22})$が成り立つ．
        \item 条件付き分布の共分散は，周辺分布のそれよりも，半正定値性の意味で小さくなる：$\Sigma_{22}\ge\Sigma/\Sigma_{22}$．
        \item $x_1$を所与としたときの$R(x_1)$は，$x_2$を平均自乗誤差を最小にする予測である．
    \end{enumerate}
\end{proposition}

\begin{definition}[regression]
    この平均に登場した関数
    \[(E[X_2|X_1]=)\mu_2+\Sigma_{21}\Sigma_{11}^\top(X-\mu_1)\]
    を$X_2$の$X_1$に対する\textbf{回帰}という．
\end{definition}
\begin{example}
    いずれも1次元確率変数であるとき，回帰は
    \[R(x_1)=\mu_2+\frac{\sigma_{12}}{\sigma_1^2}(x_1-\mu_1)\]
    となり，条件付き分布の分散は$\Var[x_2|x_1]=\sigma_2^2(1-\rho^2)$となる．
\end{example}

\subsection{一般化スペクトル分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    固有空間分解を射影作用素の言葉で記述したものをスペクトル分解というならば，一般化固有空間分解を射影作用素の言葉で記述したものを一般化スペクトル分解という．
\end{tcolorbox}

\begin{proposition}[空間の直和分解の射影子による特徴付け]
    $\{P_i\}_{i\in[r]}\subset\End_K(V)$を射影子(冪等作用素)とする．次の2条件を満たすことと，$V=\oplus_{i\in[r]}\Im P_i$が成り立つこととは同値：
    \begin{enumerate}
        \item $\sum P_i=I$．
        \item $P_iP_j=\delta_{ij}P_i=\delta_{ij}P_j$．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    $(V_i)$が線型空間$V$の直和分解を与えることは，射影子の間の代数的な関係によって特徴付けられる．
\end{remarks}

\begin{theorem}
    $A\in\End_K(V)$に対して，$\{f_i\}_{i\in[r]}\subset K[t]$は次を満たすならば，$V=\oplus_{i\in[r]}\Ker f_i(A)$が成り立つ：
    \begin{enumerate}
        \item $f_1,\cdots,f_r$はどの2つも互いに素である．
        \item $f:=f_1\cdots f_r$とすると，$f(A)=0$．
    \end{enumerate}
\end{theorem}

\subsection{Fisher-Cochranの定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\R^n$の直和分解に対して，独立な二次形式が定まる．
\end{tcolorbox}

\begin{theorem}
    $\{A_i\}_{i\in[k]}\subset M_n(\R)$は$I_n$の分解とする．このとき，次の4条件は同値：
    \begin{enumerate}
        \item 各$A_i$は射影である．
        \item $\forall_{i,j\in[k]}\;i\ne j\Rightarrow A_iA_j=O$．
        \item $\R^n=\oplus_{i\in[k]}\Im A_i$．
        \item $\sum_{i\in[k]}\rank A_i=n$．
    \end{enumerate}
\end{theorem}

\begin{theorem}[Fisher-Cochran]
    $\{A_i\}_{i\in[k]}\subset M_n(\R)$は対称行列からなる$I_n$の分解，$Y\sim N_n(\mu,I_n)\;(\mu\in\R^n)$とする．
    係数行列$A_i$の定める二次形式$Q_i:=Y^*A_iY,n_i:=\rank A_i$について，次の5条件は同値：
    \begin{enumerate}
        \item $\exists_{\delta_i\in\R_+}\;Q_i\sim\chi^2(n_i,\delta_i)$かつ$Q_1,\cdots,Q_k$は独立．
        \item $\sum_{i\in[k]}n_i=n$．
        \item 各$A_i$は射影である．
        \item $\forall_{i,j\in[k]}\;i\ne j\Rightarrow A_iA_j=O$．
        \item $\R^n=\oplus_{i\in[k]}\Im A_i$．
    \end{enumerate}
    このとき，$\delta_i=\mu^*A_i\mu$が成り立ち，特に$\sum_{j\in[n]}\mu_j^2=\sum_{i\in[k]}\delta_i$が成り立つ．
\end{theorem}

\section{非負行列の理論}

\subsection{正行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    正行列には，次の性質を兼ね備える正固有値$\al>0$を持つ：
    \begin{enumerate}
        \item $\al$に属する固有ベクトルは正に取れて，その1次元のみである．
        \item $\al$の代数的重複度も$1$である．
        \item 他の固有値の絶対値は$\al$よりも真に小さい．
    \end{enumerate}
    実はこれが正行列のスペクトル半径であり，Frobenius根という．
    正行列の性質はFrobenius根に支配される．
    Frobenius根が$\rho(A)\ge\rho(B)$を満たすならば，$A-B$は非負行列である．
\end{tcolorbox}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    実は，$F$-行列のスペクトル半径は正$\rho(A):=\max_{a\in\Sp(A)}\abs{a}>0$で，$\lambda:=\rho(A)$自体も固有値であると同時に，いくつか$\lambda e^{i\theta}$という形の固有値も存在し得る(その総数は周期に等しい)．
    正行列は必ず周期1である．
    正行列のスペクトル半径はFrobenius根に一致する．
\end{tcolorbox}

\begin{history}[正行列から$F$行列へ]
    Perronが正行列について始めた理論を，Frobeniusが分解不能な非負行列(これを$F$-行列という)に対して拡張した．
    確率論や力学系のエルゴード理論，工学・経済学・人口学の安定性理論において応用を持つ．
\end{history}

\begin{theorem}[Perron-Frobeniusの定理 (1907,1912)]
    正な正方行列$A>0\in M_n(\R)$について，
    \begin{enumerate}
        \item $A$は正の固有値を持ち，そのうち最大のものは重複度1の特性根である．これを\textbf{Frobenius根}という．
        \item さらに，$\al$に対応する固有ベクトル$u\in V_\al$は各成分が正になるように取れる．
        \item 他の一般化固有空間の元は，必ずどれかの成分が非正である．すなわち，$A$の正の固有ベクトルは$V_{\lambda(A)}$の元に限る．
        \item $\lambda(A)=\rho(A)$である．さらに$A$の他の固有値の絶対値は$\al$より真に小さい．
        \item ${}^t\!A$のFrobenius根も$\al$である．
    \end{enumerate}
    (1)について，特に成分の和が1になるように正規化したものを\textbf{確率固有ベクトル}という．
\end{theorem}
\begin{Proof}\mbox{}
    \begin{description}
        \item[正の固有値とそれに属する正ベクトルの存在] \begin{enumerate}[{Step}1]
            \item $\ep:=\min_{i,j\in[n]} a_{ij}>0$とすると，任意の非負ベクトル$x\in(\R_+)^n$に対して，$y:=Ax$は，
            \[y_i=\sum_{j\in[n]}a_{ij}x_j\ge\ep\sum_{j\in[n]}x_j\ge\ep\norm{x}_\infty\ge\ep x_i.\]
            より，$x\in\R^n$が正ならば$y=Ax\in\R^n$も正である．
            \item Step1の議論より，$\al(x):=\min_{i\in[n]}\frac{y_i}{x_i},\beta(x):=\max_{i\in[n]}\frac{y_i}{x_i}$とおけば，
            \[0<\ep\le\al(x)\le\beta(x)\]
            が成り立つ．以降，変換$x':=\frac{1}{\norm{Ax}_\infty}Ax$を考えると，不等式
            \[\begin{cases}
                \al(x)\le\al(x')\le\beta(x')\le\beta(x),\\
                \al(x')\ge\al(x)+\frac{\ep}{\norm{A}_1}\norm{Ax-\al(x)x}_\infty\ge\al(x).
            \end{cases}\]
            が成り立つ．
            \item このことを用いれば，任意の長さ1の正のベクトル$x_0\in\R^n$から変換
            \[x_1:=\frac{1}{\norm{Ax_0}_\infty}Ax_0,\cdots,x_p:=\frac{1}{\norm{Ax_{p-1}}_\infty}Ax_{p-1}.\]
            と定めると，長さ1のベクトルの列であって，
            \[\begin{cases}
                0<\al(x_0)\le\al(x_1)\le\cdots\le\beta(x_1)\le\beta(x_0),\\
                \al(x_{p+1})\ge\al(x_p)+\frac{\ep}{\norm{A}_1}\norm{Ax_p-\al(x_p)x_p}_\infty.
            \end{cases}\]
            を満たす．したがって，極限$\lim_{p\to\infty}\al(x_p)=\al>0$が成り立つ．
            同様に，$\R^n$の単位球面はコンパクトであるから，ある部分列$\{x_{p'}\}\subset\{x_p\}$が存在して，$u:=\lim_{p'\to\infty}x_{p'}\in\R^n$．
            この極限$u$は非負で長さ1であり，さらに$Au=\al u$より特に正である．
        \end{enumerate}
        \item[転置行列の任意の正固有値が正の固有ベクトルを持つなら$\al$である] 転置行列${}^t\!A$も再び正行列だから，(1)より正の固有値$\gamma$とこれに属する正の固有ベクトル$v$が存在する．
        \[\al(v|u)=v^\top\al u=v^\top Au=(A^\top v)^\top u=\gamma v^\top u=\gamma(v|u).\]
        $(v|u)>0$より，$\al=\gamma$が必要．
        \item[$\al$の代数的・幾何的重複度は1である] $x\in(\R^+)^n$を$A$の正の固有ベクトルとすると，必ず$\al$に属する必要がある．
        よって$x-cu\;(c>0)$も$\al$に属する固有ベクトルであるが，このとき$x-cu=0$が必要．
        よって，$\al$の固有空間は1次元である．
        これに加えて，$\al$の代数的重複度も1だと，Jordan標準形の議論から示せる．
        \item[$\al$の絶対値の最大性] $\al$以外の固有値$\lambda\in\C$を取ると，$\abs{\lambda}<\al$である．
    \end{description}
\end{Proof}

\begin{proposition}[非負であるということが定める順序関係はスペクトル半径の大小関係に等しい]
    正な正方行列$A>0\in M_n(\R)$とそのFrobenius根$\al>0$について，
    \begin{enumerate}
        \item $\rho>\al$ならば$\rho I-A\in\GL_n(\R)$で，逆も正である：$(\rho I-A)^{-1}>0$．
        \item 任意の実数$\rho\in\R$と非零ベクトル$x\in\R^n$とについて，$Ax-\rho x$が非負ならば，$\rho\le\al$．
        $\forall_{\rho\in\R,\R^n\ni x\ge0}\;x\ne0\land Ax-\rho x\ge0$ならば，$\rho\le\rho(A)$．
        \item $B>0\in M_n(\R)$も正行列とする．$A-B\ge0$ならば，$\rho(B)\le\rho(A)$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $\rho^{-1}A$の固有値の絶対値は全て1より小さいため，Neumann級数展開可能である．
        \item $Ax-\rho x$が非負のとき，$(\rho I-A)x$は非正である．$\rho>\al$のとき，(1)より$(\rho I-A)^{-1}$も正行列だから，$x$も非正である必要があり，矛盾．
        \item 仮定より，$\rho(B)$に属する$B$の正の固有ベクトル$v$について，$Av-\rho(B)v=(A-B)v$は非負ベクトルになる．(2)より，$\rho(B)\le\rho(A)$．
    \end{enumerate}
\end{Proof}

\subsection{非負行列に対するFrobenius理論}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    非負行列の特徴は，第一象限$(\R_+)^n\setminus\{0\}$を第一象限に写すことである．
    特に球面$S^{n-1}\subset\R^n$に議論を制限すると，
    $S^{n-1}$の第一象限はコンパクトであるから，ここに不動点が存在し，これがFrobenius根となる．
    しかし，他の固有値の絶対値より真に大きいという性質のみ失敗し，非負行列の固有値の様子を更に詳しく調べる必要がある．
\end{tcolorbox}

\begin{theorem}[非負行列のFrobenius根]
    一般の非負行列$A\in M_n(\C)$について，
    \begin{enumerate}
        \item 非負の実固有値を持つ．その最大のものを$\al$とすれば，これに属する非負の固有ベクトルが存在する．
        \item $A$の任意の固有値の絶対値は$\al$を超えない：$\rho(A)=\al$．
        \item スペクトル半径$\rho(A)$は，行和$\sum_{i=1}^na_{ij}$の平均に等しい．特に，
        \[\min_{j\in[n]}\sum_{i=1}^na_{ij}\le\rho(A)\le\max_{j\in[n]}\sum_{i=1}^na_{ij}.\]
        \item $A\ge B\ge O$ならば$\rho(A)\ge\rho(B)$が成り立つ．
        \item 転置行列${}^t\!A$のFrobenius根も$\rho(A)$である．
    \end{enumerate}
\end{theorem}
\begin{Proof}
    $A=(a_{ij})$に対して，$A(t):=(a_{ij}+t)_{i,j\in[n]}$と定めると，$t>0$について$A(t)>0$で，$A=\lim_{t\searrow0}A(t)$．
    $A(t)$のFrobenius根を$\al(t)$とし，これに対応する長さ$1$の正の固有ベクトルを$u(t)$とする．
    \begin{enumerate}
        \item $(\al(t))$は単調増加であり，$\al=\lim_{t\searrow0}\al(t)\ge0$で，$u:=\lim_{t\searrow0}u(t)$とすると，$Au=\al u$が成立する．
        \item $A$の任意の固有値$\lambda\in\C$を取ると，$A(t)$の固有値$\lambda(t)$が存在してその極限になる：$\lambda=\lim_{t\searrow0}\lambda(t)$．
    \end{enumerate}
\end{Proof}

\begin{theorem}[可逆な$M$行列の特徴付け１]
    非負行列$A\in M_n(\R)$と正数$\mu>0$について，次は同値：
    \begin{enumerate}
        \item $\forall_{b\ge0\in\R^n}\;\exists_{x\ge0\in\R^n}\;(\mu I_n-A)x=b$．
        \item $\exists_{x>0\in\R^n}\;(\mu I_n-A)x>0$．
        \item $(\mu^{-1}A)^p\to O\;(p\to\infty)$．
        \item $\rho(A)<\mu$．
        \item $\mu I_n-A$の全ての首座小行列式は正．
        \item $\mu I_n-A\in\GL_n(\R)$かつ$(\mu I_n-A)^{-1}\ge O$．
        \item 単位下三角$Z$-行列$L$と，対角要素が正な上三角$Z$-行列$U$を用いて，$\mu I_n-A=LU$と表せる．
    \end{enumerate}
    (5)は$\det A>0$を含意している．
\end{theorem}
\begin{remarks}
    $m+1$の節点を持つ正の線型抵抗を持つ電気回路の接点コンダクタンス行列は$M$-行列になる．
    これは，各節点でのOhmの法則$i_\al=\sum_{\beta=1}^my_{\al\beta}v_\beta\;(\al\in[m])$の係数行列である．
    $Y$が正定値であることは，あらゆる電圧の欠け方に対して，Joule熱が正であることに対応する：$\forall_{i_\al,v_\al\in\R}\;\sum_{\al=1}^mi_\al v_\al=\sum_{\al,\beta\in[m]}y_{\al\beta}v_\al v_\beta>0$．
    これは条件(5)に対応する．すると，(6)$Y^{-1}\ge O$は，電圧・電流関係の単調性を表す．
\end{remarks}

\subsection{分解不能行列の周期標準形}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    行列が定めるグラフが\textbf{強連結}とは，その行列を遷移行列とするMarkov連鎖があらゆる2点を移動可能であることをいう(迂回路を含む)．
    行列については\textbf{分解不能}という．
    分解不能な非負行列を$F$-行列といい，Perron-Frobeniusの定理は最終的にこのクラスにまで拡張される．
    \begin{enumerate}
        \item 実は非負行列については，分解不能行列のクラスは，各辺ごとに見て「いずれ通行可能になる」行列のクラスに一致する．これを\textbf{既約行列}という．
        \item よって非負な既約行列を$F$-行列と定義しても良い．
        例えば正行列はこれを満たすが，これでは条件が強すぎるので，何回か乗じた後には正行列になり得るクラスを考える．これを\textbf{原始的}という．
        このクラスは$\lim_{n\to\infty}A^n$の極限を持つクラスと同値になるので特に重要であり，この意味で\textbf{エルゴード的}ともいう．
        \item これは明らかに周期を持つことが予想される．
        実は，各辺ごとに見て，「いつ通行可能になるか」の周期は辺に依らない！
        \item そしてこれの周期が1であることが，$F$-行列が原始的であることに同値になる．
    \end{enumerate}
\end{tcolorbox}

\begin{definition}[strongly connected directed graph]
    有向グラフ$(\Om,\Gamma)$について，
    \begin{enumerate}
        \item $i,j\in\Om$を結ぶ\textbf{有向道}とは，系列$(i_0,\cdots,i_p)\in\Om^{p+1}$であって，$\forall_{k\in p}\;(i_k,i_{k+1})\in\Gamma$を満たすものをいう．
        \item $\Gamma(i,j)$を，$i,j\in\Om$を結ぶ有向道全体の集合とする．
        \item $l(\sigma)$で$\sigma\in\Gamma(i,j)$の\textbf{長さ}を表す．
        \item 有向グラフ$(\Om,\Gamma)$が\textbf{強連結}とは，$\abs{\Om}\ge2$かつ任意の相異なる2点を通る有向道が存在することをいう：$\forall_{i,j\in\Om}\;\Gamma(i,j)\ne\emptyset$．
        \item 頂点$i\in\Om$の\textbf{周期}とは，$h_i:=\gcd\Brace{l(\sigma)\in\N^+\mid\sigma\in\Gamma(i,i)}$をいう．
    \end{enumerate}
\end{definition}

\begin{proposition}[強連結有向グラフの周期]
    強連結な有向グラフ$(\Om,\Gamma)$について，周期$h_i$は頂点$i\in\Om$の選び方に依らない．
    以降，この共通の値$h$を\textbf{強連結有向グラフ$(\Om,\Gamma)$の周期}という．
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}[{Step}1]
        \item 任意の$i\in\Om$について，$\Gamma(i,i)\ne\emptyset$である．
        実際，$\abs{\Om}\ge2$より，ある$j\in\Om\setminus\{i\}$が取れて，$\sigma_1\in\Gamma(i,j)\ne\emptyset$かつ$\tau_1\in\Gamma(j,i)\ne\emptyset$．
        これについて，$\sigma_1+\tau_1\in\Gamma(i,i)$である．
        特に，$h_i|(l(\sigma_1)+l(\tau_1))$．
        \item 任意の$\rho\in\Gamma(j,j)$を取ると，$\sigma_1+\rho+\tau_1\in\Gamma(i,i)$であるから，$h_i|(l(\sigma_1)+l(\rho)+l(\tau_1))$．
        よって，$h_i|l(\rho)$であるから，$h_i|h_j$を得る．
        \item 同様にして$h_j|h_i$も言えるから，$h_i=h_j$．
    \end{enumerate}
\end{Proof}

\begin{definition}[indecomposable matrix]\mbox{}
    \begin{enumerate}
        \item 行列$A\in M_n(K)$が\textbf{定める有向グラフ}とは，
        \[\Gamma:=\Brace{(i,j)\in[n]^2\mid a_{ij}\ne0}\]
        によって定まる
        $([n],\Gamma)$をいう．
        \item 行列$A\in M_n(K)$が定める有向グラフが強連結であるとき，\textbf{分解不能}であるという．
        \item 分解不能な非負行列を\textbf{Frobenius行列}または\textbf{$F$-行列}という．
        \item 周期1の$F$-行列を\textbf{非振動的}という．
    \end{enumerate}
    任意の正行列は$F$-行列である．
\end{definition}

\begin{lemma}[強連結な有向グラフの周期]
    有向グラフ$(\Om,\Gamma)$は強連結とする．
    \begin{enumerate}
        \item 任意の$i\in\Om$について，$\Gamma(i,i)$の元の長さの最大公約数$h_i$は$i\in\Om$に依らない．これを\textbf{周期}という．
        \item $\forall_{\sigma,\tau\in\Gamma(i,j)}\;l(\sigma)=l(\tau)\mod h$．
        \item $i\sim j:\Leftrightarrow\exists_{\sigma\in\Gamma(i,j)}\;h|l(\sigma)$は$\Om$上に同値関係を定める．
        \item $i_0\in\Om$を固定し，$f:\Om\to\Z/(h)$を$f(i):=l(\sigma)\mod h\;(\sigma\in\Gamma(i_0,i))$とすると，これは上の同値関係を引き起こす全射である．
        そこで，各$t\in\Z/(h)$に対応する同値類を$\Om_t$とする．
        \item 同値類$(\Om_t)$は次を満たす：$\forall_{i\in\Om_s,j\in\Om_t}\;s+1\ne t\mod h\Rightarrow (i,j)\notin\Gamma$．
    \end{enumerate}
\end{lemma}

\begin{proposition}[強連結な有向グラフの標準分解]
    有向グラフ$(\Om,\Gamma)$は強連結とし，$h$を周期とする．
    \begin{enumerate}
        \item $i\sim j:\Leftrightarrow\exists_{\sigma\in\Gamma(i,j)}\;h|l(\sigma)$は$\Om$上に同値関係を定める．
        \item 任意の$i_0\in\Om$に対して，写像$f:\Om\to\Z/(h)$を$f(i):=l(\sigma)\mod h\;(\sigma\in\Gamma(i_0,i),i\in\Om)$と定める．これはwell-definedであり，全単射$\o{f}:\Om/\simeq\equiv\Z/(h)$を定める．
        \item この標準分解$\Om=\sqcup_{i\in[h]}\Om_i$について，$s+1\not\equiv t\mod h$ならば，任意の$i\in\Om_s,j\in\Om_t$の間に辺はない$(i,j)\notin\Gamma$．
        すなわち，$\Om$上の$i\in\Om_0$からスタートする単純酔歩について，
        時刻$t\in\N$が$t=i\in[h]\mod h$のとき，$\Om_i$上にしか存在しえない．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 
        \begin{enumerate}[{Step}1]
            \item まず，$\exists_{\sigma\in\Gamma(i,j)}\;h|l(\sigma)$のとき，任意の$\sigma\in\Gamma(i,j)$について$h|l(\sigma)$が成り立つ．
            これは$\forall_{\sigma,\tau\in\Gamma(i,j)}\;l(\sigma)\equiv l(\tau)\mod h$による．
    
            実際，任意の帰路$\tau_1\in\Gamma(j,i)$を取れば，$h|(l(\sigma)+l(\tau_1))$かつ$h|(l(\tau)+l(\tau_1))$が成り立つ．よって，$h|(l(\sigma)-l(\tau))$．
            \item 反射律$i\sim i$は周期の定義から明らか．対称律は任意の$\tau_1\in\Gamma(i,j),\tau_2\in\Gamma(j,i)$のとき，$\tau_1+\tau_2\in\Gamma(i,i)$より$h|(l(\tau_1)+l(\tau_2))$．仮定より$h|l(\tau_1)$が成り立つならば，$h|l(\tau_2)$も成り立つ．
            推移律も同様．
        \end{enumerate}
        \item 
        \begin{description}
            \item[well-defined性] まず$\sigma\in\Gamma(i_0,i)$の選び方と$i_0\in\Om$の選び方に依らないのは，(1) Step1で示した性質$\forall_{\sigma,\tau\in\Gamma(i_0,i)}\;l(\sigma)=l(\tau)\;\mod h$による．
            \item[商集合上に単射を定める] 次に，$i\sim j\Leftrightarrow f(i)=f(j)$を示す．
            任意の$\sigma\in\Gamma(i_0,i),\tau\in\Gamma(i_0,j),\rho\in\Gamma(i,j)$について，
            $\sigma+\rho\in\Gamma(i_0,j)$より，$l(\sigma)+l(\rho)\equiv l(\tau)\mod h$．
            あとは$i\sim j\Leftrightarrow l(\rho)\equiv0\mod h$から従う．
            \item[全射性] 最後に，$f:\Om\to\Z/(h)$が全射であることを示す．
            $i_0\ne i\in\Om$，$\sigma\in\Gamma(i_0,i),\tau\in\Gamma(i,i_0)$を取る．
            $\sigma+\tau=(i_0,i_1,\cdots,i_p),i_p=i_0$と定めると，$l(\sigma)>0$かつ$h|p$より，$p\ge h$．
            よってこれに対して，$f(i_0),f(i_1),\cdots,f(i_{h-1})$がそれぞれmod $h$で$0,1,\cdots,h-1$である．
        \end{description}
    \end{enumerate}
\end{Proof}

\begin{example}
    $\Z^2$上の酔歩は，頂点集合$\Z^2$上に強連結な有向グラフを定め，周期2である．
    $\abs{(x,y)}:=\abs{x}+\abs{y}$とすると，奇数時刻には$\abs{(x,y)}$が奇数の点，偶数時刻には$\abs{(x,y)}$が偶数の点上にしか存在しえない．
\end{example}

\begin{theorem}[分解不能行列の周期標準形]
    $A\in M_n(K)$を周期$h\in\N^+$を持つ分解不能行列とする．
    標準基底$e_1,\cdots,e_n$を同値類別$\Om_1+\cdots+\Om_h$に登場する順で並び替え，基底の変換行列を$(e_{\sigma(1)}\cdots e_{\sigma(n)})=(e_1\cdots e_n)P$とする．
    このとき，
    \[PAP^{-1}=\begin{pmatrix}0&A_1&0&\cdots&0\\0&0&A_2&\cdots&0\\\vdots&\vdots&\ddots&\ddots&\vdots\\0&0&0&\cdots&A_{h-1}\\A_h&0&0&\cdots&0\end{pmatrix},\quad A_i\in M_{\abs{\Om_i}}(K).\]
    と表せる．
    特に，$A^p=:(a_{ij}^{(p)})$とおくと，$p\ne0\mod h\Leftrightarrow a_{11}^{(p)}=\cdots=a_{nn}^{(p)}=0$．
\end{theorem}
\begin{remarks}
    $\Om_i$内の点からは$\Om_{i+1}$内の点への推移しか起こり得ないため，他の行の成分は$O$になる．
\end{remarks}

\subsection{$F$-行列の固有値理論}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
    title=]
    一般の$F$-行列も，$\rho(A)$に等しい固有値は重複度1で，他に絶対値が$\rho(A)$に等しい固有値も重複度1である．
    この描像は，$\Sp(A)$の外側に，$A$の周期$h\in\N^+$に等しい数だけ固有値が$\rho(A)e^{2\pi in/h}\;(n\in h)$というように分布している．
    $F$行列の周期が1であるときのみ，$\lim_{n\to\infty}A^n$が存在する．
\end{tcolorbox}

\begin{lemma}
    非負行列$A=(a_{ij})\ge0$について，$A^p=:(a_{ij}^{(p)})$と表す．
    任意の$i,j\in[n]$について，
    \begin{enumerate}
        \item $p\in\N^+$について，次は同値：
        \begin{enumerate}
            \item $a_{ij}^{(p)}>0$．
            \item ある$\sigma\in\Gamma(i,j)$が存在して，$a_{\sigma}>0$かつ$l(\sigma)=p$．
        \end{enumerate}
        \item 次も同値：
        \begin{enumerate}
            \item $\Gamma(i,j)\ne\emptyset$．
            \item $a_{ij}+a_{ij}^{(2)}+\cdots+a_{ij}^{(n-1)}>0$．
        \end{enumerate}
    \end{enumerate}
\end{lemma}
\begin{remarks}
    非負行列$A\ge0$について，
    \begin{enumerate}
        \item 周期$1$であること（非振動的）は，任意の$i\in[n]$について，$p_{ii}^{m}>0\;\fe$と同値．すなわち，原始的であることに同値．
        \item 既約であることは，任意の$i,j\in[n]$について，$\exists_{k\in\N}\;p_{ij}^{(k)}>0$に同値．
    \end{enumerate}
\end{remarks}

\begin{theorem}[Frobenius根の性質]\label{thm-Perron-Frobenius-root}
    $F$-行列$A\in M_n(\R)$について，
    \begin{enumerate}
        \item $(I+A)^{n-1}>0$．
        \item スペクトル半径は正であり$\rho(A)>0$，$r:=\rho(A)$も$A$の固有値である．さらに，$r$には正な固有ベクトルが存在する．
        \item 非負ベクトルの非負固有値はFrobenius固有値に限る：ある非負数$\al\in\R_+$と零でない非負ベクトル$x\in(\R_+)^n$について$Ax=\al x$が成り立つならば，$\al=\rho(A)$かつ$x>0$である．
    \end{enumerate}
\end{theorem}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 次の式と行列の非負性より，$(I+A)^{n-1}$の$(i,i)$成分$x_{ii}$は1以上，特に，正である．
        \[(I+A)^{n-1}=I+\comb{n-1}{1}A+\comb{n-1}{2}A^2+\cdots+A^{n-1}.\]
        $x_{ij}\;(i\ne j)$も，分解不能であるから$\Gamma(i,j)\ne\emptyset$より，補題から
        \[x_{ij}=(n-1)a_{ij}+\comb{n-1}{2}a_{ij}^{(2)}+\cdots+a_{ij}^{(n-1)}>0.\]
        \item 
    \end{enumerate}
\end{Proof}

\begin{theorem}[$F$-行列の対角化]
    $F$-行列$A\in M_n(\R)$と，一般の行列$B\in M_n(\C)$について，$A\ge B^+:=(\abs{b_{ij}})$が成り立つとする．
    \begin{enumerate}
        \item $\rho(A)\ge\rho(B)$．
        \item 等号成立するならば，$A=B^+$．さらに絶対値が$\rho(A)$に等しい$B$の固有値$\rho(A)e^{i\theta}$に対して，絶対値1の複素数からなる対角行列$D$が存在して，$B=e^{i\theta}DAD^{-1}$．
        \item $A$の固有値$re^{i\theta}$について，ユニタリ対角行列$D_1$が存在して，$A=e^{i\theta}DAD^{-1}$が成り立つ．
    \end{enumerate}
\end{theorem}

\begin{theorem}[$F$-行列の最大絶対値を持つ固有値]
    $F$-行列$A\in M_n(\R)$について，
    \begin{enumerate}
        \item $A$のFrobenius根は単純である．
        \item $\rho(A)=\abs{\lambda}$を満たす固有値$\lambda\in\Sp(A)$も単純である．
        \item $A$の周期を$h$とすれば，$\abs{\lambda}=\rho(A)$を満たす固有値は$h$個あり，$e^{2\pi in/h}\rho(A)\;(n\in h)$と表せる．
    \end{enumerate}
\end{theorem}
\begin{Proof}
    \cite{岩堀77-線型不等式}定理6.7．
\end{Proof}

\begin{theorem}[$F$-行列の極限の存在条件]\label{thm-limit-of-nonnegative-matrix}
    $F$-行列$A$に対して，$B:=\rho(A)^{-1}A$とおく．次は同値：
    \begin{enumerate}
        \item $A$は非振動的(周期が1である)．
        \item $A$は原始的である：$\exists_{m\in\N^+}\;A^m>0$．
        \item $\lim_{i\to\infty}B^i$が存在する．
    \end{enumerate}
\end{theorem}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(1)$\Leftrightarrow$(2)] 補題より，周期1のとき，任意の$i.j\in[n]$について，$\exists_{k\in\N^+}\;\forall_{n\ge k}\;p_{ij}^{(n)}>0$．よって，原始的である．
        逆も成り立つ．
        \item[(1)$\Leftrightarrow$(3)] $B$のJordan標準形と，前の定理より．周期が$1$でない限り，$e^{2\pi in/h}\rho(A)\;(1\le n\le h-1)$という形の固有値が回転したまま収束しない．
    \end{description}
\end{Proof}
\begin{remarks}\mbox{}
    \begin{enumerate}
        \item 周期が1でないとき，すなわち絶対値が$\rho(A)$になる固有値が複数ある場合は，$A,A^2,A^3,\cdots$の系列は収束しないが，Cesaro和は収束する．
        これはCesaro和が振動を抑えるためである．
        \item 最後の極限$B$は，右固有ベクトル$u$と，左固有ベクトル$v$とも用いて，$uv^\top$と表せる．
        これは$\rho(B)$に属する固有空間上への射影となっており，Perron射影ともいう．
    \end{enumerate}
\end{remarks}

\subsection{確率行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    確率行列は極めて微妙な立ち位置に居る．
    非負行列として，Frobenius根の存在は確約される．
    一方で，既約でない限りエルゴード性は保証されない．
\end{tcolorbox}

\begin{definition}[probability matrix]
    非負行列$A\ge0\in M_n(\R)$が\textbf{(行)確率行列}であるとは，
    各行の値の和が$\forall_{s\in[n]}\;\sum_{i\in[n]}a_{si}=1$を満たすことをいう．
\end{definition}

\begin{lemma}[行確率行列の特徴付け]
    非負行列$A\in M_n(\R)_+$について，次は同値：
    \begin{enumerate}
        \item $A$は確率行列である．
        \item $A\b{1}_n=\b{1}_n$．
    \end{enumerate}
\end{lemma}
\begin{Proof}
    $A$の第$i$行の成分の和を$\al_i$とすると，
    $A\b{1}_n=(\al_1,\cdots,\al_n)^\top$より，
    この値が$\b{1}_n$に等しいことと，$\forall_{i\in[n]}\;\al_i=1$とは同値．
\end{Proof}


\begin{proposition}[確率行列の性質]
    確率行列$P\ge0$に対して，次のことが成り立つ．
    \begin{enumerate}
        \item $P$は$1$を固有値に持ち，$\b{1}_n$はこれに属する固有ベクトルである．
        \item $P$が既約ならば，$1$は絶対値が最大の固有値であり，これに属する固有空間は1次元で，$\R\b{1}_n$と表せる．
        \item さらに，$P$が原始的ならば，さらに次が成り立つ：
        \begin{enumerate}
            \item 他の固有値の絶対値は$\rho(P)$より真に小さい．
            \item 極限$\lim_{m\to\infty}P^m=B$が存在する．
            \item 極限$B$は，
            転置$P^\top$のFrobenius根$1$に属する固有ベクトル$u\in\R^n$であって$u^\top\b{1}_n=1$を満たすものについて，
            \[B=u\b{1}_n^\top\]
            と表せる．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 確率行列の定義より$P\b{1}_n=\b{1}_n$．
        \item 定理\ref{thm-Perron-Frobenius-root}から，関係式$P\b{1}_n=\b{1}_n$から直ちに，$1$は$P$のPerron-Frobenius根であり，$\b{1}_n$はその固有ベクトルの1つであることが解る．
        \item (a),(b)は定理\ref{thm-limit-of-nonnegative-matrix}より．
        極限$B$について，$B\b{1}_n=\b{1}_n$が必要．
        同様にして，$P^\top$のFrobenius根
        $vB=v$が必要．
    \end{enumerate}
\end{Proof}
\begin{remark}\label{remark-limit-of-probability-matrix}
    特に，$B$の行ベクトルは全て$u$であり，
    $P^\top$の$1$に属する固有空間上への射影に他ならない(Perron射影ともいう)．
    特に$P$が対称行列ならば，$u=\frac{1}{n}\b{1}_n$であり，
    $B$の成分は全て$1/n$である．
\end{remark}

\begin{definition}
    $P\ge0$を既約でない確率行列とし，既約標準形の一つを
    \[P^\top AP=\begin{pmatrix}A_{11}&*&*&*\\O&A_{22}&*&*\\O&O&\ddots&*\\O&O&O&A_{ss}\end{pmatrix}\]
    とする．
    \begin{enumerate}
        \item 各対角ブロック$A_{kk}$は，付随する有向グラフの強連結成分に対応する．
        \item 各対角ブロック$A_{kk}$が強連結成分として極大であることと，$A_{kk}$の上方の$*$にある$A$の要素は全て$0$であることとは同値．このとき，$A_{kk}$は既約な確率行列になっている．
        \item 極大な強連結成分$A_{kk}$を\textbf{エルゴード部分}，それ以外の強連結成分を\textbf{消散部分}という．
        \item 各エルゴード部分の内部では，$A_{kk}$が定めるMarkov連鎖に従って，初期分布に依らない平衡分布に到達するが，エルゴード部分の間での確率の分配は初期状態確率に依存する．
    \end{enumerate}
\end{definition}

\subsection{二重確率行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    任意の二重確率行列は，置換行列の凸結合である．
    これは任意の確率分布が$\delta$-測度の凸結合であることに似ている．
\end{tcolorbox}

\begin{definition}
    行和も列和も1になる非負行列を\textbf{二重確率行列}という．
    対称な確率行列は二重である．
\end{definition}

\begin{theorem}[Birkhoff]
    $A\in M_n(\R)$を二重確率行列とする．
    このとき，$A$は有限個の置換行列$P_1,\cdots,P_N$の凸結合である：
    \[A=\al_1P_1+\cdots+\al_NP_N,\quad \al_1,\cdots,\al_N>0,\sum_{n\in[N]}\al_n=1.\]
\end{theorem}

\section{行列の計算}

\subsection{行列の分類}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    いままで成分の正負の観点から行列を見てきたが，
    「対角成分への集約」などの粗密の観点から行列を捉え直す．
\end{tcolorbox}

\begin{definition}
    行列$A=(a_{ij})\in M_{mn}(K)$について，
    \begin{enumerate}
        \item $b:=\min\Brace{b\ge1\mid\forall_{(i,j)\in[m]\times[n]}\;\abs{i-j}>b\Rightarrow a_{ij}=0}$について，$2b+1$を\textbf{帯幅}という．
        \item 帯幅3の帯行列を\textbf{三重対角行列}という．
        \item 三重対角行列と上三角行列との和で表せる行列を\textbf{上Hessenberg行列}という．
    \end{enumerate}
\end{definition}
\begin{remarks}
    行列計算では上三角化が最重要視され，次善策がHessenberg行列となる．
\end{remarks}

\begin{definition}[diagonally dominated matrix, reduceable]
    $A\in M_n(\C)$について，
    \begin{enumerate}
        \item $A$が(行方向の)\textbf{対角優位行列}であるとは，次を満たすことをいう：
        \[\forall_{i\in[n]}\quad\abs{a_{ii}}\ge\sum_{j\ne i\in[n]}\abs{a_{ij}}.\]
        \item 不等号が真の意味で成り立つとき，\textbf{狭義優対角行列}という．
        \item ある正値対角行列$D=\diag(d_i)\;(d_1,\cdots,d_n>0)$が存在して，$AD$が狭義優対角行列になるとき，$A$を\textbf{一般化狭義優対角行列}という．すなわち，次を定義とする：
        \[\exists_{d_1,\cdots,d_n>0}\;\forall_{i\in[n]}\quad\abs{a_{ii}}d_i\ge\sum_{j\ne i\in[n]}\abs{a_{ij}}d_j.\]
        \item $n\ge2$のとき$A$が\textbf{可約}であるとは，次を満たすことをいう：
        \[\exists_{\emptyset\ne J\subsetneq[n]}\;\forall_{i\in J}\;\forall_{j\in[n]\setminus J}\;a_{ij}=0.\]
        すなわち，行ベクトルの真部分集合$J\subsetneq [n]$であって，
        同じ番号の列ベクトルとの交点でない限り値が$0$であるような$J$が存在することをいう．
        \item 可約でない行列を\textbf{既約}であるという．$n=1$のとき，$A=O$のみ可約とする．
    \end{enumerate}
\end{definition}

\begin{theorem}[既約性の幾何学的な意味]
    $A\in M_n(\C)$について，次は同値である．
    \begin{enumerate}
        \item $A$は既約である．
        \item $A$は非自明な不変部分空間を持たない．
        \item $A$は置換行列$P$によって上三角ブロック行列に相似変換されることはない．
    \end{enumerate}
    さらに$A$が非負であるとき，分解不能性に同値．
\end{theorem}

\subsection{Gaussの消去算譜}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    算譜中に対角成分が消えると，情報落ち・桁落ちが生じる可能性がある．
    これが起きないようなクラスが，正定値自己共役行列と一般化狭義優対角行列なのである．
\end{tcolorbox}

\begin{theorem}\label{thm-Gaussian-elimination}
    $A\in M_n(\R)$について，次は同値：
    \begin{enumerate}
        \item $A$の上三角化の対角成分が消えない．
        \item $A$の全ての首座小行列は正則である．
        \item $A$は上三角化$U$と単位下三角行列$L$とを用いて$A=LU$に一意に分解出来る．
    \end{enumerate}
\end{theorem}

\begin{proposition}
    $A\in M_n(\R)$が正定値対称，一般化狭義優対角ならば，(2)を満たす．
\end{proposition}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item (LDL) 実対称行列が定理の条件を満たすならば，同様の$L$と$A$の上三角化の対角成分からなる対角行列$D$を用いて$A=LDL^\top$の形に一意に分解出来る．
        \item (Cholesky) 正定値の実対称行列が定理の条件を満たすならば，対角成分が正であるような下三角行列$S$を用いて，$A=SS^\top$と一意に分解出来る．
    \end{enumerate}
\end{proposition}

\subsection{$M$-行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    非負行列$B\ge0$を用いて，$sI-B\;(s\ge\rho(B))$の形で表される$Z$-行列をMinkowskiにちなんで$M$-行列という． 
\end{tcolorbox}

\begin{definition}
    正方行列について，
    \begin{enumerate}
        \item 任意の主小行列式が正である行列を\textbf{$P$-行列}，その閉包を$P_0$-行列といい，任意の主小行列式が非負であることに同値．
        \item 非対角要素が全て非正である行列を\textbf{$Z$-行列}という．
        逆に，非対角行列が全て非負である行列をMetzler行列または$Z^-$-行列という．
        \item 非負行列$B\ge0$を用いて，$sI-B\;(s\ge\rho(B))$の形で表される$Z$-行列を\textbf{$M$-行列}という．
        \item 行列$A=(a_{ij})\in M_n(\C)$の\textbf{比較行列}とは，これが定める$Z$-行列$\al_{ij}=(-1)^{\chi_{\Brace{i\ne j}}}\abs{a_{ij}}$をいう．
        \item 比較行列が$M$-行列になるような行列を\textbf{$H$-行列}という．
    \end{enumerate}
\end{definition}

\begin{theorem}[可逆な$M$-行列の特徴付け２]
    $Z$-行列$A\in M_n(\C)$について，次は同値：
    \begin{enumerate}
        \item 任意の非負対角行列$D:=\diag(d_i)\;(d_1,\cdots,d_n\ge0)$について，$A+D$は可逆である．
        \item 可逆で，さらに逆行列が非負である．
        \item $P$-行列でもある：任意の主小行列式は正である．
        \item 任意の実固有値は正である．
        \item 任意の固有値の実部は非負である．
        \item $A$は単調である：$\forall_{x\ge0}\;Ax\ge0$．
        \item 一般化狭義優対角行列である．
    \end{enumerate}
\end{theorem}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item 一般化狭義優対角行列は可逆である．
        \item 既約な優対角行列は，少なくとも1つの行$k\in[n]$で$\abs{a_{kk}}>\sum_{j\ne k}\abs{a_{kj}}$が成り立てば可逆である．
    \end{enumerate}
\end{proposition}

\subsection{Householder行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    QR分解の第一段階であり，対称行列の三角化，非対称行列のHessenberg化に広く用いられる変換である．
    QR分解と三角化の計算コストの低さはHouseholder変換が支えている．
\end{tcolorbox}

\begin{definition}
    単位ベクトル$u\in\C^n,\norm{u}=1$について，$H(u):=I_n-2uu^*$を\textbf{Householder行列}という．
\end{definition}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item Hermiteかつユニタリ行列である：$H(u)^2=I_n,H(u)^*=H(u)$．
        \item $\det H(u)=-1$．
        \item $H(u)$は$u$を法線ベクトルの1つとする原点を通る超平面に関する鏡映変換を定める．
    \end{enumerate}
\end{proposition}

\begin{theorem}
    任意の正則行列$A\in M_n(\R)$は，$n-1$回のHouseholder変換によって$A=QR$の形に分解可能である．
\end{theorem}
\begin{remarks}
    この算譜が殆ど最適であるが，それでもLU分解の約2倍の乗除算が必要であり，連立一次方程式の解法としては実用性はなく，むしろ固有値問題において真価を発揮する．
\end{remarks}

\subsection{Givens行列}

\begin{definition}
    Givens回転$G(k,l,\theta)\in M_n(\R)$とは，単位行列$I_n$の4成分$(g_{ij})_{i,j\in\Brace{k,j}^2}$を回転行列に変更したものをいう．
    すなわち，$\R^n$の元を$(k,l)$-部分平面で$\theta$だけ反時計回りに回転させる変換をいう．
\end{definition}
\begin{remarks}
    ハウスホルダー変換は直列処理機械
    上の密行列に適しており、一方でギヴンス変換は並列処理機械
    や疎行列に適している。
\end{remarks}

\subsection{離散Fourier変換}

\begin{definition}
    原始$n$乗根$\zeta:=e^{2\pi i/n}$について，$Z:=\paren{z_{ij}:=\frac{1}{\sqrt{n}}\zeta^{(i-1)(j-1)}}_{i,j\in[n]}\in M_n(\C)$とすると，これは対称なユニタリ行列である．
    線形写像$Z:\C^n\to\C^n$を\textbf{離散Fourier変換}という．
\end{definition}

\subsection{三重対角行列}

\begin{theorem}[\cite{Smith86-NumericalSolutionOfPDE} Exercise16]\label{thm-eigenvalue-of-tridiagonal-matrix}
    実三重対角行列の非対角成分が全て負であるか，全て正であるとき，全ての固有値は実である．
\end{theorem}

\begin{theorem}[\cite{Smith86-NumericalSolutionOfPDE} p.154]
    三重対角なToeplitz行列
    \[\begin{pmatrix}
        a&b\\
        c&a&b\\
        &\ddots&\ddots&\ddots\\
        &&\ddots&\ddots&\ddots\\
        &&&c&a&b\\
        &&&&c&a
    \end{pmatrix}\in M_n(\C)\]
    の固有値は
    \[\lambda_j=a+2b\sqrt{\frac{c}{b}}\cos\frac{j\pi}{n+1},\qquad j\in[n]\]
    で与えられる．
\end{theorem}
\begin{Proof}\mbox{}
    \begin{enumerate}[{Step}1]
        \item 任意の固有値$\lambda$と，これに属する零でない固有ベクトル$v=(v_1,\cdots,v_n)^\top$を取ると，
        \[Av=\lambda v\quad\Leftrightarrow\quad 
        \begin{pmatrix}
            a-\lambda&b\\
            c&a-\lambda&b\\
            &\ddots&\ddots&\ddots\\
            &&\ddots&\ddots&\ddots\\
            &&&c&a-\lambda&b\\
            &&&&c&a-\lambda
        \end{pmatrix}\begin{pmatrix}v_1\\v_2\\\vdots\\\vdots\\v_{n-1}\\v_n\end{pmatrix}=0\]
        を満たすが，これは$v_0=v_{n+1}=0$と置くと，三項間漸化式
        \[cv_{j-1}+(a-\lambda)v_j+bv_{j+1}=0,\qquad(j=1,\cdots,n).\]
        を満たす．
        \item この三項間漸化式の特性方程式
        \[c+(a-\lambda)m+bm^2=0\]
        は重根を持たないことを示す．仮に2解が$m_1=m_2$を満たすとすると，
        $v_j=(B+Cj)m_1^j\;(B,C\in\R)$は上の三項間漸化式の解であるが，
        初期条件$v_0=v_{n+1}=0$の下では$B=C=0$が必要であるから，結局$v=0$．
        これは$\lambda$を固有値，$v$をその非零固有ベクトルとした仮定に矛盾．
        \item よって，特性根を$m_1\ne m_2$とすると，
        \[v_j=Bm_1^j+Cm_2^j\qquad(j=0,1,\cdots,n,n+1).\]
        は解を与える．初期条件
        \[\begin{cases}
            0=B+C=v_0,\\
            0=Bm_1^{n+1}+Cm_2^{n+1}=v_{n+1}.
        \end{cases}\]
        から，$m_2\ne0$を仮定しても一般性を失わないことに注意して，
        \[\paren{\frac{m_1}{m_2}}^{n+1}=-\frac{C}{B}=1.\]
        が必要．特性方程式の解と係数の関係から$m_1m_2=\frac{C}{B}$と併せると，
        \[\begin{cases}
            m_1=(c/b)^{1/2}e^{\frac{is\pi}{n+1}},\\
            m_2=(c/b)^{1/2}e^{-\frac{is\pi}{n+1}}.
        \end{cases}\qquad s=1,2,\cdots,n.\]
        を得る．
        \item 再び解と係数の関係$m_1+m_2=\frac{\lambda-a}{b}$から，固有値は
        \[\lambda=a+b\sqrt{\frac{c}{b}}\paren{e^{\frac{is\pi}{n+1}}+e^{-\frac{is\pi}{n+1}}}=a+b\sqrt{\frac{c}{b}}\cos\frac{s\pi}{n+1},\qquad s=1,\cdots,n.\]
        が必要であることが従う．
    \end{enumerate}
\end{Proof}

\chapter{作用素の空間}

\begin{quotation}
    行列のなす$*$-代数の構造を引き続き調べる．
    これは$B(H)$を，$H$が有限次元の場合について調べていることになる
    $B(V)$は連続性関係なく，単に自己準同型の空間に成り果てる：$B(V)=\End_K(V)$．
    FVSの自己準同型には次の，Jordan分解＝冪等・冪零分解による分類理論がある：
    \begin{enumerate}
        \item 代入による作用$K[X]\times M_n(K)\to M_n(K)$によって，$K[X]$-加群をなす．
        \item $A\in M_n(K)$を止めて得る環準同型$K[X]\to M_n(K)$の核を単項生成する元を最小多項式というが，これが$K$上で因数分解出来るとき，これに沿った$V$の一般化固有空間分解$\wt{V}_a$を得る．これらは$f_A$-安定なので(隣の一般化固有空間に漏れ出さない)，各一般化固有空間分解$\wt{V}_a$で上三角化できれば，全体としても$A$を上三角化出来る．
        \item 各一般化固有空間分解$\wt{V}_a$が1次元でないとき($\varphi$が重根を持つとき)，その自己準同型は冪零成分を持つことになるが，
        各$\wt{V}_a$上ではうまく基底を取れば上三角行列で表現できる(例えば同伴行列が道しるべになる)．
        \item しかしさらに詳しく観ると，うまく基底をとれば冪零成分は帯行列で表現出来る．よって，各一般化固有空間$\wt{V}_\al$でJordan行列で表現することで，全体として$A$をJordan標準形に相似変換することが出来る．
    \end{enumerate}
    こうして，代数的には$M_n(K[x])\simeq M_n(K)[x]$なる環上の加群が注目されるが，$x$-行列は，行列値解析関数とも見れる．
    すると，固有値とは解素の極である．
    こうして解素を通じて，複素解析は一般のBanach空間$B(H)$-値正則関数にも適用範囲を広げる．
    \begin{enumerate}
        \item $M_n(K)$は内積$(A|B):=\Tr(AB)$によって，Banach代数をなし，$*$-作用素$\Tr:M_n(K)\to M_n(K)$によって，$C^*$-代数をなす．
    \end{enumerate}
\end{quotation}

\section{対角化まとめ}

一般化固有空間$\wt{V}_a$を塔の集まりと見て，高さと棟の数の2点から考察する．
一階部分$V_a$を固有空間という．
\begin{enumerate}
    \item 最小多項式の重複度$d$は一般化固有空間の高さを表す：$\wt{V}_a=\otimes_{i=1}^dV_a$．
    \item 一般化固有空間の1つの塔では，ある$x\in V$を取って$x,f(x),f^2(x),\cdots$が基底になるように取れ，これについての行列表示は同伴行列$C$になる．特に，１つの棟の上では最小多項式と固有多項式とは一致する．
    \item 一般化固有空間が横に広いとき，１階部分$V_a$が横に広いことによる．$\dim V_a$を幾何的重複度という．
    \item 固有多項式の重複度は$\dim\wt{V}_a=m$に等しい\ref{prop-algebraic-multiplicity-is-dimension-of-generalized-eigenspace}．これを代数的重複度といい，幾何的重複度の$d$倍になる．
    \item 行列の対角化可能性は，冪零成分が零であることに同値．すなわち，全ての塔が1階建てであること$d=1$に同値．これは固有値の幾何的重複度と代数的重複度とが一致することに同値．
\end{enumerate}

\section{最小多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    体$K$について，環$K[X]$はEudlic整域，特に単項イデアル整域である．
    代入による作用$K[X]\times\End_K(V)\to\End_K(V)$の
    第一引数$\ev_f:K[X]\to\End_K(V)\;(f\in\End_K(V))$に注目すると，これは環準同型で
    ，核が単項イデアルになるが，これを生成する元を$f$の\textbf{最小多項式}という．
    環の同型$K[X]/(\varphi)\iso K[f]\subset \End_K(V)$が得られ，$f$の届き得る範囲が調べられる．
    $K[f]$の次元は$\varphi$の次数に等しい．
    最小多項式の根を固有値という．固有多項式とは冪のみが違い得て，$f$-安定部分空間の上では一致する．．
\end{tcolorbox}

\subsection{定義と存在}

\begin{proposition}[作用のwell-definedness]\label{prop-functoriality-of-substitution}
    代入$K[X]\times\End_K(V)\to\End_K(V)$はたしかに作用を定める．すなわち，
    $K[X]\to\End_K(\End_K(V))$は環の準同型である．すなわち，
    多項式$F,G\in K[X]$に対して，
    \begin{align*}
        (F+G)(f)&=F(f)+G(f),&(FG)(f)&=F(f)\circ G(f)
    \end{align*}
    が成り立つ．
\end{proposition}

\begin{proposition}[有限次元線型空間の自己射は必ず最小多項式を持つ]\label{prop-existence-of-minimal-polynomial}
    $V\in\FinVect_K,f\in\End_K(V)$とする．
    \[I_f:=\Brace{F\in K[X]\mid F(f)=0}\]
    は，$0$を省けば，$K$倍の違いを除いて$\deg$に関する最小元を持つ．
    そのうちモニックなものを\textbf{最小多項式}という．
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[$I_f$はイデアルである] $0\in I_f$である．$\forall_{F,G\in I_f}\;(F+G)(f)=F(f)+G(f)=0$．$\forall_{F\in I_f,G\in K[X]}\;(FG)(f)=F(f)\circ G(f)=0$．
        \item[生成元が最小元である] $K[X]$はEuclid整域，特に単項イデアル整域であるから，ある$F\in I_f$によって単項生成される．
        任意の$f\in K[X]$に対して，$g\in(f)\Leftrightarrow f|g$であるから，Euclid関数の性質より$I_f$の生成元が，求める最小元である．
    \end{description}
\end{Proof}

\begin{definition}[minimal polynomial]
    線型自己準同型$f:V\to V$に対して，$F(f)=0$を満たす$0$でない多項式$F\in K[X]$が存在する時，$f$は\textbf{最小多項式を持つ}という．
    このような$F$のうちmonicなもので次数が最小の多項式を\textbf{最小多項式}という．
\end{definition}

\subsection{最小多項式の例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    同伴行列の概念は，引き戻し可能な単射$K[X]/(X^{n+1})\mono M_n(K)$を与える．
    これが２つの対象を媒介する理論的な役割を果たす．
    要は，任意の線型空間も，このような同伴行列を考えれば良くなるような$f$-安定部分空間にまで分解すれば良い．（命題\ref{prop-stable-subspace}）．
    これが一般固有空間分解であり，その上のJordan分解である．
\end{tcolorbox}

\begin{example}[最小多項式]\mbox{}
    \begin{enumerate}
        \item 線型空間$0$の恒等写像$\id_0$の最小多項式は$1$．
        \item $0$でない線型空間$V$の自己準同型$f$の最小多項式が一次式$X-a$で表せることと，$f$がスカラー$a$倍写像であることは同値．
        \item 行列$\begin{pmatrix}a&b\\c&d\end{pmatrix}$倍写像の最小多項式は，$A$がスカラー行列でなければ，$X^2-(a+d)X+ad-bc$である．
        \item むしろこの最小多項式の次元が2で収まっているのが不思議であるが，最小多項式は固有多項式を割り切るから，次数は$V$の次元よりも小さくなる．上の証明では$d$を具体化しておらず，閉集合上の連続写像$\min$で抽象的に存在を示したので，$n^2$次以下とまでしか言えていない．構成論の負けで，固有多項式の理論を待つのが良い．
    \end{enumerate}
\end{example}

\begin{definition}[Frobeniusのcompanion matrix]
    monicな多項式$F(X) = X^n+a_1X^{n-1}+\cdots +a_{n-1}X+a_n \in K[X]$に対して，
        \[C(F)=\begin{bmatrix}
        0 & 0 & \dots & 0 & -a_n \\
        1 & 0 & \dots & 0 & -a_{n-1} \\
        0 & 1 & \dots & 0 & -a_{n-2} \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & \dots & 1 & -a_1
        \end{bmatrix}\]
    と定義される正方行列$C(F)\in M_n(K)$のことを\textbf{多項式$F$の同伴行列}と呼ぶ．
    これは，$K$-線型空間$K[X]$上の自己射$X\times$が商空間$K[X]/(F)$\footnote{$F$で割り切れる多項式全体の集合$(F)=\{GF\in K[X]\mid G\in K[X]\}$．条件$G\in (F)$とは，$F$で割り切れることを意味する．}上に引き起こす自己準同型$F_X$の，基底
    $\overline{1},\overline{X},\cdots,\overline{X^{n-1}}$についての行列表示が$C(F)$となっている．
    即ち，最右の列ベクトルは，最後の基底$\overline{X^{n-1}}$の$X$による像
    \[ X^n=-a_1X^{n-1}-\cdots-a_{n-1}X-a_n \]
    を表している．
\end{definition}

\begin{proposition}[companionship：同伴行列と最小多項式]
    多項式$F(X) = X^n+a_1X^{n-1}+\cdots +a_{n-1}X+a_n \in K[X]$の同伴行列$A:=C(F)\in M_n(K)$の最小多項式は$F$自身である．
\end{proposition}
\begin{Proof}
    \begin{description}
        \item[零写像であること$F(A)=0$を示す] 
        同伴行列$A$を元の多項式$F$に代入して得る行列$F(A)$が
        \begin{align}
            F(A)e_i&=0,&(i=1,2,\cdots,n)
        \end{align}
        を満たすことを示す．いきなり多項式$F(A)$を考える前に個々の挙動を見ると，まず
        \begin{align*}
            A^ie_1&=e_{i+1},&(i=0,1,\cdots,n-1)
        \end{align*}
        が帰納的に示せる．これを用いて，$i=n$の時は
        \begin{align*}
            A^ne_1&=A(A^{n-1}e_1)\\
            &=Ae_n\\
            &=\begin{pmatrix}-a_n\\-a_{n-1}\\\vdots\\-a_1\end{pmatrix}\\
            &=-e_1(a_1A^{n-1}+a_2A^{n-2}+\cdots+a_{n-1}A+a_n)
        \end{align*}
        より，
        \begin{align*}
            F(A)e_1&=A^ne_1+(a_1A^{n-1}+\cdots+a_{n-1}A+a_n)e_1\\
            &=-e_1(a_1A^{n-1}+a_2A^{n-2}+\cdots+a_{n-1}A+a_n)\\
            &\hphantom{=}\;+e_1(a_1A^{n-1}+a_2A^{n-2}+\cdots+a_{n-1}A+a_n)\\
            &=0
        \end{align*}
        を得る．他の$e_i$についても，
        \[F(A)e_i=F(A)A^{i-1}e_1=A^{i-1}F(A)e_1=0\]
        が従う\footnote{$F(A)$は$A$とスカラー倍$a_i$のみからなる多項式なので．}．よって，$F(A)=0$．
        \item[$F$がこれを満たす最小次の多項式であることを示す] 
        $n-1$次以下の多項式$G=b_1X^{n-1}+\cdots+b_n$が$G(A)=0$を満たしたとする．すると，特に$G(A)e_1=0$だから，
        \begin{align*}
            b_1A^{n-1}e_1+b_2A^{n-2}e_1+\cdots+b_ne_1&=0\\
            b_1e_n+b_2e_{n-1}+\cdots+b_ne_1&=0
        \end{align*}
        であるから，$b_1=\cdots=b_n=0$が従う．よって$G=0$．よって，$F$が$A=C(F)$の最小多項式である．
    \end{description}
\end{Proof}

\begin{theorem}[同伴行列の特徴付け]
    行列$A\in M_n(K)$について，次の条件は同値：
    \begin{enumerate}
        \item $A$の固有多項式の同伴行列$C(\Phi_A)$に相似．
        \item $A$の固有多項式と最小多項式は等しい．
        \item $A$の最小多項式の次数は$n$である．
        \item $\exists_{x\in K^n}\;\brac{x,Ax,\cdots,A^{n-1}x}=K^n$．
        \item $K^n$は$K[A]$-加群として巡回的かつ$K^n=K[A]/(\Phi_A(A))$である．
    \end{enumerate}
\end{theorem}
\begin{remarks}\label{remarks-companion-matrix-and-vandermonde-matrix}
    すなわち，$n\ge2$のとき，同伴行列は「冪零成分があるならば各段階で1ずつ次元が減っていくような行列」の標準形として取れる．
    特に，$n$階線型微分方程式を1階の方程式系に変換した際の係数行列として出現する．
    そして，冪零成分がないとき，すなわち最小多項式$\varphi$が相異なる根$(\al_i)_{i\in[n]}$についての一次式として表せるとき，$V$を$(\al_i)$が定めるVandermonde行列として$VC(\varphi)V^{-1}=\diag(\al_1,\cdots,\al_n)$と対角化出来る．
\end{remarks}

\begin{definition}[Jordan matrix]
        行列
        \[J(a,n)=\begin{bmatrix}
        a & 1 & 0 & \dots & 0 \\
        0 & a & 1 & \dots & 0 \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & \dots & a & 1 \\
        0 & 0 & \dots & 0 & a
        \end{bmatrix}\in M_n(K)\]
    を\textbf{Jordan行列}という．
\end{definition}

\begin{corollary}[Jordan行列は，冪零成分が最短の零元になる]
    Jordan行列$J(a,n)$の最小多項式は$(X-a)^n$である．
\end{corollary}
\begin{Proof}
    対角成分を$a=0$としたJordan行列$J(0,n)$の転置$J^t(0,n)$は多項式$X^n$の同伴行列になっている．
    転置行列と元の行列の最小多項式は一般に一致するから（双対命題），$J(0,n)$の最小多項式も$X^n$である．これに$X=X-a$と代入し直すことで，$J(a,n)=a+J(0,n)$の最小多項式は$(X-a)^n$．
\end{Proof}

\subsection{$f$-軌道が生成する安定部分空間上の最小多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    自己準同型$f\in\End_K(V)$の性質に合わせた$V$の直和分解を与えるに当たって，基本的な語彙は$f$-安定部分空間である．
    ある点$x\in V$が生成するように安定部分空間を取れば，その表現行列は同伴行列になるから，有理標準形への道標となる．
    あとは全空間がこのような安定部分空間の直和に分解出来るかの問題になる．
\end{tcolorbox}

\begin{proposition}[安定部分空間上の最小多項式]\label{prop-stable-subspace}
    $V\in\FVS_K,f\in\End(V)$とする．$x\in V$．
    $0\le m\le\dim V$を，$x,f(x),\cdots,f^m(x)$が一次独立ではなくなるような最小の自然数とし，$W=\langle x,f(x),\cdots,f^{m-1}(x)\rangle$と置く．
    \begin{enumerate}
        \item $x,f(x),\cdots,f^{m-1}(x)$は$W$の基底であり，$f(W)\subset W$である．
        \item $f^m(x)$の成分表示を$f^m(x)=a_1f^{m-1}(x)+\cdots+a_{m-1}f(x)+a_mx$と置くと，$f|_W$の行列表示は，多項式
        \[ \varphi_x=X^m-(a_1X^{m-1}+\cdots+a_{m-1}X+a_m) \]
        の同伴行列である．
        \item $f|_W$の最小多項式は$\varphi_x$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $x,f(x),\cdots,f^{m-1}(x)$は$W$の一次独立な生成系だから基底である．また，$W$の生成系$x,f(x),\cdots,f^{m-1}(x)$が一次独立であることの特徴付け（命題\ref{prop-linear-system-expansion}）より$f^m(x)\in W$であるから，$f(W)=\langle f(x),\cdots,f^m(x)\rangle\subset W$\footnote{等号は任意の$W$の元を取れば，一次独立かは置いておいて，$f(x),\cdots,f^m(x)$が像の生成系に他ならないとわかる．}．不安なら還元論を展開すれば出来るが，どの変形にも証明がつけられるならそれで良い．
        \item[2.] $W$の各基底$x,f(x),\cdots,f^{m-1}(x)$の行き先の，この基底による表示を列ベクトルで並べると，
        \[A=\begin{bmatrix}
            0 & 0 & \dots & 0 & -a_n \\
            1 & 0 & \dots & 0 & -a_{n-1} \\
            0 & 1 & \dots & 0 & -a_{n-2} \\
            \vdots & \vdots & \ddots & \vdots & \vdots \\
            0 & 0 & \dots & 1 & -a_1
            \end{bmatrix}\]
        となり，これは$\varphi_x=X^m-(a_1X^{m-1}+\cdots+a_{m-1}X+a_m)$の同伴行列である．
        \item[3.] 命題より．
    \end{description}
\end{Proof}
\begin{remarks}
    同伴行列は，1次元ずつ潰れていく線型変換の表現行列であるから，ある点$x\in V$を固定してこの$f$軌道が生成する安定部分空間へ分解していくと，有理標準形が得られそうである．
\end{remarks}

\subsection{空間の直和分解と最小多項式の積}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    $f$-安定な部分空間たちに分解できれば，最小多項式はそれらの\textbf{最小公倍式}になる．
    なお，各$f$-安定部分空間を「極小」にとって，直和$V=V_1\oplus\cdots\oplus V_r$になるとき，これは一般化固有空間分解になっている．
    最終的に全て固有空間にまで落ちるとき，対角化可能であり，最小多項式はそれらの積である．
\end{tcolorbox}

\begin{proposition}[最小公倍式としての最小多項式]\label{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}
    $f\in\End_K(V)$について，
    \begin{enumerate}
        \item $W$を$V$の$f$-安定部分空間とする：$f(W)\subset W$．$f$の最小多項式$\varphi$が存在するならば，$f|_W$の最小多項式$\varphi|_W$も存在し，$\varphi$を割り切る．
        \item $W_1,\cdots,W_r$を$V$の$f$-安定部分空間で，$V=W_1+\cdots+W_r, f(W_i)\subset W_i\;(i\in[r])$を満たすとする．各$f|_{W_i}$に最小多項式$\varphi_i$が存在する時，$f$の最小多項式も存在し，$\varphi=\lcm(\varphi_1,\cdots,\varphi_r)$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $f|_W$の$\varphi$への代入は，$\varphi(f|_W)=\varphi(f)|_W=0$\footnote{この場合$\varphi(f\circ i)=\varphi(f)\circ i$が成り立つのだな．$i$が冪等だからである．}より，$f|_W$の最小多項式も存在し，$\varphi$を割り切る．
        \item[2.] $(W_i)_{i\in[r]}$は$V$を被覆しているから，$F(f)=0$と$F(f)|_{W_i}=F(f|_{W_i})=0\;\;(i\in[r])$とは同値．これは，$F$が$\varphi_1,\cdots,\varphi_r$で割り切れることに同値．系より，$\varphi=\lcm(\varphi_1,\cdots,\varphi_r)$と置くと$\bigcap_{i\in[r]}(\varphi_i)=(\varphi)$なので，これは$\varphi$で割り切れることに同値．従って，この生成元が$f$の最小多項式．
    \end{description}
\end{Proof}

\begin{problem}
    $A=\begin{pmatrix}1&0&0&0\\0&0&0&0\\0&1&0&0\\1&0&1&1\end{pmatrix}$の最小多項式を求めよ．
\end{problem}
\begin{Proof}[［解答］]
    $e_1,e_2$の生成する安定部分空間に注目して，
    $W_1:=\langle e_1,e_4\rangle,W_2:=\langle e_2,e_3,e_4$は，$K^4=W_1+W_2$を満たす．
    $W_1$上に$A$が定める自己準同型の表現行列は，部分行列$\begin{pmatrix}1&0\\1&1\end{pmatrix}$だから，最小多項式は$X^2-2X+1=(X-1)^2$．
    $W_2$上に$A$が定める自己準同型の表現行列は，部分行列$\begin{pmatrix}0&0&0\\1&0&0\\0&1&1\end{pmatrix}$だから，これは$X^3-X^2=X^2(X-1)$の同伴行列．
    以上，$A$の最小多項式は，最小公倍式$X^2(X-1)^2$．
\end{Proof}

\begin{itembox}[l]{最小多項式の求め方}
    \begin{enumerate}
        \item $f(W)\subset W$を満たす$f$-安定部分空間による被覆を見つける．
        \item それの最小多項式を調べ，その張り合わせが全体空間だから，最小公倍式を見つければ良い．
        \item 「最小公倍式」ってのは，どの部分空間も潰れるために必要である．これがぴったり環論の言葉で表現できる対応がすごいが，もっと厳密に対応を定式化したい気がする．
    \end{enumerate}
\end{itembox}

\subsection{自己準同型の多項式が定める空間の分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    以後の議論の最も一般的な形を観ることで，全貌を提示する．
    一般化固有空間分解は$\wt{V}_{a}=\cup_{n\in\N}\Ker(f-a)^n$という意味で安定な概念であるから，必ずしも最小多項式$\varphi$が定める
    自己準同型のみを考える必要はないので
    一般化固有空間の次元が固有多項式における重複度で，一般化固有空間の寿命($f$を何回適用すれば冪零成分が消えるか)が最小多項式における重複度である．
    これが一致するならば，その一般化固有空間上では行列表示は同伴行列である．
    一致しない場合は必ずしも帯行列の形にはならないが，上三角行列にはなる．
    そこで，「うまく取り直せる」ことが，Jordan標準形に関する幾何的な議論である．
\end{tcolorbox}


\begin{theorem}[一般化された一般化固有空間分解]
    $A\in M_n(K)$に対して，多項式$f_1,\cdots,f_r\in K[t]$はどの2つも互いに素で$f:=f_1f_2\cdots f_r\in(\varphi_A)$，すなわち$f(A)=0$であるとする．
    このとき，$\wt{V}_i:=\Ker f_i(A)$とおけば，$V=\oplus_{i=1}^r\wt{V}_i$が成り立つ．
\end{theorem}

\begin{corollary}[安定部分空間は一般化固有空間分解に沿って分解出来る]
    $f\in\End_K(V)$の定める一般固有空間分解を$V=\oplus_{i=1}^r\wt{V}_i$とする．任意の$f$-
    安定部分空間$W\in S(V)$は，これに沿って$W=\oplus_{i=1}^r\wt{V}_i\cap W$と表せる．
\end{corollary}
\begin{Proof}
    $f$が対角化可能な場合はすぐに示せる．が，同じ方法だと直接この主張を示すのは行き詰まる：
    $f$の最小多項式を$\prod^r_{i=1}(x-a_i)^{m_i}$とする．任意の$x\in W$について，
    $x=\sum_{i\in[r]}v_i\;(v_i\in\wt{V}_i)$と一意的に表せる．
    ここで，両辺に$f$の多項式$(f-a_1)^{m_1}\cdots(f-a_{j-1})^{m_{j-1}}(f-a_{j+1})^{m_{j+1}}\cdots(f-a_r)^{m_r}$を作用させると，
    左辺は$W$の$f$-安定性より$W$の元で，右辺は$wt{V}_j$の元である．
    これは，各$\wt{V}_i\;(i\ne j)$上ではこの作用は零で，$\wt{V}_j$は$f$-安定であることによる．
    これ以上何も言えないが(1)の場合だったら，右辺は$v_j$のスカラー倍になる．
    (2)の場合でも，$v_j$のスカラー倍を得るような$v_j$が取れないか？
\end{Proof}

\section{自己準同型が定める固有空間分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    自己準同型$f\in\End_K(V)$がスカラー倍写像に退化するような1次元部分空間への分解$V=\oplus_{a\in\Sp(f)}V_a$が与えられるとき，$f$は対角化可能であるという．
    作用素の言葉を使えば，1次元射影の線形結合に分解される場合をいう．
    また，線型写像がスカラー倍写像であることは，その最小多項式が1次であることに同値．
\end{tcolorbox}

\subsection{固有値の特徴付け}

\begin{definition}[eigenspace, eigenvalue, eigenvector]\mbox{}
    \begin{enumerate}
        \item $V\in\Vect_K,f\in\End_K(V)$について，部分空間$V_a(f):=\Ker(f-a)$を\textbf{$a$に属する固有空間}という．
        \item $a\ne a'\Leftrightarrow V_{a}\cap V_{a'}=0$であるから，$\cup_{a\in K}V_a(f)=\sqcup_{a\in K}V_a(f)\epi V$はベクトル束をなす．
        \item $V_a\ne 0$である時（$f-a$が単射でない時），\textbf{$a$は$f$の固有値である}という．
        \item 固有空間$V_a$の$0$でない元を，\textbf{固有値$a$の固有ベクトル}という．
    \end{enumerate}
\end{definition}

\begin{proposition}[最小多項式の根が固有値である]\label{prop-minimal-polynomial's-root-is-eigenvalue}
    線型空間の自己射$f\in\End_K(V)$の最小多項式を$\varphi$とする．$a\in K$に対して，次の条件は同値である．
    \begin{enumerate}
        \item $a$は$f$の固有値である．
        \item $\varphi(a)=0$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1$\Rightarrow$2] $a$を$f$の固有値とすると，$f|_{V_a}=a$．従って，$f$が部分空間$V_a$上に定める準同型$f|_{V_a}$の最小多項式は$X-a$．よって，$\varphi$は$X-a$によって割り切れるから，$\varphi(a)=0$．
        \item[2$\Rightarrow$1] $\varphi(a)=0$の時，$\varphi$は$X-a$で割り切れるから，$G\in K[X]$が存在して，$\varphi=(X-a)G(X)$と表せる．$\varphi$が最小多項式であるから，$G(f)\ne 0$．すると，$f$の代入は$\varphi(f)=(f-a)\circ G(f)=0$と分解できて，この（おそらく完全）系列について
        \[ 0\subsetneq\Im G(f)\subset\Ker(f-a). \]
        よって，$V_a\ne 0$で，$a$は$f$の固有値である．
    \end{description}
\end{Proof}

\begin{proposition}[上三角行列の固有値]\label{prop-eigenvalue-of-triangular-matrices}
    $A\in M_n(K)$を上三角行列とし，$a_1,\cdots,a_n\in K$を対角成分とする．
    \begin{enumerate}
        \item 最小多項式は$F(X):=(X-a_1)\cdots(X-a_n)$を割り切る（実はこれが上三角行列の固有多項式）．
        \item $a_1,\cdots,a_n$は$A$の固有値である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $V_i:=\langle e_1,\cdots,e_i\rangle\subset K^n\;(1\le i\le n)$と置くと，上からの帰納法により，
        \begin{align*}
            (A-a_n)K^n&\subset V_{n-1}\\
            \vdots\hphantom{\;\;\;\;\;K^n}&\hphantom{\subset}\;\;\;\;\vdots\\
            (A-a_i)\cdots(A-a_n)K^n&\subset V_{i-1}\\
            \vdots\hphantom{\;\;\;\;\;K^n}&\hphantom{\subset}\;\;\;\;\vdots\\
            F(A)K^n&\subset V_0:=0
        \end{align*}
        が成り立つ．完全に環上の加群の書き方である．すでに$K^n$の第$i+1,\cdots,n$射影が$0$になった空間$V_i$において，左から掛ける行列の第$i$行の第$i$列までは$0$で第$i$列も$0$にすれば，それ以降の第$i+1$から$n$列に依らず，像は$V_{i-1}$に縮小する．
        よって，$F$は$\varphi$が割り切る．
        \item[2.] 上三角行列の計算法則として，$\varphi(A)=0$の対角成分はそれぞれ別に計算した$\varphi(a_1),\cdots,\varphi(a_n)$に等しい．よって，$a_1,\cdots,a_n$は全て$\varphi$の零点だから，命題より，固有値である．
    \end{description}
\end{Proof}

\subsection{対角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    最小多項式が異なる1次式の積であるとき，$V$を固有空間へと直和分解出来る．
    実は，対角化可能な場合はこの場合に限る．
\end{tcolorbox}

\begin{proposition}[重根を持たない多項式が定める自己準同型の核]\label{prop-diagonalization}
    $a_1,\cdots,a_r\in K$を異なる元とし，多項式を$F=(X-a_1)\cdots(X-a_r)\in K[X]$と置く．
    これへの代入が定める作用$F:\End_K(V)\to\End_K(V)$の像は対角行列で，核は$a_1,\cdots,a_r$に属する$f$-固有空間の直和になる：
    \[\forall_{f\in\End_K(V)}\;\Ker F(f)=V_{a_1}(f)\oplus\cdots\oplus V_{a_r}(f)=\bigoplus_{i=1}^r\Ker(f-a_i). \]
\end{proposition}
\begin{Proof}
    $r\in\N$については帰納法で示す．$r=1$の時，$V_{a_1}$の定義に他ならない．$r>1$とする．
    $G=(X-a_1)\cdots(X-a_{r-1})$と置くと，$F=G(X-a_r)$で，この多項式への$f$の代入を考えることで，分解$F(f)=G(f)\circ (f-a_r)$を得る．
    すると，$\Ker F(f)=\Ker G(f)\oplus\Ker(f-a_r)$と表せることを示せば良い．
    この準同型$f-a_r$に注目すれば，これを導ける．

    \begin{description}
        \item[$\Ker F(f)$への制限] $(f-a_r)|_{\Ker F(f)}$の核を調べると，
        \[\Ker((f-a_r)|_{\Ker F(f)})=\Ker(f-a_r)\cap\Ker F(f)=\Ker(f-a_r)\]
        とわかる．
        \item[$\Ker G(f)$への制限] 帰納法の仮定より，$\Ker G(f)=V_{a_1}\oplus\cdots\oplus V_{a_{r-1}}$である．$f$はそれぞれの上ではスカラー倍写像$f=a_i$であるから，$(f-a_r)|_{\Ker G(f)}$は直和$(a_1-a_r)\oplus\cdots(a_n-a_r)$に他ならない．よって，これは同型である．
        \item[$f-a_r$は全射] 注\ref{remark-1}での議論より，$(f-a_r)(\Ker F(f))\subset\Ker G(f)$が成り立つ．即ち，$(f-a_r)|_{\Ker F(f)}:\Ker F(f)\to\Ker G(f)$は全射である．
        \item[終わり] 以上の結果と線型写像の標準分解の命題\ref{prop-pre-homomorphism-thm}より，$\Ker F(f)=\Ker G(f)\oplus\Ker(f-a_r)$を得る．
    \end{description}
\end{Proof}
\begin{remarks}
    各$V_{a_i}$は$0$たり得る．$F$が$f$の最小多項式であるとき，$\Ker F(f)=\Ker 0=V$であるから，底空間$V$を固有空間に分解出来たことになる．
\end{remarks}

\begin{corollary}[対角化可能条件]\label{cor-diagonalizability}
    $V\in\FVS_K,f\in\End_K(V)$の固有値を$a_1,\cdots,a_r\in K$とすると，次の条件は同値である．
    \begin{enumerate}
        \item $f$は対角化可能．
        \item $V$の固有ベクトルのみからなる基底$x_1,\cdots,x_n$が存在する．
        \item $f$の最小多項式$\varphi$は相異なる一次式の積$(X-a_1)\cdots(X-a_r)$の形である．
        \item $V=V_{a_1}+\cdots+V_{a_r}$．
        \item $V=V_{a_1}\oplus\cdots\oplus V_{a_r}$．
    \end{enumerate}
\end{corollary}
\begin{Proof}
    1と2は言い換えである．
    \begin{description}
        \item[2$\Rightarrow$4] $V=\langle x_1,\cdots,x_n\rangle=V_{a_1}+\cdots+V_{a_n}$．
        \item[4$\Rightarrow$3] まず$a_1,\cdots,a_r$が固有値なのだから，$F=(X-a_1)\cdots(X-a_r)$は最小多項式$\varphi$を割り切る（命題\ref{prop-minimal-polynomial's-root-is-eigenvalue}）．$V=V_{a_1}+\cdots+V_{a_r}$の時，$V$の任意の元は固有ベクトルの和で表せるから，$F(f)=(f-a_1)\circ\cdots\circ(f-a_r)=0$になる．よって，最小多項式$\varphi$は$F$を割り切る．$\therefore\;F=\varphi$．
        \item[3$\Rightarrow$5] 命題より，$V=\Ker\varphi(f)=V_{a_1}\oplus\cdots\oplus V_{a_r}$．
        \item[5$\Rightarrow$2] 言い換えになっている．
    \end{description}
\end{Proof}
\begin{remark}
    改めて環の作用$(X-a_1)\cdots(X-a_r)$がどういう意味かわかり，関手性に関する命題\ref{prop-functoriality-of-substitution}
    がやっと理解された．多項式$(X-a_1)\cdots(X-a_r)$の作用は各固有ベクトルの方向に向かって射影を取るようなもので，「一回射影をとれば潰せる」という条件が成り立つものが対角化可能なのである．
    それで命題もわかった．$F(f)=(f-a_1)\cdots(f-a_r)$によって潰れる空間は正確に$\Ker F(f)=V_{a_1}\oplus\cdots\oplus V_{a_r}$なのである．相異なる固有値に属する固有空間は交わらない$V_{a_i}\cap V_{a_j}=0\;(i\ne j)$という主張が紛れ込んでいる．

    また，3$\Rightarrow$1は意義深いな．冪が$2$以上になるとそれは冪零成分を意味する．
    冪が$1$でも，ブロックの大きさは全くわからない．
\end{remark}

\begin{corollary}[安定部分空間への遺伝]
    $f\in\End(V)$とし，$W$を$f(W)\subset W$を満たす$V$の$f$-安定部分空間とする．
    $f$が対角化可能ならば$f|_W$も対角化可能である．
\end{corollary}
\begin{Proof}
    $f$は対角化可能だから，系\ref{cor-diagonalizability}より，$f$の最小多項式は一次式の積である．
    命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$f|_W$の最小多項式はこれを割り切るから，こちらも一次式の積である．
    よって，$f|_W$も対角化可能．
\end{Proof}

\subsection{可換系の対角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    対角化可能な可換系は最小多項式を共有する．
    対角化可能ならば最小多項式は異なる一次式の積で，各固有空間上では$f=gfg^{-1}$であるため．
    したがって同じ固有空間分解を定め，固有ベクトルからなる基底を取ることで一斉対角化可能である．
\end{tcolorbox}

\begin{lemma}[可換性の必要条件]\label{lemma-commutative}
    $f,g\in\End(V)$とする．$f\circ g=g\circ f$ならば，
    $\Ker g,\Im g$は$f$-安定である：
    $f(\Ker g)\subset\Ker g$かつ$f(\Im g)\subset\Im g$．
\end{lemma}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $x\in f(\Ker g)$を取ると，$\exists y\in\Ker g,\;f(y)=x$であるから，$g(x)=g(f(y))=f(g(y))=f(0)=0$より，$x\in\Ker g$．
        \item $x\in f(\Im g)$を取ると，$\exists y\in\Im g,\;f(y)=x$．よって$\exists z\in V,\;g(z)=y$．$x=f(g(z))=g(f(z))$より，$x\in\Im g$．
    \end{enumerate}
\end{Proof}

\begin{corollary}[可換系の対角化]\label{cor-commutative-linear-mappings-triangulization}
    \[S=\{f,g\in\End(V)\mid f,gは対角化可能で，互いに可換：fg=gf\}\]
    とすると，$V$の基底であって，それに関する$S$の任意の元の行列表示が対角行列となるものが存在する．
\end{corollary}
\begin{Proof}
    $V$の次元に関する帰納法で示す．$S$の元が全てスカラー倍の時は明らかに成り立ち，$\dim V\le 1$の場合はこれに含まれる．
    $f\in S$をスカラー倍でない準同型とする．$f$に関する固有空間分解を$V=V_{a_1}\oplus\cdots\oplus V_{a_r}$とすると，補題\ref{lemma-commutative}より，任意の$g\in S$について$g(V_{a_i})\subset V_{a_i}$．
    したがって系より，$g|_{V_{a_i}}$は対角化可能である．よって帰納法の仮定より，各$V_{a_i}$の基底であって，それに関する$S$の任意の自己準同型の行列表示が対角行列になるものが存在する．これを並べれて得られる$V$の基底を考えれば良い．
\end{Proof}


\subsection{自己準同型の可換性の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=可換性は本質的にスカラー倍に由来するものしか存在しない]
    まず，一般固有空間分解が，全て固有空間に退化している場合は，各$f|_{V_a}=a$はスカラー倍写像$a$なので，
    全固有空間$V_a$が$g$-安定な場合に可換になり，それに限ることが分かる．

    実はこれが対角化の理論だったのか！
    Hermite内積を備えた空間で考察する
    命題\ref{prop-Hermite-diagonalizability}にて，全てが解決する！
\end{tcolorbox}

\begin{proposition}[自己準同型の可換性の行列への翻訳]
    $V\in\FVS_K,f,g\in\End_K(V)$とし，$x_1,\cdots,x_n\in V$を$V$の基底とする．次の２条件は同値である．
    \begin{enumerate}
        \item $f\circ g=g\circ f$．
        \item $f$の$x_1,\cdots,x_n$に関する行列表示と，$f$の$g(x_1),\cdots,g(x_n)$に関する行列表示とは等しい．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    基底$x$に関する$f,g$の行列表示を$A,B$とすると，$A=B^{-1}AB$と同値で，$B:K^n\to K^n$とは基底$x_1,\cdots,x_n$から$g(x_1),\cdots,g(x_n)$への変換行列と思える．
\end{Proof}

\begin{corollary}
    $A,B\in\End_K(V)$を可換とする．
    \begin{enumerate}
        \item $A,B$が共に対角化可能ならば，$A\pm B,AB$も対角化可能である．
        \item $A,B$が冪零ならば，$A\pm B,AB$も冪零である．
    \end{enumerate}
\end{corollary}

\begin{proposition}
    $V\in\FVS_K,f\in\End_K(V)$とし，$g\in\End_K(V)$に対する次の２条件を考える：
    \begin{enumerate}[(1)]
        \item $f\circ g=g\circ f$．
        \item $f$の一般固有空間は全て$g$-安定である．
    \end{enumerate}
    (2)$\Rightarrow$(1)であり，$f$が対角化可能である時(2)$\Rightarrow$(1)である．
    また，次が成り立つ．
    \begin{enumerate}[(1)]\setcounter{enumi}{2}
        \item $K=\C$とすると，逆命題「(1)と(2)が同値なら$f$は対角化可能である」が成り立つ．
        即ち，任意の$g\in\End_K(V)$について(2)$\Rightarrow$(1)が成り立つならば，$f$は対角化可能である．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    \begin{description}
        \item[(2)$\Rightarrow$(1)] 
        $a\in\C$を$f$の固有値とし，$m$をその重複度とする．$(f-a)^m(g(\widetilde{V}_a))=0$を示せば良い．
        自己準同型の合成は分配則を満たすから，
        \begin{align*}
            (f-a)^m(g(\widetilde{V}_a))&=(f-a)^m\circ g(\widetilde{V}_a)\\
            &=(f^m-af^{m-1}+a^2f^{m-2}-\cdots+(-1)^ma^m)\circ g(\widetilde{V}_a)\\
            &=(f^m\circ g-af^{m-1}\circ g+a^2f^{m-2}\circ g-\cdots+(-1)^ma^mg)(\widetilde{V}_a)\\
            &=(g\circ f^m-ag\circ f^{m-1}+a^2 g\circ f^{m-2}-\cdots+(-1)^ma^mg)(\widetilde{V}_a)&(\because\;\mathrm{(a)})\\
            &=g\circ(f^m-af^{m-1}+a^2f^{m-2}-\cdots+(-1)^ma^m)(\widetilde{V}_a)\\
            &=g\circ(f-a)^m(\widetilde{V}_a)\\
            &=g((f-a)^m(\widetilde{V}_a))=g(0)=0.
        \end{align*}
        よって，$g(\widetilde{V}_a)\subset\widetilde{V}_a$．
        \item[(1)$\Rightarrow$(2)]
        $f$が対角化可能である時，$V$の固有ベクトルのみからなる基底が存在するから，
        任意の固有値$a\in\C$と対応する固有ベクトル$v\in\Ker(f-a)$について，$f\circ g(v)=g\circ f(v)$を示せば良い．
    
        $\Ker(f-a)$は$g$-安定部分空間だから，$g(\Ker(f-a))\subset\Ker(f-a)$より，$g(v)\in\Ker(f-a)$だから，
        $f(g(v))=a\cdot g(v)$．また，$g(f(v))=g(a\cdot v)=a\cdot g(v)$．
    
        \item[(3)]
        正しいことを証明する．
        $\C$-線型写像$f$は三角化可能であり，$f$の固有値$a_1,\cdots,a_n$について，$V=\widetilde{V}_{a_1}\oplus\cdots\oplus\widetilde{V}_{a_n}$
        と一般固有空間分解できる．
        いま，任意の$g\in\End_\C(V)$に対して$g(\widetilde{V}_{a_i})\subset\widetilde{V}_{a_i}\;(i=1,\cdots,n)$ならば，$f\circ g=g\circ f$が成り立つと仮定する．
        この時，任意の一般固有空間$\widetilde{V}_{a_i}$について，制限写像$f|_{\widetilde{V}_{a_i}}=:f_i,g|_{\widetilde{V}_{a_i}}=:g_i$は
        それぞれ$\widetilde{V}_{a_i}$の自己準同型$f_i:\widetilde{V}_{a_i}\to\widetilde{V}_{a_i},g_i:\widetilde{V}_{a_i}\to\widetilde{V}_{a_i}$を定める．
        $f\circ g=g\circ f$の時，$f_i\circ g_i=g_i\circ f_i$であるが，$g$が（従って$g_i$が）任意だったから，後述の補題より$f$はスカラー写像である：$\exists a\in\C,\;f=a$．
        この時，$a=a_i$となる．よって，$\widetilde{V}_{a_i}=V_{a_i}$である．これが任意の$1\le i\le n$について成り立つのであったから，$f$は対角化可能である．
    \end{description}
\end{Proof}

\begin{lemma}[スカラー倍写像の特徴付け]
    $V\in\FVS_K(V)$とし，$\forall g\in\End_K(V),\;f\circ g=g\circ f$とする．この時，$f$はスカラー倍写像である：$\exists a\in K,\; f=a$．
\end{lemma}
\begin{Proof}
    $V$の基底$x_1,\cdots,x_n$に関する$f$の行列表示を$A=(a_{ij})$とする．
    $f$がスカラー倍写像ではないと仮定して，矛盾を導く．即ち，ある$i\ne j$が存在して，$a_{ij}\ne 0$と仮定する．
    すると，行列$B=(b_{ij})$を，$i\ne j$の時$b_{ij}=0\in K$とし，$b_{ii}\ne b_{jj}\in K$とすれば，他の$b_{kk}\;(k\ne i,j)$の値に依らず，
    $BA$の$ij$成分は$\sum^n_{k=1}a_{kj}b_{ik}=a_{ij}b_{ii}$，$AB$の$ij$成分は$\sum^n_{k=1}a_{ik}b_{kj}=a_{ij}b_{jj}$より，$a_{ij}b_{ii}\ne a_{ij}b_{jj}$となるから，$AB\ne BA$である．
    従って，$V$の基底$x_1,\cdots,x_n$が定める同型を$\varphi_x:K^n\to V$とすれば，
    $g$をこの行列$B$が表現する線型写像$g=\varphi_x^{-1}\circ B\times\circ\varphi_x\in\End_K{V}$とすれば，$f\circ g\ne g\circ f$より，矛盾．
    よって，$f$はスカラー写像である．
\end{Proof}

\section{一般固有空間と三角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    $f$-安定な部分空間たちに分解できれば，最小多項式はそれらの積になり，
    行列表示はそれらの直和となる．$f$-安定部分空間上の行列表示は上三角に出来るから，標準形を探すという試みはこうして
    一般固有空間分解の理論に到達する．
    線型空間の標準的表示を，自己準同型$f\in\End_K(V)$の言葉によって得たことになる．
\end{tcolorbox}

\subsection{一般固有空間の性質}

\begin{definition}[generalized eigenspace]
    $V\in\Vect_K,f\in\End_K(V)$について，$d$を$f$の最小多項式$\varphi$の根$a$の重複度とする．
    \begin{enumerate}
        \item $V$の部分空間$\wt{V}_a:=\Ker(f-a)^d$を\textbf{$a$に属する一般固有空間}という．
        \item $\oplus_{a\in K}\wt{V}_a\epi V$はベクトル束をなす．制限$\oplus_{i=1}^r\wt{V}_{a_i}\epi V$が同型を与えるとき，この定義域を\textbf{一般固有空間分解}という．
    \end{enumerate}
\end{definition}

\begin{proposition}[一般固有空間への制限は三角化可能である]\label{prop-algorithm-for-making-triangular-matrices}
    $V\in\Vect_K,f\in\End_K(V),a\in K$について，$f$の最小多項式$\varphi$の根$a$の重複度を$d\in\N$とする．
    \begin{enumerate}
        \item (特徴付け) $\wt{V}_a=\Brace{x\in V\mid\exists_{n\in\N}\;(f-a)^n(x)=0}=\cup_{n\in\N}\Ker(f-a)^n$．
        \item ($f$-安定性) $f(\widetilde{V}_a)\subset\widetilde{V}_a,V_a\subset\widetilde{V}_a$．
        \item (三角化可能性) $\widetilde{V}_a$が有限次元であるとする．$f|_{\widetilde{V}_a}:\widetilde{V}_a\to\widetilde{V}_a$は三角化可能である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $W=\{x\in V\mid\exists n\in\N,\; (f-a)^n(x)=0\}$と置く．$\tilde{V}_a\subset W$であるから，あとは$\tilde{V}_a\supset W$を示せば良い．
        $x\in W$を任意に取ると，ある$n\in\N$が存在して$(f-a)^n(x)=0$即ち$x\in\Ker(f-a)^n$が成立する．この時，
        \begin{enumerate}[(1)]
            \item 注\ref{remark-1}より，$F(f)=(f-a)^n$と置くと$f(\Ker F(f))\subset\Ker F(f)$だから，$f(\Ker(f-a)^n)\subset\Ker(f-a)^n$．
            \item $V$の部分空間$\Ker(f-a)^n$に$f$が引き起こす射$(f-a)^n|_{\Ker(f-a)^n}$は$(f-a)^n(\Ker(f-a)^n)=0$を満たすから，$(f-a)^n|_{\Ker(f-a)^n}$の最小多項式は多項式$(X-a)^n$を割り切るので，$e|n$を満たす$e\in\N$を用いて$\psi=(X-a)^e$と書ける．
            \item 1.が成り立つので命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$\psi=(X-a)^e$は$f$の最小多項式$\varphi$も割り切るから，$e|d$でもある．
        \end{enumerate}
        以上の議論より，$x$が，$f$が保つような$V$の部分空間$\Ker(f-a)^n$に入っているならば，その部分空間上に定まる自己準同型$(f-a)^n|_{\Ker(f-a)^n}$の最小多項式$\psi$の空間にも入っており（微視的には$\Ker(f-a)^n=\Ker\psi(f)$であるが，$V$の部分空間としては後者の方が大きい可能性がある），次大域的な自己準同型$f$の零化空間$\tilde{V}_a$には局所的なものは収まるから，次の系列を得る：
        \[ x\in\Ker(f-a)^n\subset\Ker\psi(f)=\Ker(f-a)^e\subset\Ker(f-a)^d=\tilde{V}_a \]
        が導けたから，$\tilde{V}_a=W$．
        \item[2.] 注\ref{remark-1}より，$F(f)=(f-a)^d$と置くと$f(\Ker F(f))\subset\Ker F(f)$だから，$f(\Ker(f-a)^d)\subset\Ker(f-a)^d$．また系列を考えれば$d\ge 1$ならば$\Ker(f-a)\subset\Ker(f-a)^d$であるが，$d=0$の時は$(f-a)^d=1$と約束したから，$\tilde{V}_a=0$．一方この時，根$a$の重複度も$d$即ち$a$は固有値ではないと約束したから，$V_a=0$．
        \item[3.] 列$(V_k:=(f-a)^k(\tilde{V}_a))^d_{k=0}$は減少列
            \[\tilde{V}_a=V_0\supset V_1\supset\cdots\supset V_d=0\]
            であり，それぞれの次元の組を$(n_k:=\dim V_k)_{k=0}^d$とする．算譜\ref{thm-linear-system-extension-algorithm}により，$V_k\;(k=0,1,\cdots,d-1)$の基底を帰納的に上から延長することによって定めることができる．
            $V_k$に対して基底は$x_1,\cdots,x_{n_k}$と表せ，$\tilde{V}_a=V_0$の基底$x_1,\cdots,x_{n_0}$を得る．
            
            この基底についての自己準同型$(f-a)|_{\tilde{V}_a}$の行列表示は，
            各$k$について$(f-a)(V_k)=V_{k+1}$と基底が消えていくから，対角成分が全て$0$の上三角行列である．
            従って，$f|_{\tilde{V}_a}$の同じ基底による表示は，対角成分が$a$の上三角行列である．
    \end{description}
\end{Proof}

\subsection{一般の多項式が定める自己準同型の核の一般化固有空間分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    異なる一次式の積$F=(X-a_1)\cdots(X-a_r)$の$\End_K(K)$への作用の核を固有空間の直和で与えたが，さらに一般化して
    \[\Ker((X-a_1)^{d_1}\cdots(X-a_r)^{d_r}|_{X=f})=\Ker(f-a_1)^{d_1}\oplus\cdots\oplus\Ker(f-a_r)^{d_r}\subset V\]
    という関手性を示す（定理\ref{thm-triangulization}）．左辺の一次式の積が，何かの線型写像$f$の最小多項式$\varphi$であった場合，等号が成り立ち，
    この定理は空間$V$の一般固有空間分解を与える．
\end{tcolorbox}

\begin{theorem}[一般の多項式が定める自己準同型の核]\label{thm-triangulization}
    $V$を$K$-線型空間とする．$a_1,\cdots,a_r\in K$を相異なる元として，$F=(X-a_1)^{d_1}\cdots(X-a_r)^{d_r}\;(d_i>0)$と置く．
    この時，
    \[ \Ker F(f)=\Ker(f-a_1)^{d_1}\oplus\cdots\oplus\Ker(f-a_r)^{d_r}. \]
\end{theorem}
\begin{Proof}
    命題\ref{prop-diagonalization}と同様，$r$についての帰納法で示す．$r=1$の時は定義そのものである．
    $r>1$とした時，$G=(X-a_1)^{d_1}\cdots(X-a_{r-1})^{d_{r-1}}$と置くと，帰納法の仮定より$\Ker G(f)=\Ker(f-a_1)^{d_1}\oplus\cdots\oplus\Ker(f-a_{r-1})^{d_{r-1}}$である．
    $a_1,\cdots,a_r$は相異なるから，$G(a_r)\ne 0$である．
    すると，次の補題が成り立てば，命題\ref{prop-pre-homomorphism-thm}より，$\Ker F(f)=\Ker G(f)\oplus\Ker(f-a_r)^{d_r}$とわかる．
\end{Proof}

\subsection{三角化と安定部分空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=上三角化をSchur標準形ともいう，一意性はないが]
    一次式の積として表せる多項式に対して，その作用の核の一般化固有空間分解を得た．
    一般化固有空間は$f$-安定であるから，そこでの表示は三角化可能である．
    従って，一次式の積の形の最小多項式を持つならば，各一般化固有空間分解上での表示を考えれば，三角化可能である．
\end{tcolorbox}

\begin{lemma}\label{lemma-for-triangulization}
    $V\in\Vect_K,f\in\End_K(V)$，
    $G\in K[X],a\in K$とし，$W:=\Ker G(f)$と置く．$G(a)\ne 0$ならば，次が成り立つ．
    \begin{enumerate}
        \item $f-a$が$W$に引き起こす写像$(f-a)|_W:W\to W$は可逆である．
        \item $\Ker G(f)(f-a)^d=W\oplus\Ker(f-a)^d$．
    \end{enumerate}
\end{lemma}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $\exists G\in K[X],\; G=Q(X-a)+G(a)$と表せる．ここで$H=-\frac{Q}{G(a)}\in K[X]$と置くと，
        \[H(X-a)=1-\frac{G}{G(a)}\]
        である．よって，$W=\Ker G(f)$の範囲に制限すれば第二項は消えるから，$H(f)\circ (f-a)=(f-a)\circ H(f)=\id$．よって，$(f-a)|_W$は可逆で逆射は$H(f)$．
        \item[2.] $W\subset W':=\Ker G(f)(f-a)^d$と置くと，$W'$に関する$W$の補空間が$\Ker(f-a)^d$だと示せば良い．
        $(f-a)^d(W')\subset W$より，$(f-a)^d$は$W'$上に線型写像$g:=(f-a)^d|_{W'}:W'\to W$を引き起こす．これは制限を課さずとも$\Ker(f-a)^d\subset W'$だから，$\Ker g=\Ker(f-a)^d\cap W'=\Ker (f-a)^d$が成り立つ．よって，命題\ref{prop-pre-homomorphism-thm}より，$W'=W\oplus\Ker g$．
    \end{description}
\end{Proof}

\begin{corollary}[三角化可能条件]\label{cor-triangulability}
    $V\in\FVS_K$とする．次は同値．
    \begin{enumerate}
        \item $f$は三角化可能．
        \item $V$の基底$x_1,\cdots,x_n$で，$f(x_i)\in\langle x_1,\cdots,x_i\rangle\;(i\in[n])$を満たすものが存在する．
        \item $f$の最小多項式$\varphi$は一次式の積に分解する．
        \item $\exists_{a_1,\cdots,a_r\in K}\;V=\wt{V}_{a_1}\oplus\cdots\oplus\wt{V}_{a_r}$．
        \item $V$の基底であって，それに関する$f$の行列表示$A$が，その対角成分が全て$a_i\in K$の上三角行列$A_i$の直和$A=A_1\oplus\cdots\oplus A_r$となるものがある．
    \end{enumerate}
\end{corollary}
\begin{Proof}
    1と2は少し高度だが，5までくれば言い換えであると分かる．
    \begin{description}
        \item[1$\Rightarrow$3] 任意の上三角行列の最小多項式を$\varphi$とする．対角成分を$a_1,\cdots,a_n$とすると，命題\ref{prop-eigenvalue-of-triangular-matrices}より，$\varphi$は多項式$(X-a_1)\cdots(X-a_n)$を割り切る．よって$\varphi$は一次式の積に分解する．
        \item[3$\Rightarrow$4] $\varphi$は最小多項式なので，$V=\Ker\varphi(f)$だから，定理\ref{thm-triangulization}より従う．
        \item[4$\Rightarrow$5] 上三角行列の算譜（命題\ref{prop-algorithm-for-making-triangular-matrices}）により，各$\tilde{V}_{a_i}$上では$f|_{\tilde{V}_{a_i}}$は上三角化可能である．この基底を並べれば，条件の行列表示を得る．
        
        \item[5$\Rightarrow$1] 5の行列は上三角行列である．
    \end{description}
\end{Proof}


\begin{corollary}[三角化可能性の遺伝]
    $V\in\FVS_K$とし，$f\in\End(V)$を三角化可能とする．
    \begin{enumerate}
        \item 次の条件は同値である．
        \begin{enumerate}[(1)]
            \item $f$は対角化可能．
            \item $f$の固有値$a_1,\cdots,a_r$について，$\widetilde{V}_{a_i}=V_{a_i}\;(i\in[r])$．
        \end{enumerate}
        \item $W$を$f(W)\subset W$を満たす$V$の$f$-安定部分空間とする．$f|_W$は三角化可能である．
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $f$は三角化可能だから，系\ref{cor-triangulability}より$a_1,\cdots,a_r\in K$が存在して$V=\tilde{V}_{a_1}\oplus\cdots\oplus \tilde{V}_{a_r}$と分解できる．
        命題\ref{prop-algorithm-for-making-triangular-matrices}.2より，$V_{a_i}\subset\tilde{V_{a_i}}$なので，(2)の条件は$V=V_{a_1}\oplus\cdots\oplus V_{a_r}$と分解できることを言っている．
        これは$f$が対角化可能であることと同値である（系\ref{cor-diagonalizability}）．
        \item[2.] 系\ref{cor-triangulability}より，$f$の最小多項式$\varphi$は一次式の積に分解する．命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$f|_W$の最小多項式は$\varphi$を割り切る．よってこれも一次式の積に分解し，$f|_W$は三角化可能．
    \end{description}
\end{Proof}

\section{自己準同型の冪零・冪等分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    三角化の理論をさらにもう一歩だけ深めたい．
    %必ずしも一般の係数体$K$に対して一般固有空間に分解できるとは限らず，もっと線型空間に寄り添って，核心に迫りたい．
    個々の一般固有空間に引き起こされる射に注目して
    $g_i:=(f-a_i)|_{\widetilde{V}_{a_i}}$とすると，$g_i^{d_i}=0$が成り立つわけであるが，
    この固有空間を一般化する際に加味した冪零の要素に注目して，理論を深化させることを考える．
    三角行列の細胞$A_i$が$g_i$の行列表示である．
    $g_i$に注目して，この行列表示がどこまで簡単になるかを考える．

    一般の冪零写像$N$について，線型空間には定理\ref{thm-Jordan-decomposition}のような標準的な分解がある（これはいくらか同伴行列に起こっている現象と似ている！ロケット鉛筆！）．
    この，冪零性の寿命と人生航路を考慮した分解がJordanの理論である．
    これに沿った行列表示を考えれば，三角化よりも踏み込んだ表示Jordan標準形を得る．
    これは，有限次元線型空間の三角化可能な自己準同型は，対角化可能な部分と冪零な部分に分解し，それで全てであることを表している．

    Jordan blockの大きさが冪零成分の系列の長さ（寿命），個数がその系列の空間の次元を表す．対角成分が半単純部分を表す．非対角成分は冪を取るごとにはけてゆく．
    この表示により，共役類の貼り合わせとしての線型写像の振る舞いを一眼で見ることが出来るようになる．
    これが基底変換である．

    そう，三角化可能な有限次元線型空間の自己準同型については，この「冪零成分はJordan blockに，そうでない成分は対角行列に」というのが最も線型代数的に自然なもので，これが上三角行列の真の精緻化としてふさわしいものである．
    Jordan標準形は，一般固有空間のそれぞれに対して，Jordan分解を考えたものである．
\end{tcolorbox}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=上三角表示の精緻化・一意化]
    $V_a\subsetneq\wt{V}_a$となるときは対角化可能でないが，何が起こっているか．
    これは，最小多項式の$(x-a)^d\;(d\ge2)$なる因子に起因していて，
    $\wt{V}_a$上で$f-a$は冪零写像を定めている．
    $\wt{V}_a$上でみれば，$f$のスカラー倍以外の成分はいずれ消える．そこで，
    冪零自己準同型はこれを適用する毎に正確に1つずつ潰れていくような直和分解$Kx_1\oplus\cdots Kx_r$を取れば，
    これについての行列表示は上三角どころか帯行列になる．
\end{tcolorbox}

\subsection{冪零自己準同型のJordan標準形}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    次数$m$の冪零自己準同型$N^{m+1}=0$は，それぞれの段階で空間をどのように潰していくかに沿った空間の分解を持つ．
    これを用いれば，一般化固有空間内で基底を取り直すことで，任意の三角行列をJordan標準形に直すことが出来る．
\end{tcolorbox}

\begin{theorem}[空間上の冪零自己準同型の核への分解]\label{thm-Jordan-decomposition}
    $V\in\Vect_K, N\in\End(V)$を$N^{m+1}=0$を満たす自己準同型とする．この時，
    $(p,q)\in\N^2\;(p+q\le m)$で添字付けられた
    $V$の直和分解
    \[ V=\bigoplus_{p,q\in\N,p+q\le m}V_{p,q} \]
    が存在し，次の条件(J1),(J2)を満たす：
    \begin{enumerate}[({J}1)]
        \item 余命$p$が$p>0$を満たすならば，$N|_{V_{p,q}}:V_{p,q}\to V_{p-1,q+1}$は同型である．
        \item 余命$p$がすでに尽きている$p=0$ならば，$V_{0,q}\subset\Ker N$．
    \end{enumerate}
    特に，$N$が$m+1$次の冪零準同型ならば$\dim V\ge m+1$である．
\end{theorem}
\begin{remarks}
    $p+q$をその系列の寿命，$N_{-,0}$を開始地点としており，
    各$N_{p,q}$の添字$(p,q)$の
    $q$が$N$をすでに作用させた回数で，$p$が$0$にまで潰れるまでの余命である．
    
    添字$(p,q)$は格子点だから，座標系を-45度回転させて次の図を得る．
    核の系列$\Ker N\subsetneq\Ker N^2\subsetneq\cdots\Ker N^m\subsetneq\Ker N^{m+1}=V$は，
    $p=0$に平行に下から水位が上がっていくように全てを飲み込むように迫ってくる．
    一方で像の系列$V=\Im N^0\supsetneq\Im N^1\supsetneq\cdots\supsetneq\Im N^m\supsetneq\Im N^{m+1}=0$は，
    $q=0$と並行に上から水位が下がっていくように消える．
    \[\xymatrix{
        &&&&V_{m,0}\ar[d]^-{\rotatebox{90}{$\sim$}}\\
        &&V_{1,0}\ar@{.}[urr]\ar[dd]^-{\rotatebox{90}{$\sim$}}&&V_{m-1,1}\ar@{}[dd]|{\vdots}\\
        V_{0,0}\ar@{.}[urr]^-{q=0}\ar@{.}[drr]_-{p=0}&&{}\ar@{}[rr]|{\cdots\cdots}&&{}\\
        &&V_{0,1}\ar@{.}[drr]&&V_{1,m-1}\ar[d]^-{\rotatebox{90}{$\sim$}}\\
        &&&&V_{0,m}
    }\]
    以上で，$(p,q)$はそれぞれ$N^r$の像と核で指定出来るので，その言葉を使って構成する．
    なお，$p=0$軸に関する直和が固有空間となり，$q=0$軸方向への伸びが一般化固有空間である．
    $\dim V_{0,q}$が大きさ$q$のJordan細胞の数である．
\end{remarks}
\begin{Proof}\mbox{}
    \begin{description}
        \item[構成] 
        \begin{enumerate}
            \item $p=0$上にある空間$V_{0,q}\;(q\in[m])$は，$\Ker N\cap\Im N^q=V_{0,q}\oplus(\Ker N\cap\Im N^{q+1})$を満たす補空間とする．
            \item $q=0$上にある空間$V_{q,0}\;(q\in[m])$は，$(N^q)^{-1}(V_{0,q})=V_{q,0}\oplus(\Ker N^q)$を満たす補空間とすると，準同型定理より，核の補空間$V_{q,0}$上への$N^q$の制限は同型になる．
            \item 一般の$V_{p,q}\;(2\le p+q\le m)$は，$V_{p,q}:=N^q(V_{p+q,0})$とする．
        \end{enumerate}
        \item[証明] これらは条件(J)を満たす．
    \end{description}
\end{Proof}

\begin{corollary}
    冪零自己準同型$N\in\End_\C(V)$のJordan標準形$J$について，
    \begin{enumerate}
        \item Jordan細胞の総数は，$N$の$0$に属する固有空間の次元に等しい．
        \item 最大のJordan細胞の大きさは，$N$の指数(最小多項式の$0$の重複度)に等しい．
    \end{enumerate}
\end{corollary}

\begin{example}[$J(0,n)$の場合]
    $K^n$上の自己準同型$N:=J(0,n)$を考える．
    これは$N^n=0$であり，$V_{i-1,n-i}=\langle e_i\rangle\;(i=1,\cdots,n)$と置き，それ以外を$0$とすれば良い．
    即ち，$J(0,n)$とは，寿命が$n$である一番右の列の直和だけで$V$が表せる場合である．
    また$N:=J(0,r)\oplus J(0,n-r)$のとき，寿命$r$と寿命$n-r$の2列の直和として$V$が得られる．
    実は，任意の冪零自己準同型は，それぞれの列の次元の大きさ分の大きさのJordan細胞の直和で表せる．
    そう，冪零自己準同型には0と1以外の数は必要ないのである．
\end{example}

\begin{corollary}[冪零準同型のJordan標準形]\label{cor-Jordan-form-of-nilpotents}
    $V\in\FVS_K$とし，$N\in\End(V)$を$N^{m+1}=0$を満たすとする．このとき，$V$の基底で，それに関する$N$の行列表示が
    \[J=J(0,1)^{\oplus n_0}\oplus\cdots\oplus J(0,r+1)^{\oplus n_r}\oplus\cdots\oplus J(0,m+1)^{\oplus n_m}\quad(n_r:=\dim(V_{0,r}))\]
    というJordan行列になるものが存在する．
\end{corollary}

\begin{problem}[実際の$V_{p,0}$探索に使う算譜]
    $V$の基底$x_1,\cdots,x_n$と$\Im N^r$の$V_{r,0}$に対する補空間$W_r=\sum_{0\le p,r\le p,r\textcolor{red}{<}p+q\le m}V_{p,q}$と，
    その基底$N^ry_1,\cdots,N^ry_s$が与えられているとする．
    始空間$V_{r,0}$とその基底の構成算譜を与えよ．$(1\le r\le m)$である．こうやって$p+q=m$の場合から構成していく．
\end{problem}
\begin{Proof}[［解答］]
    $W_r$は残機が尽きている虫の息の$V_{0,r}$を$\Im N^r$から除いた補空間であるから，$N(\Im N^r)=N(W_r)$が成り立つ．
    $\Im N^r$の基底を探し，$x_{i_1},\cdots,x_{i_t}$を用いて，$N^ry_1,\cdots,N^ry_s,N^rx_{i_1},\cdots,N^rx_{i_t}$と表せたとし，
    ここから$V_{0,r}$の基底を遡上して探す方法を考える．
    $N(\Im N^r)=N(W_r)$より，$1\le j\le t$について，
    \[ \exists a_{1j}N^ry_1+\cdots+a_{sj}N^ry_s\in\Im N^r,\; N(N^{r}x_{i_j})=N(a_{1j}N^ry_1+\cdots+a_{sj}N^ry_s) \]
    であるから，
    \[ z_j=x_{i_j}-(a_{1j}y_1+\cdots+a_{sj}y_s) \]
    と置けば，これはちょうど次の$N$の作用で消える元だから，$V_{r,0}$の元である．
    $z_1,\cdots,z_t$の右辺の同型$N^r$による値は$\Im N^r$の基底であるから，同型$(N^r)^{-1}$による像である$z_1,\cdots,z_t$も基底で，
    $V_{r,0}=\langle z_1,\cdots,z_t\rangle$と置けば良い．
\end{Proof}

\begin{problem}
    次の行列のJordan標準形を求めよ．
    \[N=\begin{pmatrix}0&0&0&1&0&0\\0&0&0&0&1&-1\\1&-1&0&-1&-1&1\\0&0&0&0&0&0\\0&0&0&0&0&0\\0&0&0&0&0&0\end{pmatrix}\]
\end{problem}
\begin{Proof}[［解答］]
    \[N^2=\begin{pmatrix}0&0&0&0&0&0\\0&0&0&0&0&0\\0&0&0&1&-1&1\\0&0&0&0&0&0\\0&0&0&0&0&0\\0&0&0&0&0&0\end{pmatrix},\;N^3=0.\]
    右下から見つかる：$V_{0,2}=\Im N^2=\langle e_3\rangle=\Im N^2\cap\Ker N$．続いて遡上するには，$e_3=N^2e_4,Ne_4=e_1-e_3$を了解すれば，$V_{2,0}=\langle  e_4\rangle,V_{1,1}=\langle e_1-e_3\rangle$とわかる．
    従って，$W_1:=V_{0,2}+V_{1,1}=\langle e_3,e_1-e_3\rangle$とわかる．

    続いて，右端の列の情報を上で考えた算譜に適用して寿命１の列を調べる．
    $\Im N=\langle  e_3,e_1-e_3,e_2-e_3\rangle=\langle e_2-e_3\rangle+W_1$である．
    ここでトリックで，$N(e_2-e_3)=-e_3=-N(e_1-e_3)\in W_1$かつ$e_1-e_3\in W_1$なのを利用して$V_{0,1}=\langle (e_2-e_3)+(e_1-e_3)\rangle =\langle e_1+e_2-2e_3\rangle$とする．
    なぜなら，$e_1+e_2-2e_3=N(e_4+e_5)$だからである．$V_{1,0}=\langle e_4+e_5\rangle$とおける．
    すると，今まで明らかにした空間は$W_0:=\langle e_3,e_1-e_3,e_4,e_2-e_1,e_4+e_5\rangle$となる．

    最後に，$V=\langle e_6\rangle +W_0$で，$Ne_6=e_3-e_2=-Ne_5\in W_0$かつ$e_5\in W_0$であるから，$V_{0,0}=\langle e_5+e_6\rangle$と置けば良い．

    すると，Jordan分解$K^6=\oplus_{0\le p,q\le 2,p+q\le 2}V_{p,q}$を得た．

    Jordan標準形を得るための底の変換行列は，標準基底$e_1,\cdots,e_6\in K^6$の行き先を順に，右下から上への動きで指定して，
    \[ P=\begin{pmatrix}0&1&0&1&0&0\\0&0&0&1&0&0\\1&-1&0&-2&0&0\\0&0&1&0&1&0\\0&0&0&0&1&1\\0&0&0&0&0&1\end{pmatrix}. \]
    Jordan標準形は
    \[ P^{-1}NP=\begin{pmatrix}0&1&0&0&0&0\\0&0&1&0&0&0\\0&0&0&0&0&0\\0&0&0&0&1&0\\0&0&0&0&0&0\\0&0&0&0&0&0\end{pmatrix}. \]
    寿命３のものが一番上のブロックに来ており，次に寿命が２のもの，最後に寿命１のものである．それぞれ次元が３，２，１で合計６である．
\end{Proof}

\subsection{一般の自己準同型のJordan分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=三角化の一意化がJordan分解である]
これで，冪零準同型の理論は揃った．
一般の線型写像を考える．対角化できなくて三角状に余分な成分が残るものは，全てこの冪零成分による．対角化可能であることと，冪零成分が消えていることが同値であるという形で定式化される．
\end{tcolorbox}

\begin{corollary}[一般の線型写像のJordan標準形]
    $V\in\FVS_K,f\in\End(V)$を三角化可能とする．
    $f$の固有値を$a_1,\cdots,a_r$とする．この時，自然数の列$1\le p_{1,i}\le\cdots\le p_{l,i}\;(i=1,\cdots,r)$であって，
    行列$J(a_i,p_{j,i})\;(1\le i\le r,1\le j\le l_i)$の直和が$f$の行列表示となるようなものが存在する．
    （実は一意的）．
\end{corollary}
\begin{Proof}
    各一般固有空間への制限$(f-a_i)|_{\tilde{V}_{a_i}}$は冪零だから，
    これについて系を適用するとJordan分解を得る．これを並べた直和の行列を得れば良い．

    系より，基底の並べ方を除いて一意的に定まる．
\end{Proof}

\begin{definition}[Jordan normal form]
    $V\in\FVS_K,f\in\End(V)$を三角化可能とする．$f$の行列表示$J$がJordan行列の直和からなる時，$J$を$f$の\textbf{Jordan標準形}であるという．
\end{definition}

\begin{definition}[semi-simple part, nilpotent part, unipotent part]
    $V=\widetilde{V}_{a_1}\oplus\cdots\oplus\widetilde{V}_{a_r}$を$f\in\End_K(V)$に関する一般固有空間分解とする．
    \begin{enumerate}
        \item $V$の自己準同型$s\in\End(V)$で，各$\widetilde{V}_{a_i}$への制限が$a_i$倍写像であるという条件で定まるものを，\textbf{$f$の半単純部分}と言う．
        \item $n:=f-s$を\textbf{$f$の冪零部分}と言う．
        \item $f=s+n$を$f$の\textbf{Jordan分解}と言う．
        \item $f=s+n$が$s=\id_V$であるとき，\textbf{冪単}であるという．
        \item 固有値$a_1,\cdots,a_r$がいずれも$0$でない時（即ち$V_{0,0}=0$である時），$u:=s^{-1}f$を\textbf{$f$の冪単部分}と呼び，$f=su$を$f$の\textbf{乗法的なJordan分解}または\textbf{Chevalley分解}と呼ぶ．
    \end{enumerate}
\end{definition}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item 単位元をもつ環（可換でなくてもよい）上の加群は、単純（既約）部分加群の直和であるときに、半単純 (semisimple) あるいは完全可約 (completely reducible) という。 \footnote{\url{https://ja.wikipedia.org/wiki/半単純加群}}
        \item 結局半単純部分と冪零部分の解離が，最小多項式と固有多項式の解離部分に等しい．$n$がfullの時（一般固有空間と固有空間が一致する時も含め，冪零次元が満たされている時），２つの多項式は一致する．一番乖離が大きいのは$n=0$即ち対角化可能である時である．
        \item $J(a,n)=a+J(0,n)$はJordan分解である．
    \end{enumerate}
\end{remark}

\begin{corollary}[固有空間と一般化固有空間の乖離]
    $A\in\End_\C(V)$について，
    \begin{enumerate}
        \item $A$のJordan標準形における固有値$\al$に属するJordan細胞の大きさの和は，$\al$の幾何的重複度(一般化固有空間の次元)に等しい．
        \item $A$のJordan標準形における固有値$\al$に属するJordan細胞の数は，$\al$に属する固有空間の次元に等しい．
    \end{enumerate}
\end{corollary}

\begin{corollary}
    $A\in\End_\C(V)$とその固有値$\al$について，
    \begin{enumerate}
        \item $\al$に属するJordan細胞はただ1つである．
        \item $\al$の最小多項式における重複度と，固有多項式における重複度とは一致する．
    \end{enumerate}
\end{corollary}
\begin{remarks}
    Jordan細胞の数=固有空間の次元が$\dim V_{0,q}$で，次数の和=一般化固有空間の次元が$V_{0,q}$の列に関する直和である．
    そして，最小多項式における重複度が寿命の長さを意味しているから，これが幾何的重複度に一致するならば，幅$\dim V_{0,q}$は1であることが分かる．
\end{remarks}

\begin{corollary}[Jordan分解の遺伝]
    $W\in V(S)$を$A\in\End_K(V)$-安定部分空間，$A=S+N$をJordan分解とする．
    \begin{enumerate}
        \item $W$は$S,N$-安定でもある．
        \item $A|_W=S|_W+N|_W$が$A|_W$のJordan分解を与える．
    \end{enumerate}
\end{corollary}

\subsection{共役類の標準形である}

\begin{theorem}[Jordan標準形は共役類不変量である]
    $K$を代数的閉体，$V\in\FVS_K$とする．任意の$A\in\End_K(V)$はJordan標準形を持ち，次の2条件は同値：
    \begin{enumerate}
        \item $A,B$は共役．
        \item $A,B$のJordan標準形は一致する．
    \end{enumerate}
\end{theorem}

\begin{proposition}[一般化固有空間分解とそこでの冪零次数が共役不変量である]
    $K$を代数的閉体，$V\in\FVS_K$とする．
    \begin{enumerate}
        \item $\dim V\le3$ならば，$A\in\End_K(V)$が共役であることと最小多項式が一致することとは同値．
        \item $\dim V\ge4$では同様の事実は成り立たない．ただし，各固有空間への制限が，同じ冪零次数を持つことを課せば再び同値になる．
    \end{enumerate}
\end{proposition}

\begin{proposition}[同時Jordan行列化は必ずしも可能でない]
    $K$を代数的閉体，$V\in\FVS_K$，$A,B\in\End_K(V)$は可換とする．
    \begin{enumerate}
        \item $A,B$は同時上三角化可能である．
        \item 一方で，可換だからといって，同じ基底についてJordan標準形に表せるとは限らない．
    \end{enumerate}
\end{proposition}

\begin{proposition}
    位相線型空間$M_n(\C)$の対角行列の全体$D$は$M_n(\C)$上稠密である．
\end{proposition}

\section{Jordan標準形}

\subsection{Jordan標準形}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    固有空間$V_a$の次元は，$a$に対応するJordan細胞$J(a,-)$の個数に等しい．
\end{tcolorbox}

\begin{lemma}[$x$-行列の直和の標準形]
    $A(x)\in M_n(K[x]),B(x)\in M_m(K[x])$は単因子標準形$A(x)=\diag(1,\cdots,1,f(x)),B(x)=\diag(1,\cdots,1,g(x))$を持つとする．
    \begin{enumerate}
        \item $f(x)|g(x)$ならば，$A(x)\oplus B(x),B(x)\oplus A(x)$はいずれも$\diag(1,\cdots,1,f(x),g(x))$に対等である．
        \item $f,g$が共通因子を持たないならば，$A(x)\oplus B(x)$は$\diag(1,\cdots,1,f(x)g(x))$に対等である．
    \end{enumerate}
\end{lemma}

\begin{corollary}[Jordan標準形の共役類]
    2つのJordan行列(Jordan細胞の直和で表される行列)が相似であることは，一方が他方のJordan細胞を並び替えたものであることに同値．
\end{corollary}

\begin{theorem}[Jordan標準形]
    任意の$A\in M_n(K)$に対して，Jordan細胞の並び替えを除いて唯一のJordan行列$J$に相似である．
\end{theorem}

\begin{corollary}[対角化可能性の単因子による特徴付け]
    $A\in M_n(K)$について，
    \begin{enumerate}
        \item $A$は対角化可能である．
        \item $A$の特性行列$xE-A\in M_n(K[x])$の最後の(最大次数の)単因子$e_n(x)$が，相異なる一次式の積に分解される(重根を持たない)．
    \end{enumerate}
\end{corollary}

\subsection{実行列がJordan標準形を持つ場合}

\begin{theorem}
    実行列$A\in M_n(\R)$について，次の2条件は同値．
    \begin{enumerate}
        \item $P\in\GL_n(\R)$によってJordan標準形に変形される．
        \item $A$の固有値が全て実数である．
    \end{enumerate}
\end{theorem}

\subsection{最小多項式}

\begin{theorem}
    $A\in M_n(K)$の最小多項式は，特性行列$xI-A\in M_n(K[x])$の最大次数の単因子に他ならない．
\end{theorem}

\begin{proposition}[直和の最小多項式]
    $A_1,A_2\in M_n(K)$について，直和$A_1\oplus A_2$の最小多項式は$\lcm(\varphi_{A_1}(x),\varphi_{A_2}(x))$である．
\end{proposition}

\begin{proposition}
    $A_1,\cdots,A_k\in M_n(K)$の最小多項式は，どの2つも共通因数を持たないとする．このとき，各$A_i$の多項式として得られる行列$B_i\in M_n(K)$について，$B_1\oplus\cdots\oplus B_k$も$A_1\oplus\cdots\oplus A_k$の多項式として得られる．
\end{proposition}

\subsection{Jordan分解}

\begin{theorem}
    $A\in M_n(\C)$について，次の条件を満たす$S,N\in M_n(\C)$がただ一組存在する：
    \begin{enumerate}
        \item $A=S+N,SN=NS$．
        \item $S$は対角化可能で$N$は冪零．
        \item $S,N$は共に$A$の多項式で表せる．
    \end{enumerate}
    特に，$A$が実であるとき，$S,N$も実である．
\end{theorem}

\section{行列式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    行列式の代数的本質は外積代数で，特に正規化した歪対称な多重線型写像として特徴付けられる．
    また，Lie群の準同型$\GL_n(\R)\to\R$としても$\pm\abs{\det X}^s\;(s\in\R)$まで特徴付けられる．
    行列式はあまり作用素には一般化されないが，固有値の積のことである．
    跡が固有値の和であるので，対称式のような関係がある．
\end{tcolorbox}

\begin{history}
    Cramerが1750に連立方程式を解くのに行列式を用いた．
    関孝和も1683に独自に見つけていた．行列式は1800年代にGaussがドイツ語Determinanteと命名し，行列はSylvesterが1850年ごろにmatrixと命名した．
    全く語源的関連はなく，日本でも初めはデテルミナントと母式と訳したが，高木貞治が行列式と行列と命名し直した．
\end{history}

\subsection{定義と特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    行列式を
    \begin{enumerate}
        \item 小行列による計算法則（手でやるのが良いアルゴリズム）
        \item 規格化された多重交代線型形式（公理論で採用するもの）
        \item 符号による計算法則（還元主義的）
    \end{enumerate}
    によって定義する．
    これにより，行列式の性質と置換の符号の性質を導く．
    置換の符号は行列式によって定義できるからである．
    これは置換の行列表現と呼び得る，遠回りに見えてもしかしたら極めて有効な代数的手段である：$P(\sigma\circ\tau)=P(\sigma)P(\tau)$．
\end{tcolorbox}

\begin{definition}[determinant]
    $A\in M_n(K)$に対して，\textbf{行列式}$\det:M_n(K)\to K$を次のように帰納的に定義する．
    \begin{enumerate}
        \item $n=0$の時，$M_0(K)=0$であり，$\det\; 0=1$とする．
        \item $A=(a_{ij})\in M_n(K)$の行列式は，$A_i\in M_{n-1}(K)$を$A$の第$n$列と第$i$行を除いて得られる行列として，
        \[ \det A:=\sum^n_{i=1}(-1)^{n-i}\det A_i\cdot a_{in} \]
        と定める．
    \end{enumerate}
\end{definition}

\begin{proposition}[行列式の特徴付け１：交代多重線型形式]\label{prop-characterization-of-determinant}
    写像$d:M_n(K)\to K$について，次の４条件は全て同値である．
    \begin{enumerate}
        \item $\forall A\in M_n(K),\;d(A)=d(1)\det A$．
        \item $\forall A\in M_n(K),\;d(A)=d(1)\sum_{\sigma\in\mathfrak{S}_n}\sgn(\sigma)\cdot a_{\sigma(1)1}a_{\sigma(2)2}\cdots a_{\sigma(n)n}$．
        \item 次の二条件を満たす．
        \begin{enumerate}[(1)]
            \item (多重線型性)  $A$の第$j$列$a_j$を，$b\in K^n$で置き換えたものを$B$，$a_j+b$で置き換えたものを$C$，$ca_j$で置き換えたものを$D$とすると，次が成り立つ：
            \begin{align*}
                d(C)&=d(A)+d(B),&d(D)&=c\cdot d(A).
            \end{align*}
            \item (交代性)  $A$のある２列が等しいならば$d(A)=0$．
        \end{enumerate}
        \item (2)の代わりに次の(3)を満たす．
        \begin{enumerate}[(1)]\setcounter{enumii}{2}
            \item (歪対称性)  $B$を$A$のある二列$a_j,a_{j'}$を入れ替えて得られる行列とすると，$d(A)+d(B)=0$．
        \end{enumerate}
    \end{enumerate}
\end{proposition}

\begin{proposition}[行列式の特徴付け２：群準同型]\mbox{}
    \begin{enumerate}
        \item 行列式の制限
        $\det:\GL_n(K)\to K^\times$は群の準同型である：$\det BA=\det B\cdot\det A$．
        \item 連続写像$\rho:\GL_n(\R)\to\R^\times$が条件$\rho(AB)=\rho(A)\rho(B)$を満たすならば，$\exists_{s\in\R}\;\rho(X)=\abs{\det X}^s$または$\rho(X)=\sgn(\det X)\abs{\det X}^s$である．
    \end{enumerate}
\end{proposition}
\begin{remarks}[置換の符号]
    $\sgn(\sigma):=\det(e_{\sigma(1)}\;\cdots\;e_{\sigma(n)})$と定められるから，
    これは$\sgn(\sigma\circ\tau)=\sgn(\sigma)\sgn(\tau)\;(\sigma,\tau\in\mathfrak{S}_n)$を系として含む．
\end{remarks}

\subsection{行列式の評価}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $M_n(K)$について，
    転置とは$*$-演算であり，跡とは内積である．
\end{tcolorbox}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item $\Tr(AB)=\Tr(BA)$．
        \item $\norm{A}\le\Tr(A)$．
        \item $A\in M_2(K)$ならば，$\det(A)=\frac{\Tr(A)^2-\Tr(A^2)}{2}$．これは分散公式に近い．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    実際，共分散作用素の跡が2次の中心積率である．
\end{remarks}

\begin{example}[上三角行列の行列式]\label{example-determinant-of-triangular-matrices}
    上三角行列について，$\det (A)=\Tr(A)$である．より一般に，
    $A=\begin{pmatrix}A_{11}&A_{12}\\0&A_{22}\end{pmatrix}$ならば，$\det A=\det A_{11}\det A_{22}$である．
    これはきっとデータ構造自体に内在する機構なのだろう．一つのデータ単位を，一文字$a_{11}$で表すか，ブロック$A_{11}$で表すかの違いで，全く同じ代数的取り扱いが出来るはず．
\end{example}

\begin{proposition}[Hadamardの不等式]
    任意の$A=(a_1\;\cdots\;a_n)\in M_n(K)$について，
    \begin{enumerate}
        \item $\abs{\det A}\le\norm{a_1}\cdots\norm{a_n}$．
        \item $A\in\GL_n(K)$のとき，等号成立条件は列ベクトル$a_1,\cdots,a_n$が直行すること．
    \end{enumerate}
\end{proposition}

\subsection{Cramerの公式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    置換の符号も行列式で表せるのであったから，置換の符号も加味した小行列の行列式を余因子という．
    これによって$\det A$が表せることが，多重線形性から示せる．
    $A$が可逆な時は，その逆行列を$\det A$と$\Delta(A)$とで表す公式として使用できる．

    行列のデータ構造は不思議なものである．内積が自然とするなら，
    この双対性を横と縦の対として表現するのである．
\end{tcolorbox}

\begin{definition}[minor, first minor, cofactor matrix]\mbox{}
    \begin{enumerate}
        \item 行列から１つ以上の行や列を取り除いて得られる行列を小行列という．その行列式を小行列式という．小行列式は余因子と符号分だけ違う．
        \item 行列$A$の第$ij$成分を$1$，第$i$行と第$j$列のそれ以外の要素を$0$とした行列の行列式$\Delta_{ij}\in K$を\textbf{余因子}と言う．
        \item 余因子を転置させて並べた行列$\Delta(A):=(\Delta_{ji})\in M_n(K)$を$A$の\textbf{余因子行列}という．
    \end{enumerate}
\end{definition}

\begin{proposition}[Cramer]\label{prop-Cramer}
    \[\Delta(A)A=\det A.\]
\end{proposition}

\begin{example}
    自明な例として，二次行列$A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$の逆行列が$A^{-1}=\frac{1}{ad-bc}\begin{pmatrix}d&-b\\-c&a\end{pmatrix}$とわかる．
\end{example}

\begin{corollary}\label{cor-characterization-of-invertibility}
    次の２条件は同値である．
    \begin{enumerate}
        \item $A$は可逆である．
        \item $\det A\ne 0$．
    \end{enumerate}
\end{corollary}

\section{跡}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Lie群における行列式のLie環に於ける対応物が跡である：
    \[\det(I+A)=1+\Tr(A)+o(A).\]
\end{tcolorbox}

\subsection{代数的性質}

\begin{proposition}[代数的性質による特徴付け]
    $\Tr:M_n(K)\to K$について，
    \begin{enumerate}
        \item 線形性：$\Tr(aX+bY)=a\Tr(X)+b\Tr(Y)$．
        \item 可換性：$\Tr(XY)=\Tr(YX)$．
    \end{enumerate}
    また，上の2性質を持つ線型写像$f:M_n(K)\to K$は跡の定数倍に限る．
\end{proposition}

\begin{proposition}[3つの不変性]
    $\Tr:M_n(K)\to K$について，
    \begin{enumerate}
        \item 転置不変性：$\Tr(X^\top)=\Tr(X)$．
        \item 相似不変性：$\forall_{P\in\GL_n(K)}\;\Tr(P^{-1}XP)=\Tr(X)$．
        \item 巡回不変性：巡回置換$\sigma$について，$\Tr\paren{\prod_{i\in[m]}X_i}=\Tr\paren{\prod_{i\in[m]}X_{\sigma(i)}}$．
    \end{enumerate}
\end{proposition}

\section{固有多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    最小多項式は一般の線型写像に定義されるが，
    固有多項式は，行列式の概念を通じて有限次元線型空間にしか定義されない：
    $\Phi_A:=\det(X-A)\in K[X]$．
    したがってまずこれが行列表示に依らない，線型写像の特徴量であることを見る必要がある．
    しかし固有多項式は初等的で，また安定部分空間上では最小多項式に一致するため，
    十分な代用になる．
\end{tcolorbox}

\subsection{線型写像の固有多項式}

\begin{definition}[characteristic polynomial, trace]
    $A\in M_n(K)$について，monicな多項式$\Phi_A:=\det(X-A)\in K[X]$を$A$の\textbf{固有多項式}という．
\end{definition}

\begin{remark}[固有方程式の最高次係数と定数項としての特徴付け]
    \[ \Phi_A=\det\begin{pmatrix}X-a_{11}&-a_{12}&\cdots&-a_{1n}\\-a_{21}&X-a_{22}&\ddots&\vdots\\\vdots&\ddots&\ddots&-a_{(n-1)n}\\-a_{n1}&\cdots&-a_{n(n-1)}&X-a_{nn}\end{pmatrix} \]
    より，$X^{n-1}$の係数は$-\Tr A$であり，定数項は$(-1)^n\det A$である．
\end{remark}

\begin{example}\mbox{}\label{example-eigenpolynomial}
    \begin{enumerate}
        \item $A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$とすると，注より，$\Phi_A=X^2-(a+d)X+ad-bc$．
        \item $A$が上三角行列ならば，固有多項式は対角成分に関する積$\Phi_A=(X-a_{11})\cdots(X-a_{nn})$．$a_{11},\cdots,a_{nn}$が全て相異なる時，これは最小多項式に一致する．
        \item $A$がJordan行列$J(a,n)$ならば，$\Phi_A=(X-a)^n$である．これも最小多項式でもある．
        \item $A$を$F\in K[X]$の同伴行列とすると，固有多項式は$\Phi_A=F$．これは最小多項式でもある．
    \end{enumerate}
\end{example}

\begin{proposition}[線型写像の特徴量としてのwell-definedness]\label{prop-行列の特徴量は線型写像について定まっている}
    $A,B\in M_n(K)$が共役ならば，$A$と$B$の
    \begin{enumerate}
        \item 行列式
        \item トレース
        \item 固有多項式
    \end{enumerate}
    は等しい．
\end{proposition}
\begin{Proof}
    共役の定義\ref{def-conjugate}より，任意の$P\in\GL_n(K)$を取って考えると良い．
    $X$はスカラー行列より，系\ref{cor-determinant-of-product-and-transposition}から，
    \begin{align*}
        \Phi_{P^{-1}AP}&=\det(X-P^{-1}AP)=\det(P^{-1}(X-A)P)=\det(X-A)=\Phi_A
    \end{align*}
    である．
\end{Proof}

\subsection{固有多項式の遺伝}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    最小多項式よりも強い条件を満たすクラスが固有多項式であるはずが，その違いは最小多項式よりも冪が大きくなり得るのみであり，
    根が固有値であることは変わらない．
    遺伝性についても，最小多項式と同じものが成り立つ．
\end{tcolorbox}

\begin{proposition}[固有値であることの特徴付け]
    $V\in\FVS_K,f\in\End(V)$とする．次の２条件は同値である．
    \begin{enumerate}
        \item $a$は$f$の固有値である．
        \item $\Phi_f(a)=0$．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    定義\ref{def-eigenpolynomial-of-linear-mapping}より，
    2は$\det(f-a)=0$と同値．系\ref{cor-characterization-of-invertibility}より，これは$f-a$が可逆でないことと同値．
    $V$が有限次元であることより，次元定理\ref{cor-thm-of-dimention}から特に$f-a$が単射でないことと同値．
    よって，$V_a=\Ker(f-a)\ne 0$より，$a$は$f$の固有値である．
\end{Proof}

\begin{proposition}[固有多項式の遺伝]\label{prop-eigenpolynomial-as-patching}
    $V\in\FVS_K,f\in\End(V)$とする．
    \begin{enumerate}
        \item $W\subset V$を$f$-安定部分空間とする：$f(W)\subset W$．$f|_W$の固有多項式は$f$の固有多項式を割り切る．
        \item $g\in\End(W)$とする．全射$p:V\to W$が存在して次が可換になるならば，$g$の固有多項式は$f$の固有多項式を割り切る．
        \[\xymatrix{
            V\ar[r]^-p\ar[d]_-f&W\ar[d]^-g\\
            V\ar[r]^-p&W
        }\]
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $B'=(x_1,\cdots,x_m)$を$W$の基底とし，$B=(x_1,\cdots,x_n)$をその$V$の基底への延長とする．この時，$f$の$B$に関する行列表示は\[A=\begin{pmatrix}A_{11}&A_{12}\\0&A_{22}\end{pmatrix}\]と置ける．いま，$f|_W:W\to W$の行列表示が$A_{11}$である．
        これについて，例\ref{example-determinant-of-triangular-matrices}より，
        \[\det(X-f)=\det(X-A)=\det(X-A_{11})\det(X-A_{22})\]
        であるから，$f|_W$の固有多項式$\det(X-A_{11})$はこれを割り切る．
        \item $x_1,\cdots,x_m$を$\Ker p$の基底とし，$B=(x_1,\cdots,x_n)$をその$V$の基底への延長とすると，$B'=(p(x_{m+1}),\cdots,p(x_n))$が$W$の基底になる．
        いま，図式が可換であることより，$p(f(x_i))=g(p(x_i))=g(0)=0\;(1\le i\le m)$であるから，$f(x_i)\;(1\le i\le n)$の基底$x_{m+1},\cdots,x_n$に関する係数は$0$であるから，$f$の基底$B$に関する行列表示は，
        \[A=\begin{pmatrix}A_{11}&A_{12}\\0&A_{22}\end{pmatrix}\]と置ける．
        この時，$g$の$B'$に関する行列表示が$A_{22}$である．なぜならば，$A=(a_{ij})_{1\le i,j\le n}$と置くと，図式が可換であることより，
        \[p(\sum^n_{i=1}a_{ij}x_i)=p(f(x_j))=g(p(x_j))\;\;(m+1\le j\le n)\]
        だから，$f(x_j)$の$B$に関する行列表示の部分行列と，$g(x_j)$の$B'$に関する行列表示が一致する．
        よって，$\det(X-g)=\det(X-A_{22})$は$\det(X-f)=\det(X-A)$を割り切る．
    \end{enumerate}
\end{Proof}

\begin{proposition}
    $A,B\in M_{n}(K)$について，
    \begin{enumerate}
        \item $A$とその半単純部分$S$との固有多項式は一致する．
        \item $AB,BA$の固有多項式は一致する．
        したがって，2つの行列の固有値は重複度も含めて一致する．
    \end{enumerate}
\end{proposition}

\subsection{最小多項式と固有多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    非自明な$f$-安定部分空間が存在しないとき(ある$x\in V$が存在して$(f^n(x))_{n\in\N}$が$V$の生成元になるとき)，$f$の固有多項式は最小多項式に一致する．
    存在するとき，張り合わせて全体の固有多項式を得る際に，冪が余分に増えてしまう．
\end{tcolorbox}

\begin{lemma}
    $V\in\FVS_K,f\in\End(V)$とする．
    $V$の$f$-安定部分空間$W$への制限$f|_W$は，最小多項式と固有多項式とが一致する．
\end{lemma}
\begin{Proof}
    $x\in V$に対し，$x$が生成する$f$-安定部分空間を$W_x$とする．
    $V$が有限次元より，制限$f|_{W_x}:W_x\to W_x$には最小多項式が存在し，これを$\varphi_x$とする．
    命題\ref{prop-stable-subspace}より，$W_x$の基底であって，それに関する$f|_{W_x}$の行列表示$A$が$\varphi_x$の同伴行列となるもの，$x,f(x),\cdots,f^{m-1}(x)\in W_x$がある．
    例\ref{example-eigenpolynomial}.4より，$A$の固有方程式も$\varphi_x$である．
\end{Proof}

\begin{theorem}[Cayley-Hamilton]\label{thm-Cayley-Hamilton}
    $V\in\FVS_K,f\in\End(V)$とする．$\Phi\in K[X]$を$f$の固有多項式とし，$\dim V=n$とする．
    \begin{enumerate}
        \item (Cayley-Hamilton) $f$の最小多項式$\varphi$は，固有多項式$\Phi$を割り切る．特に，$\Phi(f)=0$．
        \item $f$の固有多項式$\Phi$は，$\varphi^n$なら割り切る．
    \end{enumerate}
\end{theorem}
\begin{Proof}
        $x_1,\cdots,x_n$を$V$の基底とする．
    \begin{enumerate}
        \item $V=W_{x_1}+\cdots+W_{x_n}$だから，命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$f$の最小多項式$\varphi$は$\varphi=\lcm\{\varphi_{x_1},\cdots,\varphi_{x_n}\}$．
        命題\ref{prop-eigenpolynomial-as-patching}.1より，最小公倍式は$\Phi$を割り切る．
        \item $\varphi_{x_1}\cdots\varphi_{x_n}$は$\varphi$を割り切るから，$\Phi$が$\varphi_{x_1}\cdots\varphi_{x_n}$を割り切ることを示す．
        直和$W_{x_1}\oplus\cdots\oplus W_{x_n}$の自己準同型$f|_{W_{x_1}}\oplus\cdots\oplus f|_{W_{x_n}}$の固有多項式は，
        積$\varphi_{x_1}\cdots\varphi_{x_n}$である．
        ここで，全射$W_{x_1}\oplus\cdots\oplus W_{x_n}\to V=W_{x_1}+\cdots+W_{x_n}$に命題\ref{prop-eigenpolynomial-as-patching}.2を適用すれば，$f$の固有多項式$\Phi$は$\varphi_{x_1}\cdots\varphi_{x_n}$を割り切ることがわかる．
    \end{enumerate}
\end{Proof}


\begin{corollary}[最小多項式の代用]
    $V\in\FVS_K,f\in\End(V)$とする．
    \begin{enumerate}
        \item 次の条件は同値である．\begin{enumerate}[(1)]
            \item $f$は三角化可能である．
            \item $f$の固有多項式は一次式の積に分解する．
        \end{enumerate}
        \item $n=\dim V$とする．\begin{enumerate}
            \item $f$は冪零である．
            \item $f$の固有多項式は$X^n$である．
        \end{enumerate}
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item Cayley-Hamiltonの定理\ref{thm-Cayley-Hamilton}より，(2)と最小多項式が一次式の積に分解することは同値である．
        （1より，固有多項式が一次式の積に分解するなら，それを割り切る最小多項式も一次式の積である．2より，最小多項式が一次式の積なら，$\varphi^n$を割り切る固有多項式もそうである）．
        よって，系\ref{cor-triangulability}より従う．
        \item $\exists m\in[n],\;f^m=0$の時，系\ref{cor-Jordan-form-of-nilpotents}より$f$はJordan行列の直和としての行列表示をもち，例\ref{example-eigenpolynomial}のように，
        $\det(f-X)=X^n$である．逆に，$\Phi_f=X^n$である時，Cayley-Hamiltonの定理\ref{thm-Cayley-Hamilton}.1より，$\varphi$はこれを割り切る$X^m\;(m\in[n])$だから，$f$は冪零である．
    \end{enumerate}
\end{Proof}

\subsection{対角化可能性の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    固有多項式の根の重複度を固有値の重複度といい，これは一般化固有空間の次元を表している．
    一般化固有空間の全てが固有空間に一致するとき，最小多項式は互いに異なる一次式の積となっており，対角化可能になる．
\end{tcolorbox}

\begin{definition}[multiplicity of an eigenvalue of a linear mapping]
    $V\in\FVS_K,f\in\End(V)$とする．$\Phi_f$の根$a$の重複度を，固有値$a$の重複度という．
\end{definition}

\begin{proposition}[一般固有空間の次元は，固有値の重複度に等しい]\label{prop-algebraic-multiplicity-is-dimension-of-generalized-eigenspace}
    $V\in\FVS_K,f\in\End(V)$とする．$f$の固有値$a\in K$の重複度を$m$とすると，$\dim\widetilde{V}_{a}=m$である．
\end{proposition}
\begin{Proof}
    $d$を$f$の最小多項式$\varphi$の根$a$の重複度とすると，$\varphi=(X-a)^dF$と置ける．$W=\Ker F(f)$と定めると，$V=W\oplus\widetilde{V}_a$である．（$V=\Ker\varphi(f)=\Ker(f-a)^dF(f)$かつ$F(a)\ne 0$なので，補題\ref{lemma-for-triangulization}.2と同じ状況である）．
    $f|_W$の固有多項式を$\Psi$とする．$f|_{\widetilde{V}_a}$の固有多項式は$\dim\widetilde{V}_a=:l$を用いて$(X-a)^l$である（命題\ref{prop-algorithm-for-making-triangular-matrices}）．
    $V=\widetilde{V}_a\oplus W$だから，$\Phi=(X-a)^l\Psi$である．補題\ref{lemma-for-triangulization}より，$(f-a)|_W$は同型だから，$\Psi(a)\ne 0$である．よって，$\Psi$の根$a$の重複度$m$は$l=\dim\widetilde{V}_a$とわかる．
\end{Proof}
\begin{remarks}
    一般化固有空間は$f$-安定であるから，その上で最小多項式と固有多項式とは一致する．
\end{remarks}

\begin{corollary}
    $A\in M_n(K)$の固有多項式$\Phi$の根$a_1,\cdots,a_r\;(r\le n)$の重複度を$m_1,\cdots,m_r$とする．次の2条件は同値：
    \begin{enumerate}
        \item $A$は対角化可能である．
        \item $\forall_{i\in[r]}\;V_{a_i}=\wt{V}_{a_i}$が成り立つ．
        \item $\forall_{i\in[r]}\;\dim V_{a_i}=m_i$が成り立つ．
    \end{enumerate}
\end{corollary}

\section{行列の関数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    最小多項式とは，行列の多項式を考えている．
    これを冪級数にしてみることを考える．適当な基底変換を施すことにより，収束半径の中にあるかどうかは固有値について考えれば良い．
\end{tcolorbox}

\subsection{行列の多項式}

\begin{theorem}[固有多項式]
    $A\in M_n(K)$，固有多項式は$\Phi_A(t)=\prod^n_{i=1}(t-\lambda_i)$とする．
    任意の多項式$f\in K[X]$に対して，$f(A)\in M_n(K)$の固有多項式は$\Phi_{f(A)}(t)=\prod^n_{i=1}(t-f(\lambda_i))$と表せる．
\end{theorem}

\subsection{行列の冪級数の収束}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $x$-行列は$K^{n^2}$-値関数とも見れるが，行列係数多項式と見れるのであった：$M_n(K[x])\simeq M_n(K)[x]$．
    そこで，行列係数の冪級数の収束性を考えれば，ベクトル値関数への示唆にもなるとも考えられる．
    こうして，環$M_n(K)[x]$の考察から，行列値解析関数$K\to M_n(K)$が定義される．
\end{tcolorbox}

\begin{theorem}[行列の冪級数の収束性]
    形式的冪級数を$\sum_{p=0}^\infty a_pX^p$と定め，$X=z\in\C$のときの収束半径を$\rho:=(\limsup\abs{a_p}^{1/n})^{-1}$とする．
    $X\in M_n(\C)$としたとき，この級数は
    \begin{enumerate}
        \item 行列$X$の全ての固有値の絶対値が$\rho$より小さければ収束する．
        \item 行列$X$の固有値の絶対値が1つでも$\rho$を超えれば発散する．
    \end{enumerate}
\end{theorem}

\begin{corollary}
    形式的冪級数$\sum_{p=0}^\infty a_pX^p$について，
    \begin{enumerate}
        \item $X\in M_n(\C)$のとき収束するならば，$X=P^{-1}XP$のときも収束し，和は$P^{-1}\paren{\sum_{p\in\N}a_pX^p}P$に等しい．
        \item $X$の固有値を$\al_1,\cdots,\al_n$とすれば，冪級数$\sum_{p\in\N}a_pX^p$の固有値は$\sum_{p\in\N}a_p\al_i^p\;(i=1,2,\cdots,n)$である．
    \end{enumerate}
\end{corollary}

\subsection{行列の指数関数}

\begin{definition}
    $a_p=1/p!$としたとき，任意の$X\in M_n(\C)$について収束する．
    このとき，次の写像を\textbf{行列の指数関数}という：
    \[\xymatrix@R-2pc{
        \exp:M_n(\C)\ar[r]&\GL_n(\C)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        X\ar@{|->}[r]&\exp X:=\sum_{p\in\N}\frac{1}{p!}X^p
    }\]
    系より，$\exp(P^{-1}XP)=P^{-1}(\exp X)P$であるから，$\exp X$の固有値は$e^{\al_1},\cdots,e^{\al_n}$である．
    よって，$\det(\exp X)=\exp(\Tr X)\ne0$で，必ず正則．
\end{definition}
\begin{remarks}[$t$-行列の指数関数]
    ここで，形式的冪級数$\sum_{p\in\N}\frac{1}{p!}X^p$に$t$-行列$X=tX\in M_n(\C[t])\simeq M_n(\C)[t]$を代入すると，ベクトル値の解析関数$\exp:\C\to\GL_n(\C);t\mapsto\exp tX$を定める．
    微分可能な行列値関数$A(t)$が，ある行列$X\in M_n(\R)$に関して
    \[A'(t)=XA(t),\quad A(0)=E\]
    を満たすならば，連立微分方程式系の解の存在と一意性より，$A(t)=\exp tX$となる．
    こうして，線型連立微分方程式の解は，$\exp tA$の列ベクトルが与える．
\end{remarks}

\begin{proposition}[加法定理]\mbox{}
    \begin{enumerate}
        \item ２つの行列$X,Y$が可換ならば，$\exp(X+Y)=\exp X\cdot\exp Y$．特に，任意の行列$X$について，$\exp(-X)=(\exp X)^{-1}$．
        \item $X$が交代行列ならば，$\exp X$は直交行列である．逆に，任意の$t\in\R$に関して$\exp tX$が直交行列ならば，$X$は交代行列である．
        \item $X$が実対称行列ならば，$\exp X$は正値対称行列である．逆に，任意の$t\in\R$に関して$\exp tX$が実対称行列ならば，$X$は実対称行列である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $\exp t(X+Y),\exp tX,\exp tY$は共に$t$の正則関数であるから，Maclauren展開の係数比較より．
        \item ${}^t\!X=-X$ならば，${}^t\!\exp X=\exp{}^t\!X=e^{-X}=(\exp X)^{-1}$より，$\exp X$は直交行列である．逆に，任意の
        $\exp{}^ttX$が全て直交行列ならば，$(\exp t({}^t\!X))(\exp tX)=E$．両辺の$0$における微分係数を比較すれば，${}^t\!X+X=O$を得る．
    \end{enumerate}
\end{Proof}

\begin{example}[行列式1の直交行列の指数関数としての表示]
    $X=\begin{pmatrix}0&-\al\\\al&0\end{pmatrix}$ならば，$X^2=\begin{pmatrix}-\al^2&0\\0&-\al^2\end{pmatrix}$と続いていくから，$\exp X=\begin{pmatrix}\cos\al&-\sin\al\\\sin\al&\cos\al\end{pmatrix}$となる．
    行列式$1$の任意の直交行列は，ある交代行列$X$によって，$\exp X$と表される．
\end{example}

\subsection{行列の正則関数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\GL_n(\R)$の作用素ノルムはEuclidノルムに一致してしまう．
\end{tcolorbox}

\begin{proposition}[その他の冪級数]\mbox{}
    \begin{enumerate}
        \item $\log(E+X):=\sum_{p=1}^\infty(-1)^{p-1}\frac{1}{p}X^p$は$\Sp(X)\subset\Delta$ならば収束する．
        \item $(E-X)^{-1}=\sum^\infty_{p=0}X^p$は$\Sp(X)\subset\Delta$ならば収束する．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    これにより，解素$R_A:\C\to M_n(\C)$を$(zI-A)^{-1}$として定義出来る．
    ここから，一般の正則関数$f:\C\to\C$に対して，延長$f:M_n(\C)\to M_n(\C)$を
    \[f(A)=\frac{1}{2\pi i}\int_Cf(z)R_A(z)dz=\frac{1}{2\pi i}\int_C\frac{f(z)dz}{zI-A}\]
    で定めることが出来る．
\end{remarks}

\begin{theorem}\mbox{}
    \begin{enumerate}
        \item 零でない連続写像$\rho:\GL_n(\R)\to\R$が群準同型性$\rho(XY)=\rho(X)\rho(Y)$を満たすならば，$\exists_{s\in\R}\;\rho(X)=\abs{\det(X)}^s$または$\rho(X)=\sgn(\det(X))\abs{\det}^s$．
        \item 零でない連続写像$\rho:\GL_n(\C)\to\C$が群準同型性$\rho(XY)=\rho(X)\rho(Y)$を満たすならば，$\exists_{k\in\Z}\;\exists_{s\in\R}\;\rho(X)=e^{ik\arg(\det X)}\abs{\det X}^s$．
    \end{enumerate}
\end{theorem}

\chapter{半双線型形式}

\begin{quotation}
    線型空間には内積の構造が入るが，その前段階において「直交」の概念はペアリングが定めるものである．
    \begin{enumerate}
        \item 標準的なペアリング$V\otimes V^*\to K$によって，表の世界$f:V\to W$に対応する双対空間上の線型写像$f^*:W^*\to V^*$を「双対」という．
        \item 双対による$V,V^*$の同一視に加えて，一般のペアリング$b:V\otimes W\to K$が定めるメイト$r_b:W\to V^*$で$f\in\End_K(V)$から$f^*\End_K(V^*)$を通じて$f^*\in\End_K(W)$に渡ることができる．
        これを\textbf{随伴}という．
        \item $K$の標数が2でない限り，対称な双線型形式と二次形式とは一対一対応する．
        後者のほうが歴史上先に出現した，直観の効く幾何学的対象である．
        $x$-行列の行列式が不変式である．
        Riemann計量の考え方もここに返ってくる．
        \item 前節で議論した最小多項式による対角化の理論に加えて，内積空間における自己共役行列は直交基底により対角化可能である．
    \end{enumerate}
\end{quotation}

\section{線型形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
    title=]
    特別な双線型形式：
    評価の定めるペアリング$\brac{-,-}:V\times V^*\to K$は必然的に非退化(有限次元のときは完全でもある)で，あらゆる(半)双線型形式の模範となる．
    このペアリングが定める「(右)直交補空間」を\textbf{零化空間}という．
    すると，再双対の手続きと再零化の手続きは一致し，ペアリングの概念が双対性を一般化するものであることが分かる．
\end{tcolorbox}

\subsection{双対空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    線型形式の全体も同次元の線型空間をなす．
\end{tcolorbox}

\begin{definition}[dual module]
    $R$-加群$M$に対して，$M^*:=\Hom_R(M,R)$は再び加群をなし，これを\textbf{双対加群}という．
\end{definition}

\begin{proposition}[双対基底の存在]
    $V\in\FVS_K$の基底$x_1,\cdots,x_n$に対して，次を満たす線型形式$f_1,\cdots,f_n\in V^*$がただ一組存在する：
    \[f_i(x_j)=\delta_{ij}.\]
    これは$V^*$の基底をなし，特に$\dim V^*=n$．
\end{proposition}

\begin{proposition}[双対基底の特徴付け]
    $V\in\FVS_K$とする．線型形式$f_1,\cdots,f_n\in V^*$について，次の３条件は同値である．
    \begin{enumerate}
        \item $f_1,\cdots,f_n$は$V^*$の基底である．
        \item 積写像$(f_1,\cdots,f_n):V\to K^n$は線型同型．
        \item $x_1,\cdots,x_n$を$V$の基底とすると，行列$A=(f_i(x_j))\in M_n(K)$は可逆である．
    \end{enumerate}
\end{proposition}

\subsection{零化と被零化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $V,V^*$の間には部分空間の対応が存在する．
    これは，標準的なペアリング（評価）がもたらす対応である．
\end{tcolorbox}

\begin{proposition}[annihilator, annihilated]
    $V$を線型空間，$V^*$をその双対空間とする．
    \begin{enumerate}
        \item $W\subset V$に対して，
        \[W^\bot:=\{f\in V^*\mid f(W)=0\}=\bigcap_{x\in W}\Ker\ev_x\]
        は$V^*$の部分空間である．これを\textbf{零化空間}という．
        \item $W\subset V^*$に対して，
        \[W^\top:=\{x\in V\mid f\in W\Rightarrow f(x)=0\}=\bigcap_{f\in W}\Ker f\]
        は$V$の部分空間である．これを\textbf{被零化空間}という．
    \end{enumerate}
\end{proposition}

\begin{lemma}[基底の対応]
    $V\in\FVS_K$とする．
    \begin{enumerate}
        \item 部分空間$W\subset V$の基底$x_1,\cdots,x_m$を延長して得られる$V$の基底$x_1,\cdots,x_n$に対応する$V^*$の双対基底$f_1,\cdots,f_n$のうち，$f_{m+1},\cdots,f_n$が$W^\perp$の基底になる．
        特に，$\dim W^\perp=\dim V-\dim W$．
        \item 部分空間$W\subset V^*$の基底$f_1,\cdots,f_m$を延長して得られる$V^*$の基底$f_1,\cdots,f_m$に対応する$V$の基底$x_1,\cdots,x_n$のうち，$x_{m+1},\cdots,x_n$が$W^\top$の基底である．
        $\dim W^\top=\dim V-\dim W$．
    \end{enumerate}
\end{lemma}

\begin{corollary}[TVSでは再零化空間は元に戻る]
    $V\in\FVS_K$とする．
    \begin{enumerate}
        \item $\forall_{W\in S(V)}\;W=(W^\perp)^\top$．
        \item $\forall_{W\in S(V^*)}\;W=(W^\top)^\perp$．
    \end{enumerate}
\end{corollary}

\begin{proposition}[双対空間の零化空間への分解]\label{prop-annihilator-space-and-direct-sum}
    $W,W'\subset V\in\Vect$を部分空間とする．
    \begin{enumerate}
        \item $W^\bot\cap W'^\bot=(W+W')^\bot$．
        \item $W^\bot+W'^\bot=(W\cap W')^\bot$．
        \item $V=W\oplus W'$ならば，$V^*=W^\bot\oplus W'^\bot$．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    零化，被零化の操作は$\cap$を$+$に対応させる．
\end{remarks}

\subsection{再双対空間}

\begin{lemma}[再双対空間の基底の対応]\label{prop-eV-is-monic}
    $V\in\Vect_K$とする．
    \begin{enumerate}
        \item $\ev_x:V^*\to K$は線型写像である．
        \item $e_V:V\to V^{**};x\mapsto \ev_x$は線型写像である．
        \item $V$の基底$x_1,\cdots,x_n$の双対基底$f_1,\cdots,f_n\in V^*$の双対基底は$e_V(x_1),\cdots,e_V(x_n)\in V^{**}$である．
        \item $e_V:V\to V^{**}$は単射である．$V$が有限次元ならば可逆である．
    \end{enumerate}
\end{lemma}

\begin{corollary}\label{cor-biannihilator-subspace}
    $W\subset V\in\Vect$を部分空間とする．
    \begin{enumerate}
        \item $W=e_V^{-1}((W^\bot)^\bot)$，$W=(W^\bot)^\top$．
        \item $V$が有限次元ならば，同型$e_V:V\to V^{**}$は同型$W\to(W^\bot)^\bot$を引き起こす．
    \end{enumerate}
\end{corollary}
\begin{remarks}
    主張$W=(W^\perp)^\top$が一般の次元でも成り立つことが主な主張である．
    有限次元の場合，これは$(W^\top)^\top$に同型になる．
\end{remarks}

\section{双対写像と転置}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    双対空間の間の基底の対応を見たが，今度は写像の対応を見る．
    すると，線型写像の双対は逆向きの線型写像であり，この間の対応が$*$-作用素である．
\end{tcolorbox}

\subsection{双対写像}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    反変関手$-^*:=\Hom(-,K)$を$*$-作用素として，$\End(V)\simeq\End(V^*)$は$*$-代数をなす．$M_n(K)$とみると，これは転置作用素である．
\end{tcolorbox}

\begin{proposition}[dual mapping]
    $f:V\to W$を$K$-線型写像とする．
    \begin{enumerate}
        \item $g\in W^*$を線型形式$g\circ f:V\to K$に写す写像$f^*:W^*\to V^*$は線型写像である．これを\textbf{双対写像}という．
        \item この対応$-^*:\Hom(V,W)\to\Hom(W^*,V^*)$は反変Hom関手$-^*=\Hom(-,K)$に他ならない．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    命題\ref{prop-Hom-sets-are-linear-spaces}として一般的に示せる．
\end{Proof}

\begin{proposition}[$\Hom(-,K)$は反変関手である]\mbox{}\label{prop-Hom-K-is-contravariant}
    \begin{enumerate}
        \item $V$を線型空間とすると，$\id^*_V=\id_{V^*}$である．
        \item 線型写像$f,g:V\to W,a\in K$に対し，$(f+g)^*=f^*+g^*$，$(af)^*=af^*$．
        \item 線型写像$f:U\to V,g:V\to W$に対し，$(g\circ f)^*=f^*\circ g^*$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $\id^*_V:V^*\to V^*$は線型形式に$\id_V$を合成する関手で，$\id_{V^*}$に等しい．
        \item[2.] 結局双対写像が線型写像である理由と同じ理由でこの関手性が成り立つ．$h\in W^*$に対して$f+g$を合成させるのと，$f,g$を別々に合成させて話を取るのは等しい．$af$を右から合成するのと，$f$を合成して$a$倍するのとは可換である．
        \item[3.] $h\in W^*$とすると，$h\circ(g\circ f)=(h\circ g)\circ f=(g^*(h))\circ f=f^*(g^*(h))$．
    \end{description}
\end{Proof}

\subsection{双対写像と表現行列の転置}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    線型写像の双対とは，行列の転置に等しい．
\end{tcolorbox}

\begin{proposition}[双対写像の行列表示は転置行列]\label{prop-matrix-representation-of-dual-map}
    $V,W\in\FVS$とし，$B=(x_1,\cdots,x_n),B'=(y_1,\cdots,y_m)$を$V,W$の基底，
    $B^*=(f_1,\cdots,f_n),B'^*=(g_1,\cdots,g_m)$をそれぞれの双対基底とする．
    \begin{enumerate}
        \item $n=m$とし，$f:V\to W$を$x_1,\cdots,x_n$と$y_1,\cdots,y_n$とが定める同型とする．この時，双対写像$f^*:W^*\to V^*$は$g_1,\cdots,g_n$を$f_1,\cdots,f_n$に写す同型である．
        \item $f:V\to W$を線型写像とする．$f$の$B,B'$に関する行列表示を$A\in M_{mn}(K)$とする．双対写像$f^*:W^*\to V^*$の双対基底$B'^*,B^*$に関する行列表示は，転置${}^t\!A\in M_{nm}(K)$である．
    \end{enumerate}
\end{proposition}

\begin{corollary}
    $V\in\Vect$とし，$B=(x_1,\cdots,x_n),B'=(x'_1,\cdots,x'_n)$を$V$の基底とする．$P\in\GL_n(K)$を$B$から$B'$への底の変換行列とすると，
    双対基底$B^*$から$B'^*$への底の変換行列は${}^tP^{-1}$である．
\end{corollary}

\subsection{双対写像の核・像の零化による表示}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Hilbでは，$T\in B(H)$について(1)は引き続き成り立つが，(2)は$(\Ker T)^\perp=\oo{\Im T^*}$までしか成り立たない．
    一方でFVSでは双対の言葉によって，単射性・全射性が特徴付けられる．
\end{tcolorbox}

\begin{proposition}[双対写像の核と像]\label{prop-dual-map-in-terms-of-annihilator}
    $f:V\to W$を線型写像，$f^*:W^*\to V^*$を双対写像とする．
    \begin{enumerate}
        \item $\Ker f^*=(\Im f)^\bot$．
        \item $\Im f^*=(\Ker f)^\bot$．
    \end{enumerate}
\end{proposition}

\begin{corollary}
    $k$を体とする．$\varphi:V\to W$を$k$-線型空間の間の線型写像とし，$\varphi^*:W^*\to V^*$をその双対写像とする．
    この時，
    \begin{enumerate}
        \item $\varphi$が単射であることは，$\varphi^*$が全射であることと同値である．
        \item $\varphi$が全射であることは，$\varphi^*$が単射であることと同値である．
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $0\to\Ker\varphi\to V\to W\to\Coker\varphi\to 0$は完全列である．
        \item $k$は$k$加群として入射的．即ち，関手$\Hom(-,k)$は完全となる．
        \item $0\to(\Coker\varphi)^\vee\to W^\vee\to V^\vee\to(\Ker\varphi)^\vee\to 0$は完全列である．
    \end{enumerate}
\end{Proof}

\begin{corollary}[直交と双対]\label{cor-duality-of-dual-map}
    $V,W\in\Vect_K$，$f:V\to W$を線型写像とする．
    \begin{enumerate}
        \item $f$が定める全射$p:V\to \Im f$の双対$p^*$は同型$(\Im f)^*\to\Im(f^*)$を定める．
        特に，$f,f^*$の階数は一致する．
        \item $V=W\oplus W'$とし，$p:V\to W,p':V\to W'$を射影とする．この時，$p^*,p'^*$は，同型$W^*\to W'^\bot,W'^*\to W^\bot$を定める．したがって，$p^*\oplus p'^*:W^*\oplus W'^*\iso V^*$．
    \end{enumerate}
\end{corollary}

\subsection{部分空間・商空間の双対}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    \begin{enumerate}
        \item 部分空間の双対空間は，双対空間の零化空間による商空間と同型である．
        \item 商空間の双対空間は，零化空間と同型である．
    \end{enumerate}
\end{tcolorbox}

\begin{proposition}[零化空間は包含写像の双対の核かつ商写像の双対の像]\label{prop-fundamental-theorem-of-dual-maps}
    $V\in\Vect_K$とし，$W$を部分空間とする．$W$の零化空間$W^\bot$について，次が成り立つ．
    \begin{enumerate}
        \item 包含写像$i:W\to V$の双対写像$i^*:V^*\to W^*$は，同型$V^*/W^\bot\to W^*$を引き起こす．
        特に，$\Ker i^*=W^\perp$．
        \item 標準全射$p:V\to V/W$の双対写像$p^*:(V/W)^*\to V^*$は同型$(V/W)^*\to W^\bot$を定める．
        特に，$\Im p^*=W^\perp$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 系\ref{cor-duality-of-dual-map}より$i^*$は全射であり，その核が$W^\bot$であるから，これに準同型定理を適用すれば良い．
        \item 命題\ref{prop-universality-of-quotient-spaces}より，$p^*$の像は$W$を潰す線型形式$f(W)=0$からなる集合$W^\bot$であり，またその対応$p^*$は単射であるから．
    \end{enumerate}
\end{Proof}

\subsection{双対写像の代数的性質}

\begin{proposition}
    $V\in\FVS_K$，$f\in\End_K(V)$について，
    \begin{enumerate}
        \item $f,f^*$で固有多項式は一致する．
        \item $f,f^*$で最小多項式も一致する．
        \item $V=\wt{V}_{a_1}\oplus\cdots\oplus\wt{V}_{a_r}$を$f$に沿った$V$の一般固有空間分解とする．
        $f^*$に沿った$V^*$の一般固有空間分解は$V^*=\wt{V^*}_{a_1}\oplus\cdots\oplus\wt{V^*}_{a_r}$が与える．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 一般に$\det(X-A)=\det(X-{}^t\!A)$であるため．
        \item 任意の多項式$F\in K[X]$に対して，$F({}^t\!A)={}^t\!F(A)$であるため．
        \item 
    \end{enumerate}
\end{Proof}

\section{線型写像の空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $V^*=\Hom(V,K)$に注目したが，多くの重要な性質は一般の$\Hom(V,W)$において成り立つ．
\end{tcolorbox}

\subsection{作用素の空間の間の射}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $*$-作用素$\Hom(-,K)$だけでなく，一般のHom作用素$\Hom(-,-)$を考える．
\end{tcolorbox}

\begin{proposition}[Vectは豊穣圏]
    $\Hom_K(V,W)=\{f\in W^V\mid fは線型写像\}$は$K$-線型部分空間である．
\end{proposition}

\begin{proposition}[Hom作用素のwell-definedness]\label{prop-Hom-sets-are-linear-spaces}
    $V,V',W,W'\in\Vect_K$とする．
    \begin{enumerate}
        \item 線型写像$g:W\to W'$が定める共変Hom関手$g_*:\Hom(V,W)\to\Hom(V,W')$は再び線型写像である$g_*\in\Vect_K$．
        \item 線型写像$h:V'\to V$が定める共変Hom関手$h^*:\Hom(V,W)\to\Hom(V',W)$は再び線型写像である$h^*\in\Vect_K$．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    2を示す．$f,g\in\Hom_{\Vect_K}(V,W),a\in K$とする．
    \begin{align*}
        h^*(f+g)&=(f+g)\circ h=f\circ h+g\circ h=h^*(f)+h^*(g)\\
        h^*(af)&=(af)\circ h=a(f\circ h)=a\cdot h^*(f)
    \end{align*}
    が成り立つのは，結局$x\in V'$について，
    \begin{align*}
        (f+g)\circ h(x)&=(f+g)(h(x))=f(h(x))+g(h(x))=(f\circ  h+g\circ h)(x)\\
        (af)\circ h(x)&=(af)(h(x))=a\cdot f(h(x))=a\cdot (f\circ h)(x)
    \end{align*}
    だからである．
\end{Proof}


\begin{proposition}[直和分解が引き起こすHom空間の直交分解]\label{prop-characterization-of-direct-sum}
    $V,W\in\Vect_K$について，
    \begin{enumerate}
        \item $i_1:V_1\to V,i_2:V_2\to V$を包含とする．このとき，$i^*_1\oplus i^*_2:\Hom(V_1\oplus V_2,W)\iso\Hom(V_1,W)\oplus\Hom(V_2,W)$は線型同型．
        \item $p_1:W\to W_1,p_2\to W_2$を$W=W_1\oplus W_2$を定める射影とする．このとき，$p_{1*}\oplus p_{2*}:\Hom(V,W_1\oplus W_2)\iso\Hom(V,W_1)\oplus\Hom(V,W_2)$．
    \end{enumerate}
\end{proposition}

\subsection{完全系列のHom関手による特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    完全系列をHom関手の言葉で特徴付けると，
    驚くべきことが証明できる．これが私が求めていたものである．
\end{tcolorbox}

\begin{proposition}[完全系列の普遍性]\label{proposition-universality-of-exact-sequence}
    線型写像の列$V'\xrightarrow{f}V\xrightarrow{g}V''$について，次の４条件は全て同値である．
    \begin{enumerate}
        \item $V'\xrightarrow{f}V\xrightarrow{g}V''$は完全系列である．
        \item 任意の$K$-線型空間$W$に対し，$\Hom(W,V')\xrightarrow{f_*}\Hom(W,V)\xrightarrow{g_*}\Hom(W,V'')$は完全系列である．
        \item 任意の$K$-線型空間$W$に対し，$\Hom(V'',W)\xrightarrow{g^*}\Hom(V,W)\xrightarrow{f^*}\Hom(V',W)$は完全系列である．
        \item $V''^*\xrightarrow{g^*}V^*\xrightarrow{f^*}V'^*$は完全系列である．
    \end{enumerate}
\end{proposition}


\begin{lemma}
    $K$を体とし，$f:V\to W$を$K$-線型空間の間の線型写像とする．このとき，任意の$K$-線型空間$Z$に対して，
    \begin{enumerate}
        \item $f:V\to W$が単射であることは，$f^*:\Hom_K(W,Z)\to\Hom_K(V,Z)$が全射であることと同値である．
        \item $f:V\to W$が全射であることは，$f^*:\Hom_K(W,Z)\to\Hom_K(V,Z)$が単射であることと同値である．
        \item $f:V\to W$が単射であることは，$f_*:\Hom_K(Z,V)\to\Hom_K(Z,W)$が単射であることと同値である．
        \item $f:V\to W$が全射であることは，$f_*:\Hom_K(Z,V)\to\Hom_K(Z,W)$が全射であることと同値である．
    \end{enumerate}
\end{lemma}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.,2.] 線型写像$f:V\to W$について，次の系列
        \begin{equation}
            \xymatrix@1
            {
            0\ar[r]&\Ker f\ar[r]&V\ar[r]^-f&W\ar[r]&\Coker f\ar[r]&0
            }
            \label{eq-1}
        \end{equation}
        が完全であることと，
        \[\xymatrix@1{
            0\ar[r]&\Hom_K(\Coker f,Z)\ar[r]&\Hom_K(W,Z)\ar[r]^-{f^*}&\Hom_K(V,Z)\ar[r]&\Hom_K(\Ker f,Z)\ar[r]&0
        }\]
        が完全であることとは同値であることから従う．
        \item[3.,4.] 系列\ref{eq-1}が完全であることと，
        \[\xymatrix@1{
            0\ar[r]&\Hom_K(Z,\Ker f)\ar[r]&\Hom_K(Z,V)\ar[r]^-{f_*}&\Hom_K(Z,W)\ar[r]&\Hom_K(Z,\Coker f)\ar[r]&0
        }\]
        が完全であることとは同値であることから従う．
    \end{description}
\end{Proof}

\begin{corollary}[同型の普遍性]\label{cor-characterization-of-isomorphism}
    線型写像$f:V\to W$に対し，次の条件は同値．
    \begin{enumerate}
        \item $f$は同型．
        \item 任意の線型空間$W'$に対し，$f^*:\Hom(W,W')\to\Hom(V,W')$は同型．
        \item 任意の線型空間$V'$に対し，$f_*:\Hom(V',V)\to\Hom(V',W)$は同型．
    \end{enumerate}
\end{corollary}

\section{双線型形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    半双線型形式は双線型形式$V\otimes V'\to K$に他ならないので，まずは一般の$V\otimes W\to K$を考える．
\end{tcolorbox}

\subsection{双線型形式の定義と行列表示}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    双線型形式の行列表示は，$K^n$上の標準的なペアリング$\brac{-,-}$を通じて，
    $b(-,-)=\brac{-,A-}$で与えられる．
\end{tcolorbox}

\begin{definition}
    $V,W\in\Vect_K$について，
    \begin{enumerate}
        \item テンソル積上の線型形式$b:V\otimes W\to K$を\textbf{双線型形式}という．
        \item カリー化$r_b:W\to V^*,l_b:V\to W^*$を\textbf{メイト}といい，それぞれの核$\Ker r_b,\Ker l_b$を右・左\textbf{根基}という．
        \item 右・左根基が$0$である，すなわちメイト$r_b,l_b$が単射であるとき，\textbf{非退化}であるという．環上の加群については\textbf{単模}であるという．
        \item メイト$r_b:W\to V^*$が同型を定めるとき，$b$は\textbf{完全なペアリング}であるという．有限次元線型空間の間の評価が定めるペアリングは完全である．
    \end{enumerate}
\end{definition}

\begin{definition}[双線型形式の行列表示]\label{def-matrix-representation-of-bilinear-forms}
    双線型形式$b:V\times W\to K$の，
    基底$x_1,\cdots,x_m\in V$と$y_1,\cdots,y_n\in W$に関する\textbf{行列表示}とは，
        \[(b(x_i,y_j))_{1\le i\le m\\1\le j\le n}=\begin{pmatrix}b(x_1,y_1)&\cdots&b(x_1,y_n)\\\vdots&\ddots&\vdots\\b(x_m,y_1)&\cdots&b(x_m,y_n)\end{pmatrix}\in M_{mn}(K)\]
        を指す．$W$の成分表示$K^n$が右から作用出来るようになっている．
        すなわち，$b_A:=(x,Ay)$について，次の図式が可換になる：
        \[\xymatrix{
            K^n\times K^m\ar[r]^-{b_A}\ar[d]_-{x\times y}&K\ar[d]^-{\id_K}\\
            V\times W\ar[r]_-b&K
        }\]
        すなわち，次が成り立つ：
        \[\forall_{x\in K^n,y\in K^m}\quad b(g(x),g'(y))=b_A(x,y)={}^t\!xAy.\]
\end{definition}
\begin{remarks}
    添字規則は通常の行列$(a_{ij})$と同様．すると第二引数である$W$の成分ベクトルが右から作用するようになる．
\end{remarks}

\begin{proposition}[行列表示との全単射対応]
    $V,W\in\FVS_K$とする．
    次の写像は可逆である：
        \[\xymatrix@R-2pc{
            \{b\in K^{V\times W}\mid b:V\times W\to Kは双線型形式\}\ar[r]&M_{mn}(K)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            b_A\ar@{|->}[r]&A
        }.\]
    これにより，任意の双線型形式は，標準的内積との類推から$\brac{-,-}:V\times W\to K$を表すことが示唆される．
\end{proposition}

\subsection{双線型形式の基底変換}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    基底変換$x'=xP,y'=yQ$について，$b_A(-,-)=\brac{P-,AQ-}=\brac{-,{}^t\!PAQ-}$と変換される．
\end{tcolorbox}

\begin{proposition}[双線型形式の変換]
    $b:V\times W\to K$を双線型形式とする．
    $V$の基底$B=(x_1,\cdots,x_m)$から$B'=(x_1',\cdots,x_m')$への底の変換行列を$P\in\GL_m(K)$とし，
    $W$の基底$D=(y_1,\cdots,y_n)$から$D'=(y_1',\cdots,y_n')$への底の変換行列を$Q\in\GL_n(K)$とする．
    $B,D$に関する$b$の行列表示を$A$とし，$B',D'$に関する$b$の行列表示を$A'$とすると，$A'={}^t\!PAQ$である．
\end{proposition}
\begin{Proof}
    $B,D$に関する行列表示
    $A:W\to V^*$を用いて，$b=(-,A-)$と表せる．基底変換$y'=yQ,x'=xP$を考えると，
    $B',D'$に関する行列表示は$b=(P-,AQ-)=(-,{}^t\!PAQ-)$．
\end{Proof}

\subsection{線型写像としての双線型形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    双線型形式は元々テンソル積上の線型形式であるが，双対空間の概念によっても線型写像とみなせる．
    双線型形式$b:V\times W\to K$について，左右のメイトの行列表示は互いに転置になる．
    これは，$b^*(x,y):=\o{(y,x)}$を「共役」と呼ぶことに対応する．
\end{tcolorbox}

\begin{proposition}[双線型形式の行列表示の特徴付け]\label{prop-characterization-of-matrix-representation-of-bilinar-form}
    $b:V\times W\to K$を双線型形式とする．
    \begin{enumerate}
        \item 写像$r_b(y):V\to K$は線型形式である．
        \item $r_b:W\to V^*$は線型写像である．
        \item $V,W\in\FVS_K$とする．$B=(x_1,\cdots,x_m),B'=(y_1,\cdots,y_n)$をそれぞれ$V,W$の基底とし，$B^*=(f_1,\cdots,f_m)$を双対基底とする．$b$の$B,B'$に関する行列表示は，線型写像$r_b:W\to V^*$の基底$B',B^*$に関する行列表示に等しい．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    (3)を示す．$r_b$の$B',B^*$-行列表示を$A$とする：
    \[(r_b(y_1)\;\cdots\;r_b(y_n))=(f_1\;\cdots\;f_m)A.\]
    このことは，
    \[b(x_i,y_j)=r_b(y_j)(x_i)=a_{1j}f_1(x_i)+\cdots+a_{mj}f_m(x_i)=a_{ij}\]
    に同値．
\end{Proof}

\subsection{随伴と行列の転置}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $V,W\in\FVS_K$上に非退化なペアリング$b:V\times W\to K$が与えられているとき，
    メイト$r_b:W\to V^*$を通じて，
    任意の自己同型$f\in\End_K(V)$に対して，双対写像$f^*\in\End_K(V^*)$の延長
    $f^*:W\iso V^*\to V^*\iso W$を定める．
    これを\textbf{(右)随伴}という．
    これは，$b(f(x),y)=b(x,f^*(y))$を意味する．特に$V=W=K^n$のとき，随伴対応${}^t\!:M_n(K)\to M_n(K)$は\textbf{転置}である．
\end{tcolorbox}

\begin{definition}[right adjoint]
    $V,W\in\Vect_K$とし，$b:V\times W\to K$を$W$上で非退化な双線型形式とする．
    このとき，$r_b:W\to V^*$は単射だから，
    $f\in\End_K(V)$に対して唯一の$g\in\End_K(W)$が対応して次の図式を可換にする．
    \[\xymatrix{
            W\ar[r]^-{r_b}\ar[d]_-g&V^*\ar[d]^-{f^*}\\
            W\ar[r]^-{r_b}&V^*
        }\]
    $g$は$f$の\textbf{右随伴写像}という．$g$のことも$f^*$で表す．
\end{definition}

\begin{proposition}[随伴写像の行列表示]
    $V,W\in\FVS$，$b:V\times W\to K$を非退化な双線型形式とする．このとき，$\dim V=\dim W$．
    $f:V\to V$を線型写像とし，$f^*:W\to W$をその右随伴写像とする．
    $B,B'$をそれぞれ$V,W$の基底とし，$B,B'$に関する$b$の行列表示を$P\in\GL_n(K)$とする．
    $f$の$B$に関する行列表示が$A\in M_n(K)$ならば，$B'$に関する随伴写像$f^*$の行列表示は，
    $P^{-1}{}^t\!AP\in M_n(K)$
    である．
\end{proposition}
\begin{Proof}
    $b$の行列表示が$P$であるから，標準的なペアリング$(-,-):K^n\times K^n\to K$について，
    \[b(f(-),-)=(A-,P-)=(-,{}^t\!AP-)=(-,P(P^{-1}{}^t\!AP)-)=b(-,f^*(-))\]
    より，$f^*$の行列表示は$P^{-1}{}^t\!AP$．
\end{Proof}

\subsection{双線型形式の非退化性}

\begin{definition}
    $b:V\otimes W\to K$を双線型形式とする．
    \begin{enumerate}
        \item $b$が\textbf{$W$上非退化}とは，
        $r_b:W\to V^*$が単射であることをいう．
        \item $b$が\textbf{非退化}とは，$V,W$いずれの上でも非退化であることをいう．
        が，この定義は$V,W\in\FVS_K$の場合に限定させられる．
    \end{enumerate}
\end{definition}

\begin{proposition}[非退化であることと完全であることは同値]
    $V,W\in\FVS_K$，$b\in(V\otimes W)^*$．
    \begin{enumerate}
        \item $\rank r_b=\rank l_b$．
        \item $\dim V=\dim W$のとき，次は同値：
        \begin{enumerate}[(a)]
            \item $b$は非退化．
            \item $b$は$W$で非退化．
            \item $V,W$の基底に関する$b$の行列表示が可逆．
            \item $l_b:V\to W^*$は同型．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $b$の行列表示$A$を一つ取ると，$\rank A=\rank A^\top$を確かめれば良い．
        \item $V,W\in\FVS_K$と仮定したために，上のような行列をとった議論が実行できる．
    \end{enumerate}
\end{Proof}

\section{内積空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $V$とその共役$V'$上の双線型形式$V\times V'\to\bF$を調べる．
    これはどこか標準的なペアリング$\brac{-,-}:V\times V^*\to\bF$に似ており，その零化空間に対応する概念を\textbf{直交}という．
    一般に双線型形式は二次形式を定めるが，半双線型形式の定める二次形式をノルムという．
\end{tcolorbox}

\subsection{半双線型形式と随伴}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Hilbert空間とは，Banach空間であって，ノルムが中線定理を満たすような空間である．

    双線型形式が関数$x^2$であるとしたら，半双線型形式がノルム$\abs{x^2}$を定める．
\end{tcolorbox}

\begin{definition}[sesquilinear form, adjoint form, self-adjoint, positive, semi-inner product, inner product]
    $\bF$-線型空間$X$について，
    \begin{enumerate}
        \item 線型形式$X\otimes X'\to\bF$を\textbf{半双線型形式}という．$\bF=\R$のとき，$X'=X$に注意．
        \item $(-|-)^*=(-|-)$を満たす半双線型形式を\textbf{自己共役}という．$\bF=\R$であるときは対称ともいう．
        \item 正定値な自己共役半双線型形式を\textbf{内積}という：$\forall_{x\in V\setminus\{0\}}\;h(x,x)>0$．
    \end{enumerate}
\end{definition}

\begin{definition}[orthonormal basis]
    非退化な自己共役形式$h:V\otimes V'\to\C$について，
    \begin{enumerate}
        \item 基底$B$に関する行列表示が単位行列になるとき，$B$を\textbf{正規直交基底}という．
        \item $f\in\End_K(V)$が$f=f^*$を満たすとき，\textbf{自己共役変換}(対称変換)という．すなわち，$\forall_{x,y\in V}\;h(f(x),y)=h(x,f(y))$．
        \item $f^*=f^{-1}$のとき，\textbf{ユニタリ変換}(直交変換)という．すなわち，$\forall_{x,y\in V}\;h(f(x),f(y))=h(x,y)$．
    \end{enumerate}
\end{definition}

\begin{proposition}
    $V$の基底$B$について，
    \begin{enumerate}
        \item 非退化自己共役形式$h:V\otimes V'\to\C$は行列表示$A$を持つ．
        \item $f\in\End_V(K)$は行列表示$C$を持つ．
    \end{enumerate}
    このとき，$f^*$の行列表示は$\o{A}^{-1}C^*\o{A}$となる．
\end{proposition}
\begin{Proof}
    共役$\o{A}$をとっているのは，メイト$r_b:V'\to V^*$が共役を含んでいるためである．
\end{Proof}

\begin{remarks}[固有ベクトルの存在の幾何学的な理解]
    半双線型形式は内積の一般化で，特に（正規化すれば）「類似度」を測っているともみれる．
    対称の場合はさらに踏み込んで（正規化すれば）「向き」のようなものを測っているとみれる．
    それが対称であるとは，任意のベクトルの組$(x,y)$に対して，引かれあうなら引かれ合う，離れあうなら離れあうと，対称な変換を施すことになる．
    したがって固有ベクトルの存在はある種の不動点定理の帰結のように理解できる．

    実固有ベクトルの存在を示したい．$\partial B$上の点に注目すれば，有限次元のときこれはコンパクトだから，
    どこかで最大値$\norm{A}=:\al\in\R_+$を取る．
    この点$x\in\partial B$について，$\al^2=(Ax|Ax)=(x|AAx)$となるから，$\al\in\R_+$が固有値であるか，$A$が向きに関して対合であるだけで
    真の固有ベクトルは$\al x+Ax$であるかである：$\al Ax+AAx=\al(Ax+\al x)$．

    また，対称形式は直交性を保存するので，固有ベクトルの中から直交基底を選び出せる．
    $x\in\partial B$を固有ベクトルとすると，その直交補空間の元$u\in (\R x)^\top$について$(Ax|u)=(x|Au)$より，$(\R x)^\top$は$A$-不変部分空間である．
    よって対称形式$b$は$(\R x)^\top$に制限できて，再びここには固有ベクトルが存在する．
\end{remarks}

\subsection{直交行列による対角化の理論}

\begin{theorem}
    $V\in\FVS_\C$，$h:V\otimes V'\to\C$を内積とする．
    集合$\S\subset\End_\C(V)$が次を満たすならば，ある$V$の正規直交基底で，$\S$の元の行列表示は全て対角行列になるものが存在する：
    \begin{enumerate}
        \item $\forall_{f,g\in\S}\;f\circ g=g\circ f$．
        \item $\forall_{f\in\S}\;f\circ f^*=f^*\circ f$．
    \end{enumerate}
\end{theorem}
\begin{Proof}まず，$S$が(1)と次の(3)を満たすならば結論を満たすことを示す．
    \begin{enumerate}[(1)]\setcounter{enumi}{2}
        \item $f\in S\Rightarrow f^*\in S$．
    \end{enumerate}
    \begin{description}
        \item[(1),(3)$\Rightarrow$結論] 
        $\dim V$に関する帰納法で示す．
        系\ref{cor-existence-of-orthogonal-basis}の対称形式の場合と同様，$V$の直交基底が存在し，これを正規化できる．
        $\dim V\le 1$の時，$S$の元は全てスカラー倍写像であるから，その元の行列表示は全て対角写像である．
        $\dim >2$とする．$f\in S$はスカラー倍でないとすると，$f$のある固有値$a\in\C$について，$W=V_a$を固有空間とすれば，$0\subsetneq W\subsetneq V$である．
        今，$W^\perp$を$W$の直交とすると，任意の$g\in S$について，$W,W^\perp$は$g$-安定だと示す：$\forall g\in S,\;g(W)\subset W,g(W^\perp)\subset W^\perp$．
        \begin{quotation}
            $x\in W,g\in S$とすると，(1)より$f\circ g=g\circ f$だから，$f(g(x))=g(f(x))=g(ax)=ag(x)$より，$g(x)\in W$である．

            $x\in W^\perp,g\in S$とすると，(3)より$g^*\in S$だから，(1)より同様にして，任意の$y\in W$について$g^*(y)\in W$．
            よって，$\forall y\in W,\;h(g(x),y)=h(x,g^*(y))=0$だから，$g(x)\in W^\perp$．
        \end{quotation}
        $\dim W,\dim W^\perp<\dim V$だから，帰納法の仮定より，$W$の基底と$W^\perp$の基底で，それに関する$f\in S$の行列表示が全て対角行列になるようなものが存在する．
        此処で，正定値なHermite形式$h$は非退化で，
        $W$への制限も非退化だから，命題\ref{prop-decomposition-along-orthogonal-space}.1より，$V=W\oplus W^\perp$．
        よって，$W$の基底と$W^\perp$の基底とを並べれば良い．
        \item[命題の(3)を用いた証明]
        $S$が条件(1),(2)を満たすとする．$S^*:=\{f^*\mid f\in S\},\tilde{S}:=S\cup S^*$と置くと，$\tilde{S}$は条件(3)を満たす．
        この$\tilde{S}$は条件(1)も満たすことを示す．
        \begin{quotation}
            $f\in S$とすると，(2)より$S_f:=\{f,f^*\}$は条件(1),(3)を満たすから，$V$の正規直交基底$B$が存在して，$f$の$B$に関する行列表示が$D$となる．
            この時，$f^*$の行列表示は対角行列$D^*=\overline{D}$である．

            $a_1,\cdots,a_m\in\C$を$f$の固有値とすると，$P(a_i)=\overline{a_i}\;(i\in[m])$を満たす多項式$P\in\C[X]$が存在する（補題）．
            この$P$を用いると$P(D)=\overline{D}=D^*$だから，$P(f)=f^*$．
            従って，$g\in S$ならば，自己準同型の合成は分配則を満たすから，
            \[f^*\circ g=P(f)\circ g=g\circ P(f)=g\circ f.\]
            であるから，
            \[f^*\circ g^*=(g\circ f)^*=(f\circ g)^*=g^\circ f^*.\]
            よって，$\tilde{S}$は条件(3)も満たす．
        \end{quotation}
        従って，$\tilde{S}$は命題の結論を満たすから，その部分集合$S\subset\tilde{S}$も命題の結論を満たす．
    \end{description}
\end{Proof}

\begin{corollary}[Hermite変換は実多角化可能]
    $V\in\FVS_\C$，$h:V\otimes V'\to\C$を内積とする．
    $f\in\End_\C(V)$がHermite変換ならば，
    \begin{enumerate}
        \item $\Sp(f)\subset\R$．
        \item $V$の正規直交規定であって，$f$が実対角行列に表示されるようなものが存在する．
    \end{enumerate}
\end{corollary}

\begin{corollary}[正規行列は一斉対角化可能]
    $V\in\FVS_\C$，$h:V\otimes V'\to\C$を内積とする．
    $A_1,\cdots,A_n\in\End_\C(V)$が正規行列ならば，
    あるユニタリ行列$U\in\GL_n(\C)$が存在して，$U^{-1}A_1U,\cdots,U^{-1}A_nU$が全て対角行列となるようにできる．
\end{corollary}

\begin{remark}[実正規行列は実対角化不可能！]\mbox{}
    \begin{enumerate}
        \item 実正規行列$A\in M_n(\R)$は，ある直交行列$Q$によって，2次の正方行列$A_1,\cdots,A_m\in M_2(\R)$を用いて$Q^{-1}AQ=\diag(A_1,\cdots,A_m,a_{2m+1},\cdots,a_n)$と変形出来る．
        \item 特に$A$が直交行列であるときは，$A_1,\cdots,A_m$は回転行列，$a_{2m+1},\cdots,a_n\in\{\pm1\}$に取れる．
    \end{enumerate}
    $\R^3$の回転を表す行列は，行列式1の直交行列であるから，ある正規直交座標について
    \[Q^{-1}AQ=\begin{pmatrix}\cos\al&-\sin\al&0\\\sin\al&\cos\al&0\\0&0&1\end{pmatrix}\]
    と表せる．
\end{remark}

\subsection{可換な行列の対角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    理論を別の観点から特殊化してみたい．
    交換可能な自己準同型には共通の固有ベクトルが存在し，そこを起点に共通の三角化する正規直交基底を編み上げることができる．
\end{tcolorbox}

\begin{theorem}[可換な線形変換に対して空間上で起こっている消息]
    $n$次元複素内積空間$V\in\FVS_\C$上の互いに可換な線型自己同型$T,S\in\GL(V)$については，
    \begin{enumerate}
        \item $T,S$は共通の固有ベクトルを持つ．
        \item $T$-不変かつ$S$-不変な部分空間のみを用いて，$0$から$V$まで次元が1ずつ増えていく部分空間の増大列$0=W_0\subset W_1\subset\cdots\subset W_{n-1}\subset W_n=V$が取れる．
    \end{enumerate}
    よって，Schmidtの直交化より，共通の正規直交基底を用いて三角化される．
\end{theorem}

\begin{corollary}[正規性の対角化可能性による特徴付け]
    正方行列$A\in M_n(\C)$について，
    \begin{enumerate}
        \item $U^{-1}AU$が上三角行列になるようなユニタリ行列$U$が存在する．
        \item $A,B$が交換可能ならば，$A+B$の固有値は$A,B$の固有値の和になり，$AB$の固有値はそれぞれの積になる．
        \item 次の2条件は同値である：
        \begin{enumerate}[(a)]
            \item $A$は正規直交基底によって対角化可能である．
            \item $A$は正規である．
        \end{enumerate}
    \end{enumerate}
\end{corollary}

\begin{corollary}[スペクトル定理の系]
    $T\in\End_\bF(V)$を正規変換とする．
    \begin{enumerate}
        \item $T$がエルミートであることと，固有値が全て実数であることとは同値．
        \item $T$がユニタリであることと，固有値が全て絶対値1であることは同値．
    \end{enumerate}
\end{corollary}

\subsection{実対称行列の特徴付け}

\begin{theorem}
    対称変換$T\in\End(V)$の相異なる固有値を$\beta_1,\cdots,\beta_k$とし，対応する固有空間を$W_1,\cdots,W_k$とする．
    \begin{enumerate}
        \item $W_1,\cdots,W_k$は互いに直交する．
        \item $V=W_1\oplus\cdots\oplus W_k$．
    \end{enumerate}
\end{theorem}

\begin{corollary}
    次の２条件は同値．
    \begin{enumerate}
        \item $T\in\End(V)$は適当な正規直交基底に関して対角行列で表せる．
        \item $T\in\End(V)$は対称変換である．
    \end{enumerate}
    特に，実正方行列$A$について，次の２条件は同値．
    \begin{enumerate}
        \item 直交行列$P$が存在して，$P^{-1}AP$は対角行列になる．
        \item $A$は対称行列である．
    \end{enumerate}
\end{corollary}

\subsection{内積空間における正規直交基底の存在}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    実対称形式は，正定値ではないどころか，非退化ではなくとも，直交基底が存在する．
\end{tcolorbox}

\begin{definition}[orthogonal]
    $b:=(-|-):X\times X\to\bF$を半双線型形式とする．
    \begin{enumerate}
        \item 部分集合$Y\subset X$について，$Y^\perp:=\Brace{x^\perp\in X\mid x^\perp\perp Y}$を\textbf{直交}という．$Y^\perp$は閉部分空間である．
        \item 全空間の直交$X^\perp$を$(-|-)$の\textbf{根基}または\textbf{核}といい，任意の直交の部分空間である．
    \end{enumerate}
\end{definition}

\begin{lemma}[直交が補空間を与えることは非退化であることに同値]\label{prop-decomposition-along-orthogonal-space}
    $V\in\FVS$とし，$b$をその上の対称形式とする．$W\subset V$を部分空間とし，$b_W:W\times W\to K$をそこへの制限とする．
    \begin{enumerate}
        \item 次の３条件は同値．
        \begin{enumerate}[(1)]
            \item $b_W$は非退化である．
            \item $V=W\oplus W^\perp$．
            \item $W\cap W^\perp=0$．
        \end{enumerate}
        特に，$b$が非退化であることは，$V^\perp=0$によって特徴付けられる．
        \item $b$が非退化ならば，$\dim V=\dim W+\dim W^\perp$．
    \end{enumerate}
\end{lemma}

\begin{corollary}[正規直交基底の存在]\label{cor-existence-of-orthogonal-basis}
    $V\in\FVS$とし，$b$をその上の対称形式とする．
    \begin{enumerate}
        \item $W$を$V$の部分空間とし，$W^\perp$をその直交とする．$b,b_W$がいずれも非退化ならば，$b_{W^\perp}$も非退化である．
        \item $K$の標数が$2$でなければ，$b$の直交基底が存在する．
        \item 準同型定理：$V=W\oplus W'$かつ$W'\subset V^\perp$とすると，次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item $b_W$が非退化．
            \item $W'=V^\perp$．
        \end{enumerate}
    \end{enumerate}
\end{corollary}

\subsection{対称形式の符号数による分類}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    対称行列は対角化可能で，実固有値が$n$個定まる．
    この符号の組は不変である．言い換えれば，
    $\FVS_\R$上の対称形式＝$\R$の二次形式には，
    符号数が定まる．
\end{tcolorbox}

\begin{proposition}[直交基底とlaw of inertia]
    $V\in\FVS_\R$とし，$b$をその上の対称形式とする．
    \begin{enumerate}
        \item $b$に関する直交基底$x_1,\cdots,x_n$であって，$b(x_i,x_i)\in\{0,\pm 1\}\;(i\in[n])$を満たすものが存在する．
        \item (慣性律) $x_1,\cdots,x_n$と$y_1,\cdots,y_n$を$b$に関する直交基底であって，
        \begin{align*}
            b(x_i,x_i)&=\begin{cases}
                1&1\le i\le rのとき,\\
                -1&r<i\le r+sのとき,\\
                0&r+s<i\le nのとき,
            \end{cases}\\
            b(y_i,y_i)&=\begin{cases}
                1&1\le i\le r'のとき,\\
                -1&r'<i\le r'+s'のとき,\\
                0&r'+s'<i\le nのとき,
            \end{cases}
        \end{align*}
        を満たすものとする．このとき，$r=r',s=s'$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 系\ref{cor-existence-of-orthogonal-basis}.2より，直交基底$x_1,\cdots,x_n\in V$が存在する．$b(x_i,x_i)\ne 0$なる$i\in[n]$に対して，$x_i$を$\frac{x_i}{\sqrt{|b(x_i,x_i)|}}$で置き換えれば良い．
        \item $V$の部分空間を次のように定める．\begin{align*}
            V_+&=\langle x_1,\cdots,x_n\rangle,&V_-&=\langle x_{r+1},\cdots,x_{r+s}\rangle,&V_0&=\langle x_{r+s+1},\cdots,x_n\rangle\\
            V'_+&=\langle y_1,\cdots,y_n\rangle,&V'_-&=\langle y_{r+1},\cdots,y_{r+s}\rangle,&V'_0&=\langle y_{r+s+1},\cdots,y_n\rangle
        \end{align*}
        系\ref{cor-existence-of-orthogonal-basis}.3より，$V_+\oplus V_-$と$V'_+,V'_-$上で$b$は非退化だから，
        $V_0=V'_0=V^\perp$．従って，$\dim V_++\dim V_-=\dim V'_++\dim V'_-=\dim V-\dim V^\perp$．
        
        今，$V_+\supset V_+\cap(V'_-\oplus V^\perp)=0$である．何故なら，この元$x\in V_+\cap(V'_-\oplus V^\perp)$は$x\in V_+$より$b(x,x)\ge 0$で，$x\in V'_-\oplus V^\perp$より$b(x,x)\le 0$なので，$b(x,x)=0$よって$x\in\Ker b=0$である．
        同様に$V_-\supset V_-\cap(V'_+\oplus V^\perp)=0$であるから，
        \begin{align*}
            \dim V_++\dim V'_-&\le\dim V-\dim V^\perp,&\dim V'_++\dim V_-&\le\dim V-\dim V^\perp
        \end{align*}
        ２式の左辺の和は$2(\dim V-\dim V^\perp)$であるから，これは等号が成り立つ．以上より，$\dim V_+=\dim V'_+,\dim V_-=\dim V'_-$
    \end{enumerate}
\end{Proof}

\begin{definition}[positive definite, negative definite, signature]
    $V\in\Vect_\R$とし，$b$をその上の対称形式とする．
    \begin{enumerate}
        \item 次が成り立つとき，$b$を\textbf{正定値}という：$\forall_{ x\in V\setminus\{0\}}\;b(x,x)>0$．$-b$が正定値であることを，\textbf{負定値}であるという．
        \item 命題の条件を満たす$b$に関する直交基底$B=(x_1,\cdots,x_n)$について，自然数の対$(r,s)\in\N^2$のことを，$b$の\textbf{符号数}という．
        \item $b$の符号数が$(r,s)$であるとは，$b$を次のように表現する$V$の基底が存在するということである：\[\begin{pmatrix}1_r&0&0\\0&-1_s&0\\0&0&0\end{pmatrix}.\]
        \item 従って，$b$が正定値とは，符号数が$(\dim V,0)$であり，$b$を単位行列に表現する$V$の基底が存在するような非退化対称形式をいう．
    \end{enumerate}
\end{definition}
\begin{remarks}
    $(n,0)$の場合はEuclid空間，$(n-1,1)$の場合をLaurentz空間という．
\end{remarks}

\subsection{二次形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    内積をノルムで表した式を極化不等式と呼んだが，これには双線型形式と二次形式との間の一般論がある．
    これが，２という数字が重要たる所以であろうか？
\end{tcolorbox}

\begin{definition}[quadratic form, quadratic refinement]\mbox{}
    \begin{enumerate}
        \item $V\in\Vect_K$上の\textbf{二次形式}とは，関数$q:V\to K$であって，２次の斉次性をもち，さらにその極化$(v,w)\mapsto q(v+w)-q(v)-q(w)$が双線型形式を定めることをいう．
        \item 双線型形式$\brac{-,-}:V\otimes V\to k$が\textbf{定める二次形式}とは，$\forall_{v,w\in V}\;\brac{v,w}=q(v,w)-q(v)-q(w)+q(0)$を満たすものをいう．\footnote{$2\in k$が可逆ならば常に存在する．}
    \end{enumerate}
\end{definition}
\begin{remark}[二次形式と双線型形式の一対一対応]\mbox{}
    \begin{enumerate}
        \item $b(x,x)=4q(x)-q(x)-q(x)=2q(x)$より，$K$の標数が２でなければ$V$の二次形式と$V$の対称形式とは一対一に対応する．
        \item 対称形式については，第一成分と第二成分で非退化になる条件が同値になるから，「非退化」の概念は退化して１つになる．
    \end{enumerate}
\end{remark}


\begin{theorem}[対称行列の対角化の二次形式の言葉による消息]
    ２次形式$F(x)=A[x]$に対し，ある直交行列$P$が存在して，$x=Py$と$A$の固有値$a_1,\cdots,a_n$に対して
    \[
        F(x)=G(y)=a_1y_1^2+a_2y_2^2+\cdots+a_ny_n^2
    \]
    が成り立つ．
\end{theorem}

\begin{definition}
    ２次形式$F(x)$の\textbf{標準形}を，$F(x)=H(z)=z_1^2+\cdots+z_p^2-z^2_{p+1}-\cdots-z^2_{p+q}$とする．ただし，$p+q$は$A$の階数である．
\end{definition}

\begin{theorem}[Sylvester's law of inertia (1852)]
    ２次形式の標準形は一意的である．
    すなわち，任意の正則な線型変換について，$p,q$は一定である．
\end{theorem}

\begin{definition}
    実対称行列，等価だが二次形式について，
    \begin{enumerate}
        \item $+1$の数$p$を\textbf{正の慣性指数}といい，$-1$の数$q$を負の慣性指数という．
        \item 組$(p,q)$を二次形式$F(x)=A[x]$の\textbf{符号}という．
        \item 差$\sgn(A):=q-p$を\textbf{符号数}という．
    \end{enumerate}
\end{definition}

\chapter{参考文献}

\bibliography{../StatisticalSciences.bib,../SocialSciences.bib,../mathematics.bib,../statistics.bib}
\begin{thebibliography}{99}
    \item
    斎藤毅 (2007) 『線形代数の世界』（東京大学出版会，大学数学の入門7）．
    \item
    伊理正夫 (1993) 『線形代数I, II』（岩波講座応用数学，基礎1）．
    \item
    斎藤正彦 (1966) 『線型代数入門』（東京大学出版会，基礎数学1）．
\end{thebibliography}

\end{document}