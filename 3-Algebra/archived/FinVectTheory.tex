\documentclass[uplatex, dvipdfmx]{jsreport}
\title{有限次元線型空間論}
\author{司馬博文}
\date{\today}
\pagestyle{headings} \setcounter{secnumdepth}{4}
\input{/Users/Hirofumi Shiba/NatureOfStatistics/preamble_no_fonts.tex}
%\input{/Users/hirofumi.shiba48/NatureOfStatistics/preamble_no_fonts.tex}
\usepackage[math]{anttor}
\begin{document}
\tableofcontents

\begin{quotation}
    線型代数の代数学の中での特殊な立ち位置が極めて不思議である．
    抽象的に定義した線型空間とその射の概念を，全て数ベクトル空間と行列の場合に引き戻して考えられると言う圏Vectの構造が，
    代数学の手法の模範とも思える．
    \begin{quote}
        抽象的な代数の面白さは，要するに目に見えるものというのは実際には複雑すぎて手に負えないんです．ところがそれを代数にしちゃえば，色々いじくることが出来るんです．
        \begin{flushright}
            広中平祐
        \end{flushright}
    \end{quote}
    そう言えば，集合代数が全てブール代数$2$の演算に引き戻されて，
    全ての「論理」がこの小数の「計算規則」に引き戻される姿は圧巻であった．あの春から，圏論に魅せられ，数学に魅せられたのであった．
    きっと\textbf{可換図式}という圏論のことばは，数学的対象の消息を代数規則に引き戻すまでを担当し，図式追跡以降の集合論的消息は\textbf{方程式}と呼ばれ，計算を司るのだろう．

    冪等性が射影の性質に相当していて，内部空間の分割の仕方に対応しているという代数と幾何の対応も見事なものである．
    線型空間は射影子があるから，位相の議論よりかはすぐに圏論的になっていく．

    そもそも行列というデータ構造が代数的技術としてあまりによくデザインされている．
    内積が基本的対象として認められたならば，その内包する双対性を縦と横という双対的なもので表される．
    すると横は双対写像としての意味を持つ．
    多重線形性は縦と横の双方について成り立つ．
    こうして双対命題を転置で行き来できる枠組みが出来上がる．

    直和が前半の，直積が後半の代数的手法の中心となる．
    基底や行列とは，直和のものを計算するための手法であるから，
    我々が書き方を恣意的に変えるだけであって，ここの要素$a_{ij}$もブロック$A_{ij}$も等しく扱って良い．

    この２点が，Hermite形式の理論において驚くべき祈りを結晶する．
    標準的な分解の理論であるとすると，線型空間は部分空間の言葉で分解する．
    線型写像は射影子の言葉でその分解を与える．
    自己準同型は一般固有空間分解を与え，さらに細かくはJordanの理論がある．
    双対空間は零化空間と非零化空間で分解すると安定する．
    対称形式が与えられた空間は直交で分解するのが標準的である．
\end{quotation}

\begin{quotation}
    行列は種々の意味で数の一般化である．
    \begin{enumerate}
        \item $M_n(\C)$，ひいては$B(H)$上で，解素を通じて複素関数論が展開出来る，
    \end{enumerate}
\end{quotation}

\chapter{有限次元線型空間とその射}


\begin{notation}\mbox{}
    \begin{enumerate}
        \item $C=\FVS_K$とする．
        \item $S(V)$で部分空間全体からなる集合を表す．これは順序集合でもあり，上限$W_1+W_2$と下限$W_1\cap W_2$について閉じた束でもある．
        \item $\S_k(V)$で$k$次元部分空間の全体を表す．
        \item 任意の対象$C$に対して，$\Aut(C)$を同型がなす群とする．
        特に線型空間$V\in\Vect_K$については，$\GL(V):=\Aut(V)$と表す．
        \item $\Bil(V):=(V\otimes V)^*$とする．$\Bil_\sa(V)$を対称型式の空間とする．
        \item $\Ses(V)=\{V\text{上の半双線型形式}V\times V\to K\}$とし，$\Ses_\sa(V):=\{V\text{上のHermite形式}h:V\times V\to\C\}$とする．
        \item $K\mono\End_K(V)$を$a\mapsto a\id_V$で同一視する．
    \end{enumerate}
\end{notation}

\section{線型空間の定義と標準分解}

\subsection{線型空間の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    Abel群$V$に対して，群の作用$G\to\Aut(V)$を備えたものを表現，環の作用$R\to\Aut(V)$を備えたものが加群，
    体の作用$K\to\Aut(V)$を備えたものが線型空間である．
    このスペクトルは，関数の代数から空間・幾何へのスペクトラムのようにも思える．
    加群は表現と空間の中間概念で，ベクトル束の一般化とも捉えられる．
\end{tcolorbox}

\begin{definition}[commutative ring, commutative field, characteristic]\mbox{}
    \begin{enumerate}
        \item Abel群$R$が乗法中立元$1\in R$を持つ結合的な双線型写像$R\times R\to R$も備えるとき，(単位的)\textbf{環}という．
        以降，環は可換とする．
        \item $R^\times=R\setminus\{0\}$が成り立つ可換環$R$を体という．
        \item 体$K$が$\Q$を（部分体として）含むとき，体の\textbf{標数}は$0$であるという．
        体$K$が有限体$\F_p$を（部分体として）含むとき，体の標数は$p$であるという．
    \end{enumerate}
\end{definition}

\begin{definition}[module, linear space, algebra, $*$-algebra]
    $R$を可換環とする．
    \begin{enumerate}
        \item \textbf{$R$-加群}とは，環の作用$R\to\Aut(V)$を受けるAbel群$R\times V\to V$をいう．
        \item $R$が体でもあるとき，特に\textbf{$R$-線型空間}という．
        \item また，$R$-加群が双線型写像$g:V\times V\to V$も備えるとき，\textbf{$R$-代数}という．
        \item $R$-代数$V$がさらに反線型かつ乗法について反変的な対合$*:V\to V$を持つとき，\textbf{$*$-代数}という．
        \item $V$がノルム$*$-代数で，対合が等長同型であるとき，あるいは同値だが，$\norm{a^*a}=\norm{a}^2$を満たすとき\textbf{$C^*$-代数}という．
    \end{enumerate}
\end{definition}
\begin{remarks}
    ノルムの$C^*$-性からは，
    ノルム代数の劣乗法性より$\norm{A^*A}=\norm{A}^2\le\norm{A^*}\norm{A}$から
    $\norm{A}\le\norm{A^*}$，対合であることより$\norm{A}=\norm{A^*}$が従う．
    $C^*$-代数は対称的$A=A^*\Rightarrow\Sp(A)\subset\R$で，正$\Sp(A^*A)\subset\R_+$である．
    $*$-準同型はノルムが1で，特に有界である．
\end{remarks}

\subsection{基底と線形独立性}

\begin{definition}[basis]\mbox{}
    族$(x_i)_{i\in I}$が$V\in\Vect_K$の\textbf{基底}であるとは，写像$K^{(I)}\to V;(a_i)_{i\in I}\mapsto\sum_{i\in I}a_ix_i$が全単射を定めることをいう．
\end{definition}
\begin{proposition}[基底の特徴付け]
    任意の$(x_i)_{i\in[n]},V$について，次の3条件は同値：
    \begin{enumerate}
        \item $(x_i)$は基底である．
        \item 対応$V\to K^n;x\mapsto(a_1,\cdots,a_n)$は全単射を定める．
        \item $(x_i)$は生成元であり，かつ，次の意味で一意に表示する：$\forall_{b_1,\cdots,b_n\in K}\;b_1x_1+\cdots+b_nx_n=0\Rightarrow b_1=\cdots=b_n=0$．
    \end{enumerate}
\end{proposition}

\begin{proposition}[線型独立性の特徴付け：一次独立系の拡大法]\label{prop-linear-system-expansion}
    $x_1,\cdots,x_n\in V$に対して，次の2条件は同値．
    \begin{enumerate}
        \item $x_1,\cdots,x_n$は線型独立である：$(x_i)_{i\in[n]}$はは$\brac{x_1,\cdots,x_n}$の基底をなす．
        \item $x_1,\cdots,x_{n-1}$が線型独立，かつ，$x_n\notin\langle x_1,\cdots,x_{n-1}\rangle$．
    \end{enumerate}
\end{proposition}


\subsection{基底の存在と構成}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $V\in\Vect_K$の任意の部分空間は直和因子である．
    任意の$V$は基底を持つという主張は選択公理と同値になる(Andreas Blass 1984)．
    FinVectでは任意の線形独立な系は基底に延長できる．
    FinVectは有限生成される空間として特徴付けられる．
\end{tcolorbox}

\begin{theorem}[基底の存在定理 (AC)]
    $V\in\Vect_K,\{x_i\}_{i\in I}\subset V$を生成系，$J\subset I$を$(x_i)_{i\in J}$が一次独立であるものとする．
    このとき，$J\subset H\subset I$であって，$(x_i)_{i\in H}$が基底であるものが存在する．
\end{theorem}

\begin{corollary}[補空間の存在]
    $V\in\Vect_K,W\subset V$を部分空間とする．$V$の部分空間$W'$であって，$V=W\oplus W'$となるものが存在する．
\end{corollary}

\begin{theorem}[線型独立系の基底への延長算譜]\label{thm-linear-system-extension-algorithm}
    $\langle x_1,\cdots,x_n\rangle =V\in\FVS_K$とする．
    \begin{enumerate}
        \item （算譜）いま$x_1,\cdots,x_m\;(m\le n)$が一次独立だったとする．
        \[\{i_1,\cdots,i_r\}:=\{i\in \{m+1,m+2,\cdots,n\}\mid x_i\notin\langle x_1,\cdots,x_{i-1}\rangle\}\]
        とすると，$x_1,\cdots,x_m,x_{i_1},\cdots,x_{i_r}$は$V$の基底である．
        \item $\dim V\le n$．等号成立時は，$x_1,\cdots,x_n$が基底である時である．
        \item $y_1,\cdots,y_m\in V$が線型独立とすれば，$m\le\dim V$である．$m=\dim V$ならば，これらは基底である．
    \end{enumerate}
\end{theorem}

\begin{corollary}[有限次元であることの特徴付け]
    任意の$V\in\Vect_K$について，次の3条件は同値：
    \begin{enumerate}
        \item $V$は有限次元である（＝有限集合$B$が存在して基底となる）．
        \item $V$の有限生成される．
    \end{enumerate}
\end{corollary}

\subsection{線型空間の直和と分類定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    ノルム空間においては「代数的直和」とも呼ばれる概念である．
    ノルム空間の直和($l^1$-直和)となるためには，さらにここから完備化が必要．
    任意の集合$S$上の自由加群$R^{(S)}$は，代数的直和としての表現$\bigoplus_{s\in S}R$をもつ．
    FinVectでは，全ての対象が係数体$K$のある代数的直和と同型になる．
\end{tcolorbox}

\begin{definition}[direct sum of vector spaces]\mbox{}
    \begin{enumerate}
        \item $V\oplus W$を，集合$V\times W$を$V,W$の構造から自然に線型空間とみたものと定め，\textbf{直和}という．しばしば「外部」や「抽象的な」などの接頭語をつける．
        \item 特に$V^{\otimes r}$は$V^r$と略記する．
        \item 線型空間の族$(V_i)_{i\in I}$について，その\textbf{直和}とは，
        \[ \bigoplus_{i\in I}V_i:=\Brace{(x_i)_{i\in I}\in\prod_{i\in I}V_i\;\middle|\; x_i=0\;\fe} \]
        のことである．
    \end{enumerate}
\end{definition}

\begin{proposition}[部分空間が互いに素であることの直和による特徴付け]\label{prop-characterization-of-direct-sum-2}
    $V\in\Vect_K$の部分空間$W,W'$について，次の２条件は同値である．
    \begin{enumerate}
        \item $W\cap W'=0$．
        \item 自然な全単射$\varphi:W\oplus W'\to W+W'$が存在する．
    \end{enumerate}
    このとき，埋め込み$W\oplus W'\mono V$によって記号を混用する．
\end{proposition}

\begin{theorem}[FinVectの分類定理 (Ernst Steinitz)]\label{thm-dimention}
    $V$を$K$-線型空間とする．$(x_i)_{i\in [m]}$と$(y_i)_{i\in [n]}$がいずれも$V$の基底であるならば，$n=m$である．
\end{theorem}
\begin{Proof}
    互いに逆写像である写像$f:[m]\to[n]$と$g:[n]\to[m]$を構成する事により，$|X|=|Y|$を証明する．

    部分空間の列$\{V_i:=\langle x_1,\cdots,x_i\rangle\}_{i=0,1,\cdots,m},\{W_j:=\langle y_1,\cdots,y_j\rangle\}_{j=0,1,\cdots,n}$を定める．
    これに対して，$f(i)=j$を，$x_i\in V_{i-1}+W_j$を満たす最小の$j$として定義し，$g$も対称に定義する．
    この時に，$f(i)=j\Leftrightarrow g(j)=i$と示せれば，定理の主張を得る．

    まず$f:[m]\to[n]$を定義する，各$i=1,\cdots,m$に対して，部分空間の増大列
    \[ V_{i-1}=V_{i-1}+W_0\subset V_{i-1}+W_1\subset\cdots\subset V_{i-1}+W_n=V \]
    を考えると，$x_i\notin V_{i-1}+W_0$と$x_i\in V_{i-1}+W_n$とより，$x_i\in V_{i-1}+W_j$を満たす最小の$1\le j\le n$が定まる（この時，部分空間の増大列が無限に長い場合，選択公理が必要となる）．
    この$j$をして，$f(i)=j$と定める．同様にして，$g:[n]\to[m]$を定める．

    この時，$f(i)=j\Leftrightarrow g(j)=i$，即ち$f\circ g=\id,g\circ f=\id$は次の補題に一般化される．
\end{Proof}

\begin{definition}[(Hamel / algebraic) dimention]\label{def-dimention}
    $n\in\N$に対し，$V$に有限な基底$(x_i)_{i\in[n]}$が存在するならば，$V$は\textbf{有限次元}であるといい，$n=:\dim V$を$V$の\textbf{次元}という．
    有限次元でない線型空間を\textbf{無限次元}であるという．
\end{definition}

\subsection{部分空間のモジュラー束}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $P(X)$と同様，$S(X)$は完備Boole代数の構造を持つ．
\end{tcolorbox}

\begin{proposition}
    部分空間の束$S(V),V\in\FinVect_K$について，
    \begin{enumerate}
        \item 環の演算$(\cap,+)$は結合的で可換で，零元$0$を持つ．
        \item 分配束ではないが，モジュラー束ではある：$\forall_{W_2\subset W_1\in S(V)}\;W_1\cap(W_2+W_3)=W_1\cap W_2+W_1\cap W_3=W_2+W_1\cap W_3$．
        \item 可補束である：$\forall_{W\in S(V)}\;\exists_{W^*\in S(V)}\;W+W^*=V,W\cap W^*=0$．
    \end{enumerate}
\end{proposition}

\subsection{線型写像の直和と行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    空間の直和の間に，線型写像の直和も生じる．
    ここで，直和の概念こそ基底を特徴付けたことを思い出せば，直和あるところに行列あり，である．
\end{tcolorbox}

\begin{definition}[線型写像の直和]\mbox{}
    \begin{enumerate}
        \item $f_1:V_1\to W,f_2:V_2\to W$を線型写像とする．これらの\textbf{直和}$f_1\oplus f_2:V_1\oplus V_2\to W$を$f_1\oplus f_2(x_1,x_2)=f_1(x_1)+f_2(x_2)$と定める．
        \begin{enumerate}[(i)]
            \item 第一射影は$\pr_1=\id_{V_1}\oplus 0:V_1\oplus V_2\to V_1\oplus 0\simeq V_1$である．この言葉を用いて，$f_1\oplus f_2=f_1\circ\pr_1+f_2\circ\pr_2$である．
            \item $V_1=V_2=W$で，$f_1=f_2=\id$である時，$\id\oplus\id:W\oplus W\to W$は$W$の加法である．
        \end{enumerate}
        \item $W=W_1\oplus W_2$とする．$f_1:V\to W_1,f_2:V\to W_2$の\textbf{直和}$f_1\oplus f_2:V_1\oplus V_2\to W_1\oplus W_2$を$f(x)=(f_1(x),f_2(x))$と定める．
        \begin{enumerate}[(i)]
            \item $i_1:W_1\to W,i_2:W_2\to W$を直和が定める標準的単射とすれば，$f_1\oplus f_2=i_1\circ f_1+i_2\circ f_2$と表せる．
        \end{enumerate}
        \item $f_11\oplus f_{12}:V_1\oplus V_2\to W_1,f_{21}\oplus f_{22}:V_1\oplus V_2\to W_2$に対して，$f:V_1\oplus V_2\to W_1\oplus W_2$を$f(x_1,x_2)=(f_{11}(x_1)+f_{12}(x_2),f_{21}(x_1)+f_{22}(x_2))$は線型写像を定める．これを
        \[ f=\begin{pmatrix}f_{11}&f_{12}\\f_{21}&f_{22}\end{pmatrix} \]
        と表す．次が成り立つからである：
        \[ \begin{pmatrix}y_1\\y_2\end{pmatrix}=\begin{pmatrix}f_{11}&f_{12}\\f_{21}&f_{22}\end{pmatrix}\begin{pmatrix}x_1\\x_2\end{pmatrix}. \]
        \item 次の$f_1,f_2$の直和の特別な場合を特に「直和」と呼ぶこともある：
        \[ f=\begin{pmatrix}f_{1}&0\\0&f_{2}\end{pmatrix} \]
    \end{enumerate}
\end{definition}

\begin{definition}[行列の直和]
    基底$x_1,\cdots,x_n$を$r$個に分割してそれぞれが生成する部分空間の間に定まる射$(f_i)_{i=1,\cdots,r}$の直和$f_1\oplus\cdots\oplus f_r:V\to W$の行列表示は，
    \[ A_1\oplus\cdots\oplus A_r:=\begin{pmatrix}A_1&0&\cdots&0\\0&A_2&\ddots&\vdots\\\vdots&\ddots&\ddots&0\\0&\cdots&0&A_r\end{pmatrix} \]
    となる．$A_1=\cdots=A_r=A$の時，行列の冪と区別して$A^{\oplus r}$と表す．
\end{definition}

\begin{example}[部分空間と行列表示]
    $V,W$の部分空間を，それぞれの基底$x_1,\cdots,x_n,y_1,\cdots,y_m$について，$V'=\langle x_1,\cdots,x_{n'}\rangle,W'=\langle y_1,\cdots,y_{m'}\rangle$と
    取った時，線型写像$f:V\to W$の表現行列が
    \[ A=\begin{pmatrix}A_{11}&A_{12}\\A_{21}&A_{22}\end{pmatrix} \]
    という形になる．この時$V'$の像がすっぽりハマる$f(V')\subset W'$の条件は$A_{21}=0$である．
    この時$f|_{V'}:V'\to W'$の行列表示が$A_{11}$である．
    このように$0$がたくさん出現する行列表示を見つけるのが目標として立つ．
\end{example}

\subsection{線型写像の行列表示}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    \begin{enumerate}
        \item $f\in\Hom_K(V,W)$の$\b{x}\in V^n,\b{y}\in W^m$-行列表示とは，$f(\b{x})^\top=\b{y}^\top A$を満たす$A\in M_{mn}(K)$をいう．
        \item 基底$\b{x},\b{y}\in V^n$の変換行列とは，$\b{y}^\top=\b{x}^\top P$を満たす$P\in\GL_n(K)$をいう．
    \end{enumerate}
    この考え方は，標準的な方法によるペアリング$\brac{-,-}:V^n\times K^n\to W$を考えていることに当たる．
\end{tcolorbox}

\begin{definition}
    $V,W\in\FinVect_K$の基底を$\b{x}=(x_1,\cdots,x_n)^\top\in V^n,\b{y}=(y_1,\cdots,y_m)^\top\in W^m$とする．
    \begin{enumerate}
        \item 元$x\in V$の\textbf{ベクトル表示}$a\in\R^n$とは，$\b{x}^\top a=x$を満たす元$a\in\R^n$をいう．
        \item 左作用$\b{x}^\top:\R^n\to V$を\textbf{基底$\b{x}\in V^n$が定める同型}という．
        \item 線型写像$f\in\Hom_K(V,W)$の\textbf{行列表示}$A\in M_{mn}(K)$とは，$f(\b{x})^\top=\b{y}^\top A$を満たすものをいう．
    \end{enumerate}
\end{definition}
\begin{remarks}[始基底の行き先の終基底による表示を列ベクトルとした行列]\mbox{}
    \begin{enumerate}
        \item 行列表示$A=(a_1\cdots a_n)$の第$j$行$a_j\in\R^m$は，元$f(x_j)\in W$の$\b{y}$に関するベクトル表示になっている：$f(x_j)=\b{x}^\top a_j$．
        \item 特に，$\b{x}$から$\b{y}$への底の変換行列$P$の第$j$行は，$y_j$の$\b{x}$に関するベクトル表示に等しい．
    \end{enumerate}
\end{remarks}

\begin{proposition}[線型写像と行列表示の対応]
    定義の設定下で，$v\in V$のベクトル表示を$a\in\R^n$，$w:=f(v)\in W$のベクトル表示を$b\in\R^m$とする：
    \[\begin{cases}
        v=\b{x}^\top a,\\
        w:=f(v)=\b{y}^\top b.
    \end{cases}\]
    このとき，$b=Aa$が成り立つ．
\end{proposition}
\begin{Proof}
    $f$の行列表示$A$は$f(\b{x})^\top =\b{y}^\top A$を満たすから，これと$f$の線型性から
    \[\b{y}^\top b=w=f(v)=f(\b{x}^\top a)=(f(\b{x}))^\top a\]
    より，$\b{y}^\top b=\b{y}^\top Aa$を得る．$\b{y}$は$W$の基底だから，$b=Aa$が必要．
\end{Proof}

\begin{theorem}[正方行列表示の変換]
    $V=W$とし，$\varphi\in\Aut_K(V)$を$\b{x}$を$\b{y}$に写す線型同型，$P$をその$\b{x}$に関する行列表示とする：$\varphi(\b{x})^\top=\b{y}^\top=\b{x}^\top P$．
    \begin{enumerate}
        \item $P$は$\id_V$の$\b{y},\b{x}$に関する行列表示に等しい．
        \item 任意の$f\in\End_K(V)$の$\b{x}$に関する行列表示$A$に対して，$P^{-1}AP$が$\b{y}$に関する行列表示を与える．
    \end{enumerate}
    この$P$を，$\b{x}$から$\b{y}$への\textbf{底の変換行列}という．
\end{theorem}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 定義から明らかである．
        \item $A$は$\b{x}$に関する行列表示だから$f(\b{x})^\top=\b{x}^\top A$．これと$f$の線型性より，
        \[f(\b{y})^\top=f(\b{x})^\top P=\b{x}^\top AP=\b{y}^\top P^{-1}AP.\]
    \end{enumerate}
\end{Proof}

\begin{corollary}[一般の行列表示の変換]
    $V$の基底$\b{x},\b{y}$と$V'$の基底$\b{x}',\b{y}'$とを考え，それぞれの底の変換行列を$P,Q$とする：
    \[\b{y}^\top=\b{x}^\top P,\quad \b{y}'^\top=\b{x}'^\top Q.\]
    このとき，任意の$f\in\Hom_K(V,V')$の$\b{x},\b{x}'$-行列表示$A$と$\b{y},\b{y}'$-行列表示$A'$とについて，$A'=Q^{-1}AP$の関係がある．
\end{corollary}
\begin{Proof}
    $f=f\circ\id_V=\id_W\circ f$に注目すると，この$\b{y},\b{x}'$-行列表示が$AP,QA'$と二通りで得られるから，$AP=QA'$が必要．
\end{Proof}
\begin{remarks}[基底の変換行列は係数ベクトルには反変に作用する]
    定理の(1)で，底の変換行列を$\id_V$の行列表示に読み替えたが，これは定義式$y^\top=x^\top A$が，
    任意のベクトル$a\in K^n$については$x^\top a=y^\top P^{-1}a\in V$の関係を満たすことを意味している．
\end{remarks}

\subsection{核と像}

\begin{proposition}[部分空間の像・逆像も部分空間]
    $V,W\in\Vect_K$，$f:V\to W$を線型写像とする．
    \begin{enumerate}
        \item $V'\in S(V)$ならば，$f(V')\in S(W)$．
        \item $W'\in S(W)$ならば，$f^{-1}(W')\in S(V)$．
    \end{enumerate}
\end{proposition}


\begin{proposition}[単射の特徴付け]\label{prop-characterization-of-monos-in-terms-of-Kernel}
    $V,W\in\Vect_K$，$f:V\to W$を線型写像とする．次の２条件は同値である．
    \begin{enumerate}
        \item $f$は単射．
        \item $\Ker f=0$．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    $f$が単射なら，$f^{-1}(0)$はただ一つの元を持つ．$f(0)=0$より$\Ker f=0$．

    $\Ker f=0$ならば，$f(x)=f(x')$の仮定の下で$f(x-x')=0$が必ず成り立つから，$x=x'$が従う．
\end{Proof}

\begin{corollary}[可逆性と全単射は同値]\label{cor-invertible-if-全単射}
    $V,W\in\Vect_K$，$f:V\to W$を線型写像とする．次の３条件は同値である．
    \begin{enumerate}
        \item $f$は同型．
        \item $f$は全単射．
        \item $\Im f=W\land\Ker f=0$．
    \end{enumerate}
\end{corollary}

\subsection{完全系列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=線形写像の全射は極めて奇妙な性質を持つ]
    準同型定理より，任意の全射$f:V\epi W$に対して，$V/\Ker f\simeq W$が誘導される．$V/\Ker f$を構成せずとも，これは補空間に同型になるから，これをみつけて定義域から排除することができれば，全射線型写像から同型を得られる．
    次元定理$\dim V=\dim\Ker f+\rank f$の消息を最もうまく運ぶ形式が完全系列である．
    線型空間の直和分解を，核と像によって与える．
\end{tcolorbox}

\begin{proposition}[核の補空間の特徴付け]\label{prop-pre-homomorphism-thm}
    $V,W\in\Vect_K$，
    $f:V\to W$を全射な線型写像とする．$V$の部分空間$V'$について，次の２条件は同値である．
    \begin{enumerate}
        \item $V=V'\oplus\Ker f$．
        \item $f|_{V'}:V'\to W$は可逆．
    \end{enumerate}
\end{proposition}

\begin{corollary}[全射の特徴付け]
    $V,W\in\Vect_K$，
    線型写像$f:V\to W$について，次の２条件は同値である．
    \begin{enumerate}
        \item $f$は全射である．
        \item $V$の部分空間$V'$であって，$f|_{V'}:V'\to W$が可逆となるものが存在する．
    \end{enumerate}
\end{corollary}

\begin{definition}[exact sequence]
    $f:U\to V,g:V\to W$に対し，$\Ker g=\Im f$が成り立つ時，図式
    \[ U\xrightarrow{f}V\xrightarrow{g}W \]
    を\textbf{完全系列}という．または，\textbf{$V$で完全}ともいう．
\end{definition}

\begin{proposition}[図式が完全であることの部分空間と直和の言葉による特徴付け]
    線型写像の列
    \[ U\xrightarrow{f}V\xrightarrow{g}W \]
    について，
    \begin{enumerate}
        \item 次の条件は同値である．
        \begin{enumerate}[(1)]
            \item $g\circ f=0$である（$\Im f\subset\Ker g$）．
            \item 直和分解$U=U_1\oplus U_2,V=V_1\oplus V_2\oplus V_3, W=W_1\oplus W_2$が存在して，それに引き起こされる同型$\overline{f},\overline{g}$や第二射影$p:U\to U_2,q:V\to V_2$について，次の図式を可換にする：
            \[\xymatrix{
                &V_2\ar[r]^-{\overline{g}}&W\ar[d]^-j\\
                U\ar[r]^-f\ar[d]_-p&V\ar[r]^-g\ar[u]_-q&W\\
                U_2\ar[r]^-{\overline{f}}&V_1\ar[u]_-i
            }\]
        \end{enumerate}
        \item 次の条件は同値である．
        \begin{enumerate}[(1)]
            \item 図式$U\xrightarrow{f}V\xrightarrow{g}W$が完全である．
            \item 1.の(2)で$V=V_1\oplus V_2\oplus V_3$を$V=V_1\oplus V_2$で置き換えたものが成り立つ．
        \end{enumerate}
    \end{enumerate}
\end{proposition}

\begin{corollary}[全単射の図式による特徴付け]
    線型写像$f:V\to W$について，次の条件は同値である．
    \begin{enumerate}
        \item \begin{enumerate}[(1)]
            \item $f$は単射である．
            \item $0\to V\xrightarrow{f}W$が完全である．
            \item (monic) $r\circ f=1_V$を満たす線型写像$r:W\to V$が存在する．
        \end{enumerate}
        \item \begin{enumerate}[(1)]
            \item $f$は全射である．
            \item $V\xrightarrow{f}W\to 0$が完全である．
            \item (epic) $f\circ s=1_W$を満たす線型写像$s:W\to V$が存在する．
        \end{enumerate}
    \end{enumerate}
\end{corollary}

\subsection{直和分解の射影子への翻訳}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=部分空間の演算は射影子のことばによる作用素論へ翻訳できる]
    任意の部分空間には補空間が取れる．
    これは，射影と部分空間とが1対1対応することを考えれば，$\id_V-e$によって補空間の定める射影が得られる．
\end{tcolorbox}

\begin{proposition}[冪等自己準同型]\mbox{}
    \begin{enumerate}
        \item 線型写像$e:V\to V$が$e^2=e$を満たすならば，$V=\Im e\oplus\Ker e$である．
        \item 次の写像$F$は可逆である：
        \[\xymatrix@R-2pc{
            {\{e\in\End(V)\mid e^2=e\}}\ar[r]^-F&{\{V=W\oplus W'を満たすVの部分空間の組(W,W')\}}\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            e\ar@{|->}[r]&{(\Im e,\Ker e)}
        }\]
    \end{enumerate}
\end{proposition}

\begin{definition}[projector]\mbox{}
    \begin{enumerate}
        \item $e\in\{e\in\End(V)\mid e^2=e\}$を$V$の\textbf{射影子}という．
        \item この時$V=\Im e\oplus\Ker e$を\textbf{射影子$e$が定める直和分解}という．
        \item 射影子が定める直和分解が直交分解でもあるとき，\textbf{正射影}ともいう．
    \end{enumerate} 
\end{definition}

\begin{proposition}[冪等自己準同型の特徴付け]
    $V\in\Vect_K$，$f\in\End(V)$に対して，次の2条件は同値：
    \begin{enumerate}
        \item $f$は冪等である．
        \item $\rank f+\rank(\id-f)=n$．
    \end{enumerate}
\end{proposition}

\begin{proposition}[正射影の特徴付け]
    $A\in M_n(K)$に対して，次の2条件は同値：
    \begin{enumerate}
        \item $A$は正射影である．
        \item $A$は冪等かつ${}^t\!A=A$．
    \end{enumerate}
\end{proposition}

\begin{proposition}[部分空間の演算の正射影の演算への対応]
    $V\in\FVS_K,W_1,W_2$を部分空間，$A_1,A_2$を対応する正射影とする．
    \begin{enumerate}
        \item $W_1\perp W_2$と$A_1A_2=0$と$A_2A_1=0$とは同値．
        \item $W_1\subset W_2$と$A_1A_2=A_1$と$A_2A_1=A_1$とは同値．
        \item $A_1A_2=A_2A_1$と$W_1=W_1\cap W_2+W_1\cap W_2^\perp$と$W_2=W_1\cap W_2+W_1^\perp\cap W_2$とは同値．このとき，$A_1A_2=A_2A_1$は$W_1\cap W_2$への正射影である．
    \end{enumerate}
\end{proposition}

\section{構成}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    任意の線型写像は完全系列に分解出来る．
    この理論を得るには，商の普遍構成が必要になる．
    すると，テンソル積の言葉が得られて，ペアリングというさらなる構成が拓かれる．
\end{tcolorbox}

\subsection{商}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
商空間$V/W$の基底は，$W$の基底を$V$に延長したものの像$0,\cdots,0,\overline{x_{m+1}},\cdots,\overline{x_n}$として得られる．
これは竟に，\textbf{補空間に普遍的な名前がついた}のである．
\end{tcolorbox}

\begin{proposition}[quotient space, canonical surjection,  class]
    $V\in\Vect_K$とし，$W$を部分空間とする．部分集合$x+W$を\textbf{類}と呼び，これらを集めた集合$V/W$を\textbf{商空間}という．類への対応を$p:V\to V/W$とする．
    \begin{enumerate}
        \item $p:V\to V/W$は全射であり，$p(x)=p(y)$は$x-y\in W$と同値である．
        \item 写像$+:V/W\times V/W\to V/W$と$\cdot:K\times V/W\to V/W$で，それぞれ次の図式を可換にするようなものが唯一つ存在する．
        \[\xymatrix{
            V\times V\ar[r]^-+\ar[d]_-{p\times p}&V\ar[d]^-p&K\times V\ar[r]^-{\cdot}\ar[d]_-{\id_K\times p}&V\ar[d]^-p\\
            V/W\times V/W\ar[r]^-+&V/W&K\times V/W\ar[r]^-{\cdot}&V/W
        }\]
        これを$V/W$上の加法とスカラー倍と定めると，代数法則$\overline{x}+\overline{y}:=\overline{x+y},a\overline{x}=\overline{ax}$が成り立つ．
        \item $V/W$はこの加法とスカラー倍について線型空間となる．
        \item 全射$p:V\to V/W$は線型写像である．これを\textbf{標準全射}という．
        \item 標準全射$p:V\to V/W$の核は$W$である．
    \end{enumerate}
\end{proposition}

\begin{corollary}[商空間の基底は，延長したものの像]
    $x_1,\cdots,x_n$を$V$の基底，$x_1,\cdots,x_m$を$W$の基底とすると，
    $\overline{x_{m+1}},\cdots,\overline{x_n}$が$V/W$の基底である．
    従って，$\dim V/W=\dim V-\dim W$．
\end{corollary}


\begin{proposition}[商空間の普遍性]\label{prop-universality-of-quotient-spaces}
    $V,V'\in\Vect_K$とし，$W$を$V$の部分空間とし，$f:V\to V'$を線型写像とする．
    次の２条件は同値である．
    \begin{enumerate}
        \item $g\circ p=f$を満たす線型写像$g:V/W\to V'$が唯一つ存在する．
        \item $f(W)=0$である．
    \end{enumerate}
    \[\xymatrix{
        V\ar@{->>}[r]^-p\ar[dr]_-f&V/W\ar@{.>}[d]^-g\\
        &V'
    }\]
\end{proposition}
\begin{remarks}
    $f\in\End(V)$と$f$-安定部分空間$W\in S(V)$について，$V/W$上に線型写像$f_1$が$f_1(x)=f(x)\;\on V/W$で定まる．$f_1:V/W\to V$も\textbf{引き起こされた写像}という．
\end{remarks}

\subsection{線型写像の標準分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=線型写像の準同型定理は，任意の線型写像を完全系列に分解する]
    Vectでは，単射は$\Ker f$の退化（命題\ref{prop-characterization-of-monos-in-terms-of-Kernel}），全射は余核$V'\setminus\Im f$の退化（命題\ref{prop-pre-homomorphism-thm}）で表される．
    これは，完全系列の言葉で観るとわかりやすいことを確認した．
    ここで，任意の線型写像は完全系列に分解出来る．
\end{tcolorbox}

\begin{proposition}[fundamental theorem on homomorphisms, canonical decomposition]\label{prop-homomorphism-thm}
    $V,V'\in\Vect_K$とし，$f:V\to V'$を$K$-線型写像とする．$f$が引き起こす線型写像$\overline{f}:V/\Ker f\to\Im f$は同型である．
    \[\xymatrix{
        V\ar[r]^-f\ar[d]_-p&V'\\
        V/\Ker f\ar[r]^-{\overline{f}}&\Im f\ar[u]_-i
    }\]
\end{proposition}
\begin{Proof}
    任意の$f(x)\in\Im f$に対して，$\overline{x}\in\overline{f}^{-1}(f(x))$であるから，$\overline{f}$は全射である．次に$\Ker\overline{f}=0$を示す．
    任意に$\overline{x}\in\Ker\overline{f}$を取ると$\overline{f}(\overline{x})=0$である．すると，$f(x)=0$である．
\end{Proof}

\begin{remarks}[Gilbert Strangによってfundamental theorem of linear algebraとしても教育されている]
    各行列$A\in M_{mn}(K)$によって，次が定まる．

    \begin{center}
        \begin{tabular}{l|l|l}
            像&$\Im(A)$&列空間\\
            核&$\Ker(A)$&零空間\\
            余像&$\Coim(A)=\Im({}^t\!A)$&行空間\\
            余核&$\Coker(A)=\Ker({}^t\!A)$&
        \end{tabular}
    \end{center}
    
    線型写像$f:V\to W$について，
    \begin{align*}
        V&=\Ker f\oplus\Coim f,&W&=\Im f\oplus\Coker f
    \end{align*}
    が成り立つ．核と余核，像と余像の次元は等しいから，
    これは次元定理(rank-nullity theorem)$\dim V=\dim\Ker f+\rank f$を含意する．
    なお，階数とは像の次元であり，退化次数とは核の次元をいい，これについての関係だからrank-nullity theoremという．
    また，この分解は基底に依らない標準的な分解で，ただの補空間ではなく，$K^n$の標準的な内積に関する直交補空間である：
    \begin{align*}
        \Ker A=(\Coim {}^t\!A)^\bot,\quad\Im A=(\Coker {}^t\!A)^\bot
    \end{align*}
\end{remarks}


\begin{corollary}[第二・第三同型定理]
    $W,W'$を$V$の部分空間とする．
    \begin{enumerate}
        \item 包含写像$i:W'\to W+W'$が引き起こす写像$W'/(W\cap W')\to(W+W')/W$は同型である．
        \item $W\supset W'$とする．標準写像$V/W'\to V/W$は同型$(V/W')/(W/W')\to V/W$を引き起こす．
    \end{enumerate}
\end{corollary}

\subsection{テンソル積}

\begin{definition}[tensor product (Whitney 1938)]
    $V_1,V_2\in\Vect_K$の\textbf{テンソル積}$V_1\otimes_KV_2$とは，$V_1\times V_2$の元によって$K$上で生成される自由加群$K^{(V_1\times V_2)}$の，次の同値関係による商$K^{(V_1\times V_2)}/R$である：
    \[(kv_1,v_2)\sim k(v_1,v_2)\sim(v_1,kv_2),\quad(v_1+v_1',v_2)\sim(v_1,v_2)+(v_1',v_2),\quad(v_1,v_2+v_2')\sim(v_1,v_2)+(v_1,v_2').\]
    ただし，$(v_1,v_2)=:v_1\otimes v_2$とは，定義関数$\chi_{(v_1,v_2)}\in K^{(V\times W)}$を表す．
\end{definition}

\begin{theorem}[テンソル積の普遍性]
    $V_1,V_2\in\Vect_K$について，
    \begin{enumerate}
        \item 対応$\otimes:V\times W\to V\otimes W;(x,y)\mapsto x\otimes y$は双線型である．
        \item 任意の双線型写像$V_1\times V_2\to V_3$に対して，唯一つの線形写像$V_1\otimes_KV_2\to V_3$が存在して，次の図式を可換にする：
        \[\xymatrix{
            V_1\times V_2\ar[r]^-{\mathrm{bilinear}}\ar[d]&V_3\\
            V_1\otimes_KV_2\ar[ur]_-{\mathrm{linear}}
        }\]
    \end{enumerate}
\end{theorem}

\begin{proposition}[普遍構成の分配法則]\label{prop-distributive-law-in-categorical-sense}
    $V,W\in\Vect$とする．
    \begin{enumerate}
        \item $V=V_1\oplus V_2$の時，次の線型写像は同型である．
        \[\xymatrix@R-2pc{
            f:V\otimes W\ar[r]&(V_1\otimes W)\oplus(V_2\otimes W)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (x_1,x_2)\otimes y\ar@{|->}[r]&(x_1\otimes y,x_2\otimes y)
        }\]
        \item $W=W_1\oplus W_2$の時，次の線型写像は同型である．
        \[\xymatrix@R-2pc{
            f:V\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            (y_1,y_2)\otimes y\ar@{|->}[r]&(x\otimes y_1,x\otimes y_2)
        }\]
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 結局は和の普遍性である．$i_1,i_2$を標準単射とし，次の２つの線型写像$g_1,g_2$の和を$g_1+g_2=:g:(V_1\otimes W)\oplus(V_2\otimes W)\to V\otimes W$とすると，これが逆写像であると示す．
        \[\xymatrix@R-2pc{
            i_1:V_1\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2),&i_2:V_2\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2),\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x_1\otimes y\ar@{|->}[r]&(x_1\otimes y,0)&x_2\otimes y\ar@{|->}[r]&(0,x_2\otimes y)
        }\]
        \[\xymatrix@R-2pc{
            g_1:V_1\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2),&g_2:V_2\otimes W\ar[r]&(V\otimes W_1)\oplus(V\otimes W_2),\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x_1\otimes y\ar@{|->}[r]&(x_1,0)\otimes y&x_2\otimes y\ar@{|->}[r]&(0,x_2)\otimes y
        }\]
        \[\xymatrix{
            V_1\otimes W\ar[dr]^-{g_1}\ar[d]_-{i_1}\\
            (V_1\otimes W)\oplus(V_2\otimes W)\ar[r]^-g&(V_1\oplus V_2)\otimes W\\
            V_2\otimes W\ar[u]^-{i_2}\ar[ur]_-{g_2}
        }\]
        $g\circ f=\id_{(V_1\oplus V_2)\otimes W}$を示す．$x_1\in V_1,x_2\in V_2,y\in W$を任意に取る．$g(f((x_1,x_2)\otimes y))=g(x_1\otimes y,x_2\otimes y)=x_1\otimes y+x_2\otimes y=(x_1+ x_2)\otimes y$．\footnote{\cite{斎藤毅-線型代数}が$(x_1+ x_2)\otimes y$も$(x_1,x_2)\otimes y$も混用するのは，内部直和と外部直和を同一視しているからか？いや，定める双線型写像と定まる線型写像とを使い分けているだけですね(1/15/2021)．}

        $f\circ g=\id_{(V\otimes W_1)\oplus(V\otimes W_2)}$を示す．$x_1\in V_1,x_2\in V_2,y\in W$を任意に取る．
        $f(g(x_1\otimes y,0))=f((x_1,0)\otimes y)=(x_1\otimes y,0)$．第二成分についても同じ．
        \item 1と同様．
    \end{enumerate}
\end{Proof}

\begin{corollary}[テンソル空間の基底は基底のテンソル積]\label{cor-the-basis-of-tensor-product}
    $x_1,\cdots,x_n$が$V$の基底で，$y_1,\cdots,y_m$が$W$の基底ならば，$x_1\otimes y_1,\cdots,x_n\otimes y_1,\cdots,x_1\otimes y_m,\cdots,x_n\otimes y_m$は$V\otimes W$の基底である．
    従って，$\dim(V\times W)=\dim V\cdot\dim W$．
\end{corollary}
\begin{Proof}
    $W=Ky_1\oplus\cdots\oplus Ky_m$より，命題\ref{prop-distributive-law-in-categorical-sense}より，
    直和分解$V\times W=(V\otimes Ky_1)\oplus\cdots\oplus(V\otimes Ky_m)$が得られる．
    各$j\in[m]$に対して，$x_1\otimes y_j,\cdots,x_n\otimes y$は$V\otimes Ky_j$の基底である（命題\ref{prop-column-vector-of-a-matrix}）．
    よって，これを並べると，$V\otimes W$の基底を得る．
\end{Proof}

\begin{remarks}[ベクトル束のテンソル]
    ベクトル束のテンソルとは，各ファイバー毎にテンソル積を取った束に自然に位相を入れて得られるもので，テンソル束
    $T(a,b):=T(M)^{\otimes a}\otimes T^*(M)^{\otimes b}$を\textbf{反変$a$次，共変$b$次のテンソルバンドル}という．この切断を，反変$a$次，共変$b$次のテンソル場という．
\end{remarks}

\subsection{基本テンソル}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    テンソル積の自由加群の商としての構成から明らかに，単純テンソルが基底であるが，
    唯一の落とし穴は，見かけが違うだけで他の単純テンソルと同じ剰余類に属する可能性がある(テンソル積の基底は基底のテンソル積)．
    基本テンソルを行列表示$x\otimes y:=(x_i\otimes y_j)_{i\in[m],j\in[n]}$すると，任意の元を$A\in M_{nm}(K)$を用いて${}^t\!(x\otimes y)A\in V\otimes W$と表せる．
\end{tcolorbox}

\begin{definition}[simple / decomposable tensor]
    テンソル積$V_1\otimes\cdots\otimes V_k$の元$x$が\textbf{単純テンソル}であるとは，
    次を満たすことをいう：
    \[\exists_{k\in\N}\;\exists_{v_i\in V_i}\;x=v_1\otimes\cdots\otimes v_k.\]
\end{definition}

\begin{proposition}[decomposable tensorの行き先が定まればテンソル積からの線型写像が定まる]\label{prop-linear-map-from-tensor-product-is-determined-by-basis-destination}
    $V,W,V'\in\Vect_K$とする．線型写像$f,g:V\otimes W\to V'$に対して，次の２条件は同値．
    \begin{enumerate}
        \item $f=g$．
        \item $\forall_{x\in V,y\in W}\;f(x\otimes y)=g(x\otimes y)$．
    \end{enumerate}
    \[\xymatrix{
        V\times W\ar[r]^-{\otimes}\ar@{.>}[dr]&V\otimes W\ar[d]^-{f,g}\\
        &V'
    }\]
\end{proposition}

\begin{proposition}[テンソルの非可換条件]
    $x,y\in V$について，次の条件は同値である．
    \begin{enumerate}
        \item $x,y\in V$は一次独立．
        \item $x\otimes y\ne y\otimes x\in V\otimes V$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] $x\otimes y=y\otimes x$とすると，命題\ref{prop-tensors}より，$y=ax\land x=a^{-1}y$を得るが，これは$x,y$が一次独立であることに矛盾．よって，$x\otimes y\ne y\otimes x$．
        あるいは直接的には，$x,y$が一次独立の時，$\langle x,y\rangle\otimes\langle x,y\rangle$の基底が$x\otimes x,x\otimes y,y\otimes x,y\otimes y$であるため．
        \item[(2)$\Rightarrow$(1)] 対偶を示す．$x,y$が一次独立の時，$\exists k\in K,\; y=kx$であるから，$x\otimes y=kx\otimes x=y\otimes x$．
    \end{description}
\end{Proof}

\begin{proposition}[テンソルの変換]\label{prop-basis-change-of-tensor}
    $x_1,\cdots,x_m\in V$と$x'_1,\cdots,x'_m\in V$を$V$の基底とし，$y_1,\cdots,y_n\in W$と$y'_1,\cdots,y'_n\in W$を$W$の基底とする．
    \begin{itemize}
        \item $P\in\GL_m(K)$を$x_1,\cdots,x_m$から$x'_1,\cdots,x'_m$への底の変換行列とし，
        \item $Q\in\GL_n(K)$を$y_1,\cdots,y_n$から$y'_1,\cdots,y'_n$への底の変換行列とする．
    \end{itemize}
    係数行列$A=(a_{ij}),B=(b_{ij})\in M_{mn}(K)$に対し，次の２条件は同値であることを示せ．
    \begin{enumerate}
        \item $\sum^m_{i=1}\sum^n_{j=1}a_{ij}x_i\otimes y_j=\sum^m_{i=1}\sum^n_{j=1}b_{ij}x'_i\otimes y'_j$．
        \item $A=PB{}^t\!Q$．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    $V\otimes W$の基本ベクトルのなす行列を$x\otimes y:=(x_i\otimes y_j)_{i\in[m],j\in[n]}$とすると，
    基底の変換行列$P,Q$は，
    \[{}^t\!(x\otimes y)P={}^t\!(x'\otimes y),\quad (x'\otimes y)Q=x'\otimes y'\]
    と変換されるから，${}^t\!Q{}^t\!(x\otimes y)P={}^t\!(x'\otimes y')$と変換される．
    $(V\otimes W)^{nm}$の元に右から作用することは，$M_{m,n}(K)$の元に左から作用することに当たるから，
    $PB{}^t\!Q=A$．
\end{Proof}
\begin{remarks}
    次の点に間違いがあった．(1)の等式は${}^t\!(x\otimes y)A={}^t\!(x'\otimes y')B$と表せるわけではない．このままでは$M_n(K)$上の等式になっている．
    テンソル上では，従来のペアリング$\brac{-,-}:V^n\times K^n\to V$が功を奏さない．
\end{remarks}

\subsection{行列のテンソル積}

\begin{definition}[tensor product / Kronecker product]
    $f:V\to V',g:W\to W'$に対して，次の線型写像を$f$と$g$の\textbf{テンソル積}$f\otimes g$という：
    \[\xymatrix@R-2pc{
        V\otimes W\ar[r]&V'\otimes W'\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x\otimes y\ar@{|->}[r]&f(x)\otimes g(y)
    }\]
    行列については\textbf{Kronecker積}ともいう．
\end{definition}

\begin{proposition}[行列のテンソル積]\label{prop-tensor-product-of-matrices}
    $V,V',W,W'\in\Vect_K$，$f:V\to V',g:W\to W'$を線型写像とする．
    \begin{enumerate}
        \item $\Ker(f\otimes g)=(\Ker f\otimes W)+(V\otimes\Ker g)$である．
        \item $\Im(f\otimes g)=(\Im f)\otimes(\Im g)$である．$\Im f,\Im g$が有限次元ならば，$\Im(f\otimes g)$も有限次元で，$\rank(f\otimes g)=\rank f\cdot\rank g$である．
        \item $V,V',W,W'$を有限次元とし，$f:V\to V'$の基底$x_1,\cdots,x_n\in V$と$y_1,\cdots,y_m\in V'$に関する行列表示を$A\in M_{mn}(K)$とし，$g:W\to W'$の基底$x'_1,\cdots,x'_{n'}\in W$と$y'_1,\cdots,y'_{m'}\in W'$に関する行列表示を$B\in M_{m'n'}(K)$とする．
        この時，$f\otimes g:V\otimes W\to V'\otimes W'$の，基底$x_1\otimes x'_1,\cdots,x_n\otimes x'_1,\cdots,x_1\otimes x'_{n'},\cdots,x_n\otimes x'_{n'}$と$y_1\otimes y'_1,\cdots,y_m\otimes y'_1,\cdots,y_1\otimes y'_{m'},\cdots,y_m\otimes y'_{m'}$に関する行列表示は，行列のテンソル積
        \[A\otimes B=\begin{pmatrix}Ab_{11}&\cdots&Ab_{1n'}\\\vdots&\ddots&\vdots\\Ab_{m'1}&\cdots&Ab_{m'b'}\end{pmatrix}\in M_{(mm')(nn')}(K)\]
        である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1,2.] 
        線型写像$f,g$による空間の標準分解$V=\Ker f\oplus V_1,W=\Ker g\oplus W_1$を考え，$\o{f}:V_1\to\Im f,\o{g}:W_1\to\Im g$をそれぞれが定める同型とする．
        これについて，テンソル積の基底からの特徴づけ\ref{prop-distributive-law-in-categorical-sense}より，
        \[V\otimes W=(\Ker f\otimes\Ker g)\oplus(\Ker f\otimes W_1)\oplus(V_1\otimes\Ker g)\oplus(V_1\otimes W_1)\]
        と分解できる．この前半３項$(\Ker f\otimes\Ker g)\oplus(\Ker f\otimes W_1)\oplus(V_1\otimes\Ker g)=(\Ker f\otimes W)+(V\otimes\Ker g)$への$f\otimes g$の制限は，$x\otimes y\;(x=0\lor y=0)$より，$0$である．
        一方で，$V_1\otimes W_1$への制限は同型$\o{f}\otimes\o{g}$となる（積写像$f\times g$が同型な双線型写像を定めるので，$f\otimes g=\otimes^*(f\times g)$も同型）．
        よって，標準分解\ref{prop-homomorphism-thm}より，
        \begin{align*}
            \Ker(f\otimes g)&=(\Ker f\otimes W)+(V\otimes\Ker g),\\
            \Im (f\otimes g)&=(\Im f)\otimes(\Im g).
        \end{align*}
        \item[3.]
        $f\otimes g$による基底$x_j\otimes x'_{j'}$の行き先が$A\otimes B$の$jj'$成分であるから，
        \begin{align*}
            f(x_j)&=\sum^m_{i=1}a_{ij}y_i,&f(x_{j'})&=\sum^{m'}_{i'=1}b_{i'j'}y'_{i'},
        \end{align*}
        であるから，
        \begin{align*}
            (f\otimes g)(x_j\otimes x'_{j'})&=f(x_j)\otimes g(x'_{j'})=\paren{\sum^m_{i=1}a_{ij}y_i}\otimes\paren{\sum^{m'}_{i'=1}b_{ii'j'}y'_{i'}}\\
            &=\sum^m_{i=1}\sum^{m'}_{i'=1}a_{ij}b_{i'j'}(y_i\otimes y'_{i'})=\sum^{m}_{i=1}a_{ij}(b_{1j'}y_i\otimes y'_1+\cdots+b_{m'j'}y_i\otimes y'_{m'})
        \end{align*}
        より，この$y_1\otimes y'_1,\cdots,y_m\otimes y'_1,\cdots,y_1\otimes y'_{m'},\cdots,y_m\otimes y'_{m'}$の係数を順に縦に並べると，$A$の列ベクトルを右の添字だけを残して$a_j=\begin{pmatrix}a_{1j}\\\vdots\\a_{mj}\end{pmatrix}$と表すと，
        \[\begin{pmatrix}a_jb_{1j'}\\\vdots\\a_jb_{m'j'}\end{pmatrix}\in M_{(mm')1}\]
        となる．よって結論を得る．
    \end{description}
\end{Proof}

\begin{proposition}
    $A\in M_m(K),B\in M_n(K)$について，
    \[\det(A\otimes B)=(\det A)^n(\det B)^m.\]
\end{proposition}

\subsection{線形写像のテンソル積}

\begin{corollary}\label{cor-tensor-product-of-linear-maps}\mbox{}
    \begin{enumerate}
        \item $f:V\to V',g:W\to W'$が全射(resp. 単射)ならば，$f\otimes g:V\otimes W\to V'\otimes W'$も全射(resp. 単射)である．
        \item $V'\subset V,W'\subset W$を部分空間とする．商空間への標準全射のテンソル積$V\otimes W\to(V/V')\otimes(W/W')$は，同型\[\o{p\otimes p'}:(V\otimes W)/(V'\otimes W+V\otimes W')\to (V/V')\otimes(W/W')\]を引き起こす．
        \item $V,W\in\FVS_K$とし，$f\in\End_K(V),g\in\End_K(W)$とする．$\Tr(f\otimes g)=\Tr g\cdot\Tr g,\det(f\otimes g)=(\det f)^{\dim W}(\det g)^{\dim V}$である．
    \end{enumerate}
\end{corollary}


\begin{notation}
    線型形式$f:V\to K$と$y\in W$に対して，線型写像$f\otimes y:V\to W$とは，
    \[\xymatrix@R-2pc{
        f\otimes y:V\ar[r]&W\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        x\ar@{|->}[r]&f(x)y
    }\]
    を表すものとする．$g:W\to K$も線型形式として，$f\otimes g:V\otimes W\to K$を
    \[\xymatrix@R-2pc{
        f\otimes g:V\otimes W\ar[r]&K\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x,y)\ar@{|->}[r]&f(x)g(y)
    }\]
    とする．
\end{notation}

\begin{example}[線型写像の空間の基底]
    $V,W\in\FVS_K$とする．
    \begin{enumerate}
        \item $V$の基底を$x_1,\cdots,x_n$とし，$f_1,\cdots,f_n\in V^*$を対応する双対基底とする．$y_1,\cdots,y_m$を$W$の基底とする．
        $f:V\to W$を線型写像とし，その$x_1,\cdots,x_n$と$y_1,\cdots,y_m$に関する行列表示を$A=(a_{ij})\in M_{mn}(K)$とすると，$f=\sum^m_{i=1}\sum^n_{j=1}a_{ij}f_j\otimes y_i$が成り立つ．
        \item 
        $x_1,\cdots,x_m\in V,y_1,\cdots,y_n\in W$を基底とし，$f_1,\cdots,f_m\in V^*,g_1,\cdots,g_n\in W^*$をそれらの双対基底とする．
        $b:V\times W\to K$を双線型形式とし，その$x_1,\cdots,x_m$と$y_1,\cdots,y_n$に関する行列表示を$A=(a_{ij})\in M_{mn}(K)$とする．$b$が定める線型写像$V\otimes W\to K$とは，$\sum^m_{i=1}\sum^n_{j=1}a_{ij}f_i\otimes g_j$である．
    \end{enumerate}
\end{example}

\begin{proposition}[テンソル積による完全系列の特徴付け]
    線型写像の列$V'\xrightarrow{f}V\xrightarrow{g}V''$について，次の３条件は同値．
    \begin{enumerate}
        \item $V'\xrightarrow{f}V\xrightarrow{g}V''$は完全系列である．
        \item 任意の$W\in\Vect_K$に対し，$V'\otimes W\xrightarrow{f\otimes 1}V\otimes W\xrightarrow{g\otimes 1}V''\otimes W$は完全系列である．
        \item 任意の$W\in\Vect_K$に対し，$W\otimes V'\xrightarrow{1\otimes f}W\otimes V\xrightarrow{1\otimes g}W\otimes V''$は完全系列である．
    \end{enumerate}
\end{proposition}

\section{行列と代数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    線型空間・写像の例と，いままでの抽象論の
    例と見れるような結果をまとめる．
    行列は一般の圏で，直和の間の直和射として得られる．
\end{tcolorbox}

\subsection{線型空間の例}

\begin{definition}[monoid ring, group ring]
    $A$を可換環，$G$をモノイドとする．
    \begin{enumerate}
        \item $A[G]:=\Brace{\al\in\Map(G,A)\mid\al(x)=0\;\fe}$とすると，$A[G]$は$A$の和によりアーベル群をなし，次の積により環の構造を持つ：
        \[(\al\beta)(z)=\sum_{xy=z}\al(x)\beta(y).\]
        右辺は有限和になることに注意．
        \item $a\cdot x\in A[G]$または$ax$によって，特性関数$a1_{\{x\}}$を表すものとすると，単位元は$1\cdot e\;(e\in G)$と表せる．
        \item さらに，埋め込み$G\mono A[G],A\mono A[G]$が存在し，後者によって$A[G]$は環$A$上の代数となる．これを\textbf{群環}または\textbf{モノイド代数}という．
    \end{enumerate}
\end{definition}

\begin{example}[加群の例]\mbox{}
    \begin{enumerate}
        \item \textbf{$X\in\Set$を生成元とする環$A$上の自由加群}を$A^{(X)}:=\Brace{f\in\Map(X,A)\mid f(x)=0\;\fe}$とする．
        \item $\Z$-加群とはアーベル群をいう．
        \item 環$R$の部分$R$-加群をイデアルという．一般に環準同型$\varphi:A\to B$について，$B$は$A$-加群とみなせる．
    \end{enumerate}
\end{example}

\subsection{多項式の空間}



\begin{example}[多項式の空間]
    $R[X]$は$R$-代数になる．
    \begin{enumerate}
        \item $R[X]$は加群である．$R[X,Y]:=(R[X])[Y]$とみなせる．
        \item $W_f:=\Brace{g\in K[X]\mid\deg g< \deg f}$とすると，$K[X]=(f)\oplus W_f$と分解できる．すなわち，$f=qg+r\mapsto(q,r)$は全単射である．
        \item 補空間$W_f$は商空間として$W_f\iso K[X]/(f)$の表示を持つ．$f$が一次式のとき，$K[X]/(f)\simeq K$となり，評価写像が準同型を与える．因数定理と呼ばれる．
        \item $f=X^n+a_1X^{n-1}+\cdots+a_{n-1}X+a_n$と表示出来るとき，$W_f=K[X]/(f)$の基底として$\o{1},\o{X},\cdots,\o{X^{n-1}}$が取れる．これについての$X$倍写像$F_X:K[X]\to K[X]$の行列表示を，\textbf{$f$の同伴行列}という．$W_f$は$\o{1}$が生成する$F_X$-安定部分空間である．
    \end{enumerate}
\end{example}

\begin{example}
    $\R[X]$の正規直交基底は次のようなものがある．
    \begin{enumerate}
        \item $L_k(x)=\frac{e^x}{k!}\dd{^k}{x^k}(e^{-x}x^k)=\sum_{i=0}^k(-1)^i \begin{pmatrix}k\\i\end{pmatrix}\frac{x^i}{i!}\;(k=0,1,2,\cdots,n)$は$n$次以下の多項式の空間$\R[X]/(X^{n+1})$の，内積$(f,g)=\int_{\R}e^{-x}f(x)g(x)dx$に関する正規直交基底である．これを\textbf{Laguerreの多項式}という．
        \[\paren{x\dd{^2}{x^2}+(k+1-x)\dd{}{x}+(n-k)}L_n^k(x)=0\]
        の解を陪多項式といい，$L^k_n(x)=\dd{^k}{x^k}L_n(x)$の関係がある．
        陪の字は「陪う（したがう）」ともよみ，お供するという意味で，「陪審」などで使われる．
        \item $He_n(x):=(-1)^ne^{\frac{x^2}{2}}\dd{^n}{x^n}e^{-\frac{x^2}{2}}$を\textbf{Hermite多項式}といい，内積
        \[\int_{\R}H_m(x)H_n(x)e^{-\frac{x^2}{2}}dx=\sqrt{2\pi}n!\delta_{nm}\]
        なる直交関係があり，$(H_m)_{m=0,1,\cdots,n}$も$n$次以下の多項式の空間$\R[X]/(X^{n+1})$の適切な内積に関する正規直交基底となる．
        同様の内積に関して，$L^2(\R,e^{-x^2/2}dx)$の完全正規直交系でもある．
    \end{enumerate}
\end{example}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item $K$を体とする．$K[X]\otimes K[Y]\simeq K[X,Y]$である．
        \item $\C\otimes_\R[X]\simeq\C[X]$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    多項式空間の基底を考えることより，$K[X]=\bigoplus^\infty_{n=0}KX^n$であることが分かる．
    \begin{enumerate}
        \item 次が同型であることを示す．\[\xymatrix@R-2pc{
            f:K[X]\otimes K[Y]\ar[r]&K[X,Y]\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            f\otimes g\ar@{|->}[r]&fg
        }\]
        注\ref{remark-テンソル積の無限分配法則}より，
        \begin{align*}
            K[X]\otimes K[Y]&=\paren{\bigoplus^\infty_{n=0}KX^n}\otimes\paren{\bigoplus^\infty_{n=0}KY^n}\\
            &=\bigoplus_{n=0}^\infty\bigoplus_{m=0}^\infty KX^n\otimes Y^m
        \end{align*}
        である．$K[X,Y]$の基底も$X^nY^m$であるから，$f$は基底$X^n\otimes Y^m$と$X^nY^m$とが定める同型である．

        \item 次が同型であることを示す．\[\xymatrix@R-2pc{
            g:\C\otimes_\R\R[X]\ar[r]&\C[X]\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            a\otimes f\ar@{|->}[r]&af
        }\]
        注\ref{remark-テンソル積の無限分配法則}より，実数の複素化は複素数である$\C\otimes_\R\R=\R_\C=\C$ということに注意して，
        \begin{align*}
            \C\otimes_\R\R[X]&=\C\otimes_\R\paren{\bigoplus^\infty_{n=0}\R X^n}\\
            &\cong\bigoplus^\infty_{n=0}\C\otimes_\R\R X^n=\bigoplus^\infty_{n=0}\C X^n=\C[X]\footnote{全部イコールで繋ぐのはまずいという鶴崎さんからの指摘}
        \end{align*}
        より．途中の同型は，基底$1\otimes X^0,\cdots,1\otimes X^n,\cdots,i\otimes X^0,\cdots,i\otimes X^n,\cdots\in\C\otimes_\R\paren{\bigoplus^\infty_{n=0}\R X^n}$と$X^0,\cdots,X^n,\cdots,iX^0,\cdots,iX^n,\cdots\in\bigoplus^\infty_{n=0}\C X^n$とが定める同型であることから従う．
    \end{enumerate}
\end{Proof}
\begin{remarks}
    $K[X]\otimes K[Y]$の基底は$X^n\otimes Y^m\;(n,m\ge 0)$．
\end{remarks}

\subsection{行列の空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    スカラー倍が作用であるところから，行列という標準的線型写像は$K^n$への左作用かつ$V$への右作用に間違いない．
    そして，代数$M_n(K)$の自己準同型は，全て共役による作用の形で表される．
\end{tcolorbox}

\begin{example}[行列の空間]\mbox{}
    \begin{enumerate}
        \item $M_n(R)$は，標準的単射$R\mono M_n(R)$によって$R$上の加群，さらに行列積によって代数の構造を持つ．
        \item また，双線型形式$\brac{A,B}:=\Tr(AB)$は$M_n(\R)$の内積を与え，これについてもBanach代数をなす．
        \item $M_{n\sa}(K):=M_n(K)$を自己共役行列のなす部分空間とする．
        \item 群準同型$\det:\GL_n(K)\to K^\times$の核を\textbf{特殊線型群}と呼び，$\SL_n(K)$で表す．
    \end{enumerate}
\end{example}


\begin{example}[一般線形群の作用***]
    重要な作用が3種類ある．
    \begin{enumerate}
        \item \textbf{共役による作用}$\GL_n(K)\to\Aut(M_n(K))$による共役類を，\textbf{標準形}といい，商群は$\Hom_K(K^n)$と同型．
        \item \textbf{自然な作用}$M_n(K)\to\Aut(M_n(K))$についての$A\in M_n(K)$の中心化群$Z_{M_n(K)}(A):=\Brace{B\in M_n(K)\mid AB=BA}$は，一斉対角化可能である．
        \item 双線型形式$b$の$f\in\GL(V)$による引き戻し$f^*b$を$f^*b(x,y)=b(f(x),f(y))$で定めると，\textbf{引き戻しによる作用}$\Bil(V)\times\GL(V)\to\Bil(V);(b,f)\mapsto f^*b$を得る．同型$M_n(K)\simeq\Bil(K^n)$に注意すると，作用$M_n(K)\times\GL_n(K)\to M_n(K)$は$(A,P)\mapsto{}^t\!PAP$と表せる．
        \begin{enumerate}[(i)]
            \item $M_n(\R)$の部分集合$\{A\in M_n(\R)\mid Aは対称行列であり，b_Aの符号数は(r,s)である\}$はこの作用に関する$\GL_n(K)$-軌道である．
            \item 自己共役形式$h$の$f\in\GL(V)\;(V\in\FVS_K)$による引き戻しによる作用$M_{n\sa}(\C)\times\GL_n(\C)\to M_{n\sa}(\C)$は$(A,P)\mapsto{}^t\!PA\o{P}$で与えられる．
            \item $M_n(\C)$の部分集合$\{A\in M_n(\C)\mid A正定値\mathrm{Hermite}行列\}$はこの作用に関する$\GL_n(\C)$-軌道である．
        \end{enumerate}
    \end{enumerate}
\end{example}

\begin{proposition}
    零でない任意の代数の準同型$f:M_n(K)\to M_n(K)$について，ある$P\in\GL_n(K)$が存在して，$f(X)=P^{-1}XP$．
\end{proposition}

\begin{example}[orthogonal group, special orthogonal group, symplectic group]
    $V\in\FVS_K$とし，$\GL(V)$の，$V$上の双線型形式全体の空間$\Bil(V)$への引き戻しによる右作用を考える．
    \begin{enumerate}
        \item $b\in B(V)$を非退化対称形式とする．$b$の固定部分群$O(V,b)=O_b(V):=\{f\in\GL(V)\mid \forall x,y\in V,\;b(f(x),f(y))=b(x,y)\}$は，$b$に関する直交変換全体の群となる．これを$b$の\textbf{直交群}という．
        \item $V=K^n$，$b$を標準的な対称形式$b(x,y)={}^t\!xy$とすると，固定部分群は直交行列全体の集合$O_n(V):=O(V,b)=\{A\in\GL_n(K)\mid AA^{-1}=1\}$となる．これを\textbf{$n$次直交群}という．
        \item $\det:O_n(K)\to K^\times$の核$SO_n(K):=O_n(K)\cap\SL_n(K)$を$n$次\textbf{特殊直交群}という．
        \item $V$を偶数次元とする．命題\ref{prop-existence-of-symplectic-basis}より，$B(V)$の非退化交代形式からなる部分集合$A(V)$は$\GL(V)$-軌道である．
        \item 非退化交代形式$b\in B(V)$の固定部分群$Sp(V,b)=Sp_b(V):=\{f\in\GL(V)\mid \forall x,y\in V,\;b(f(x),f(y))=b(x,y)\}$を$b$の\textbf{斜交群}という．
        \item $V=K^{2n}$，$b$を交代行列$J=\begin{pmatrix}0&1_n\\-1_n&0\end{pmatrix}$が定める非退化交代形式とする時，$Sp_{2n}(K):=Sp(V,b)=\{A\in\GL_{2n}(K)\mid {}^t\!AJA=J\}$を\textbf{$2n$次斜交群}という．実は$Sp_{2n}(K)\subset\SL_{2n}(K)$である．
    \end{enumerate}
\end{example}

\begin{example}[unitary group]
    $V\in\FVS_\C$とし，例\ref{example-action-of-pullback-hermitian-forms}の$\GL(\C)$の，$V$上のHermite形式全体の空間$H(V)$への引き戻しによる右作用を考える．
    \begin{enumerate}
        \item 正定値Hermite形式$h$の固定部分群$U(V,h)=U_h(V):=\{f\in\GL(V)\mid\forall x,y\in V,\;h(f(x),f(y))=h(x,y)\}$は$h$に関するunitary変換全体からなる．これを\textbf{ユニタリ群}という．
        \item $V=\C^n$，$h$を標準的なHermite形式$h(x,y)={}^t\!x\overline{y}$とすると，固定部分群は$U_n:=U(V,h)=\{A\in\GL_n(\C)\mid AA^*=1\}$となる．これを\textbf{$n$次ユニタリ群}という．
        \item $\det:U_n\to\C^\times$の核$SU_n:=U_n\cap\SL_n(\C)$を$n$次\textbf{特殊ユニタリ群}という．
    \end{enumerate}
\end{example}

\subsection{係数拡大}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    体の拡大は，線型空間の上に拡大を引き起こす．その随伴概念は係数制限になる．
    テンソル積の言葉を用いて，元から構成的にも議論出来る．
\end{tcolorbox}

\begin{proposition}[係数拡大に伴う線型空間の拡大]
    $V\in\FVS_K$，
    $K\mono L$を体の間の単射環準同型とする．
    \begin{enumerate}
        \item 体の作用$K\to\Aut(V)$は形式的な方法で唯一の環準同型$L\to\Aut(V^L)$に延長する．これを線型空間$V^L\in\FVS_L$とする．
        \item $V^L$は$K$上の線型空間とみることもでき，このとき$V$を部分空間に持つ．
        \item $V$の任意の基底は$V^L$の$L$上の基底になる．
    \end{enumerate}
    この単射線型写像$i:V\mono V^L$を，係数拡大に伴う線型空間の拡大とする．
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $V^L:=L\otimes_KV$とし，作用$L\to\Aut(V^L)$は$\al(\beta\otimes x)=(\al\beta)\otimes x$とすればよい．
    \end{enumerate}
\end{Proof}

\begin{proposition}[係数拡大に伴って引き起こされる$L$-線型写像]
    任意の$V,W\in\FVS_K$間の$K$-線型写像$A:V\to W$に対して，$i:V\mono V^L,W\mono W^L$を通じて$L$-線型写像$A^L:V^L\to W^L$が一意的に引き起こされる：$A^L\paren{\sum\al_i x_i}=\sum\al_i(Ax_i)$．
    \begin{enumerate}
        \item $V,W$の任意の基底について，$A$と$A^L$の行列表示は一致する．
        \item ${}^L:\Hom_K(V,W)\to\Hom_L(V^L,W^L)$は代数の準同型である：
        $(A+B)^L=A^L+B^L$．$(\al A)^L=\al A^L$．$(AB)^L=A^LB^L$．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    明らかに$\Hom_L(V,W)\subsetneq\Hom_L(V,W)$となり，縮小する．
\end{remarks}

\begin{proposition}[係数拡大線型写像の性質]
    代数の準同型${}^L:\Hom_K(V,W)\to\Hom_L(V^L,W^L)$は，
    \begin{enumerate}
        \item $\det:\Hom_K(V,W)\to K,\Hom_L(V^L,W^L)\to L$と可換．
        \item $\rank_K:\Hom_K(V,W)\to\N$は$\rank_L:\Hom_L(V,W)\to\N$の制限である．
        \item $\rank:\Hom_K(V,W)\to\N,\rank:\Hom_L(V^L,W^L)\to\N$と可換．
    \end{enumerate}
\end{proposition}

\begin{proposition}[係数制限]
    $U\in\Vect_L$とし，$K\subset L$を部分体とする．${}_KU$を作用$L\to\Aut(U)$の制限によって$K$-線型空間とみたものとすれば，$\dim{}_KU=\dim U\cdot\dim_KL$．
\end{proposition}
\begin{remarks}
    係数体が制限を食らったために，空間の中で別の元と見なす必要が出てきてしまい，次元が増える．
    例えば任意の$U\in\Vect_\C$の係数制限$V:={}_\R U$上の線型写像$J:x\mapsto ix$は$J^2=-I$を満たす．
\end{remarks}

\begin{proposition}[複素構造による複素化]
    $V\in\Vect_\R$，$J\in\End_\R(V)$は$J^2=-I$を満たすとする．このとき，作用$\C\to\Aut(V)$を$(a+bi)x:=ax+bJx$と定めると，
    この複雑な作用をスカラー倍とすることで$V$は同時に$\C$-線型空間でもある．
    これの係数制限は再び元の$V$である．
    このときの実線型同型$J:V\iso V$を\textbf{複素構造}という．
\end{proposition}

\subsection{複素化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Galoisの体の拡大の理論を線形代数化したのがArtinで，さらに圏論に押しすすめたのがGrothendieckである．
    複素空間上の半双線型形式は，複素共役線型空間からの双線型形式と見れる．
\end{tcolorbox}

\begin{definition}
    $V\in\FVS_\R$上の自己同型$J\in\Aut(V)$で$J^2=-\id$を満たすものを\textbf{複素構造}という．
    すると，作用$\C\times V\to V$が，この$J\in\Aut(V)$を$i\in\C$に対応づけることで$(a+bi)x:=ax+bJx$によって定まる．
    実際，$J^2=-\id$としたから，$\forall_{z,w\in\C}\;(zw)x=z(wx)$は明らかである．
    よって，スカラー倍をこのように定めることで$V$は同時に$n$次元複素線型空間でもある．
    これを$V_\C$と表して区別する．
    \item $x=Jx\Rightarrow x=0$より，$V_\C\simeq_\R V\oplus V$とみなせる．
\end{definition}
\begin{remarks}
    $i$が$\C\simeq\R^2$上に引き起こす線型変換を，一般の$V\FVS_\R$に一般化したものを複素構造といい，ここ
    を起点に代数的な方法で，複素数からの作用を模倣することができるためにこういう．
\end{remarks}

\begin{example}[複素線型空間の共役]
    $\A$を$*$-代数とし，$V\in\Vect_\A$とする．作用$\act:\A\to\Aut(V)$に$*$-作用素$:\A\to\A$を合成して得られる作用$\act\circ*:\A\to\Aut(V)$によって$V$を$\A$-線型空間とみたとき，$V'$と表して$V$の\textbf{共役}という．
    線型写像$f:V\to W$の「随伴」$f':V'\to W'$の行列表示は，元の複素共役$\o{A}$になる．
\end{example}

\begin{example}[実線形空間の複素化]
    $V\in\Vect_\R$の体の包含$\R\mono\C$についての係数拡大$V^\C$を\textbf{複素化}という．構成は次の2つがあり，いずれも同型な線型空間を定める：
    \begin{enumerate}
        \item $\C\otimes_\R V$上に作用$\al(\beta\otimes x)=(\al\beta)\otimes x$を考えたものをいう．
        \item 列ベクトルの空間$V^2$上に複素数$\al=a+bi$の作用を行列$\begin{pmatrix}a&-b\\b&a\end{pmatrix}$の作用として与えたものをいう．このとき，第一要素を実部，第二要素を虚部とすれば，$V^\C\simeq\C^n$が成り立つ．
    \end{enumerate}
    (1),(2)の対応は次のように商空間の普遍性から得られる．
    $V\in\Vect_\R$とし，$V_\C$を(2)の意味での複素化とする．
    スカラー倍による双線型写像$\C\times V\to V_\C$は，テンソル積からの同型$\C\otimes_\R V\to V_\C$を定める．
    \[\xymatrix{
        \C\times V\ar[r]^-{\otimes}\ar[dr]_-{\cdot}&\C\otimes_\R V\ar@{.>}[d]\\
        &V_\C
    }\]
\end{example}

\begin{example}[複素化とテンソル積：実軸上の点に対する複素線型変換]
    $V\in\Vect_\R$とし，$V_\C$をその複素化とする．
    スカラー倍$\C\times V\to V_\C$は，テンソル積への同型$\C\otimes_\R V\to V_\C$(これは実線型)を定める．
    \[\xymatrix{
        \C\times V\ar[r]^-{\otimes}\ar[dr]_-{\cdot}&\C\otimes_\R V\ar@{.>}[d]\\
        &V_\C
    }\]
    FVSで翻訳すれば，$\C$の$\R$-基底$1,i$と$V$の$\R$-基底$(x_1,\cdots,x_n)$について，$V^\C$の$\R$-基底は$(1,x_1),(i,x_1),\cdots,(1,x_n),(i,x_n)$となる．
\end{example}

\begin{example}[複素行列]
    以上の例を行列の空間で考えると，$\C\otimes_\R M_n(\R)\iso M_n(\C)=M_n(\R)^\C$となる．
\end{example}

\section{行列の代数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    行列の代数的な特徴を調べ，行列式の構造に集約される様子を見る．
    その次に，可換性と固有値の関係を調べ，Gram行列(複素数の絶対値$\al\o{\al}=\abs{\al}^2$に当たる)という極めて安定な構造に帰着させる．
\end{tcolorbox}

\subsection{2次元行列のJordan標準形}

\begin{proposition}
    $M_2(\R)$は(1),(2),(3)のいずれかと共役になり，(1),(2),(3)のいずれも互いに共役でない．
    $M_2(\C)$は(1),(2)のいずれかと共役になり，(3)は対角化可能になる．
    \begin{enumerate}
        \item 対角行列：$\diag(a,b)$．
        \item 冪零成分を持つ行列：$\begin{pmatrix}a&1\\0&a\end{pmatrix}$．
        \item 回転行列：$\begin{pmatrix}a&-b\\b&a\end{pmatrix}$．
    \end{enumerate}
    (1)と(3)の区別が存在するのは，$\R$が代数的閉体でないことに起因する．
\end{proposition}
\begin{remarks}
    冪零成分とはどういうことかの観察に向いている．
    $(1,a)^\top$の成分は，どのように基底をとっても部分空間$\bF(1,0)$に干渉してしまう．
    この成分を抜くと対角にできて，この成分はいずれ消える冪零成分である．
\end{remarks}

\subsection{交代化と対称化}

\begin{notation}[Levi-Civita, Einstein]
    $\Brace{i_1,\cdots,i_r},\Brace{j_1,\cdots,j_r}\subset[n]$について，
    \begin{enumerate}
        \item $\Brace{i_1,\cdots,i_r}\ne\Brace{j_1,\cdots,j_r}$のとき，$\ep^{i_1,\cdots,i_r}_{j_1,\cdots,j_r}=0$とする．
        \item そうでないとき，$\sigma(i_k)=j_k$の置換の符号を$\ep^{i_1,\cdots,i_r}_{j_1,\cdots,j_r}$とする．
    \end{enumerate}
    これを\textbf{Levi-Civita記号}という．
    $v\in M_{1n}(K),e\in M_{n1}(K)$について，
    \[v_ie^i:=\sum_{i\in[n]}v_ie^i\]
    を\textbf{Einsteinの縮約記法}という．
\end{notation}

\begin{definition}
    任意の量$F_{i_1,\cdots,i_r}$に対して，
    \begin{enumerate}
        \item 次の量を\textbf{交代化}という：
        \[F_{[i_1,\cdots,i_r]}:=\frac{1}{r!}\sum_{j_1\in[n]}\cdots\sum_{j_r\in[n]}\ep^{j_1\cdots j_r}_{i_1\cdots i_r}F_{j_1\cdots j_r}.\]
        \item 次の量を\textbf{対称化}という：
        \[F_{(i_1,\cdots,i_r)}:=\frac{1}{r!}\sum_{j_1\in[n]}\cdots\sum_{i_r\in[n]}F_{j_1\cdots j_r}.\]
    \end{enumerate}
\end{definition}
\begin{remarks}
    これは$F_{i_1,\cdots,i_r}$の，標本$(i_1,\cdots,i_r)$の全ての並び替えについて平均を取ったリサンプリングともみなせる．
\end{remarks}

\subsection{行列式}

\begin{definition}[minor, principal minor, leading principal minor]
    行列$A\in M_{mn}(K)$について，
    \begin{enumerate}
        \item 正方部分行列の行列式を\textbf{小行列式}という．
        \item 特に$\abs{A}^{i_1,\cdots,i_r}_{i_1,\cdots,i_r}$という形のものを\textbf{主小行列式}という．
        \item 特に$\abs{A}^{12\cdots r}_{12\cdots r}$という形のものを\textbf{首座小行列式}という．
    \end{enumerate}
\end{definition}

\begin{definition}
    $A\in M_n(K)$について，
    \begin{enumerate}
        \item $a_{ij}$の\textbf{余因子}とは，
        \[\De_{ij}:=(-1)^{i+j}\abs{A}^{1,\cdots,i-1,i+1,\cdots,n}_{1,\cdots,j-1,j+1,\cdots, n}\]
        をいう．
        \item \textbf{余因子行列}または\textbf{随伴行列}とは，
        \[\Adj A:=(\De_{ji})\]
        で定める．
    \end{enumerate}
\end{definition}

\begin{proposition}[Laplace expansion]
    $\det A$は$A$のある行$i_0$の各要素に，その余因子をかけて加えたものに等しい：
    \[\det A=\sum_{j=1}^na_{i_0j}\De_{i_0j}.\]
    特に，$A(\Adj A)=(\det A)O_n$が成り立つ．
\end{proposition}

\begin{proposition}[Cauchy-Binetの公式]
    \[\det(AB)=\sum_{S\subset[n],\abs{S}=m}\det(A_S)\det(B^S).\]
\end{proposition}

\begin{proposition}[Pfaffian]
    $A\in M_n(K)$は反対称=交代行列であるとする：${}^t\!A=-A$．
    \begin{enumerate}
        \item $n$が奇数ならば，$\det A=0$．
        \item $n$が偶数ならば，
        \[\det A=\paren{\frac{n!}{\paren{\frac{n}{2}}!2^{n/2}}a_{[12}a_{34}\cdots a_{n-1,n]}}^2=\paren{\frac{1}{2^nn!}a_{i_1j_1}\cdots a_{i_nj_n}\ep^{12\cdots (2n-1)2n}_{i_1j_1\cdots i_nj_n}}^2.\]
        括弧の中身を$\Pf A$とおく．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 次が必要：
        \[\det M=\det(-M^\top)=\det(-M)=(-1)^n\det M.\]
    \end{enumerate}
\end{Proof}
\begin{example}
    反対称行列$A\in M_4(K)$を
    \[A:=\begin{pmatrix}0&a_{12}&a_{13}&a_{14}\\0&0&a_{23}&a_{24}\\0&0&0&a_{34}\\0&0&0&0\end{pmatrix}-\begin{pmatrix}0&a_{12}&a_{13}&a_{14}\\0&0&a_{23}&a_{24}\\0&0&0&a_{34}\\0&0&0&0\end{pmatrix}^\top\]
    について，$\Pf A=a_{12}a_{34}-a_{13}a_{24}+a_{14}a_{23}$．
\end{example}

\subsection{小行列式}

\begin{proposition}[Grassmann-Plucker]
    横長行列$A\in M_{mn}(K)\;(m\le n)$の$m$次の小行列式$v_{j_1\cdots j_m}:=\abs{A}^{1\cdots m}_{j_1\cdots j_m}$について，
    \[v_{[j_1\cdots j_m}v_{i_1]i_2\cdots i_m}=0.\]
\end{proposition}

\subsection{逆行列}

\begin{proposition}
    $A\in \GL_n(K),D\in \GL_m(K),B\in M_{nm}(K),C\in M_{mn}(K)$かつ$D^{-1}-CA^{-1}B\in\GL_m(K)$とする．
    \begin{enumerate}
        \item (Woodbury) 次が成り立つ：
        \begin{align*}
            (A+BDC)^{-1}&=A^{-1}-A^{-1}B(D^{-1}+CA^{-1}B)^{-1}CA^{-1}\\
            &=A^{-1}-A^{-1}BD(D+DCA^{-1}BD)^{-1}DCA^{-1}.
        \end{align*}
        \item (Sherman-Morrison) 特に$m=1,B=\b{b},C=\b{c}^\top,D=1$のとき，
        \[(A+\b{b}\b{c}^\top)^{-1}=A^{-1}-\frac{(A^{-1}\b{b}(\b{c}^\top A^{-1}))}{1+\b{c}^\top A^{-1}\b{b}}.\]
    \end{enumerate}
\end{proposition}
\begin{remarks}
    $A\in\GL_n(K)$の摂動$+BDC$が再び可逆であるための条件を与えていると見れる．
\end{remarks}

\subsection{可換性と固有値}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    可換性の難しさは，直交の概念，すなわち計量の構造と深く関わることによる．
\end{tcolorbox}

\begin{theorem}
    $A,B\in M_n(\C)$について，
    \begin{enumerate}
        \item $AB$と$BA$の固有値は重複度を込めて一致する．
        \item $AB=BA$のとき，$A,B$は共通の固有ベクトルを持つ．
    \end{enumerate}
\end{theorem}

\subsection{Gram行列と特異値}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $A=(a_i)$のGram行列は標準内積に関する内積構造$G=((a_i|a_j))_{ij}$に他ならないためである．
\end{tcolorbox}

\begin{definition}[Gram matrix]
    一般の行列$A\in M_{mn}(K)$の\textbf{グラム行列}とは，正方行列$G:=A^*A\in M_{n}(K)$をいう．
\end{definition}

\begin{proposition}[Gram行列の性質]
    任意の$A\in M_{mn}(\C)$について，
    \begin{enumerate}
        \item Gram行列は半正定値なHermite行列である．
        特に正規であり，特に固有値は全て非負実数であり，
        半正定値な行列$\sqrt{A^*A}\ge0$が唯一存在して，$(\sqrt{A^*A})^2=A^*A$を満たす．
        \item また，任意の半正定値行列は，ある行列$B\in M_{mn}(\C)$のGram行列である\cite{柳井-竹内-一般逆行列}(定理1.12)．
        \item 次の3条件は同値：
        \begin{enumerate}
            \item Gram行列$G=A^*A$は正定値でもある．
            \item $n=m$かつ$A$は正則．
            \item $A^*A$は正則．
        \end{enumerate}
    \end{enumerate}
\end{proposition}

\subsection{特異値の定義}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    固有値は正方行列についてのみ定義される量であった．
    一般の行列についてもGram行列を通じて，幾何平均として特異値を定義することができる．
\end{tcolorbox}

\begin{definition}[singular value]\mbox{}
    \begin{enumerate}
        \item 一般の行列$A\in M_{mn}(K)$について，Gram行列の固有値の非負の平方根
        $\sigma_i(A):=\sqrt{\lambda_i(A^*A)}$を\textbf{特異値}といい，その全体を$\Sg(A)\subset\R$で表す．
    \end{enumerate}
\end{definition}

\begin{proposition}[特異値の性質]
    正方行列$A\in M_n(\R)$について，
    \begin{enumerate}
        \item $A$が正規行列ならば，特異値とは固有値の絶対値である：$\sigma_i(A)=\abs{\lambda_i(A)}$．
        \item $A$が半正定値Hermite行列ならば，特異値とは固有値に等しい．
    \end{enumerate}
\end{proposition}

\section{空間の分解と自己共役行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    正定値関数とはFourier変換の値域になるクラスでもある．
    $B(H)_\sa$はイデアル，$B(H)_+$はその正錐になる．
\end{tcolorbox}

\subsection{定値性とGram行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    実はGram行列の全体は半正定値行列と同じクラスをなす．
    これを詳しく見る．
\end{tcolorbox}

\begin{theorem}[Sylvester]
    Hermite行列$A\in M_n(\C)$について，次は同値．
    \begin{enumerate}
        \item $A$は正定値である：$\forall_{z\in\C^n\setminus\{0\}}\;z^*Az>0$．
        \item $n$個の首座小行列式は正である．
        \item 全ての固有値は正である：$\Sp(A)\subset\R^+$．
        \item $(x|y):=y^*Ax$は内積を定める．
        \item ある$B\in \GL_{n}(\C)$のGram行列である：$A=B^*B$．
        \item 一意なCholesky分解を持つ：正実数を対角成分に持つ下三角行列$L$が存在して，$A=LL^*$と表せる．
    \end{enumerate}
    また$A\in M_n(\R)$のとき，$\forall_{x\in\R^n\setminus\{0\}}\;x^\top Ax>0$に同値．
\end{theorem}

\begin{definition}
    正定値Hermite行列$A$のCholesky分解に登場する正実数を対角成分に持つ下三角行列$L$を\textbf{三角平方根}といい，$A_{1/2}$と表す．
\end{definition}

\begin{theorem}
    Hermite行列$A\in M_n(\C)$について，次は同値．
    \begin{enumerate}
        \item $A$は半正定値である：
        \item $\begin{pmatrix}m\\k\end{pmatrix}\cdot \begin{pmatrix}n\\k\end{pmatrix}$個の主小行列式は非負である．
        \item 全ての固有値は非負である：$\Sp(A)\subset\R_+$．
        \item ある$B\in M_{nk}(\C),k:=\rank A$のGram行列である：$A=BB^*$．
    \end{enumerate}
\end{theorem}

\subsection{定値性が定める順序関係}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item $A\ge B>0$ならば，$\det A\ge\det B$かつ$B^{-1}\ge A^{-1}$である．
        \item $A\in M_{mn}(\R),B\in M_{mq}(\R)$について，$\rank B=q$ならば，$A^\top A\ge A^\top B(B^\top B)^{-1}B^\top A$．
    \end{enumerate}
\end{proposition}


\subsection{冪等行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    冪等行列=射影行列は半正定値である．
    そして，冪等行列は直和分解と同値な対象であることがわかる．
\end{tcolorbox}

\begin{proposition}[冪等行列の固有値]
    $A\in M_n(\R)$について，次は同値：
    \begin{enumerate}
        \item $A$は冪等である：$A^2=A$．
        \item $\Ker A=\Im(I_n-A)$．特に，$\Ker A\cap\Im A=0$．
        \item $\Sp(A)\subset 2$．
        \item $\rank A+\rank(I-A)=n$．
        \item $\Im A$上で$Ax=x$であり，$\R^n\simeq\Im A\oplus\Ker A$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] まず，(1)が成立するとき，$\R^n\simeq\Im A\oplus\Ker A$が成り立ち，さらに$\Ker A=\Im(I_n-A)$でもある．
        実際，$\Ker A\subset\Im(I_n-A)$は$x\in\Ker A$が$(I_n-A)x=x$を導くことから，
        $\Ker A\supset\Im(I_n-A)$は$A(I_n-A)=O$からわかる．

        逆に，$A(I_n-A)=O$は$A=A^2$を含意している．
        \item[(1)$\Rightarrow$(5)] (5)$\Rightarrow$(1)は，任意の$x\in\R^n$に対して$A^2x=A(Ax)=Ax$が成り立つため．
        (1)$\Rightarrow$(5)については，直和分解により$x=x_1+x_2\in V\oplus W$と分解できるが，
        (2)から$Ax=x\;\on\Im A$が必要になる．
        \item[(5)$\Rightarrow$(4)] なるほど同値である．
        \item[(3)$\Rightarrow$(1)] そうでなければ$A^2=A$に矛盾する．
    \end{description}
\end{Proof}

\begin{theorem}[冪等行列の標準形]
    $A\in M_n(\R)$は冪等行列で，$\rank A=r$とすると，
    \[\Delta_r:=\diag(\underbrace{1,\cdots,1}_{r\text{個}},0,\cdots,0)\]
    に相似である．
\end{theorem}

\begin{corollary}
    $A\in M_n(\R)$が冪等であるとする．次が成り立つ：
    \begin{enumerate}
        \item $\rank A=\Tr(A)$．
        \item 特に，$A\in M_2(\R)$が冪等ならば，対角行列であるか，行列の跡が1であるか，零であるかである．
        \item 特に，単位行列でない冪等行列は特異である．
        \item $A$は$\Im A$への射影である．$I-A$は$\Ker A$への射影である．
    \end{enumerate}
\end{corollary}

\subsection{直交射影}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=] 
    冪等行列は空間の直和分解と同値である．
    特にこれが互いに直交な空間からなる分解であることと，冪等行列が自己共役でもあることとは同値である．
    自己共役性を持つ冪等行列を直交射影という．
\end{tcolorbox}

\begin{proposition}[直交する射影の特徴付け]
    冪等行列$A\in M_n(\R)$について，次は同値：
    \begin{enumerate}
        \item $\Im A\perp \Ker A$．
        \item $A$は対称：$A^\top =A$．
        \item $A$はノルム減少的である\cite{柳井-竹内-一般逆行列}定理2.22．
    \end{enumerate}
\end{proposition}

\begin{theorem}[直交射影の間の関係\footnote{\cite{柳井-竹内-一般逆行列}定理2.10}]
    $P_1,P_2$を直交射影とする．次は同値：
    \begin{enumerate}
        \item $P_1+P_2$が直交直和空間$\Im P_1\oplus\Im P_2$上への直交射影である．
        \item $P_1P_2=P_2P_1=O$．
        \item $\Im P_1\perp\Im P_2$．
    \end{enumerate}
\end{theorem}

\begin{proposition}[直交射影行列の表示]
    $A\in M_{mn}(\R)$は$\rank A=n\le m$を満たすとする．
    $A(A^\top A)^{-1}A^\top$は$A$の列空間$\Im A$への直交射影である．
\end{proposition}

\subsection{射影行列の系}

\begin{theorem}
    $P_1,P_2$を射影行列とする．次は同値：
    \begin{enumerate}
        \item $P_1P_2$は直交射影行列である．実はこのとき，$\Im(P_1P_2)=\Im P_1\cap\Im P_2$．
        \item $P_1P_2=P_2P_1$．
    \end{enumerate}
\end{theorem}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(2)$\Rightarrow$(1)] $(P_1P_2)^2=P_1^2P_2^2=P_1P_2$より射影行列である．
        また，そもそも$\R^n=(\Im P_1\cap\Im P_2)\oplus(\Ker P_1+\Ker P_2)$が成り立つ．
        よって，$\Im P_1\cap\Im P_2$上で$\id$，$\Ker P_1+\Ker P_2$で零であることを確認すれば良いが，これはすぐに従う．
        \item[(1)$\Rightarrow$(2)] 直交射影であるならば，$(P_1P_2)^\top=P_2P_1$より．
    \end{description}
\end{Proof}

\begin{theorem}[$I$の分解を与える射影行列の系\footnote{\cite{柳井-竹内-一般逆行列}定理2.13}]
    正方行列の系$\{P_i\}_{i\in[m]}\subset M_n(\R)$は$I_n$の分解であるとする：
    \[I_n=P_1+P_2+\cdots+P_m\]
    このとき，次は同値：
    \begin{enumerate}
        \item $\forall_{i\ne j\in[m]}\;P_iP_j=O$．
        \item $\forall_{i\in[m]}\;P_i^2=P_i$．
        \item $\sum_{i\in[m]}\rank P_i=n$．
    \end{enumerate}
\end{theorem}

\begin{theorem}[Khatri (1968) による一般化\footnote{\cite{柳井-竹内-一般逆行列}定理2.14}]
    $\{P_j\}_{j\in[m]}\subset M_n(\R)$を正方行列，$P:=P_1+P_2+\cdots+P_m$とする．次の4条件について，(1),(2),(3)のうち任意の2つから他の2つの主張が導かれ，また(3),(4)$\Rightarrow$(1),(2)である．
    \begin{enumerate}
        \item $\forall_{j\in[m]}\;P_j^2=P_j$．
        \item $\forall_{i\ne j\in[m]}\;P_iP_j=O$．かつ$\rank P_i^2=\rank P_i$．
        \item $P^2=P$．
        \item $\rank P=\rank P_1+\rank P_2+\cdots+\rank P_m$．
    \end{enumerate}
\end{theorem}

\subsection{一般逆行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    一意な逆を持たない行列の場合，単射な上では逆を定めているような行列の総体を一般逆行列という．
    このような候補の総体は全て有用であることがわかっている．
\end{tcolorbox}

\begin{definition}[generalized inverse \cite{CRRao62-GeneralizedInverse}]
    $A\in M_{nm}(\R)$の\textbf{一般逆行列}とは，
    任意の可解な方程式$Ax=b\in\Im(A)$に対して，$x:=A^{-}y$が解を与えるような線型変換$A^-\in M_{mn}(\R)$をいう．
    ただし，$b\in\Im(A)$は方程式の可解性を保証していない点に注意．
\end{definition}
\begin{proposition}[一般逆行列の特徴付け]
    $A\in M_{nm}(\R)$について，次は同値：
    \begin{enumerate}
        \item $A^-\in M_{mn}(\R)$は一般化逆である．
        \item $AA^-A=A$．
    \end{enumerate}
\end{proposition}

\begin{theorem}[一般逆行列のGram行列は射影を定める]
    $A\in M_{nm}(\R)$の像$\Im A$の任意の補空間$W\subset\R^m$に対して，
    ある一般逆行列$A^-$が存在して，$W=\Im(I_n-AA^-)$と表せる．
\end{theorem}

\begin{theorem}
    可解な方程式$Ax=b\in\Im(A)$に対して，解は任意の$z\in\R^m$に対して，
    \[x=A^-b+(I_m-A^-A)z\]
    と表せる．
\end{theorem}

\subsection{Moore-Penrose逆行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
    title=]
    射影作用素は有界連続な冪等作用素，
    直交射影作用素は，自己共役な射影作用素のことであるが，
    有限次元では単に冪等行列と自己共役射影行列とに退化する．
\end{tcolorbox}

\begin{definition}[Moore (1935), Penrose (55)]
    $A\in M_{mn}(\R)$について，次の2条件を満たす行列$A^+\in M_{nm}(\R)$は一意的に定まる(\cite{柳井-竹内-一般逆行列}ではKalman 1972の証明を引いている)．
    これを\textbf{Moore-Penroseの逆行列}という：
    \begin{enumerate}[(a)]
        \item 反射型一般可逆行列：$AA^+A=A,A^+AA^+=A^+$．
        \item 最小ノルム型：$A^+A$は自己共役である：$(A^+A)^\top=A^+A$．
        \item 最小誤差型：$AA^+$も自己共役である：$(AA^+)^\top=AA^+$．
    \end{enumerate}
\end{definition}
\begin{remarks}
    条件(a)は冪等性の要件を一般化した形であり，$\Im A$の補空間，$\Ker A$の補空間がそれぞれ一意に定まった場合に，$A^+$が一意に定まるための条件であり，(b),(c)でそれぞれを指定している．
    (b)は$\Ker A$の補空間は直交補空間として取ること，(c)は$\Im A$の補空間は直交補空間として取ることを指定している．
    よって，Moore-Penrose逆について，Gram行列$A^+A,AA^+$はいずれも直交射影を定める．
\end{remarks}

\begin{proposition}[\cite{柳井-竹内-一般逆行列}定理3.19]
    任意の$b\in\R^m$に対して，
    \begin{enumerate}
        \item $\norm{Ax-b}^{2}$を最小にする$x=A^-b$は(c)さえ満たせば一般の一般逆行列が満たす
        \item これがさらに$\norm{x}^2$を最小にすることと，$A^-=A^+$であることは同値．
    \end{enumerate}
\end{proposition}

\begin{example}\mbox{}
    \begin{enumerate}
        \item (非零)ベクトルの一般可逆行列は，$\norm{x}^2$でスケーリングした随伴ベクトルとなる：$x^+=(x^*x)^{-1}x^*$．
        \item 二次の正方行列\[A=\begin{pmatrix}
            a&b\\c&d
        \end{pmatrix}\in M_2(\C)\]
        の一般化逆行列は，可逆なときは逆行列に一致し，特異かつ非零であるときは
        \[A^+=\frac{1}{\abs{a}^2+\abs{b}^2+\abs{c}^2+\abs{d}^2}\begin{pmatrix}\o{a}&\o{c}\\\o{b}&\o{d}\end{pmatrix}.\]
        $A=O$のときは$A^+=O$である．
    \end{enumerate}
\end{example}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item ${}^+:M_{mn}(\R)\to M_{nm}(\R)$は転置と可換，行列積に対して反共変的な対合である．
        \item $A^+=(A^\top A)^+A^\top=A^\top(AA^\top)^+$．
        \item 横長行列$A\in M_{mn}(\C)\;(m\le n)$が最大階数であるとき，$AA^*\in M_m(\C)$は可逆で，$A^+=A^*(AA^*)^{-1}$．特に，右逆元である$AA^+=I_m$．
        \item 縦長行列$A\in M_{mn}(\C)\;(m\ge n)$が最大階数であるとき，$A^*A\in M_n(\C)$は可逆で，$A^+=(A^*A)^{-1}A^*$．特に，左逆元である$A^+A=I_n$．
    \end{enumerate}
\end{proposition}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item (特異値分解による計算法) $A$の特異値分解を$A=U\Sigma V^\top$とすると，$A^+=U\Sigma^+V^\top$と表せる．
        \item またこのとき，$\Sigma^+=\diag(\sigma_{ii}^+)$とすると，$\sigma_{ii}^+=\sigma_{ii}^{-1}$の関係がある．
        \item (最小二乗解としての特徴付け) $A\in M_{mn}(\R)$の定める1次方程式$Ax=b$の解空間は\[x=A^+b+(I_n-A^+A)k\;(k\in\R)\]で表される．
        特に，$A$が正則であるとき解は一意的である．
        ノルムが最小の解は$k=0$のときの$A^+b$で，解を持たない場合でもこれは最小二乗誤差$\norm{Ax-b}^2$を与える．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    逆行列を，1次方程式の解を与える対応だとするならば，これを「最小自乗解を与える対応」と一般化したものが一般可逆行列となっている．
\end{remarks}

\subsection{Moore-Penrose逆による射影の表現}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    もともとMoore (35)は$AA^+,A^+A$の射影としての性質を通じて，逆$A^+$を定義していた．
\end{tcolorbox}

\begin{theorem}[直交射影の一般化逆行列による表示]
    $X\in M_{np}(\R)$について，$\Im X$への直交射影の標準基底に関する行列表示を$P_X$で表す．このとき，
    $X$のGram行列の任意の一般化逆$(X^*X)^-$について，
    $P_X=X(X^*X)^-X^*$．
\end{theorem}

\begin{notation}
    $X\in M_{np}(\R),H\in M_{pq}(\R)$は$\Im H\subset\Im X^*,\rank H=q$を満たすとする．
    $X$の$\Im H$の直交補空間上への制限の像を
    \[\Im(X|H):=X(\Ker H^*)=X((\Im H)^\perp)\]
    とする．$\Im(X|H)$への標準内積に関する直交射影を$P_{X|H}$で表し，$r:=\rank X$とする．
\end{notation}

\begin{theorem}[直交射影の制限の一般化逆行列による表示]
    任意のGram行列$X^*X$の一般化逆$(X^*X)^-$について，$G:=(X^*X)^-H$とする．
    このとき，
    \begin{enumerate}
        \item $G^*X^*XG\in \GL_q(\R)$．
        \item $P_{X|H}=P_X-XG(G^*X^*XG)^{-1}G^*X^*$．
        \item $\rank P_{X|H}=r-q$．
    \end{enumerate}
\end{theorem}

\subsection{特異値分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    特異値分解は，自己準同型の対角化を，一般の準同型$A:K^n\to K^m$に一般化した結果を言う．
\end{tcolorbox}

\begin{proposition}[特異値分解 (Autonne 1915)]
    任意の縦長行列$A\in M_{m,n}(\R)$について，直交行列の縦長剪断$U\in O_{mn}(\R)$と通常の直交行列$V\in O_n(\R)$が存在して，$r:=\rank(A)$とすると
    \[A=U\Sigma V^\top,\qquad\Sigma=\begin{bmatrix}D&O_{r,n-r}\\O_{m-r,r}&O_{m-r,n-r}\end{bmatrix},\quad D=\diag(\sigma_1,\cdots,\sigma_r),\;(\sigma_1\ge\cdots\ge\sigma_r>0)\]
    と表せる．
\end{proposition}
\begin{remarks}
    中心化された(あるいは標準化された)確率行列を特異値分解する問題は\textbf{主成分分析}と呼ばれる．
\end{remarks}

\begin{corollary}\mbox{}
    \begin{enumerate}
        \item $A^\top A=V\Sigma^\top\Sigma V$，$AA^\top=U\Sigma\Sigma^\top U^\top$．
        \item $A$の特異値は$A^\top A$の非零固有値の正の平方根に等しい．
        \item $V$の列ベクトルは$A^\top A$の固有ベクトルであり，$U$の列ベクトルは$AA^\top$の固有ベクトルである．
    \end{enumerate}
\end{corollary}

\begin{theorem}[Moore-Penroseの一般化逆行列の公式 \cite{柳井-竹内-一般逆行列}定理5.6]
    任意の$A\in M_{m,n}(\R)$について，
    特異値分解を$A=U\Sigma V^\top\;(U\in\r{O}_m(\R),V\in\r{O}_n(\R),\Sigma=\diag(\Delta_r,0))$とする．
    このとき，
    \[A^+=V\mtrx{\Delta_r^{-1}}{O}{O}{O}U^\top.\]
\end{theorem}
\begin{remarks}
    すなわち，特異値の逆を対角に並べたものを，逆相似変換すれば良い．
\end{remarks}

\subsection{正定値Hermite行列の成分の消息}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    \begin{enumerate}
        \item 絶対値最大の要素は対角要素であるという意味で対角優位な行列である．
        \item 正定値Hermite行列の行列式は対角成分の積で抑えられる．
    \end{enumerate}
\end{tcolorbox}

\begin{theorem}
    一般のHermite行列$A\in M_n(\C)_\sa$について，
    任意の対角要素は数域に含まれる：$\forall_{i\in[n]}\;a_{ii}\in W(A)$．
\end{theorem}

\begin{proposition}
    $A\in M_n(\C)$を正定値エルミート行列とする．
    \begin{enumerate}
        \item 任意の対角要素は正である：$\forall_{i\in[n]}\;a_{ii}>0$．
        \item $\forall_{i,j\in[n]}\;i\ne j\Rightarrow\abs{a_{ij}}^2<a_{ii}a_{jj}$．
        \item 要素の絶対値$\abs{a_{ij}}$の最大値を達成するならば，それは対角要素である．
    \end{enumerate}
\end{proposition}

\begin{proposition}[Hadamard]
    行列$A=(a_1,\cdots,a_n)\in M_{mn}(\C)$について，
    \begin{enumerate}
        \item $\abs{\det(A)}\le\prod_{i=1}^n\norm{a_i}$．
        \item 特に，$\abs{\det(A)}\le\norm{A}_{l^\infty([nm])}^nn^{n/2}$．
        \item $A$が半正定値Hermite行列ならば，$\det(A)=\prod_{i=1}^na_{ii}$．等号成立条件は$A$が対角行列であるとき．
    \end{enumerate}
\end{proposition}

\subsection{確率変数の変換}

\begin{proposition}[平均と分散]
    $A\in M_n(\R)$を対称，$(\theta,\Sigma)\sim X\in L^2(\Om)$を確率変数とする．
    \begin{enumerate}
        \item $E[X^\top AX]=\tr(A)\Sigma+\theta^\top A\theta$．
        \item $a:=\diag(A)\in\R^n,\mu_k$を$X$の中心積率として，
        \[\Var[X^\top AX]=(\mu_4-3\mu_2^2)a^\top a+2\mu_2^2\Tr(A)^2+4\mu_2\theta^\top A^2\theta+4\mu_3\theta^\top A\theta.\]
    \end{enumerate}
\end{proposition}

\begin{proposition}[多変量正規分布の変換]
    多変量正規確率変数$X\sim (\mu,\Sigma)$について，
    \begin{enumerate}
        \item $\forall_{C\in M_{pn}(\R)}\;\forall_{\lambda\in\R^p}\;CX+\lambda\sim N(C\mu+\lambda,C\Sigma C^\top)$．
        \item ある直交行列$P\in O_n(\R)$が存在して，$P(X-\mu)\sim N(0,\Lambda)$と変換出来る．ただし，$\Lambda=P\Sigma P^\top$は$\Sigma$の対角化である．
        \item ある三角行列$L\in M_n(\R)$が存在して，$L(X-\mu)\sim N(0,I_n)$と変換出来る．
        \item $\mu=0,\Sigma=I_n$ならば，任意の直交行列$P\in O_n(\R)$に対して，$X\overset{d}{=}PX$．
    \end{enumerate}
\end{proposition}

\subsection{正規変数の二次形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    (非心率$0$の)自由度$k$の$\chi^2$-分布$\chi^2(k)$の特性関数は$\varphi(u)=(1-2iu)^{-k/2}$と表せる．
\end{tcolorbox}

\begin{theorem}[正規確率変数の二次形式]
    $A\in M_n(\R)$が対称行列，$X\sim N(0,\Sigma)$のとき，$Y:=X^\top AX$の積率母関数と特性関数は
    \[\M_Y(u)=\det{I-2\theta A\Sigma}^{-1/2}=\prod_{\lambda\in\Sp(A\Sigma)}(1-2\theta\lambda)^{-1/2},\quad\varphi_Y(u)=\exp\paren{\M_Y(iu)}.\]
    と表せる．
\end{theorem}
\begin{remarks}
    これが$\chi^2$-分布の積率母関数と一致するためには，$\lambda\in2$が必要十分であり，$1$の数だけ$\chi^2$-分布の自由度が増える．
\end{remarks}

\begin{corollary}[$\chi^2$-分布の特徴付け]
    対称行列$A\in M_n(\R)$，$X\sim N(0,\Sigma)$と$Y:=X^\top AX$について，次は同値：
    \begin{enumerate}
        \item $Y\sim \chi^2(k)$．
        \item $\rank A=k$かつ$(\Sigma_{1/2})^\top A\Sigma_{1/2}$は冪等である．
    \end{enumerate}
    ただし，$\Sigma_{1/2}$とは三角平方根，すなわち，Cholesky分解$\Sigma_{1/2}=\Sigma_{1/2}\Sigma_{1/2}^\top$を与える正実数を対角成分にもつ下三角行列である．
\end{corollary}

\begin{proposition}[非心$\chi^2$-分布の特徴付け]
    対称行列$A\in M_n(\R)$，$X\sim N(\mu,\Sigma)$と$Y:=X^\top AX$について，次は同値：
    \begin{enumerate}
        \item $Y\sim\chi^2(k,\mu^\top A\mu)$．
        \item $\rank A=k$かつ$(\Sigma_{1/2})^\top A\Sigma_{1/2}$は冪等である．
    \end{enumerate}
\end{proposition}

\subsection{Cochranの定理}

\begin{theorem}[Cochran]
    $X\sim N(0,I_n)$とすると，自乗和$X^\top X$は$\chi^2(n)$に従う．
    この自乗和の分解\[X^\top X=X^\top(A_1+\cdots+A_k)X=:\sum_{i=1}^iQ_i\quad Q_i=X^\top A_iX,\rank A_i=:n_i\]について，
    次は同値：
    \begin{enumerate}
        \item 各$Q_i$が$\chi^2(n_i)$に従う．
        \item 各$A_i$は冪等である．
        \item $n=\sum_{i\in[k]}n_i$．
        \item 各$Q_i$が独立に$\chi^2(n_i)$に従う．
    \end{enumerate}
\end{theorem}

\begin{proposition}
    $X\sim N(0,I_n)$，$A_1,A_2$をそれぞれ階数$p,q$の射影とする：$X^\top A_1X\sim\chi^2(p),X^\top A_2X\sim\chi^2(q)$．
    次の二条件は同値：
    \begin{enumerate}
        \item $X^\top A_1X\indep X^\top A_2X$．
        \item $A_1A_2=0$．
    \end{enumerate}
    これは射影でない一般の$A_1,A_2$についても成り立つ．
\end{proposition}

\begin{proposition}
    $X\sim N(0,I_n)$，$A\in M_n(\R)$を射影とする．このとき，次は同値：
    \begin{enumerate}
        \item $X^\top AX\indep b^\top X$．
        \item $Ab=0$．
    \end{enumerate}
\end{proposition}

\section{行列の解析}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    ($\R^n$を$l^2$-ノルムについてHilbert空間と見ると)行列の作用素ノルムはスペクトルノルム$\norm{A}^2=\rho(A^*A)$に等しく，これはHermite行列であるときにスペクトル半径に等しい．
\end{tcolorbox}

\subsection{行列の冪級数}

\begin{theorem}[行列の冪級数の収束半径]
    $X\in M_n(\C)$について，
    数列$\{a_n\}\subset\C$の定める冪級数$\sum_{p\in\N}a_px^p$の収束半径を$\rho:=\paren{\limsup_{n\to\infty}\sqrt[n]{\abs{a_n}}}^{-1}$とおく．
    $\sum_{p\in\N}a_pX^p$を考える．
    \begin{enumerate}
        \item $\rho(X)<\rho$ならば収束する．
        \item $\rho(X)>\rho$ならば発散する．
        \item $\sum_{p\in\N}\abs{a_p}\norm{A}^p$が収束するならば収束する．ノルムは，$l^1,l^2$またはスペクトルノルムを考える．
    \end{enumerate}
\end{theorem}

\begin{theorem}
    $X$をBanach空間，
    $A\in B(X)$とする．
    このとき，$\norm{A}<1$ならば，
    \[(I-A)^{-1}=I+A+A^2+\cdots=\sum_{n\in\N}A^n.\]
\end{theorem}

\subsection{行列のノルム}

\begin{definition}
    $A\in M_{mn}(\C)$について，
    \begin{enumerate}
        \item $\norm{A}_{l^2([mn])}:=\sqrt{\sum_{i\in[m],j\in[n]}a_{ij}^2}=\sqrt{\Tr(A^*A)}$を\textbf{Frobeniusノルム}または\textbf{Hilbert-Schmidtノルム}という．
        \item $\norm{A}_{l^1}:=\sum_{i\in[m],j\in[n]}\abs{a_{ij}}$．
        \item $\R^n,\R^m$の$l^p$-ノルムに関する作用素ノルムを$\norm{A}_p$で表す．
    \end{enumerate}
\end{definition}
\begin{remark}
    最大ノルム$\norm{A}_{l^\infty}:=\max_{i,j}\abs{a_{ij}}$は劣乗法性を満たさない．
\end{remark}
\begin{remarks}
    $B^2(H):=\Brace{T\in B_0(H)\mid\Tr(T)<\infty}$は，$(S|T):=\Tr(T^*S)$を内積としてHilbert空間をなす．
    $B^1(H):=\Span\Brace{T\in B_0(H)\mid T\ge0,\Tr(T)<\infty}$は，トレースノルムについてBanach代数をなす．
\end{remarks}

\begin{proposition}[ノルムの同値性]
    $l^1$-ノルム，$l^2$-ノルム，スペクトルノルムは同値である：
    \[\norm{A}_{l^1}\ge\norm{A}_{l^2}\ge\norm{A}_2\ge\frac{1}{n^2}\norm{A}_{l^1}.\]
    すなわち，いずれも$\R^{n+m}\simeq M_{mn}(\R)$の位相を定める．
\end{proposition}

\begin{proposition}[作用素ノルムの表示]
    $A\in M_n(\C)$について，
    \begin{enumerate}
        \item $\norm{A}_1=\max_{j\in[n]}\sum_{i\in[n]}\abs{a_{ij}}$．
        \item $\norm{A}_\infty=\max_{i\in[n]}\sum_{j\in[n]}\abs{a_{ij}}$．
    \end{enumerate}
\end{proposition}

\subsection{Schattenノルム}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Euclidノルムが定める行列の作用素ノルムは，最大の特異値に等しい．
    これは，$A^*A=\abs{A}^2$が実数のような役割を果たしているためである．
    また，Frobeniusノルムは特異値の自乗和(=$A^*A$の固有値の和)に等しい．
\end{tcolorbox}

\begin{definition}
    $A\in M_{mn}(\C)$について，$\abs{A}=\sqrt{A^*A}$の特異値の増大列を$\{s_i\}_{i\in[n]}=\Sg(A)$とする．
    \begin{enumerate}
        \item $\norm{A}_{l^p(\Sg(A))}:=\paren{\sum_{i=1}^{m\land n}s_i^p}^{1/p}$を\textbf{Schattenノルム}という．
        \item $p=1$のとき，\textbf{トレースノルム}という：$\norm{A}:=\Tr(\sqrt{A^*A})$．
        \item $p=\infty$のとき，\textbf{スペクトルノルム}という．
    \end{enumerate}
\end{definition}

\begin{proposition}
    $A\in M_{mn}(\C)$について，
    \begin{enumerate}
        \item Frobeniusノルムは2-Schattenノルムに等しい：$\norm{A}_{l^2(A)}^2=\norm{A}_{l^2(\Sg(A))}^2=\sum_{a\in\Sp(A^*A)}a$．
        \item $l^2$-作用素ノルムはスペクトルノルムに等しい：$\norm{A}_{2}^2=\rho(A^*A)=\rho(AA^*)=\norm{A}_{l^\infty(\Sg(A))}$．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    $A$がHermite行列ならば，$\norm{A}_2=\rho(A)$としてスペクトル半径に一致する．
\end{remarks}

\subsection{作用素ノルムと固有値}

\begin{definition}[condition number]
    $A\in\GL_n(K)$とノルム$\norm{-}$とについて，
    $\cond A:=\norm{A}\cdot\norm{A^{-1}}$を\textbf{条件数}という．
\end{definition}

\begin{lemma}
    \[\forall_{p\in[1,\infty]}\quad\max_{x\in\C^n\setminus\{0\}}\frac{\norm{Ax}_p}{\norm{x}_p}=\max_{x\in\R^n\setminus\{0\}}\frac{\norm{Ax}_p}{\norm{x}_p}\]
\end{lemma}

\begin{theorem}[スペクトル半径と作用素ノルム]\mbox{}
    \begin{enumerate}
        \item 行列の任意の作用素ノルムは，スペクトル半径よりも大きい：$\rho(A)\le\norm{A}$．
        \item 極限においては$\lim_{r\to\infty}\norm{A^r}^{1/r}=\rho(A)$が成り立つ．
    \end{enumerate}
\end{theorem}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 劣乗法性を満たすなら必ず満たすべき不等式なのである．実際，任意の固有値$\lambda\in\Sp(A)$とこれに属する固有ベクトル$x\in\C^n$について，
        \[\abs{\lambda}\norm{x}=\norm{Ax}\le\norm{A}\norm{x}.\]
    \end{enumerate}
\end{Proof}

\begin{theorem}[行列ノルムの稠密性?]
    任意の$A\in M_n(\C)$と$\ep>0$に対して，ある$\C^n$のノルムに関する行列の作用素ノルム$\norm{-}$が存在して，
    \[\norm{A}\le\rho(A)+\ep.\]
\end{theorem}

\begin{corollary}
    任意の$A\in M_n(\C)$について，次は同値：
    \begin{enumerate}
        \item $\lim_{n\to\infty}A^n=O$．
        \item $\rho(A)<1$．
    \end{enumerate}
\end{corollary}

\begin{theorem}[作用素ノルムの同値性]
    任意の$A\in M_n(\C)$と行列の作用素ノルム$\norm{-}$に関して，
    \[\exists_{C,C'>0}\quad C'\norm{A}\le\norm{A}_{l^\infty([n]^2)}\le C\norm{A}.\]
\end{theorem}

\begin{corollary}
    $A_n,A\in M_n(\C)$について，次は同値：
    \begin{enumerate}
        \item $\lim_{n\to\infty}A_n=A$．
        \item ある行列ノルムが存在して$\lim_{n\to\infty}\norm{A_n-A}=0$．
    \end{enumerate}
\end{corollary}

\subsection{Rayleigh商と数域半径}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Rayleigh商$R_A:\C^n\to\C$はある種，固有空間から固有値への射影となっている．
\end{tcolorbox}

\begin{definition}
    $A\in M_n(\C)$について，
    \begin{enumerate}
        \item 次の関数$R_A:\C^n\setminus\{0\}\to\C$を\textbf{Rayleigh商}という：
        \[R_A(x):=\frac{(Ax|x)}{(x|x)}\]
        \item この値域を\textbf{数域}といい，$W(A)$で表す．
        \item $r(A):=\sup_{\lambda\in W(A)}\abs{\lambda}$を\textbf{数域半径}という．
    \end{enumerate}
\end{definition}

\begin{lemma}
    $A\in M_n(\C)$について，
    \begin{enumerate}
        \item 任意の固有値$\lambda\in\Sp(A)$とこれに属する固有ベクトル$v\ne0$について，$R_A(v)=\lambda$．
        \item $R_A$は固有ベクトルの付近で停留する：$R_A(v)=\lambda+O(\norm{\ep}^2)$．
        \item $\forall_{\al\in\C\setminus\{0\}}\;R_A(\al x)=R(x)$．
        \item $A$がHermiteならば，$R_A(x)\in\R$．
        \item $R_A:\C^n\setminus\{0\}\to\C$は連続である．
        \item 数域半径$r:M_n(\C)\to\R_+$はノルムを定め，作用素ノルムと同値になる．
    \end{enumerate}
\end{lemma}

\begin{theorem}
    $A$を正規行列とする．数域$W(A)$は$\Sp(A)$の凸包である：$W(A)=\Conv(\Sp(A))$．
\end{theorem}
\begin{example}
    $A\in M_2(\C)$の数域$W(A)$は2つの固有値を焦点とする楕円になる．
\end{example}
\begin{remark}
    一般のコンパクト作用素については，$\Conv(\Sp(T))=\o{W(A)}$である．
\end{remark}

\subsection{Hermite行列の固有値}

\begin{theorem}
    $A\in M_n(\C)_\sa$をHermite行列，$\lambda_1\le\cdots\le\lambda_n$を固有値とする．
\end{theorem}

\begin{theorem}[Courant-Fisher-Weylのmin-max定理]
    $A\in M_n(\C)_\sa$をHermite行列，$\lambda_1\le\cdots\le\lambda_n$を固有値とする．
    \begin{enumerate}
        \item $\forall_{k\in[n]}\;\lambda_k=\min_{V_k\in\S_k(V)}\max_{x\in V_k}R_A(x)$．
        \item $\forall_{k\in[n]}\;\lambda_{n-k+1}=\max_{V_k\in\S_k(V)}\min_{x\in V_k}R_A(x)$．
    \end{enumerate}
    特に，$A$の最大の固有値・最小の固有値は，$R_A$の最大値・最小値に一致する．
\end{theorem}


\begin{theorem}[摂動定理]
    $A,B\in M_n(\C)_\sa$をHermite行列，$\lambda_1\le\cdots\le\lambda_n,\mu_1\le\cdots\le\mu_n$をそれぞれの固有値とする．
    任意の行列の作用素ノルム$\norm{-}$について，
    \[\forall_{k\in[n]}\;\abs{\lambda_k-\mu_k}\le\norm{A-B}\]
\end{theorem}

\subsection{固有値不等式}

\begin{proposition}
    $A,B\in M_n(\C),U$をユニタリ行列とする．
    \begin{enumerate}
        \item $U^{-1}AU=B$ならば，$\Tr(A^*A)=\Tr(B^*B)$．
        \item $A=:(a_{ij})$の固有値$\al_1,\cdots,\al_n$について，$\sum_{i\in[n]}\abs{a_i}^2\le\sum_{i,j\in[n]}\abs{a_{ij}}^n$．
        \item 等号成立条件は，$A$が正規であることである．
    \end{enumerate}
\end{proposition}

\begin{proposition}
    $A=(a_{ij})$をHermite行列とし，$[\beta,\al]\subset\R$を数域とする．
    \begin{enumerate}
        \item $\forall_{i\in[n]}\;a_{ii}\in[\beta,\al]$．
        \item $A$が正定値ならば，$\det A\le a_{11}a_{22}\cdots a_{nn}$．等号成立条件は$A$が対角行列であるとき．
    \end{enumerate}
\end{proposition}

\section{行列の分解と固有値}

\subsection{Gram-Schmidtの直交化と行列の分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    LU分解，Cholesky分解，QR分解はいずれも数値計算では欠かせない．また，
    固有値問題の数値解法では，ユニタリ変換を反復適用して上三角行列に収束させることが多いが，その背景にはSchur分解がある．
\end{tcolorbox}

\begin{definition}[LU, LDU, Cholesky, QR]
    $A\in M_{mn}(\R)$を，
    \begin{enumerate}
        \item 下三角行列$L$と上三角行列$U$の積$A=LU$に分解することを\textbf{LU分解}または\textbf{Gauss分解}という．
        \item $m=n$かつ$A$が対称であるとき，$D$を対角行列，$L$を単位(=対角要素1の)下三角行列として$A=LDL^\top$と分解出来る．これを\textbf{Cholesky分解}という．
        \item 直交行列$Q\in M_m(\R)$と上三角行列$R\in M_{mn}(\R)$を用いて$A=QR$に分解することを\textbf{QR分解}という．
        \item QR分解の一般の半単純群$G$に対して一般化したものを岩澤分解という．
    \end{enumerate}
\end{definition}


\begin{proposition}[Gram-Schmidtの直交化]
    任意の正則行列$A\in\GL_n(\bF)$は，ユニタリ行列$U$と上三角行列$T$とを用いて，$A=UT$と表せる．
\end{proposition}
\begin{remarks}
    こうして，理論上はQR分解の存在はGram-Schmidt算譜が保証しているが，応用上は殆ど用いられず，Householder変換などが使われる．
\end{remarks}

\begin{proposition}[$LU$-分解]
    $A\in M_{mn}(\R)\;(m\le n)$を横長行列とする．
    \begin{enumerate}
        \item $A$がフルランクならば，置換行列$P\in M_n(\R)$が存在して，$AP=LU$と，ピボット選択における任意性の部分を除いて一意的に表せる．
        \item 置換行列$P_1,P_2$が存在して，単位(=対角要素1の)上下三角行列$U,L$について$P_1AP_2=LDU$と，ピボット選択における任意性の部分を除いて一意的に表せる．
    \end{enumerate}
\end{proposition}
    
\begin{theorem}[Schur decomposition]\mbox{}
    \begin{enumerate}
        \item 任意の複素行列$A\in M_n(\C)$に対して，
        ユニタリ行列$U$が存在して$U^*AU$は上三角行列になる．
        なお，一意性は保証されない．
        \item $A$が正規ならば，$U^*AU$は対角行列に出来る．
    \end{enumerate}
\end{theorem}
\begin{remarks}
    正規行列の固有ベクトルの中から$\C^n$の正規直交基底を選び出せる．
\end{remarks}

\subsection{Gershgorinの定理}

\begin{definition}
    $A\in M_n(\C)$に対して，
    \[r_i:=\sum_{j\in[n]\setminus\Brace{i}}\abs{a_{ij}},\quad G_i:=\Brace{z\in\C\mid\abs{z-a_{ii}}\le r_i}\]
    を\textbf{Gershgorinの円}という．
\end{definition}

\begin{theorem}[Gershgorin]
    \[\forall_{A\in M_n(\C)}\;\Sp(A)\subset \bigcup_{i\in[n]}G_i.\]
\end{theorem}

\begin{proposition}
    $A\in M_n(\C)$の固有値は，$\cup_{i\in[n]}G_i$の各連結成分の中に，それを構成する円の個数に等しい個数ずつ含まれる．
\end{proposition}

\subsection{ブロック行列とその逆行列}

\begin{notation}[Schur complement]
    $A\in M_{p},B\in M_{pq},C\in M_{qp},D\in M_q$とし，
    \[M:=\begin{pmatrix}A&B\\C&D\end{pmatrix}\in M_{(p+q)}(\R)\]
    と定める．
    \begin{enumerate}
        \item $D\in\GL_q(\R)$のとき，$F:=A-BD^{-1}C\in M_{p}(\R)$とする．
        \item $A\in\GL_p(\R)$のとき，$G:=D-CA^{-1}B\in M_q(\R)$とする．
    \end{enumerate}
    $F,G$は\textbf{Schur補行列}といい，$M/D,M/A$とも表す．
\end{notation}

\begin{theorem}[ブロック行列の逆行列の表現]\mbox{}
    \begin{enumerate}
        \item $D\in\GL_q(\R)$のとき，行列式は$\abs{M}=\abs{F}\abs{D}$で計算できる．
        特に，$D,M$がいずれも正則であることは，$D,F$がいずれも正則であることに同値．
        \item $D,M$がいずれも正則のとき，
        \[M=\begin{pmatrix}F^{-1}&-F^{-1}BD^{-1}\\-D^{-1}CF^{-1}&D^{-1}+D^{-1}CF^{-1}BD^{-1}\end{pmatrix}\]
        と表せる．
        \item $A\in\GL_p(\R)$のとき，行列式は$\abs{M}=\abs{A}\abs{G}$で表せる．特に，$A,M$がいずれも正則であることと，$A,G$がいずれも正則であることは同値．
        \item $A,M$がいずれも正則であるとき，
        \[M=\begin{pmatrix}A^{-1}+A^{-1}BG^{-1}CA^{-1}&-A^{-1}BG^{-1}\\-G^{-1}CA^{-1}&G^{-1}\end{pmatrix}\]
        と表せる．
    \end{enumerate}
\end{theorem}

\begin{proposition}
    $M$が対称行列$N=\begin{pmatrix}A&B\\B^\top&D\end{pmatrix}$である場合を考え，一般化逆行列によって
    \[F:=A-BD^-B^\top,\quad G:=D-B^\top A^-B\]
    と定める．
    \begin{enumerate}
        \item $\Im(B^\top)=(\Ker B)^\perp\subset\Im(D)$のとき，次は$N$の一般化逆を与える．
        \[N^-=\begin{pmatrix}F^-&-F^-BD^-\\-D^-B^\top F^-&D^-+D^-B^\top F^-BD^-\end{pmatrix}\]
        \item $\Im(B)\subset\Im(A)$のとき，次は$N$の一般化逆を与える．
        \[N^-=\begin{pmatrix}A^-+A^-BG^-B^\top A^-&-A^-BG^-\\-G^-B^\top A^-&G^-\end{pmatrix}\]
    \end{enumerate}
\end{proposition}

\subsection{正規変数の条件付き分布}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Schur補行列が，正規確率変数の条件付き分布の共分散を与える．
    ここに条件付き期待値が線形変換になっていることが正規分布を特徴づける．
\end{tcolorbox}

\begin{proposition}
    $X=(X_1,X_2)\sim(\nu,\Sigma)$は正規変数とし，分割に応じて$\mu=(\mu_1,\mu_2),\Sigma=(\Sigma_{11},\Sigma_{12};\Sigma_{21},\Sigma_{22})$と対応するとする．このとき，
    \begin{enumerate}
        \item $P[X_2|X_1]\sim N(\mu_2+\Sigma_{21}\Sigma_{11}^\top(X-\mu_1),\Sigma/\Sigma_{22})$が成り立つ．
        \item 条件付き分布の共分散は，周辺分布のそれよりも，半正定値性の意味で小さくなる：$\Sigma_{22}\ge\Sigma/\Sigma_{22}$．
        \item $x_1$を所与としたときの$R(x_1)$は，$x_2$を平均自乗誤差を最小にする予測である．
    \end{enumerate}
\end{proposition}

\begin{definition}[regression]
    この平均に登場した関数
    \[(E[X_2|X_1]=)\mu_2+\Sigma_{21}\Sigma_{11}^\top(X-\mu_1)\]
    を$X_2$の$X_1$に対する\textbf{回帰}という．
\end{definition}
\begin{example}
    いずれも1次元確率変数であるとき，回帰は
    \[R(x_1)=\mu_2+\frac{\sigma_{12}}{\sigma_1^2}(x_1-\mu_1)\]
    となり，条件付き分布の分散は$\Var[x_2|x_1]=\sigma_2^2(1-\rho^2)$となる．
\end{example}

\subsection{一般化スペクトル分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    固有空間分解を射影作用素の言葉で記述したものをスペクトル分解というならば，一般化固有空間分解を射影作用素の言葉で記述したものを一般化スペクトル分解という．
\end{tcolorbox}

\begin{proposition}[空間の直和分解の射影子による特徴付け]
    $\{P_i\}_{i\in[r]}\subset\End_K(V)$を射影子(冪等作用素)とする．次の2条件を満たすことと，$V=\oplus_{i\in[r]}\Im P_i$が成り立つこととは同値：
    \begin{enumerate}
        \item $\sum P_i=I$．
        \item $P_iP_j=\delta_{ij}P_i=\delta_{ij}P_j$．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    $(V_i)$が線型空間$V$の直和分解を与えることは，射影子の間の代数的な関係によって特徴付けられる．
\end{remarks}

\begin{theorem}
    $A\in\End_K(V)$に対して，$\{f_i\}_{i\in[r]}\subset K[t]$は次を満たすならば，$V=\oplus_{i\in[r]}\Ker f_i(A)$が成り立つ：
    \begin{enumerate}
        \item $f_1,\cdots,f_r$はどの2つも互いに素である．
        \item $f:=f_1\cdots f_r$とすると，$f(A)=0$．
    \end{enumerate}
\end{theorem}

\subsection{Fisher-Cochranの定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\R^n$の直和分解に対して，独立な二次形式が定まる．
\end{tcolorbox}

\begin{theorem}
    $\{A_i\}_{i\in[k]}\subset M_n(\R)$は$I_n$の分解とする．このとき，次の4条件は同値：
    \begin{enumerate}
        \item 各$A_i$は射影である．
        \item $\forall_{i,j\in[k]}\;i\ne j\Rightarrow A_iA_j=O$．
        \item $\R^n=\oplus_{i\in[k]}\Im A_i$．
        \item $\sum_{i\in[k]}\rank A_i=n$．
    \end{enumerate}
\end{theorem}

\begin{theorem}[Fisher-Cochran]
    $\{A_i\}_{i\in[k]}\subset M_n(\R)$は対称行列からなる$I_n$の分解，$Y\sim N_n(\mu,I_n)\;(\mu\in\R^n)$とする．
    係数行列$A_i$の定める二次形式$Q_i:=Y^*A_iY,n_i:=\rank A_i$について，次の5条件は同値：
    \begin{enumerate}
        \item $\exists_{\delta_i\in\R_+}\;Q_i\sim\chi^2(n_i,\delta_i)$かつ$Q_1,\cdots,Q_k$は独立．
        \item $\sum_{i\in[k]}n_i=n$．
        \item 各$A_i$は射影である．
        \item $\forall_{i,j\in[k]}\;i\ne j\Rightarrow A_iA_j=O$．
        \item $\R^n=\oplus_{i\in[k]}\Im A_i$．
    \end{enumerate}
    このとき，$\delta_i=\mu^*A_i\mu$が成り立ち，特に$\sum_{j\in[n]}\mu_j^2=\sum_{i\in[k]}\delta_i$が成り立つ．
\end{theorem}

\section{行列の計算}

\subsection{正行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    実は，$F$-行列のスペクトル半径は正$\rho(A):=\max_{a\in\Sp(A)}\abs{a}>0$で，$\lambda:=\rho(A)$自体も固有値であると同時に，いくつか$\lambda e^{i\theta}$という形の固有値も存在し得る(その総数は周期に等しい)．
    正行列は必ず周期1である．
    正行列のスペクトル半径はFrobenius根に一致する．
\end{tcolorbox}

\begin{remarks}[正行列]
    Perronが正行列について始めた理論を，Frobeniusが分解不能な非負行列に対して拡張した．
    確率論や力学系のエルゴード理論，工学・経済学・人口学の安定性理論において応用を持つ．
\end{remarks}

\begin{theorem}[Perron-Frobeniusの定理 (1907,1912)]
    正な正方行列$A>0\in M_n(\R)$について，
    \begin{enumerate}
        \item $A$は正の固有値を持つ．
        \item 最大の正固有値を$\al$とすれば，重複度1の特性根である．これを\textbf{Frobenius根}といい，$\lambda(A)>0$で表す．
        \item $\al$に対応する固有ベクトル$u\in V_\al$は各成分が正になるように取れる．\footnote{特に成分の和が1になるように正規化したものを\textbf{確率固有ベクトル}という．}
        \item 他の一般化固有空間の元は，必ずどれかの成分が非正である．すなわち，$A$の正の固有ベクトルは$V_{\lambda(A)}$の元に限る．
        \item $\lambda(A)=\rho(A)$である．さらに$A$の他の固有値の絶対値は$\al$より真に小さい．
        \item ${}^t\!A$のFrobenius根も$\al$である．
    \end{enumerate}
\end{theorem}

\begin{proposition}[非負であるということが定める順序関係はスペクトル半径の大小関係に等しい]
    正な正方行列$A>0\in M_n(\R)$について，
    \begin{enumerate}
        \item $\forall_{\rho>\rho(A)}\;\rho I-A\in\GL_n(\R)$かつ$(\rho I-A)^{-1}>0$．
        \item $\forall_{\rho\in\R,\R^n\ni x\ge0}\;x\ne0\land Ax-\rho x\ge0$ならば，$\rho\le\rho(A)$．
        \item $B>0\in M_n(\R)$も正行列とする．$A-B\ge0$ならば，$\rho(B)\le\rho(A)$．
    \end{enumerate}
\end{proposition}

\subsection{非負行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    非負行列の特徴は，第一象限$(\R_+)^n\setminus\{0\}$を第一象限に写すことである．
    特に球面$S^{n-1}\subset\R^n$に議論を制限すると，
    $S^{n-1}$の第一象限はコンパクトであるから，ここに不動点が存在し，これがFrobenius根となる．
\end{tcolorbox}

\begin{definition}
    $A\in M_n(\C)$を非負行列とする．
    \begin{enumerate}
        \item 添字$i\in[n]$の\textbf{周期}$h_i$とは，$h_i:=\gcd\Brace{m\in\N^+\mid(A^m)_{ii}>0}$をいう．
    \end{enumerate}
\end{definition}

\begin{theorem}[非負行列のFrobenius根]
    一般の非負行列$A\in M_n(\C)$について，
    \begin{enumerate}
        \item $\rho(A)\ge0$で，$\rho(A)$自体も固有値である．
        \item $\rho(A)$に属する非負の固有ベクトルが存在する．
        \item スペクトル半径$\rho(A)$は，行和$\sum_{i=1}^na_{ij}$の平均に等しい．特に，
        \[\min_{j\in[n]}\sum_{i=1}^na_{ij}\le\rho(A)\le\max_{j\in[n]}\sum_{i=1}^na_{ij}.\]
        \item $A\ge B\ge O$ならば$\rho(A)\ge\rho(B)$が成り立つ．
        \item 転置行列${}^t\!A$のFrobenius根も$\rho(A)$である．
    \end{enumerate}
\end{theorem}

\begin{theorem}[可逆な$M$行列の特徴付け１]
    非負行列$A\in M_n(\R)$と正数$\mu>0$について，次は同値：
    \begin{enumerate}
        \item $\forall_{b\ge0\in\R^n}\;\exists_{x\ge0\in\R^n}\;(\mu I_n-A)x=b$．
        \item $\exists_{x>0\in\R^n}\;(\mu I_n-A)x>0$．
        \item $(\mu^{-1}A)^p\to O\;(p\to\infty)$．
        \item $\rho(A)<\mu$．
        \item $\mu I_n-A$の全ての首座小行列式は正．
        \item $\mu I_n-A\in\GL_n(\R)$かつ$(\mu I_n-A)^{-1}\ge O$．
        \item 単位下三角$Z$-行列$L$と，対角要素が正な上三角$Z$-行列$U$を用いて，$\mu I_n-A=LU$と表せる．
    \end{enumerate}
    (5)は$\det A>0$を含意している．
\end{theorem}
\begin{remarks}
    $m+1$の節点を持つ正の線型抵抗を持つ電気回路の接点コンダクタンス行列は$M$-行列になる．
    これは，各節点でのOhmの法則$i_\al=\sum_{\beta=1}^my_{\al\beta}v_\beta\;(\al\in[m])$の係数行列である．
    $Y$が正定値であることは，あらゆる電圧の欠け方に対して，Joule熱が正であることに対応する：$\forall_{i_\al,v_\al\in\R}\;\sum_{\al=1}^mi_\al v_\al=\sum_{\al,\beta\in[m]}y_{\al\beta}v_\al v_\beta>0$．
    これは条件(5)に対応する．すると，(6)$Y^{-1}\ge O$は，電圧・電流関係の単調性を表す．
\end{remarks}

\subsection{$F$-行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    一般の$F$-行列も，$\rho(A)$に等しい固有値は重複度1で，他に絶対値が$\rho(A)$に等しい固有値も重複度1である．
    この描像は，$\Sp(A)$の外側に，$A$の周期$h\in\N^+$に等しい数だけ固有値が$\rho(A)e^{2\pi in/h}\;(n\in h)$というように分布している．
    $F$行列の周期が1であるときのみ，$\lim_{n\to\infty}A^n$が存在する．
\end{tcolorbox}

\begin{notation}
    有向グラフ$(\Om,\Gamma)$について，
    \begin{enumerate}
        \item $\Gamma(i,j)$を，$i,j\in\Om$を結ぶ有向道全体の集合とする．
        \item $l(\sigma)$で$\sigma\in\Gamma(i,j)$の長さを表す．
    \end{enumerate}
\end{notation}

\begin{definition}\mbox{}
    \begin{enumerate}
        \item 行列$A\in M_n(K)$が\textbf{定める有向グラフ}とは，
        \[\Gamma:=\Brace{(i,j)\in[n]^2\mid a_{ij}\ne0}\]
        によって定まる
        $([n],\Gamma)$をいう．
        \item 有向グラフ$(\Om,\Gamma)$が\textbf{強連結}とは，$\abs{\Om}\ge2$かつ任意の2点を通る有向道が存在することをいう：$\forall_{i,j\in\Om}\;\Gamma(i,j)\ne\emptyset$．
        行列$A\in M_n(K)$が定める有向グラフが強連結であるとき，\textbf{分解不能}であるという．
        \item 分解不能な非負行列を\textbf{Frobenius行列}または\textbf{$F$-行列}という．
    \end{enumerate}
    任意の正行列は$F$-行列である．
\end{definition}

\begin{lemma}[強連結な有向グラフの周期]
    有向グラフ$(\Om,\Gamma)$は強連結とする．
    \begin{enumerate}
        \item 任意の$i\in\Om$について，$\Gamma(i,i)$の元の長さの最大公約数$h_i$は$i\in\Om$に依らない．これを\textbf{周期}という．
        \item $\forall_{\sigma,\tau\in\Gamma(i,j)}\;l(\sigma)=l(\tau)\mod h$．
        \item $i\sim j:\Leftrightarrow\exists_{\sigma\in\Gamma(i,j)}\;h|l(\sigma)$は$\Om$上に同値関係を定める．
        \item $i_0\in\Om$を固定し，$f:\Om\to\Z/(h)$を$f(i):=l(\sigma)\mod h\;(\sigma\in\Gamma(i_0,i))$とすると，これは上の同値関係を引き起こす全射である．
        そこで，各$t\in\Z/(h)$に対応する同値類を$\Om_t$とする．
        \item 同値類$(\Om_t)$は次を満たす：$\forall_{i\in\Om_s,j\in\Om_t}\;s+1\ne t\mod h\Rightarrow (i,j)\notin\Gamma$．
    \end{enumerate}
    周期1の$F$-行列を\textbf{非振動的}という．
\end{lemma}

\begin{theorem}[周期標準形]
    $A\in M_n(K)$を周期$h\in\N^+$を持つ分解不能行列とする．
    標準基底$e_1,\cdots,e_n$を同値類別$\Om_1+\cdots+\Om_h$に登場する順で並び替え，基底の変換行列を$(e_{\sigma(1)}\cdots e_{\sigma(n)})=(e_1\cdots e_n)P$とする．
    このとき，
    \[PAP^{-1}=\begin{pmatrix}0&A_1&0&\cdots&0\\0&0&A_2&\cdots&0\\\vdots&\vdots&\ddots&\ddots&\vdots\\0&0&0&\cdots&A_{h-1}\\A_h&0&0&\cdots&0\end{pmatrix},\quad A_i\in M_{\abs{\Om_i}}(K).\]
    と表せる．
    特に，$A^p=:(a_{ij}^{(p)})$とおくと，$p\ne0\mod h\Leftrightarrow a_{11}^{(p)}=\cdots=a_{nn}^{(p)}=0$．
\end{theorem}

\begin{theorem}[Frobenius根の性質]
    $F$-行列$A\in M_n(\R)$について，
    \begin{enumerate}
        \item $(I+A)^{n-1}>0$．
        \item $\rho(A)>0$．特に$r:=\rho(A)$も$A$の固有値であり，\textbf{Frobenius固有値}という．
        \item $\exists_{\R\ni\al\ge0}\;\exists_{\R^n\ni x\ge0}\;Ax=\al x$ならば，$x>0$かつ$\al=\rho(A)>0$．
    \end{enumerate}
    特に，$\rho(A)$に属する固有ベクトルには正のものが存在する．
\end{theorem}

\begin{theorem}[$F$-行列の対角化]
    $F$-行列$A\in M_n(\R)$と，一般の行列$B\in M_n(\C)$について，$A\ge B^+:=(\abs{b_{ij}})$が成り立つとする．
    \begin{enumerate}
        \item $\rho(A)\ge\rho(B)$．
        \item 等号成立するならば，$A=B^+$．さらに絶対値が$\rho(A)$に等しい$B$の固有値$\rho(A)e^{i\theta}$に対して，絶対値1の複素数からなる対角行列$D$が存在して，$B=e^{i\theta}DAD^{-1}$．
        \item $A$の固有値$re^{i\theta}$について，ユニタリ対角行列$D_1$が存在して，$A=e^{i\theta}DAD^{-1}$が成り立つ．
    \end{enumerate}
\end{theorem}

\begin{theorem}[周期と最大絶対値を持つ固有値の対応]
    $F$-行列$A\in M_n(\R)$について，
    \begin{enumerate}
        \item $A$のFrobenius根は単純である．
        \item $\rho(A)=\abs{\lambda}$を満たす固有値$\lambda\in\Sp(A)$も単純である．
        \item $A$の周期を$h$とすれば，$\abs{\lambda}=\rho(A)$を満たす固有値は$h$個あり，$e^{2\pi in/h}\rho(A)\;(n\in h)$と表せる．
    \end{enumerate}
\end{theorem}

\begin{theorem}[極限の存在条件]
    $F$-行列$A$に対して，$B:=\rho(A)^{-1}A$とおく．次は同値：
    \begin{enumerate}
        \item $A$は非振動的(周期が1である)．
        \item $A$は原始的である：$\exists_{m\in\N^+}\;A^m>0$．
        \item $\lim_{i\to\infty}B^i$が存在する．
    \end{enumerate}
\end{theorem}
\begin{remarks}
    周期が1でないとき，すなわち絶対値が$\rho(A)$になる固有値が複数ある場合は，$A,A^2,A^3,\cdots$の系列は収束しないが，Cesaro和は収束する．
    これはCesaro和が振動を抑えるためである．
\end{remarks}

\subsection{確率行列}

\begin{definition}
    非負行列$A\ge0\in M_n(\R)$の，各行の値の和が$\forall_{s\in[n]}\;\sum_{i\in[n]}a_{si}=1$を満たすとき，\textbf{確率行列}という．
    この定義は$A\b{1}=\b{1}$に同値．
    特に，任意の確率行列は固有値1を持ち，$\bf{1}$はこれに属する固有ベクトルである．
\end{definition}

\begin{corollary}[確率行列の性質]
    確率行列$P\ge0$に対して，次のことが成り立つ．
    \begin{enumerate}
        \item $P$のFrobenius根$\rho(P)$は$1$である．
        \item $1$に属する固有空間は，$u={}^t\!(1,1,\cdots,1)$を用いて$\R u$と表せる．
        \item $\exists_{m\in\N^+}\;P^m$が正ならば，他の固有値の絶対値は$\rho(P)$より真に小さく，
        $\lim_{m\to\infty}P^m=B$が存在し，$y^\top P=y^\top,y^\top u=1$を満たす$y\in\R^n$について
        \[B=uy=\begin{pmatrix}y\\\vdots\\ y\end{pmatrix}\]
        と表せる．特に，$B$の行ベクトルは全て等しい．
        特に$P$が対称行列ならば，$B$の成分は全て$1/n$である．
        \item 一般に$P$が既約ならば，$\sum_{i\in n}A^i>O$が成り立ち，$\lim_{n\to\infty}\frac{\sum_{i\in n}A^i}{n}=B$．
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $\rho(P)$は行和の平均として得られるため．
        \item まず固有値$1$が単純で，固有空間の次元は$1$であることに注意する．また，$\b{1}$が固有ベクトルになることは，確率行列の定義から明らかである．
    \end{enumerate}
\end{Proof}

\begin{definition}
    $P\ge0$を既約でない確率行列とし，既約標準形の一つを
    \[P^\top AP=\begin{pmatrix}A_{11}&*&*&*\\O&A_{22}&*&*\\O&O&\ddots&*\\O&O&O&A_{ss}\end{pmatrix}\]
    とする．
    \begin{enumerate}
        \item 各対角ブロック$A_{kk}$は，付随する有向グラフの強連結成分に対応する．
        \item 各対角ブロック$A_{kk}$が強連結成分として極大であることと，$A_{kk}$の上方の$*$にある$A$の要素は全て$0$であることとは同値．このとき，$A_{kk}$は既約な確率行列になっている．
        \item 極大な強連結成分$A_{kk}$を\textbf{エルゴード部分}，それ以外の強連結成分を\textbf{消散部分}という．
        \item 各エルゴード部分の内部では，$A_{kk}$が定めるMarkov連鎖に従って，初期分布に依らない平衡分布に到達するが，エルゴード部分の間での確率の分配は初期状態確率に依存する．
    \end{enumerate}
\end{definition}

\subsection{二重確率行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    任意の二重確率行列は，置換行列の凸結合である．
    これは任意の確率分布が$\delta$-測度の凸結合であることに似ている．
\end{tcolorbox}

\begin{definition}
    行和も列和も1になる非負行列を\textbf{二重確率行列}という．
    対称な確率行列は二重である．
\end{definition}

\begin{theorem}[Birkhoff]
    $A\in M_n(\R)$を二重確率行列とする．
    このとき，$A$は有限個の置換行列$P_1,\cdots,P_N$の凸結合である：
    \[A=\al_1P_1+\cdots+\al_NP_N,\quad \al_1,\cdots,\al_N>0,\sum_{n\in[N]}\al_n=1.\]
\end{theorem}

\subsection{行列の分類}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    いままで成分の正負の観点から行列を見てきたが，
    「対角成分への集約」などの粗密の観点から行列を捉え直す．
\end{tcolorbox}

\begin{definition}
    行列$A=(a_{ij})\in M_{mn}(K)$について，
    \begin{enumerate}
        \item $b:=\min\Brace{b\ge1\mid\forall_{(i,j)\in[m]\times[n]}\;\abs{i-j}>b\Rightarrow a_{ij}=0}$について，$2b+1$を\textbf{帯幅}という．
        \item 帯幅3の帯行列を\textbf{三重対角行列}という．
        \item 三重対角行列と上三角行列との和で表せる行列を\textbf{上Hessenberg行列}という．
    \end{enumerate}
\end{definition}
\begin{remarks}
    行列計算では上三角化が最重要視され，次善策がHessenberg行列となる．
\end{remarks}

\begin{definition}[diagonally dominated matrix, reduceable]
    $A\in M_n(\C)$について，
    \begin{enumerate}
        \item $A$が(行方向の)\textbf{対角優位行列}であるとは，次を満たすことをいう：
        \[\forall_{i\in[n]}\quad\abs{a_{ii}}\ge\sum_{j\ne i\in[n]}\abs{a_{ij}}.\]
        \item 不等号が真の意味で成り立つとき，\textbf{狭義優対角行列}という．
        \item ある正値対角行列$D=\diag(d_i)\;(d_1,\cdots,d_n>0)$が存在して，$AD$が狭義優対角行列になるとき，$A$を\textbf{一般化狭義優対角行列}という．すなわち，次を定義とする：
        \[\exists_{d_1,\cdots,d_n>0}\;\forall_{i\in[n]}\quad\abs{a_{ii}}d_i\ge\sum_{j\ne i\in[n]}\abs{a_{ij}}d_j.\]
        \item $n\ge2$のとき$A$が\textbf{可約}であるとは，次を満たすことをいう：
        \[\exists_{\emptyset\ne J\subsetneq[n]}\;\forall_{i\in J}\;\forall_{j\in[n]\setminus J}\;a_{ij}=0.\]
        すなわち，行ベクトルの真部分集合$J\subsetneq [n]$であって，
        同じ番号の列ベクトルとの交点でない限り値が$0$であるような$J$が存在することをいう．
        \item 可約でない行列を\textbf{既約}であるという．$n=1$のとき，$A=O$のみ可約とする．
    \end{enumerate}
\end{definition}

\begin{theorem}[既約性の幾何学的な意味]
    $A\in M_n(\C)$について，次は同値である．
    \begin{enumerate}
        \item $A$は既約である．
        \item $A$は非自明な不変部分空間を持たない．
        \item $A$は置換行列$P$によって上三角ブロック行列に相似変換されることはない．
    \end{enumerate}
    さらに$A$が非負であるとき，分解不能性に同値．
\end{theorem}

\subsection{Gaussの消去算譜}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    算譜中に対角成分が消えると，情報落ち・桁落ちが生じる可能性がある．
    これが起きないようなクラスが，正定値自己共役行列と一般化狭義優対角行列なのである．
\end{tcolorbox}

\begin{theorem}\label{thm-Gaussian-elimination}
    $A\in M_n(\R)$について，次は同値：
    \begin{enumerate}
        \item $A$の上三角化の対角成分が消えない．
        \item $A$の全ての首座小行列は正則である．
        \item $A$は上三角化$U$と単位下三角行列$L$とを用いて$A=LU$に一意に分解出来る．
    \end{enumerate}
\end{theorem}

\begin{proposition}
    $A\in M_n(\R)$が正定値対称，一般化狭義優対角ならば，(2)を満たす．
\end{proposition}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item (LDL) 実対称行列が定理の条件を満たすならば，同様の$L$と$A$の上三角化の対角成分からなる対角行列$D$を用いて$A=LDL^\top$の形に一意に分解出来る．
        \item (Cholesky) 正定値の実対称行列が定理の条件を満たすならば，対角成分が正であるような下三角行列$S$を用いて，$A=SS^\top$と一意に分解出来る．
    \end{enumerate}
\end{proposition}

\subsection{$M$-行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    非負行列$B\ge0$を用いて，$sI-B\;(s\ge\rho(B))$の形で表される$Z$-行列をMinkowskiにちなんで$M$-行列という． 
\end{tcolorbox}

\begin{definition}
    正方行列について，
    \begin{enumerate}
        \item 任意の主小行列式が正である行列を\textbf{$P$-行列}，その閉包を$P_0$-行列といい，任意の主将行列式が非負であることに同値．
        \item 非対角要素が全て非正である行列を\textbf{$Z$-行列}という．
        逆に，非対角行列が全て非負である行列をMetzler行列または$Z^-$-行列という．
        \item 非負行列$B\ge0$を用いて，$sI-B\;(s\ge\rho(B))$の形で表される$Z$-行列を\textbf{$M$-行列}という．
        \item 行列$A=(a_{ij})\in M_n(\C)$の\textbf{比較行列}とは，これが定める$Z$-行列$\al_{ij}=(-1)^{\chi_{\Brace{i\ne j}}}\abs{a_{ij}}$をいう．
        \item 比較行列が$M$-行列になるような行列を\textbf{$H$-行列}という．
    \end{enumerate}
\end{definition}

\begin{theorem}[可逆な$M$-行列の特徴付け２]
    $Z$-行列$A\in M_n(\C)$について，次は同値：
    \begin{enumerate}
        \item 任意の非負対角行列$D:=\diag(d_i)\;(d_1,\cdots,d_n\ge0)$について，$A+D$は可逆である．
        \item 可逆で，さらに逆行列が非負である．
        \item $P$-行列でもある：任意の主小行列式は正である．
        \item 任意の実固有値は正である．
        \item 任意の固有値の実部は非負である．
        \item $A$は単調である：$\forall_{x\ge0}\;Ax\ge0$．
        \item 一般化狭義優対角行列である．
    \end{enumerate}
\end{theorem}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item 一般化狭義優対角行列は可逆である．
        \item 既約な優対角行列は，少なくとも1つの行$k\in[n]$で$\abs{a_{kk}}>\sum_{j\ne k}\abs{a_{kj}}$が成り立てば可逆である．
    \end{enumerate}
\end{proposition}

\subsection{Householder行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    QR分解の第一段階であり，対称行列の三角化，非対称行列のHessenberg化に広く用いられる変換である．
    QR分解と三角化の計算コストの低さはHouseholder変換が支えている．
\end{tcolorbox}

\begin{definition}
    単位ベクトル$u\in\C^n,\norm{u}=1$について，$H(u):=I_n-2uu^*$を\textbf{Householder行列}という．
\end{definition}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item Hermiteかつユニタリ行列である：$H(u)^2=I_n,H(u)^*=H(u)$．
        \item $\det H(u)=-1$．
        \item $H(u)$は$u$を法線ベクトルの1つとする原点を通る超平面に関する鏡映変換を定める．
    \end{enumerate}
\end{proposition}

\begin{theorem}
    任意の正則行列$A\in M_n(\R)$は，$n-1$回のHouseholder変換によって$A=QR$の形に分解可能である．
\end{theorem}
\begin{remarks}
    この算譜が殆ど最適であるが，それでもLU分解の約2倍の乗除算が必要であり，連立一次方程式の解法としては実用性はなく，むしろ固有値問題において真価を発揮する．
\end{remarks}

\subsection{Givens行列}

\begin{definition}
    Givens回転$G(k,l,\theta)\in M_n(\R)$とは，単位行列$I_n$の4成分$(g_{ij})_{i,j\in\Brace{k,j}^2}$を回転行列に変更したものをいう．
    すなわち，$\R^n$の元を$(k,l)$-部分平面で$\theta$だけ反時計回りに回転させる変換をいう．
\end{definition}
\begin{remarks}
    ハウスホルダー変換は直列処理機械
    上の密行列に適しており、一方でギヴンス変換は並列処理機械
    や疎行列に適している。
\end{remarks}

\subsection{離散Fourier変換}

\begin{definition}
    原始$n$乗根$\zeta:=e^{2\pi i/n}$について，$Z:=\paren{z_{ij}:=\frac{1}{\sqrt{n}}\zeta^{(i-1)(j-1)}}_{i,j\in[n]}\in M_n(\C)$とすると，これは対称なユニタリ行列である．
    線形写像$Z:\C^n\to\C^n$を\textbf{離散Fourier変換}という．
\end{definition}

\chapter{作用素の空間}

\begin{quotation}
    行列のなす$*$-代数の構造を引き続き調べる．
    これは$B(H)$を，$H$が有限次元の場合について調べていることになる
    $B(V)$は連続性関係なく，単に自己準同型の空間に成り果てる：$B(V)=\End_K(V)$．
    FVSの自己準同型には次の，Jordan分解＝冪等・冪零分解による分類理論がある：
    \begin{enumerate}
        \item 代入による作用$K[X]\times M_n(K)\to M_n(K)$によって，$K[X]$-加群をなす．
        \item $A\in M_n(K)$を止めて得る環準同型$K[X]\to M_n(K)$の核を単項生成する元を最小多項式というが，これが$K$上で因数分解出来るとき，これに沿った$V$の一般化固有空間分解$\wt{V}_a$を得る．これらは$f_A$-安定なので(隣の一般化固有空間に漏れ出さない)，各一般化固有空間分解$\wt{V}_a$で上三角化できれば，全体としても$A$を上三角化出来る．
        \item 各一般化固有空間分解$\wt{V}_a$が1次元でないとき($\varphi$が重根を持つとき)，その自己準同型は冪零成分を持つことになるが，
        各$\wt{V}_a$上ではうまく基底を取れば上三角行列で表現できる(例えば同伴行列が道しるべになる)．
        \item しかしさらに詳しく観ると，うまく基底をとれば冪零成分は帯行列で表現出来る．よって，各一般化固有空間$\wt{V}_\al$でJordan行列で表現することで，全体として$A$をJordan標準形に相似変換することが出来る．
    \end{enumerate}
    こうして，代数的には$M_n(K[x])\simeq M_n(K)[x]$なる環上の加群が注目されるが，$x$-行列は，行列値解析関数とも見れる．
    すると，固有値とは解素の極である．
    こうして解素を通じて，複素解析は一般のBanach空間$B(H)$-値正則関数にも適用範囲を広げる．
    \begin{enumerate}
        \item $M_n(K)$は内積$(A|B):=\Tr(AB)$によって，Banach代数をなし，$*$-作用素$\Tr:M_n(K)\to M_n(K)$によって，$C^*$-代数をなす．
    \end{enumerate}
\end{quotation}

\section{最小多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    体$K$について，環$K[X]$はEudlic整域，特に単項イデアル整域である．
    代入による作用$K[X]\times\End_K(V)\to\End_K(V)$の
    第一引数$\ev_f:K[X]\to\End_K(V)\;(f\in\End_K(V))$に注目すると，これは環準同型で
    ，核が単項イデアルになるが，これを生成する元を$f$の\textbf{最小多項式}という．
    環の同型$K[X]/(\varphi)\iso K[f]\subset \End_K(V)$が得られ，$f$の届き得る範囲が調べられる．
    $K[f]$の次元は$\varphi$の次数に等しい．
    最小多項式の根を固有値という．固有多項式とは冪のみが違い得て，$f$-安定部分空間の上では一致する．．
\end{tcolorbox}

\subsection{定義と存在}

\begin{proposition}[作用のwell-definedness]\label{prop-functoriality-of-substitution}
    代入$K[X]\times\End_K(V)\to\End_K(V)$はたしかに作用を定める．すなわち，
    $K[X]\to\End_K(\End_K(V))$は環の準同型である．すなわち，
    多項式$F,G\in K[X]$に対して，
    \begin{align*}
        (F+G)(f)&=F(f)+G(f),&(FG)(f)&=F(f)\circ G(f)
    \end{align*}
    が成り立つ．
\end{proposition}

\begin{proposition}[有限次元線型空間の自己射は必ず最小多項式を持つ]\label{prop-existence-of-minimal-polynomial}
    $V\in\FVS_K,f\in\End_K(V)$は，最小多項式を持つ．
    即ち，$F(f)=0$を満たすmonicな多項式$F\in K[X]$のうち，次数が最小のものがただ一つ存在する．
\end{proposition}
\begin{Proof}
    \begin{description}
        \item[$F$の構成] $f$は有限次元空間の自己射だから，基底$x_1,\cdots,x_n\in V$を定めると，表列表示$A$を持つ．この基底が定める同型$\varphi_{x_1,\cdots,x_n}$が定めるHom同型関手$\End(V)\to\End(K^n)$は
        演算を保つから，$F(f)=0\Leftrightarrow F(A)=0$より，行列$A$を積，冪，和によって零に出来るかを考えれば良い．

        $\dim M_n(K)=n^2$より，$1+n^2$個のベクトル$1,A,A^2,\cdots,A^{n^2}$は線型従属．
        よって，
        \[ d:=\min\{d\in n^2+1\mid 1,A,\cdots,A^dが線型従属\} \]
        と置けば，$a_0,\cdots,a_{d-1}\in K$が一意的に存在して
        \[ A^d=a_0\cdot 1+a_1A+a_2A^2+\cdots+a_{d-1}A^{d-1} \]
        と表せる．これに対して，
        \[ F:=X^d-(a_0+a_1X+\cdots+a_{d-1}X^{d-1}) \]
        と置けば，これが求めるmonicな多項式である．
        \item[$F$が確かに次数が最小であることを示す] $G$が$d-1$次以下で$G(f)=0$即ち$G(A)=0$を満たすならば，$1,A,\cdots,A^{d-1}$は一次独立だから，係数が$0$で$G=0$が従う．従って$F$はmonicなもので最小次．
        \item[$F$が一意的と示す] $d$次の多項式$G$についても$G(f)=0$とすると，$F(A)=0=G(A)$の係数比較より$G=F$が従う．
    \end{description}
\end{Proof}
\begin{proposition}[有限次元線型空間の自己射は必ず最小多項式を持つ]\label{prop-existence-of-minimal-polynomial}
    $V\in\FinVect_K,f\in\End_K(V)$とする．
    \[I_f:=\Brace{F\in K[X]\mid F(f)=0}\]
    は，$0$を省けば，$K$倍の違いを除いて$\deg$に関する最小元を持つ．
    そのうちモニックなものを\textbf{最小多項式}という．
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[$I_f$はイデアルである] $0\in I_f$である．$\forall_{F,G\in I_f}\;(F+G)(f)=F(f)+G(f)=0$．$\forall_{F\in I_f,G\in K[X]}\;(FG)(f)=F(f)\circ G(f)=0$．
        \item[生成元が最小元である] $K[X]$はEuclid整域，特に単項イデアル整域であるから，ある$F\in I_f$によって単項生成される．
        任意の$f\in K[X]$に対して，$g\in(f)\Leftrightarrow f|g$であるから，Euclid関数の性質より$I_f$の生成元が，求める最小元である．
    \end{description}
\end{Proof}

\begin{definition}[minimal polynomial]
    線型自己準同型$f:V\to V$に対して，$F(f)=0$を満たす$0$でない多項式$F\in K[X]$が存在する時，$f$は\textbf{最小多項式を持つ}という．
    このような$F$のうちmonicなもので次数が最小の多項式を\textbf{最小多項式}という．
\end{definition}

\subsection{最小多項式の例}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    同伴行列の概念は，引き戻し可能な単射$K[X]/(X^{n+1})\mono M_n(K)$を与える．
    これが２つの対象を媒介する理論的な役割を果たす．
    要は，任意の線型空間も，このような同伴行列を考えれば良くなるような$f$-安定部分空間にまで分解すれば良い．（命題\ref{prop-stable-subspace}）．
    これが一般固有空間分解であり，その上のJordan分解である．
\end{tcolorbox}

\begin{example}[最小多項式]\mbox{}
    \begin{enumerate}
        \item 線型空間$0$の恒等写像$\id_0$の最小多項式は$1$．
        \item $0$でない線型空間$V$の自己準同型$f$の最小多項式が一次式$X-a$で表せることと，$f$がスカラー$a$倍写像であることは同値．
        \item 行列$\begin{pmatrix}a&b\\c&d\end{pmatrix}$倍写像の最小多項式は，$A$がスカラー行列でなければ，$X^2-(a+d)X+ad-bc$である．
        \item むしろこの最小多項式の次元が2で収まっているのが不思議であるが，最小多項式は固有多項式を割り切るから，次数は$V$の次元よりも小さくなる．上の証明では$d$を具体化しておらず，閉集合上の連続写像$\min$で抽象的に存在を示したので，$n^2$次以下とまでしか言えていない．構成論の負けで，固有多項式の理論を待つのが良い．
    \end{enumerate}
\end{example}

\begin{definition}[Frobeniusのcompanion matrix]
    monicな多項式$F(X) = X^n+a_1X^{n-1}+\cdots +a_{n-1}X+a_n \in K[X]$に対して，
        \[C(F)=\begin{bmatrix}
        0 & 0 & \dots & 0 & -a_n \\
        1 & 0 & \dots & 0 & -a_{n-1} \\
        0 & 1 & \dots & 0 & -a_{n-2} \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & \dots & 1 & -a_1
        \end{bmatrix}\]
    と定義される正方行列$C(F)\in M_n(K)$のことを\textbf{多項式$F$の同伴行列}と呼ぶ．
    これは，$K$-線型空間$K[X]$上の自己射$X\times$が商空間$K[X]/(F)$\footnote{$F$で割り切れる多項式全体の集合$(F)=\{GF\in K[X]\mid G\in K[X]\}$．条件$G\in (F)$とは，$F$で割り切れることを意味する．}上に引き起こす自己準同型$F_X$の，基底
    $\overline{1},\overline{X},\cdots,\overline{X^{n-1}}$についての行列表示が$C(F)$となっている．
    即ち，最右の列ベクトルは，最後の基底$\overline{X^{n-1}}$の$X$による像
    \[ X^n=-a_1X^{n-1}-\cdots-a_{n-1}X-a_n \]
    を表している．
\end{definition}

\begin{proposition}[companionship：同伴行列と最小多項式]
    多項式$F(X) = X^n+a_1X^{n-1}+\cdots +a_{n-1}X+a_n \in K[X]$の同伴行列$A:=C(F)\in M_n(K)$の最小多項式は$F$自身である．
\end{proposition}
\begin{Proof}
    \begin{description}
        \item[零写像であること$F(A)=0$を示す] 
        同伴行列$A$を元の多項式$F$に代入して得る行列$F(A)$が
        \begin{align}
            F(A)e_i&=0,&(i=1,2,\cdots,n)
        \end{align}
        を満たすことを示す．いきなり多項式$F(A)$を考える前に個々の挙動を見ると，まず
        \begin{align*}
            A^ie_1&=e_{i+1},&(i=0,1,\cdots,n-1)
        \end{align*}
        が帰納的に示せる．これを用いて，$i=n$の時は
        \begin{align*}
            A^ne_1&=A(A^{n-1}e_1)\\
            &=Ae_n\\
            &=\begin{pmatrix}-a_n\\-a_{n-1}\\\vdots\\-a_1\end{pmatrix}\\
            &=-e_1(a_1A^{n-1}+a_2A^{n-2}+\cdots+a_{n-1}A+a_n)
        \end{align*}
        より，
        \begin{align*}
            F(A)e_1&=A^ne_1+(a_1A^{n-1}+\cdots+a_{n-1}A+a_n)e_1\\
            &=-e_1(a_1A^{n-1}+a_2A^{n-2}+\cdots+a_{n-1}A+a_n)\\
            &\hphantom{=}\;+e_1(a_1A^{n-1}+a_2A^{n-2}+\cdots+a_{n-1}A+a_n)\\
            &=0
        \end{align*}
        を得る．他の$e_i$についても，
        \[F(A)e_i=F(A)A^{i-1}e_1=A^{i-1}F(A)e_1=0\]
        が従う\footnote{$F(A)$は$A$とスカラー倍$a_i$のみからなる多項式なので．}．よって，$F(A)=0$．
        \item[$F$がこれを満たす最小次の多項式であることを示す] 
        $n-1$次以下の多項式$G=b_1X^{n-1}+\cdots+b_n$が$G(A)=0$を満たしたとする．すると，特に$G(A)e_1=0$だから，
        \begin{align*}
            b_1A^{n-1}e_1+b_2A^{n-2}e_1+\cdots+b_ne_1&=0\\
            b_1e_n+b_2e_{n-1}+\cdots+b_ne_1&=0
        \end{align*}
        であるから，$b_1=\cdots=b_n=0$が従う．よって$G=0$．よって，$F$が$A=C(F)$の最小多項式である．
    \end{description}
\end{Proof}

\begin{theorem}[同伴行列の特徴付け]
    行列$A\in M_n(K)$について，次の条件は同値：
    \begin{enumerate}
        \item $A$の固有多項式の同伴行列$C(\Phi_A)$に相似．
        \item $A$の固有多項式と最小多項式は等しい．
        \item $A$の最小多項式の次数は$n$である．
        \item $\exists_{x\in K^n}\;\brac{x,Ax,\cdots,A^{n-1}x}=K^n$．
        \item $K^n$は$K[A]$-加群として巡回的かつ$K^n=K[A]/(\Phi_A(A))$である．
    \end{enumerate}
\end{theorem}
\begin{remarks}\label{remarks-companion-matrix-and-vandermonde-matrix}
    すなわち，$n\ge2$のとき，同伴行列は「冪零成分があるならば各段階で1ずつ次元が減っていくような行列」の標準形として取れる．
    特に，$n$階線型微分方程式を1階の方程式系に変換した際の係数行列として出現する．
    そして，冪零成分がないとき，すなわち最小多項式$\varphi$が相異なる根$(\al_i)_{i\in[n]}$についての一次式として表せるとき，$V$を$(\al_i)$が定めるVandermonde行列として$VC(\varphi)V^{-1}=\diag(\al_1,\cdots,\al_n)$と対角化出来る．
\end{remarks}

\begin{definition}[Jordan matrix]
        行列
        \[J(a,n)=\begin{bmatrix}
        a & 1 & 0 & \dots & 0 \\
        0 & a & 1 & \dots & 0 \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & \dots & a & 1 \\
        0 & 0 & \dots & 0 & a
        \end{bmatrix}\in M_n(K)\]
    を\textbf{Jordan行列}という．
\end{definition}

\begin{corollary}[Jordan行列は，冪零成分が最短の零元になる]
    Jordan行列$J(a,n)$の最小多項式は$(X-a)^n$である．
\end{corollary}
\begin{Proof}
    対角成分を$a=0$としたJordan行列$J(0,n)$の転置$J^t(0,n)$は多項式$X^n$の同伴行列になっている．
    転置行列と元の行列の最小多項式は一般に一致するから（双対命題），$J(0,n)$の最小多項式も$X^n$である．これに$X=X-a$と代入し直すことで，$J(a,n)=a+J(0,n)$の最小多項式は$(X-a)^n$．
\end{Proof}

\subsection{$f$-軌道が生成する安定部分空間上の最小多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    自己準同型$f\in\End_K(V)$の性質に合わせた$V$の直和分解を与えるに当たって，基本的な語彙は$f$-安定部分空間である．
    ある点$x\in V$が生成するように安定部分空間を取れば，その表現行列は同伴行列になるから，有理標準形への道標となる．
    あとは全空間がこのような安定部分空間の直和に分解出来るかの問題になる．
\end{tcolorbox}

\begin{proposition}[安定部分空間上の最小多項式]\label{prop-stable-subspace}
    $V\in\FVS_K,f\in\End(V)$とする．$x\in V$．
    $0\le m\le\dim V$を，$x,f(x),\cdots,f^m(x)$が一次独立ではなくなるような最小の自然数とし，$W=\langle x,f(x),\cdots,f^{m-1}(x)\rangle$と置く．
    \begin{enumerate}
        \item $x,f(x),\cdots,f^{m-1}(x)$は$W$の基底であり，$f(W)\subset W$である．
        \item $f^m(x)$の成分表示を$f^m(x)=a_1f^{m-1}(x)+\cdots+a_{m-1}f(x)+a_mx$と置くと，$f|_W$の行列表示は，多項式
        \[ \varphi_x=X^m-(a_1X^{m-1}+\cdots+a_{m-1}X+a_m) \]
        の同伴行列である．
        \item $f|_W$の最小多項式は$\varphi_x$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $x,f(x),\cdots,f^{m-1}(x)$は$W$の一次独立な生成系だから基底である．また，$W$の生成系$x,f(x),\cdots,f^{m-1}(x)$が一次独立であることの特徴付け（命題\ref{prop-linear-system-expansion}）より$f^m(x)\in W$であるから，$f(W)=\langle f(x),\cdots,f^m(x)\rangle\subset W$\footnote{等号は任意の$W$の元を取れば，一次独立かは置いておいて，$f(x),\cdots,f^m(x)$が像の生成系に他ならないとわかる．}．不安なら還元論を展開すれば出来るが，どの変形にも証明がつけられるならそれで良い．
        \item[2.] $W$の各基底$x,f(x),\cdots,f^{m-1}(x)$の行き先の，この基底による表示を列ベクトルで並べると，
        \[A=\begin{bmatrix}
            0 & 0 & \dots & 0 & -a_n \\
            1 & 0 & \dots & 0 & -a_{n-1} \\
            0 & 1 & \dots & 0 & -a_{n-2} \\
            \vdots & \vdots & \ddots & \vdots & \vdots \\
            0 & 0 & \dots & 1 & -a_1
            \end{bmatrix}\]
        となり，これは$\varphi_x=X^m-(a_1X^{m-1}+\cdots+a_{m-1}X+a_m)$の同伴行列である．
        \item[3.] 命題より．
    \end{description}
\end{Proof}
\begin{remarks}
    同伴行列は，1次元ずつ潰れていく線型変換の表現行列であるから，ある点$x\in V$を固定してこの$f$軌道が生成する安定部分空間へ分解していくと，有理標準形が得られそうである．
\end{remarks}

\subsection{空間の直和分解と最小多項式の積}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    $f$-安定な部分空間たちに分解できれば，最小多項式はそれらの\textbf{最小公倍式}になる．
    なお，各$f$-安定部分空間を「極小」にとって，直和$V=V_1\oplus\cdots\oplus V_r$になるとき，これは一般化固有空間分解になっている．
    最終的に全て固有空間にまで落ちるとき，対角化可能であり，最小多項式はそれらの積である．
\end{tcolorbox}

\begin{proposition}[最小公倍式としての最小多項式]\label{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}
    $f\in\End_K(V)$について，
    \begin{enumerate}
        \item $W$を$V$の$f$-安定部分空間とする：$f(W)\subset W$．$f$の最小多項式$\varphi$が存在するならば，$f|_W$の最小多項式$\varphi|_W$も存在し，$\varphi$を割り切る．
        \item $W_1,\cdots,W_r$を$V$の$f$-安定部分空間で，$V=W_1+\cdots+W_r, f(W_i)\subset W_i\;(i\in[r])$を満たすとする．各$f|_{W_i}$に最小多項式$\varphi_i$が存在する時，$f$の最小多項式も存在し，$\varphi=\lcm(\varphi_1,\cdots,\varphi_r)$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $f|_W$の$\varphi$への代入は，$\varphi(f|_W)=\varphi(f)|_W=0$\footnote{この場合$\varphi(f\circ i)=\varphi(f)\circ i$が成り立つのだな．$i$が冪等だからである．}より，$f|_W$の最小多項式も存在し，$\varphi$を割り切る．
        \item[2.] $(W_i)_{i\in[r]}$は$V$を被覆しているから，$F(f)=0$と$F(f)|_{W_i}=F(f|_{W_i})=0\;\;(i\in[r])$とは同値．これは，$F$が$\varphi_1,\cdots,\varphi_r$で割り切れることに同値．系より，$\varphi=\lcm(\varphi_1,\cdots,\varphi_r)$と置くと$\bigcap_{i\in[r]}(\varphi_i)=(\varphi)$なので，これは$\varphi$で割り切れることに同値．従って，この生成元が$f$の最小多項式．
    \end{description}
\end{Proof}

\begin{problem}
    $A=\begin{pmatrix}1&0&0&0\\0&0&0&0\\0&1&0&0\\1&0&1&1\end{pmatrix}$の最小多項式を求めよ．
\end{problem}
\begin{Proof}[［解答］]
    $e_1,e_2$の生成する安定部分空間に注目して，
    $W_1:=\langle e_1,e_4\rangle,W_2:=\langle e_2,e_3,e_4$は，$K^4=W_1+W_2$を満たす．
    $W_1$上に$A$が定める自己準同型の表現行列は，部分行列$\begin{pmatrix}1&0\\1&1\end{pmatrix}$だから，最小多項式は$X^2-2X+1=(X-1)^2$．
    $W_2$上に$A$が定める自己準同型の表現行列は，部分行列$\begin{pmatrix}0&0&0\\1&0&0\\0&1&1\end{pmatrix}$だから，これは$X^3-X^2=X^2(X-1)$の同伴行列．
    以上，$A$の最小多項式は，最小公倍式$X^2(X-1)^2$．
\end{Proof}

\begin{itembox}[l]{最小多項式の求め方}
    \begin{enumerate}
        \item $f(W)\subset W$を満たす$f$-安定部分空間による被覆を見つける．
        \item それの最小多項式を調べ，その張り合わせが全体空間だから，最小公倍式を見つければ良い．
        \item 「最小公倍式」ってのは，どの部分空間も潰れるために必要である．これがぴったり環論の言葉で表現できる対応がすごいが，もっと厳密に対応を定式化したい気がする．
    \end{enumerate}
\end{itembox}

\subsection{自己準同型の多項式が定める空間の分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    以後の議論の最も一般的な形を観ることで，全貌を提示する．
    一般化固有空間分解は$\wt{V}_{a}=\cup_{n\in\N}\Ker(f-a)^n$という意味で安定な概念であるから，必ずしも最小多項式$\varphi$が定める
    自己準同型のみを考える必要はないので
    一般化固有空間の次元が固有多項式における重複度で，一般化固有空間の寿命($f$を何回適用すれば冪零成分が消えるか)が最小多項式における重複度である．
    これが一致するならば，その一般化固有空間上では行列表示は同伴行列である．
    一致しない場合は必ずしも帯行列の形にはならないが，上三角行列にはなる．
    そこで，「うまく取り直せる」ことが，Jordan標準形に関する幾何的な議論である．
\end{tcolorbox}


\begin{theorem}[一般化された一般化固有空間分解]
    $A\in M_n(K)$に対して，多項式$f_1,\cdots,f_r\in K[t]$はどの2つも互いに素で$f:=f_1f_2\cdots f_r\in(\varphi_A)$，すなわち$f(A)=0$であるとする．
    このとき，$\wt{V}_i:=\Ker f_i(A)$とおけば，$V=\oplus_{i=1}^r\wt{V}_i$が成り立つ．
\end{theorem}

\begin{corollary}[安定部分空間は一般化固有空間分解に沿って分解出来る]
    $f\in\End_K(V)$の定める一般固有空間分解を$V=\oplus_{i=1}^r\wt{V}_i$とする．任意の$f$-
    安定部分空間$W\in S(V)$は，これに沿って$W=\oplus_{i=1}^r\wt{V}_i\cap W$と表せる．
\end{corollary}
\begin{Proof}
    $f$が対角化可能な場合はすぐに示せる．が，同じ方法だと直接この主張を示すのは行き詰まる：
    $f$の最小多項式を$\prod^r_{i=1}(x-a_i)^{m_i}$とする．任意の$x\in W$について，
    $x=\sum_{i\in[r]}v_i\;(v_i\in\wt{V}_i)$と一意的に表せる．
    ここで，両辺に$f$の多項式$(f-a_1)^{m_1}\cdots(f-a_{j-1})^{m_{j-1}}(f-a_{j+1})^{m_{j+1}}\cdots(f-a_r)^{m_r}$を作用させると，
    左辺は$W$の$f$-安定性より$W$の元で，右辺は$wt{V}_j$の元である．
    これは，各$\wt{V}_i\;(i\ne j)$上ではこの作用は零で，$\wt{V}_j$は$f$-安定であることによる．
    これ以上何も言えないが(1)の場合だったら，右辺は$v_j$のスカラー倍になる．
    (2)の場合でも，$v_j$のスカラー倍を得るような$v_j$が取れないか？
\end{Proof}

\section{自己準同型が定める固有空間分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    自己準同型$f\in\End_K(V)$がスカラー倍写像に退化するような1次元部分空間への分解$V=\oplus_{a\in\Sp(f)}V_a$が与えられるとき，$f$は対角化可能であるという．
    作用素の言葉を使えば，1次元射影の線形結合に分解される場合をいう．
    また，線型写像がスカラー倍写像であることは，その最小多項式が1次であることに同値．
\end{tcolorbox}

\subsection{固有値の特徴付け}

\begin{definition}[eigenspace, eigenvalue, eigenvector]\mbox{}
    \begin{enumerate}
        \item $V\in\Vect_K,f\in\End_K(V)$について，部分空間$V_a(f):=\Ker(f-a)$を\textbf{$a$に属する固有空間}という．
        \item $a\ne a'\Leftrightarrow V_{a}\cap V_{a'}=0$であるから，$\cup_{a\in K}V_a(f)=\sqcup_{a\in K}V_a(f)\epi V$はベクトル束をなす．
        \item $V_a\ne 0$である時（$f-a$が単射でない時），\textbf{$a$は$f$の固有値である}という．
        \item 固有空間$V_a$の$0$でない元を，\textbf{固有値$a$の固有ベクトル}という．
    \end{enumerate}
\end{definition}

\begin{proposition}[最小多項式の根が固有値である]\label{prop-minimal-polynomial's-root-is-eigenvalue}
    線型空間の自己射$f\in\End_K(V)$の最小多項式を$\varphi$とする．$a\in K$に対して，次の条件は同値である．
    \begin{enumerate}
        \item $a$は$f$の固有値である．
        \item $\varphi(a)=0$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1$\Rightarrow$2] $a$を$f$の固有値とすると，$f|_{V_a}=a$．従って，$f$が部分空間$V_a$上に定める準同型$f|_{V_a}$の最小多項式は$X-a$．よって，$\varphi$は$X-a$によって割り切れるから，$\varphi(a)=0$．
        \item[2$\Rightarrow$1] $\varphi(a)=0$の時，$\varphi$は$X-a$で割り切れるから，$G\in K[X]$が存在して，$\varphi=(X-a)G(X)$と表せる．$\varphi$が最小多項式であるから，$G(f)\ne 0$．すると，$f$の代入は$\varphi(f)=(f-a)\circ G(f)=0$と分解できて，この（おそらく完全）系列について
        \[ 0\subsetneq\Im G(f)\subset\Ker(f-a). \]
        よって，$V_a\ne 0$で，$a$は$f$の固有値である．
    \end{description}
\end{Proof}

\begin{proposition}[上三角行列の固有値]\label{prop-eigenvalue-of-triangular-matrices}
    $A\in M_n(K)$を上三角行列とし，$a_1,\cdots,a_n\in K$を対角成分とする．
    \begin{enumerate}
        \item 最小多項式は$F(X):=(X-a_1)\cdots(X-a_n)$を割り切る（実はこれが上三角行列の固有多項式）．
        \item $a_1,\cdots,a_n$は$A$の固有値である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $V_i:=\langle e_1,\cdots,e_i\rangle\subset K^n\;(1\le i\le n)$と置くと，上からの帰納法により，
        \begin{align*}
            (A-a_n)K^n&\subset V_{n-1}\\
            \vdots\hphantom{\;\;\;\;\;K^n}&\hphantom{\subset}\;\;\;\;\vdots\\
            (A-a_i)\cdots(A-a_n)K^n&\subset V_{i-1}\\
            \vdots\hphantom{\;\;\;\;\;K^n}&\hphantom{\subset}\;\;\;\;\vdots\\
            F(A)K^n&\subset V_0:=0
        \end{align*}
        が成り立つ．完全に環上の加群の書き方である．すでに$K^n$の第$i+1,\cdots,n$射影が$0$になった空間$V_i$において，左から掛ける行列の第$i$行の第$i$列までは$0$で第$i$列も$0$にすれば，それ以降の第$i+1$から$n$列に依らず，像は$V_{i-1}$に縮小する．
        よって，$F$は$\varphi$が割り切る．
        \item[2.] 上三角行列の計算法則として，$\varphi(A)=0$の対角成分はそれぞれ別に計算した$\varphi(a_1),\cdots,\varphi(a_n)$に等しい．よって，$a_1,\cdots,a_n$は全て$\varphi$の零点だから，命題より，固有値である．
    \end{description}
\end{Proof}

\subsection{対角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    最小多項式が異なる1次式の積であるとき，$V$を固有空間へと直和分解出来る．
    実は，対角化可能な場合はこの場合に限る．
\end{tcolorbox}

\begin{proposition}[重根を持たない多項式が定める自己準同型の核]\label{prop-diagonalization}
    $a_1,\cdots,a_r\in K$を異なる元とし，多項式を$F=(X-a_1)\cdots(X-a_r)\in K[X]$と置く．
    これへの代入が定める作用$F:\End_K(V)\to\End_K(V)$の像は対角行列で，核は$a_1,\cdots,a_r$に属する$f$-固有空間の直和になる：
    \[\forall_{f\in\End_K(V)}\;\Ker F(f)=V_{a_1}(f)\oplus\cdots\oplus V_{a_r}(f)=\bigoplus_{i=1}^r\Ker(f-a_i). \]
\end{proposition}
\begin{Proof}
    $r\in\N$については帰納法で示す．$r=1$の時，$V_{a_1}$の定義に他ならない．$r>1$とする．
    $G=(X-a_1)\cdots(X-a_{r-1})$と置くと，$F=G(X-a_r)$で，この多項式への$f$の代入を考えることで，分解$F(f)=G(f)\circ (f-a_r)$を得る．
    すると，$\Ker F(f)=\Ker G(f)\oplus\Ker(f-a_r)$と表せることを示せば良い．
    この準同型$f-a_r$に注目すれば，これを導ける．

    \begin{description}
        \item[$\Ker F(f)$への制限] $(f-a_r)|_{\Ker F(f)}$の核を調べると，
        \[\Ker((f-a_r)|_{\Ker F(f)})=\Ker(f-a_r)\cap\Ker F(f)=\Ker(f-a_r)\]
        とわかる．
        \item[$\Ker G(f)$への制限] 帰納法の仮定より，$\Ker G(f)=V_{a_1}\oplus\cdots\oplus V_{a_{r-1}}$である．$f$はそれぞれの上ではスカラー倍写像$f=a_i$であるから，$(f-a_r)|_{\Ker G(f)}$は直和$(a_1-a_r)\oplus\cdots(a_n-a_r)$に他ならない．よって，これは同型である．
        \item[$f-a_r$は全射] 注\ref{remark-1}での議論より，$(f-a_r)(\Ker F(f))\subset\Ker G(f)$が成り立つ．即ち，$(f-a_r)|_{\Ker F(f)}:\Ker F(f)\to\Ker G(f)$は全射である．
        \item[終わり] 以上の結果と線型写像の標準分解の命題\ref{prop-pre-homomorphism-thm}より，$\Ker F(f)=\Ker G(f)\oplus\Ker(f-a_r)$を得る．
    \end{description}
\end{Proof}
\begin{remarks}
    各$V_{a_i}$は$0$たり得る．$F$が$f$の最小多項式であるとき，$\Ker F(f)=\Ker 0=V$であるから，底空間$V$を固有空間に分解出来たことになる．
\end{remarks}

\begin{corollary}[対角化可能条件]\label{cor-diagonalizability}
    $V\in\FVS_K,f\in\End_K(V)$の固有値を$a_1,\cdots,a_r\in K$とすると，次の条件は同値である．
    \begin{enumerate}
        \item $f$は対角化可能．
        \item $V$の固有ベクトルのみからなる基底$x_1,\cdots,x_n$が存在する．
        \item $f$の最小多項式$\varphi$は相異なる一次式の積$(X-a_1)\cdots(X-a_r)$の形である．
        \item $V=V_{a_1}+\cdots+V_{a_r}$．
        \item $V=V_{a_1}\oplus\cdots\oplus V_{a_r}$．
    \end{enumerate}
\end{corollary}
\begin{Proof}
    1と2は言い換えである．
    \begin{description}
        \item[2$\Rightarrow$4] $V=\langle x_1,\cdots,x_n\rangle=V_{a_1}+\cdots+V_{a_n}$．
        \item[4$\Rightarrow$3] まず$a_1,\cdots,a_r$が固有値なのだから，$F=(X-a_1)\cdots(X-a_r)$は最小多項式$\varphi$を割り切る（命題\ref{prop-minimal-polynomial's-root-is-eigenvalue}）．$V=V_{a_1}+\cdots+V_{a_r}$の時，$V$の任意の元は固有ベクトルの和で表せるから，$F(f)=(f-a_1)\circ\cdots\circ(f-a_r)=0$になる．よって，最小多項式$\varphi$は$F$を割り切る．$\therefore\;F=\varphi$．
        \item[3$\Rightarrow$5] 命題より，$V=\Ker\varphi(f)=V_{a_1}\oplus\cdots\oplus V_{a_r}$．
        \item[5$\Rightarrow$2] 言い換えになっている．
    \end{description}
\end{Proof}
\begin{remark}
    改めて環の作用$(X-a_1)\cdots(X-a_r)$がどういう意味かわかり，関手性に関する命題\ref{prop-functoriality-of-substitution}
    がやっと理解された．多項式$(X-a_1)\cdots(X-a_r)$の作用は各固有ベクトルの方向に向かって射影を取るようなもので，「一回射影をとれば潰せる」という条件が成り立つものが対角化可能なのである．
    それで命題もわかった．$F(f)=(f-a_1)\cdots(f-a_r)$によって潰れる空間は正確に$\Ker F(f)=V_{a_1}\oplus\cdots\oplus V_{a_r}$なのである．相異なる固有値に属する固有空間は交わらない$V_{a_i}\cap V_{a_j}=0\;(i\ne j)$という主張が紛れ込んでいる．

    また，3$\Rightarrow$1は意義深いな．冪が$2$以上になるとそれは冪零成分を意味する．
    冪が$1$でも，ブロックの大きさは全くわからない．
\end{remark}

\begin{corollary}[安定部分空間への遺伝]
    $f\in\End(V)$とし，$W$を$f(W)\subset W$を満たす$V$の$f$-安定部分空間とする．
    $f$が対角化可能ならば$f|_W$も対角化可能である．
\end{corollary}
\begin{Proof}
    $f$は対角化可能だから，系\ref{cor-diagonalizability}より，$f$の最小多項式は一次式の積である．
    命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$f|_W$の最小多項式はこれを割り切るから，こちらも一次式の積である．
    よって，$f|_W$も対角化可能．
\end{Proof}

\subsection{可換系の対角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    対角化可能な可換系は最小多項式を共有する．
    対角化可能ならば最小多項式は異なる一次式の積で，各固有空間上では$f=gfg^{-1}$であるため．
    したがって同じ固有空間分解を定め，固有ベクトルからなる基底を取ることで一斉対角化可能である．
\end{tcolorbox}

\begin{lemma}[可換性の必要条件]\label{lemma-commutative}
    $f,g\in\End(V)$とする．$f\circ g=g\circ f$ならば，
    $\Ker g,\Im g$は$f$-安定である：
    $f(\Ker g)\subset\Ker g$かつ$f(\Im g)\subset\Im g$．
\end{lemma}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $x\in f(\Ker g)$を取ると，$\exists y\in\Ker g,\;f(y)=x$であるから，$g(x)=g(f(y))=f(g(y))=f(0)=0$より，$x\in\Ker g$．
        \item $x\in f(\Im g)$を取ると，$\exists y\in\Im g,\;f(y)=x$．よって$\exists z\in V,\;g(z)=y$．$x=f(g(z))=g(f(z))$より，$x\in\Im g$．
    \end{enumerate}
\end{Proof}

\begin{corollary}[可換系の対角化]\label{cor-commutative-linear-mappings-triangulization}
    \[S=\{f,g\in\End(V)\mid f,gは対角化可能で，互いに可換：fg=gf\}\]
    とすると，$V$の基底であって，それに関する$S$の任意の元の行列表示が対角行列となるものが存在する．
\end{corollary}
\begin{Proof}
    $V$の次元に関する帰納法で示す．$S$の元が全てスカラー倍の時は明らかに成り立ち，$\dim V\le 1$の場合はこれに含まれる．
    $f\in S$をスカラー倍でない準同型とする．$f$に関する固有空間分解を$V=V_{a_1}\oplus\cdots\oplus V_{a_r}$とすると，補題\ref{lemma-commutative}より，任意の$g\in S$について$g(V_{a_i})\subset V_{a_i}$．
    したがって系より，$g|_{V_{a_i}}$は対角化可能である．よって帰納法の仮定より，各$V_{a_i}$の基底であって，それに関する$S$の任意の自己準同型の行列表示が対角行列になるものが存在する．これを並べれて得られる$V$の基底を考えれば良い．
\end{Proof}


\subsection{自己準同型の可換性の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=可換性は本質的にスカラー倍に由来するものしか存在しない]
    まず，一般固有空間分解が，全て固有空間に退化している場合は，各$f|_{V_a}=a$はスカラー倍写像$a$なので，
    全固有空間$V_a$が$g$-安定な場合に可換になり，それに限ることが分かる．

    実はこれが対角化の理論だったのか！
    Hermite内積を備えた空間で考察する
    命題\ref{prop-Hermite-diagonalizability}にて，全てが解決する！
\end{tcolorbox}

\begin{proposition}[自己準同型の可換性の行列への翻訳]
    $V\in\FVS_K,f,g\in\End_K(V)$とし，$x_1,\cdots,x_n\in V$を$V$の基底とする．次の２条件は同値である．
    \begin{enumerate}
        \item $f\circ g=g\circ f$．
        \item $f$の$x_1,\cdots,x_n$に関する行列表示と，$f$の$g(x_1),\cdots,g(x_n)$に関する行列表示とは等しい．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    基底$x$に関する$f,g$の行列表示を$A,B$とすると，$A=B^{-1}AB$と同値で，$B:K^n\to K^n$とは基底$x_1,\cdots,x_n$から$g(x_1),\cdots,g(x_n)$への変換行列と思える．
\end{Proof}

\begin{corollary}
    $A,B\in\End_K(V)$を可換とする．
    \begin{enumerate}
        \item $A,B$が共に対角化可能ならば，$A\pm B,AB$も対角化可能である．
        \item $A,B$が冪零ならば，$A\pm B,AB$も冪零である．
    \end{enumerate}
\end{corollary}

\begin{proposition}
    $V\in\FVS_K,f\in\End_K(V)$とし，$g\in\End_K(V)$に対する次の２条件を考える：
    \begin{enumerate}[(1)]
        \item $f\circ g=g\circ f$．
        \item $f$の一般固有空間は全て$g$-安定である．
    \end{enumerate}
    (2)$\Rightarrow$(1)であり，$f$が対角化可能である時(2)$\Rightarrow$(1)である．
    また，次が成り立つ．
    \begin{enumerate}[(1)]\setcounter{enumi}{2}
        \item $K=\C$とすると，逆命題「(1)と(2)が同値なら$f$は対角化可能である」が成り立つ．
        即ち，任意の$g\in\End_K(V)$について(2)$\Rightarrow$(1)が成り立つならば，$f$は対角化可能である．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    \begin{description}
        \item[(2)$\Rightarrow$(1)] 
        $a\in\C$を$f$の固有値とし，$m$をその重複度とする．$(f-a)^m(g(\widetilde{V}_a))=0$を示せば良い．
        自己準同型の合成は分配則を満たすから，
        \begin{align*}
            (f-a)^m(g(\widetilde{V}_a))&=(f-a)^m\circ g(\widetilde{V}_a)\\
            &=(f^m-af^{m-1}+a^2f^{m-2}-\cdots+(-1)^ma^m)\circ g(\widetilde{V}_a)\\
            &=(f^m\circ g-af^{m-1}\circ g+a^2f^{m-2}\circ g-\cdots+(-1)^ma^mg)(\widetilde{V}_a)\\
            &=(g\circ f^m-ag\circ f^{m-1}+a^2 g\circ f^{m-2}-\cdots+(-1)^ma^mg)(\widetilde{V}_a)&(\because\;\mathrm{(a)})\\
            &=g\circ(f^m-af^{m-1}+a^2f^{m-2}-\cdots+(-1)^ma^m)(\widetilde{V}_a)\\
            &=g\circ(f-a)^m(\widetilde{V}_a)\\
            &=g((f-a)^m(\widetilde{V}_a))=g(0)=0.
        \end{align*}
        よって，$g(\widetilde{V}_a)\subset\widetilde{V}_a$．
        \item[(1)$\Rightarrow$(2)]
        $f$が対角化可能である時，$V$の固有ベクトルのみからなる基底が存在するから，
        任意の固有値$a\in\C$と対応する固有ベクトル$v\in\Ker(f-a)$について，$f\circ g(v)=g\circ f(v)$を示せば良い．
    
        $\Ker(f-a)$は$g$-安定部分空間だから，$g(\Ker(f-a))\subset\Ker(f-a)$より，$g(v)\in\Ker(f-a)$だから，
        $f(g(v))=a\cdot g(v)$．また，$g(f(v))=g(a\cdot v)=a\cdot g(v)$．
    
        \item[(3)]
        正しいことを証明する．
        $\C$-線型写像$f$は三角化可能であり，$f$の固有値$a_1,\cdots,a_n$について，$V=\widetilde{V}_{a_1}\oplus\cdots\oplus\widetilde{V}_{a_n}$
        と一般固有空間分解できる．
        いま，任意の$g\in\End_\C(V)$に対して$g(\widetilde{V}_{a_i})\subset\widetilde{V}_{a_i}\;(i=1,\cdots,n)$ならば，$f\circ g=g\circ f$が成り立つと仮定する．
        この時，任意の一般固有空間$\widetilde{V}_{a_i}$について，制限写像$f|_{\widetilde{V}_{a_i}}=:f_i,g|_{\widetilde{V}_{a_i}}=:g_i$は
        それぞれ$\widetilde{V}_{a_i}$の自己準同型$f_i:\widetilde{V}_{a_i}\to\widetilde{V}_{a_i},g_i:\widetilde{V}_{a_i}\to\widetilde{V}_{a_i}$を定める．
        $f\circ g=g\circ f$の時，$f_i\circ g_i=g_i\circ f_i$であるが，$g$が（従って$g_i$が）任意だったから，後述の補題より$f$はスカラー写像である：$\exists a\in\C,\;f=a$．
        この時，$a=a_i$となる．よって，$\widetilde{V}_{a_i}=V_{a_i}$である．これが任意の$1\le i\le n$について成り立つのであったから，$f$は対角化可能である．
    \end{description}
\end{Proof}

\begin{lemma}[スカラー倍写像の特徴付け]
    $V\in\FVS_K(V)$とし，$\forall g\in\End_K(V),\;f\circ g=g\circ f$とする．この時，$f$はスカラー倍写像である：$\exists a\in K,\; f=a$．
\end{lemma}
\begin{Proof}
    $V$の基底$x_1,\cdots,x_n$に関する$f$の行列表示を$A=(a_{ij})$とする．
    $f$がスカラー倍写像ではないと仮定して，矛盾を導く．即ち，ある$i\ne j$が存在して，$a_{ij}\ne 0$と仮定する．
    すると，行列$B=(b_{ij})$を，$i\ne j$の時$b_{ij}=0\in K$とし，$b_{ii}\ne b_{jj}\in K$とすれば，他の$b_{kk}\;(k\ne i,j)$の値に依らず，
    $BA$の$ij$成分は$\sum^n_{k=1}a_{kj}b_{ik}=a_{ij}b_{ii}$，$AB$の$ij$成分は$\sum^n_{k=1}a_{ik}b_{kj}=a_{ij}b_{jj}$より，$a_{ij}b_{ii}\ne a_{ij}b_{jj}$となるから，$AB\ne BA$である．
    従って，$V$の基底$x_1,\cdots,x_n$が定める同型を$\varphi_x:K^n\to V$とすれば，
    $g$をこの行列$B$が表現する線型写像$g=\varphi_x^{-1}\circ B\times\circ\varphi_x\in\End_K{V}$とすれば，$f\circ g\ne g\circ f$より，矛盾．
    よって，$f$はスカラー写像である．
\end{Proof}

\section{一般固有空間と三角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    $f$-安定な部分空間たちに分解できれば，最小多項式はそれらの積になり，
    行列表示はそれらの直和となる．$f$-安定部分空間上の行列表示は上三角に出来るから，標準形を探すという試みはこうして
    一般固有空間分解の理論に到達する．
    線型空間の標準的表示を，自己準同型$f\in\End_K(V)$の言葉によって得たことになる．
\end{tcolorbox}

\subsection{一般固有空間の性質}

\begin{definition}[generalized eigenspace]
    $V\in\Vect_K,f\in\End_K(V)$について，$d$を$f$の最小多項式$\varphi$の根$a$の重複度とする．
    \begin{enumerate}
        \item $V$の部分空間$\wt{V}_a:=\Ker(f-a)^d$を\textbf{$a$に属する一般固有空間}という．
        \item $\oplus_{a\in K}\wt{V}_a\epi V$はベクトル束をなす．制限$\oplus_{i=1}^r\wt{V}_{a_i}\epi V$が同型を与えるとき，この定義域を\textbf{一般固有空間分解}という．
    \end{enumerate}
\end{definition}

\begin{proposition}[一般固有空間への制限は三角化可能である]\label{prop-algorithm-for-making-triangular-matrices}
    $V\in\Vect_K,f\in\End_K(V),a\in K$について，$f$の最小多項式$\varphi$の根$a$の重複度を$d\in\N$とする．
    \begin{enumerate}
        \item (特徴付け) $\wt{V}_a=\Brace{x\in V\mid\exists_{n\in\N}\;(f-a)^n(x)=0}=\cup_{n\in\N}\Ker(f-a)^n$．
        \item ($f$-安定性) $f(\widetilde{V}_a)\subset\widetilde{V}_a,V_a\subset\widetilde{V}_a$．
        \item (三角化可能性) $\widetilde{V}_a$が有限次元であるとする．$f|_{\widetilde{V}_a}:\widetilde{V}_a\to\widetilde{V}_a$は三角化可能である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $W=\{x\in V\mid\exists n\in\N,\; (f-a)^n(x)=0\}$と置く．$\tilde{V}_a\subset W$であるから，あとは$\tilde{V}_a\supset W$を示せば良い．
        $x\in W$を任意に取ると，ある$n\in\N$が存在して$(f-a)^n(x)=0$即ち$x\in\Ker(f-a)^n$が成立する．この時，
        \begin{enumerate}[(1)]
            \item 注\ref{remark-1}より，$F(f)=(f-a)^n$と置くと$f(\Ker F(f))\subset\Ker F(f)$だから，$f(\Ker(f-a)^n)\subset\Ker(f-a)^n$．
            \item $V$の部分空間$\Ker(f-a)^n$に$f$が引き起こす射$(f-a)^n|_{\Ker(f-a)^n}$は$(f-a)^n(\Ker(f-a)^n)=0$を満たすから，$(f-a)^n|_{\Ker(f-a)^n}$の最小多項式は多項式$(X-a)^n$を割り切るので，$e|n$を満たす$e\in\N$を用いて$\psi=(X-a)^e$と書ける．
            \item 1.が成り立つので命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$\psi=(X-a)^e$は$f$の最小多項式$\varphi$も割り切るから，$e|d$でもある．
        \end{enumerate}
        以上の議論より，$x$が，$f$が保つような$V$の部分空間$\Ker(f-a)^n$に入っているならば，その部分空間上に定まる自己準同型$(f-a)^n|_{\Ker(f-a)^n}$の最小多項式$\psi$の空間にも入っており（微視的には$\Ker(f-a)^n=\Ker\psi(f)$であるが，$V$の部分空間としては後者の方が大きい可能性がある），次大域的な自己準同型$f$の零化空間$\tilde{V}_a$には局所的なものは収まるから，次の系列を得る：
        \[ x\in\Ker(f-a)^n\subset\Ker\psi(f)=\Ker(f-a)^e\subset\Ker(f-a)^d=\tilde{V}_a \]
        が導けたから，$\tilde{V}_a=W$．
        \item[2.] 注\ref{remark-1}より，$F(f)=(f-a)^d$と置くと$f(\Ker F(f))\subset\Ker F(f)$だから，$f(\Ker(f-a)^d)\subset\Ker(f-a)^d$．また系列を考えれば$d\ge 1$ならば$\Ker(f-a)\subset\Ker(f-a)^d$であるが，$d=0$の時は$(f-a)^d=1$と約束したから，$\tilde{V}_a=0$．一方この時，根$a$の重複度も$d$即ち$a$は固有値ではないと約束したから，$V_a=0$．
        \item[3.] 列$(V_k:=(f-a)^k(\tilde{V}_a))^d_{k=0}$は減少列
            \[\tilde{V}_a=V_0\supset V_1\supset\cdots\supset V_d=0\]
            であり，それぞれの次元の組を$(n_k:=\dim V_k)_{k=0}^d$とする．算譜\ref{thm-linear-system-extension-algorithm}により，$V_k\;(k=0,1,\cdots,d-1)$の基底を帰納的に上から延長することによって定めることができる．
            $V_k$に対して基底は$x_1,\cdots,x_{n_k}$と表せ，$\tilde{V}_a=V_0$の基底$x_1,\cdots,x_{n_0}$を得る．
            
            この基底についての自己準同型$(f-a)|_{\tilde{V}_a}$の行列表示は，
            各$k$について$(f-a)(V_k)=V_{k+1}$と基底が消えていくから，対角成分が全て$0$の上三角行列である．
            従って，$f|_{\tilde{V}_a}$の同じ基底による表示は，対角成分が$a$の上三角行列である．
    \end{description}
\end{Proof}

\subsection{一般の多項式が定める自己準同型の核の一般化固有空間分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    異なる一次式の積$F=(X-a_1)\cdots(X-a_r)$の$\End_K(K)$への作用の核を固有空間の直和で与えたが，さらに一般化して
    \[\Ker((X-a_1)^{d_1}\cdots(X-a_r)^{d_r}|_{X=f})=\Ker(f-a_1)^{d_1}\oplus\cdots\oplus\Ker(f-a_r)^{d_r}\subset V\]
    という関手性を示す（定理\ref{thm-triangulization}）．左辺の一次式の積が，何かの線型写像$f$の最小多項式$\varphi$であった場合，等号が成り立ち，
    この定理は空間$V$の一般固有空間分解を与える．
\end{tcolorbox}

\begin{theorem}[一般の多項式が定める自己準同型の核]\label{thm-triangulization}
    $V$を$K$-線型空間とする．$a_1,\cdots,a_r\in K$を相異なる元として，$F=(X-a_1)^{d_1}\cdots(X-a_r)^{d_r}\;(d_i>0)$と置く．
    この時，
    \[ \Ker F(f)=\Ker(f-a_1)^{d_1}\oplus\cdots\oplus\Ker(f-a_r)^{d_r}. \]
\end{theorem}
\begin{Proof}
    命題\ref{prop-diagonalization}と同様，$r$についての帰納法で示す．$r=1$の時は定義そのものである．
    $r>1$とした時，$G=(X-a_1)^{d_1}\cdots(X-a_{r-1})^{d_{r-1}}$と置くと，帰納法の仮定より$\Ker G(f)=\Ker(f-a_1)^{d_1}\oplus\cdots\oplus\Ker(f-a_{r-1})^{d_{r-1}}$である．
    $a_1,\cdots,a_r$は相異なるから，$G(a_r)\ne 0$である．
    すると，次の補題が成り立てば，命題\ref{prop-pre-homomorphism-thm}より，$\Ker F(f)=\Ker G(f)\oplus\Ker(f-a_r)^{d_r}$とわかる．
\end{Proof}

\subsection{三角化と安定部分空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=上三角化をSchur標準形ともいう，一意性はないが]
    一次式の積として表せる多項式に対して，その作用の核の一般化固有空間分解を得た．
    一般化固有空間は$f$-安定であるから，そこでの表示は三角化可能である．
    従って，一次式の積の形の最小多項式を持つならば，各一般化固有空間分解上での表示を考えれば，三角化可能である．
\end{tcolorbox}

\begin{lemma}\label{lemma-for-triangulization}
    $V\in\Vect_K,f\in\End_K(V)$，
    $G\in K[X],a\in K$とし，$W:=\Ker G(f)$と置く．$G(a)\ne 0$ならば，次が成り立つ．
    \begin{enumerate}
        \item $f-a$が$W$に引き起こす写像$(f-a)|_W:W\to W$は可逆である．
        \item $\Ker G(f)(f-a)^d=W\oplus\Ker(f-a)^d$．
    \end{enumerate}
\end{lemma}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $\exists G\in K[X],\; G=Q(X-a)+G(a)$と表せる．ここで$H=-\frac{Q}{G(a)}\in K[X]$と置くと，
        \[H(X-a)=1-\frac{G}{G(a)}\]
        である．よって，$W=\Ker G(f)$の範囲に制限すれば第二項は消えるから，$H(f)\circ (f-a)=(f-a)\circ H(f)=\id$．よって，$(f-a)|_W$は可逆で逆射は$H(f)$．
        \item[2.] $W\subset W':=\Ker G(f)(f-a)^d$と置くと，$W'$に関する$W$の補空間が$\Ker(f-a)^d$だと示せば良い．
        $(f-a)^d(W')\subset W$より，$(f-a)^d$は$W'$上に線型写像$g:=(f-a)^d|_{W'}:W'\to W$を引き起こす．これは制限を課さずとも$\Ker(f-a)^d\subset W'$だから，$\Ker g=\Ker(f-a)^d\cap W'=\Ker (f-a)^d$が成り立つ．よって，命題\ref{prop-pre-homomorphism-thm}より，$W'=W\oplus\Ker g$．
    \end{description}
\end{Proof}

\begin{corollary}[三角化可能条件]\label{cor-triangulability}
    $V\in\FVS_K$とする．次は同値．
    \begin{enumerate}
        \item $f$は三角化可能．
        \item $V$の基底$x_1,\cdots,x_n$で，$f(x_i)\in\langle x_1,\cdots,x_i\rangle\;(i\in[n])$を満たすものが存在する．
        \item $f$の最小多項式$\varphi$は一次式の積に分解する．
        \item $\exists_{a_1,\cdots,a_r\in K}\;V=\wt{V}_{a_1}\oplus\cdots\oplus\wt{V}_{a_r}$．
        \item $V$の基底であって，それに関する$f$の行列表示$A$が，その対角成分が全て$a_i\in K$の上三角行列$A_i$の直和$A=A_1\oplus\cdots\oplus A_r$となるものがある．
    \end{enumerate}
\end{corollary}
\begin{Proof}
    1と2は少し高度だが，5までくれば言い換えであると分かる．
    \begin{description}
        \item[1$\Rightarrow$3] 任意の上三角行列の最小多項式を$\varphi$とする．対角成分を$a_1,\cdots,a_n$とすると，命題\ref{prop-eigenvalue-of-triangular-matrices}より，$\varphi$は多項式$(X-a_1)\cdots(X-a_n)$を割り切る．よって$\varphi$は一次式の積に分解する．
        \item[3$\Rightarrow$4] $\varphi$は最小多項式なので，$V=\Ker\varphi(f)$だから，定理\ref{thm-triangulization}より従う．
        \item[4$\Rightarrow$5] 上三角行列の算譜（命題\ref{prop-algorithm-for-making-triangular-matrices}）により，各$\tilde{V}_{a_i}$上では$f|_{\tilde{V}_{a_i}}$は上三角化可能である．この基底を並べれば，条件の行列表示を得る．
        
        \item[5$\Rightarrow$1] 5の行列は上三角行列である．
    \end{description}
\end{Proof}


\begin{corollary}[三角化可能性の遺伝]
    $V\in\FVS_K$とし，$f\in\End(V)$を三角化可能とする．
    \begin{enumerate}
        \item 次の条件は同値である．
        \begin{enumerate}[(1)]
            \item $f$は対角化可能．
            \item $f$の固有値$a_1,\cdots,a_r$について，$\widetilde{V}_{a_i}=V_{a_i}\;(i\in[r])$．
        \end{enumerate}
        \item $W$を$f(W)\subset W$を満たす$V$の$f$-安定部分空間とする．$f|_W$は三角化可能である．
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $f$は三角化可能だから，系\ref{cor-triangulability}より$a_1,\cdots,a_r\in K$が存在して$V=\tilde{V}_{a_1}\oplus\cdots\oplus \tilde{V}_{a_r}$と分解できる．
        命題\ref{prop-algorithm-for-making-triangular-matrices}.2より，$V_{a_i}\subset\tilde{V_{a_i}}$なので，(2)の条件は$V=V_{a_1}\oplus\cdots\oplus V_{a_r}$と分解できることを言っている．
        これは$f$が対角化可能であることと同値である（系\ref{cor-diagonalizability}）．
        \item[2.] 系\ref{cor-triangulability}より，$f$の最小多項式$\varphi$は一次式の積に分解する．命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$f|_W$の最小多項式は$\varphi$を割り切る．よってこれも一次式の積に分解し，$f|_W$は三角化可能．
    \end{description}
\end{Proof}

\section{自己準同型の冪零・冪等分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    三角化の理論をさらにもう一歩だけ深めたい．
    %必ずしも一般の係数体$K$に対して一般固有空間に分解できるとは限らず，もっと線型空間に寄り添って，核心に迫りたい．
    個々の一般固有空間に引き起こされる射に注目して
    $g_i:=(f-a_i)|_{\widetilde{V}_{a_i}}$とすると，$g_i^{d_i}=0$が成り立つわけであるが，
    この固有空間を一般化する際に加味した冪零の要素に注目して，理論を深化させることを考える．
    三角行列の細胞$A_i$が$g_i$の行列表示である．
    $g_i$に注目して，この行列表示がどこまで簡単になるかを考える．

    一般の冪零写像$N$について，線型空間には定理\ref{thm-Jordan-decomposition}のような標準的な分解がある（これはいくらか同伴行列に起こっている現象と似ている！ロケット鉛筆！）．
    この，冪零性の寿命と人生航路を考慮した分解がJordanの理論である．
    これに沿った行列表示を考えれば，三角化よりも踏み込んだ表示Jordan標準形を得る．
    これは，有限次元線型空間の三角化可能な自己準同型は，対角化可能な部分と冪零な部分に分解し，それで全てであることを表している．

    Jordan blockの大きさが冪零成分の系列の長さ（寿命），個数がその系列の空間の次元を表す．対角成分が半単純部分を表す．非対角成分は冪を取るごとにはけてゆく．
    この表示により，共役類の貼り合わせとしての線型写像の振る舞いを一眼で見ることが出来るようになる．
    これが基底変換である．

    そう，三角化可能な有限次元線型空間の自己準同型については，この「冪零成分はJordan blockに，そうでない成分は対角行列に」というのが最も線型代数的に自然なもので，これが上三角行列の真の精緻化としてふさわしいものである．
    Jordan標準形は，一般固有空間のそれぞれに対して，Jordan分解を考えたものである．
\end{tcolorbox}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=上三角表示の精緻化・一意化]
    $V_a\subsetneq\wt{V}_a$となるときは対角化可能でないが，何が起こっているか．
    これは，最小多項式の$(x-a)^d\;(d\ge2)$なる因子に起因していて，
    $\wt{V}_a$上で$f-a$は冪零写像を定めている．
    $\wt{V}_a$上でみれば，$f$のスカラー倍以外の成分はいずれ消える．そこで，
    冪零自己準同型はこれを適用する毎に正確に1つずつ潰れていくような直和分解$Kx_1\oplus\cdots Kx_r$を取れば，
    これについての行列表示は上三角どころか帯行列になる．
\end{tcolorbox}

\subsection{冪零自己準同型のJordan標準形}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    次数$m$の冪零自己準同型$N^{m+1}=0$は，それぞれの段階で空間をどのように潰していくかに沿った空間の分解を持つ．
    これを用いれば，一般化固有空間内で基底を取り直すことで，任意の三角行列をJordan標準形に直すことが出来る．
\end{tcolorbox}

\begin{theorem}[空間上の冪零自己準同型の核への分解]\label{thm-Jordan-decomposition}
    $V\in\Vect_K, N\in\End(V)$を$N^{m+1}=0$を満たす自己準同型とする．この時，
    $(p,q)\in\N^2\;(p+q\le m)$で添字付けられた
    $V$の直和分解
    \[ V=\bigoplus_{p,q\in\N,p+q\le m}V_{p,q} \]
    が存在し，次の条件(J1),(J2)を満たす：
    \begin{enumerate}[({J}1)]
        \item 余命$p$が$p>0$を満たすならば，$N|_{V_{p,q}}:V_{p,q}\to V_{p-1,q+1}$は同型である．
        \item 余命$p$がすでに尽きている$p=0$ならば，$V_{0,q}\subset\Ker N$．
    \end{enumerate}
    特に，$N$が$m+1$次の冪零準同型ならば$\dim V\ge m+1$である．
\end{theorem}
\begin{remarks}
    $p+q$をその系列の寿命，$N_{-,0}$を開始地点としており，
    各$N_{p,q}$の添字$(p,q)$の
    $q$が$N$をすでに作用させた回数で，$p$が$0$にまで潰れるまでの余命である．
    
    添字$(p,q)$は格子点だから，座標系を-45度回転させて次の図を得る．
    核の系列$\Ker N\subsetneq\Ker N^2\subsetneq\cdots\Ker N^m\subsetneq\Ker N^{m+1}=V$は，
    $p=0$に平行に下から水位が上がっていくように全てを飲み込むように迫ってくる．
    一方で像の系列$V=\Im N^0\supsetneq\Im N^1\supsetneq\cdots\supsetneq\Im N^m\supsetneq\Im N^{m+1}=0$は，
    $q=0$と並行に上から水位が下がっていくように消える．
    \[\xymatrix{
        &&&&V_{m,0}\ar[d]^-{\rotatebox{90}{$\sim$}}\\
        &&V_{1,0}\ar@{.}[urr]\ar[dd]^-{\rotatebox{90}{$\sim$}}&&V_{m-1,1}\ar@{}[dd]|{\vdots}\\
        V_{0,0}\ar@{.}[urr]^-{q=0}\ar@{.}[drr]_-{p=0}&&{}\ar@{}[rr]|{\cdots\cdots}&&{}\\
        &&V_{0,1}\ar@{.}[drr]&&V_{1,m-1}\ar[d]^-{\rotatebox{90}{$\sim$}}\\
        &&&&V_{0,m}
    }\]
    以上で，$(p,q)$はそれぞれ$N^r$の像と核で指定出来るので，その言葉を使って構成する．
    なお，$p=0$軸に関する直和が固有空間となり，$q=0$軸方向への伸びが一般化固有空間である．
    $\dim V_{0,q}$が大きさ$q$のJordan細胞の数である．
\end{remarks}
\begin{Proof}\mbox{}
    \begin{description}
        \item[構成] 
        \begin{enumerate}
            \item $p=0$上にある空間$V_{0,q}\;(q\in[m])$は，$\Ker N\cap\Im N^q=V_{0,q}\oplus(\Ker N\cap\Im N^{q+1})$を満たす補空間とする．
            \item $q=0$上にある空間$V_{q,0}\;(q\in[m])$は，$(N^q)^{-1}(V_{0,q})=V_{q,0}\oplus(\Ker N^q)$を満たす補空間とすると，準同型定理より，核の補空間$V_{q,0}$上への$N^q$の制限は同型になる．
            \item 一般の$V_{p,q}\;(2\le p+q\le m)$は，$V_{p,q}:=N^q(V_{p+q,0})$とする．
        \end{enumerate}
        \item[証明] これらは条件(J)を満たす．
    \end{description}
\end{Proof}

\begin{corollary}
    冪零自己準同型$N\in\End_\C(V)$のJordan標準形$J$について，
    \begin{enumerate}
        \item Jordan細胞の総数は，$N$の$0$に属する固有空間の次元に等しい．
        \item 最大のJordan細胞の大きさは，$N$の指数(最小多項式の$0$の重複度)に等しい．
    \end{enumerate}
\end{corollary}

\begin{example}[$J(0,n)$の場合]
    $K^n$上の自己準同型$N:=J(0,n)$を考える．
    これは$N^n=0$であり，$V_{i-1,n-i}=\langle e_i\rangle\;(i=1,\cdots,n)$と置き，それ以外を$0$とすれば良い．
    即ち，$J(0,n)$とは，寿命が$n$である一番右の列の直和だけで$V$が表せる場合である．
    また$N:=J(0,r)\oplus J(0,n-r)$のとき，寿命$r$と寿命$n-r$の2列の直和として$V$が得られる．
    実は，任意の冪零自己準同型は，それぞれの列の次元の大きさ分の大きさのJordan細胞の直和で表せる．
    そう，冪零自己準同型には0と1以外の数は必要ないのである．
\end{example}

\begin{corollary}[冪零準同型のJordan標準形]\label{cor-Jordan-form-of-nilpotents}
    $V\in\FVS_K$とし，$N\in\End(V)$を$N^{m+1}=0$を満たすとする．このとき，$V$の基底で，それに関する$N$の行列表示が
    \[J=J(0,1)^{\oplus n_0}\oplus\cdots\oplus J(0,r+1)^{\oplus n_r}\oplus\cdots\oplus J(0,m+1)^{\oplus n_m}\quad(n_r:=\dim(V_{0,r}))\]
    というJordan行列になるものが存在する．
\end{corollary}

\begin{problem}[実際の$V_{p,0}$探索に使う算譜]
    $V$の基底$x_1,\cdots,x_n$と$\Im N^r$の$V_{r,0}$に対する補空間$W_r=\sum_{0\le p,r\le p,r\textcolor{red}{<}p+q\le m}V_{p,q}$と，
    その基底$N^ry_1,\cdots,N^ry_s$が与えられているとする．
    始空間$V_{r,0}$とその基底の構成算譜を与えよ．$(1\le r\le m)$である．こうやって$p+q=m$の場合から構成していく．
\end{problem}
\begin{Proof}[［解答］]
    $W_r$は残機が尽きている虫の息の$V_{0,r}$を$\Im N^r$から除いた補空間であるから，$N(\Im N^r)=N(W_r)$が成り立つ．
    $\Im N^r$の基底を探し，$x_{i_1},\cdots,x_{i_t}$を用いて，$N^ry_1,\cdots,N^ry_s,N^rx_{i_1},\cdots,N^rx_{i_t}$と表せたとし，
    ここから$V_{0,r}$の基底を遡上して探す方法を考える．
    $N(\Im N^r)=N(W_r)$より，$1\le j\le t$について，
    \[ \exists a_{1j}N^ry_1+\cdots+a_{sj}N^ry_s\in\Im N^r,\; N(N^{r}x_{i_j})=N(a_{1j}N^ry_1+\cdots+a_{sj}N^ry_s) \]
    であるから，
    \[ z_j=x_{i_j}-(a_{1j}y_1+\cdots+a_{sj}y_s) \]
    と置けば，これはちょうど次の$N$の作用で消える元だから，$V_{r,0}$の元である．
    $z_1,\cdots,z_t$の右辺の同型$N^r$による値は$\Im N^r$の基底であるから，同型$(N^r)^{-1}$による像である$z_1,\cdots,z_t$も基底で，
    $V_{r,0}=\langle z_1,\cdots,z_t\rangle$と置けば良い．
\end{Proof}

\begin{problem}
    次の行列のJordan標準形を求めよ．
    \[N=\begin{pmatrix}0&0&0&1&0&0\\0&0&0&0&1&-1\\1&-1&0&-1&-1&1\\0&0&0&0&0&0\\0&0&0&0&0&0\\0&0&0&0&0&0\end{pmatrix}\]
\end{problem}
\begin{Proof}[［解答］]
    \[N^2=\begin{pmatrix}0&0&0&0&0&0\\0&0&0&0&0&0\\0&0&0&1&-1&1\\0&0&0&0&0&0\\0&0&0&0&0&0\\0&0&0&0&0&0\end{pmatrix},\;N^3=0.\]
    右下から見つかる：$V_{0,2}=\Im N^2=\langle e_3\rangle=\Im N^2\cap\Ker N$．続いて遡上するには，$e_3=N^2e_4,Ne_4=e_1-e_3$を了解すれば，$V_{2,0}=\langle  e_4\rangle,V_{1,1}=\langle e_1-e_3\rangle$とわかる．
    従って，$W_1:=V_{0,2}+V_{1,1}=\langle e_3,e_1-e_3\rangle$とわかる．

    続いて，右端の列の情報を上で考えた算譜に適用して寿命１の列を調べる．
    $\Im N=\langle  e_3,e_1-e_3,e_2-e_3\rangle=\langle e_2-e_3\rangle+W_1$である．
    ここでトリックで，$N(e_2-e_3)=-e_3=-N(e_1-e_3)\in W_1$かつ$e_1-e_3\in W_1$なのを利用して$V_{0,1}=\langle (e_2-e_3)+(e_1-e_3)\rangle =\langle e_1+e_2-2e_3\rangle$とする．
    なぜなら，$e_1+e_2-2e_3=N(e_4+e_5)$だからである．$V_{1,0}=\langle e_4+e_5\rangle$とおける．
    すると，今まで明らかにした空間は$W_0:=\langle e_3,e_1-e_3,e_4,e_2-e_1,e_4+e_5\rangle$となる．

    最後に，$V=\langle e_6\rangle +W_0$で，$Ne_6=e_3-e_2=-Ne_5\in W_0$かつ$e_5\in W_0$であるから，$V_{0,0}=\langle e_5+e_6\rangle$と置けば良い．

    すると，Jordan分解$K^6=\oplus_{0\le p,q\le 2,p+q\le 2}V_{p,q}$を得た．

    Jordan標準形を得るための底の変換行列は，標準基底$e_1,\cdots,e_6\in K^6$の行き先を順に，右下から上への動きで指定して，
    \[ P=\begin{pmatrix}0&1&0&1&0&0\\0&0&0&1&0&0\\1&-1&0&-2&0&0\\0&0&1&0&1&0\\0&0&0&0&1&1\\0&0&0&0&0&1\end{pmatrix}. \]
    Jordan標準形は
    \[ P^{-1}NP=\begin{pmatrix}0&1&0&0&0&0\\0&0&1&0&0&0\\0&0&0&0&0&0\\0&0&0&0&1&0\\0&0&0&0&0&0\\0&0&0&0&0&0\end{pmatrix}. \]
    寿命３のものが一番上のブロックに来ており，次に寿命が２のもの，最後に寿命１のものである．それぞれ次元が３，２，１で合計６である．
\end{Proof}

\subsection{一般の自己準同型のJordan分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=三角化の一意化がJordan分解である]
これで，冪零準同型の理論は揃った．
一般の線型写像を考える．対角化できなくて三角状に余分な成分が残るものは，全てこの冪零成分による．対角化可能であることと，冪零成分が消えていることが同値であるという形で定式化される．
\end{tcolorbox}

\begin{corollary}[一般の線型写像のJordan標準形]
    $V\in\FVS_K,f\in\End(V)$を三角化可能とする．
    $f$の固有値を$a_1,\cdots,a_r$とする．この時，自然数の列$1\le p_{1,i}\le\cdots\le p_{l,i}\;(i=1,\cdots,r)$であって，
    行列$J(a_i,p_{j,i})\;(1\le i\le r,1\le j\le l_i)$の直和が$f$の行列表示となるようなものが存在する．
    （実は一意的）．
\end{corollary}
\begin{Proof}
    各一般固有空間への制限$(f-a_i)|_{\tilde{V}_{a_i}}$は冪零だから，
    これについて系を適用するとJordan分解を得る．これを並べた直和の行列を得れば良い．

    系より，基底の並べ方を除いて一意的に定まる．
\end{Proof}

\begin{definition}[Jordan normal form]
    $V\in\FVS_K,f\in\End(V)$を三角化可能とする．$f$の行列表示$J$がJordan行列の直和からなる時，$J$を$f$の\textbf{Jordan標準形}であるという．
\end{definition}

\begin{definition}[semi-simple part, nilpotent part, unipotent part]
    $V=\widetilde{V}_{a_1}\oplus\cdots\oplus\widetilde{V}_{a_r}$を$f\in\End_K(V)$に関する一般固有空間分解とする．
    \begin{enumerate}
        \item $V$の自己準同型$s\in\End(V)$で，各$\widetilde{V}_{a_i}$への制限が$a_i$倍写像であるという条件で定まるものを，\textbf{$f$の半単純部分}と言う．
        \item $n:=f-s$を\textbf{$f$の冪零部分}と言う．
        \item $f=s+n$を$f$の\textbf{Jordan分解}と言う．
        \item $f=s+n$が$s=\id_V$であるとき，\textbf{冪単}であるという．
        \item 固有値$a_1,\cdots,a_r$がいずれも$0$でない時（即ち$V_{0,0}=0$である時），$u:=s^{-1}f$を\textbf{$f$の冪単部分}と呼び，$f=su$を$f$の\textbf{乗法的なJordan分解}または\textbf{Chevalley分解}と呼ぶ．
    \end{enumerate}
\end{definition}
\begin{remark}\mbox{}
    \begin{enumerate}
        \item 単位元をもつ環（可換でなくてもよい）上の加群は、単純（既約）部分加群の直和であるときに、半単純 (semisimple) あるいは完全可約 (completely reducible) という。 \footnote{\url{https://ja.wikipedia.org/wiki/半単純加群}}
        \item 結局半単純部分と冪零部分の解離が，最小多項式と固有多項式の解離部分に等しい．$n$がfullの時（一般固有空間と固有空間が一致する時も含め，冪零次元が満たされている時），２つの多項式は一致する．一番乖離が大きいのは$n=0$即ち対角化可能である時である．
        \item $J(a,n)=a+J(0,n)$はJordan分解である．
    \end{enumerate}
\end{remark}

\begin{corollary}[固有空間と一般化固有空間の乖離]
    $A\in\End_\C(V)$について，
    \begin{enumerate}
        \item $A$のJordan標準形における固有値$\al$に属するJordan細胞の大きさの和は，$\al$の幾何的重複度(一般化固有空間の次元)に等しい．
        \item $A$のJordan標準形における固有値$\al$に属するJordan細胞の数は，$\al$に属する固有空間の次元に等しい．
    \end{enumerate}
\end{corollary}

\begin{corollary}
    $A\in\End_\C(V)$とその固有値$\al$について，
    \begin{enumerate}
        \item $\al$に属するJordan細胞はただ1つである．
        \item $\al$の最小多項式における重複度と，固有多項式における重複度とは一致する．
    \end{enumerate}
\end{corollary}
\begin{remarks}
    Jordan細胞の数=固有空間の次元が$\dim V_{0,q}$で，次数の和=一般化固有空間の次元が$V_{0,q}$の列に関する直和である．
    そして，最小多項式における重複度が寿命の長さを意味しているから，これが幾何的重複度に一致するならば，幅$\dim V_{0,q}$は1であることが分かる．
\end{remarks}

\begin{corollary}[Jordan分解の遺伝]
    $W\in V(S)$を$A\in\End_K(V)$-安定部分空間，$A=S+N$をJordan分解とする．
    \begin{enumerate}
        \item $W$は$S,N$-安定でもある．
        \item $A|_W=S|_W+N|_W$が$A|_W$のJordan分解を与える．
    \end{enumerate}
\end{corollary}

\subsection{共役類の標準形である}

\begin{theorem}[Jordan標準形は共役類不変量である]
    $K$を代数的閉体，$V\in\FVS_K$とする．任意の$A\in\End_K(V)$はJordan標準形を持ち，次の2条件は同値：
    \begin{enumerate}
        \item $A,B$は共役．
        \item $A,B$のJordan標準形は一致する．
    \end{enumerate}
\end{theorem}

\begin{proposition}[一般化固有空間分解とそこでの冪零次数が共役不変量である]
    $K$を代数的閉体，$V\in\FVS_K$とする．
    \begin{enumerate}
        \item $\dim V\le3$ならば，$A\in\End_K(V)$が共役であることと最小多項式が一致することとは同値．
        \item $\dim V\ge4$では同様の事実は成り立たない．ただし，各固有空間への制限が，同じ冪零次数を持つことを課せば再び同値になる．
    \end{enumerate}
\end{proposition}

\begin{proposition}[同時Jordan行列化は必ずしも可能でない]
    $K$を代数的閉体，$V\in\FVS_K$，$A,B\in\End_K(V)$は可換とする．
    \begin{enumerate}
        \item $A,B$は同時上三角化可能である．
        \item 一方で，可換だからといって，同じ基底についてJordan標準形に表せるとは限らない．
    \end{enumerate}
\end{proposition}

\begin{proposition}
    位相線型空間$M_n(\C)$の対角行列の全体$D$は$M_n(\C)$上稠密である．
\end{proposition}

\section{単因子と有理標準形}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Jordan標準形の理論は，一般の単項イデアル整域上の加群で成り立つ．
    これは，有限生成単項イデアル整域上の加群について，構造定理が成り立つことによる．
    $x$-行列の対等類の標準形はSmith標準形が，共役類の標準形は有理標準形が与える．
\end{tcolorbox}

\subsection{単項イデアル整域上の行列の単因子標準形}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $M_n(R)$のモデルとして
    $M_n(\Z)$の環を考える．
    「正則」の代わりに\textbf{単模}という．
    この環にはSmith標準形がある．
    このときの固有値に当たるものを\textbf{単因子}という．
\end{tcolorbox}

\begin{notation}[fundamental matrix]
    次の基本行列の定める左作用を考える（行基本変形）．これらの基本行列はユニモジュラーである．
    \begin{enumerate}
        \item $P_n(i,j)$を，単位行列の$i$行と$j$行を入れ替えたもので，行の入れ替え変換に対応する行列とする．
        \item $Q_n(i;-1)$を，単位行列の$a_{ii}$成分の符号を反転させたもので，行の$-1$倍変換に対応する行列とする．
        \item $R_n(i,j;c)$を，単位行列に$a_{ij}$成分だけ$c$である行列を足したもので，行の定数倍を加える変換に対応する行列とする．
    \end{enumerate}
    同様の行列の右作用を考えると，同種の列基本変形に対応する．
\end{notation}

\begin{definition}[unimodular]\mbox{}
    \begin{enumerate}
        \item 環$M_n(\Z)$の可逆元を\textbf{単模行列}といい，これがなす群を$\GL_n(\Z):=\Brace{A\in M_n(\Z)\mid\det A=\pm1}$で表す．
        \item  一般の単項イデアル整域$R$について，環$M_n(R)$の元で行列式が単元になる行列も単模行列という．
        \item $R$が体のとき，行列が単模であることと正則であることは同値．
    \end{enumerate}
\end{definition}

\begin{theorem}[(Smith) normal form / invariant factor normal form]
    $R$を単項イデアル整域，$A\in M_{mn}(R)$を行列とする．
    $\forall_{1\le i\le r-1}\;e_i|e_{i+1}$を満たす自然数の組$(e_1,\cdots,e_r)$が単元倍を除いて一意的に存在して，
    ある単模行列$P,Q\in\GL_n(R)$について，$PAQ=\diag(e_1,\cdots,e_r,0,\cdots,0)$が成り立つ．
    ただし，$e_i|e_{i+1}$は$\forall_{1\le i\le r-1}\;(e_i)\supset(e_{i+1})$とした．
\end{theorem}
\begin{corollary}[ユニモジュラー行列の特徴付け]
    $A\in M_n(R)$について，(1)と(2)は同値で，$R=K[X]$のとき(3)も同値：
    \begin{enumerate}
        \item ユニモジュラー行列である．
        \item 基本行列の積として表せる．
        \item $\det(A(x))\in K^\times$．
    \end{enumerate}
\end{corollary}
\begin{definition}[elementary divisor]
    任意の$A\in M_{mn}(\Z)$について，Smith標準形に現れる$(e_1,\cdots,e_r)$を\textbf{単因子}といい，$r$を\textbf{階数}という．
\end{definition}

\begin{definition}[Hermite normal form, pivot]
    整数成分行列$H\in M_{nm}(\Z)$が次の3条件を満たすとき，\textbf{Hermite標準形}であるという：
    \begin{enumerate}
        \item 任意の成分は非負：$H\ge0$．
        \item 各行での最初の非零元$p_i:=H_{i,j_i}$は，一つ上の行のそれの右に現れる：$j_i>j_{i-1}$．これを\textbf{ピボット}という．
        \item ピボット$p_i$はその列の中で唯一の最大元である．
    \end{enumerate}
    一般の行列の\textbf{行階段形}に当たる概念である．
\end{definition}
\begin{theorem}
    任意の整数成分行列$M\in M_{nm}(\Z)$に対して唯一の可逆行列$U\in\GL_n(\Z)$が存在して，$UM$はHermite標準形になる．
\end{theorem}

\subsection{単項イデアル整域上の有限生成加群の構造定理}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    単因子の全貌を観るために，一度単項イデアル整域上の有限生成加群の構造定理を単因子の言葉で述べる．
    $M_n(R)$に限らず，一般に単項イデアル整域上の有限生成加群について，単因子が定まる．
\end{tcolorbox}

\begin{theorem}
    $R$を単行イデアル整域，$M$を有限生成$R$-加群とする．
    イデアルの狭義減少列$(d_1)\supsetneq\cdots\supsetneq(d_n)$が一意的に存在して，これらが定める巡回加群の直和に同型になる：
    \[M\simeq\bigoplus_{i\in[n]}R/(d_i).\]
    このイデアルの生成元$d_i$は単元倍を除いて一意であり，\textbf{単因子}という．
\end{theorem}

\begin{corollary}
    $A$を有限生成Abel群(自由$\Z$-加群)とする．このとき，$A\simeq\Z^n\oplus\bigoplus_{i}\Z/p_i^{k_i}\Z$．
\end{corollary}

\subsection{$x$-行列の対等性}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $R=K[X]$の場合を考え，
    $M_n(K[X])\simeq M_n(K)[X]$の元を$X$-行列と呼ぶこととする．
    行列因子なる共役不変量を用いて，行列の対等類(equivalence of matrix)について単因子標準形の一意性が導ける．
\end{tcolorbox}

\begin{definition}
    $n$次の$x$-行列$A(x)$のすべての$k$次小行列式の（モニックな）最大公約数を，$A(x)$の$k$次\textbf{行列式因子}といい，$d_k(x)$で表す．$d_k(x)=0$とは，$k$次小行列式がすべて$0$であることとする．
\end{definition}
\begin{lemma}[行列式因子は共役不変量である]
    相似な行列の間で，$n$個の行列式因子は一致する．
\end{lemma}
\begin{Proof}
    基本変形によって，行列式因子は変わらないことを示せば良い．

    基本変形のうち，行の交換・他の行に$K^*$-倍を加える変換は，$A(x)$の小行列全体の集合を，各元の単元倍しか変えないため，
    行列式因子を変えない．
\end{Proof}

\begin{theorem}[多項式係数の行列の単因子標準形]
    任意の$n$次$x$-行列$A(x)$は，一意的な標準形$\diag(e_1,\cdots,e_r,0,\cdots,0)$に対等である．
    ただし，$e_i(x)$はモニックな多項式で，$e_i(x)$は$e_{i-1}(x)$で割り切れるとする．
\end{theorem}
\begin{Proof}\mbox{}
    \begin{description}
        \item[存在] $n>1$についての数学的帰納法により証明する．
        \begin{enumerate}
            \item $A(x)=O$のとき，これはすでに標準形である．$A(x)\ne0$のとき，基本変形によって，$A(x)$と対等な行列であって，$(1,1)$-成分が$0$でないものが存在する．
            そのようなものの中で，$(1,1)$-成分の次数が最小であるものを一つ取る．基本変形により，特に$(1,1)$-成分がモニックであるもの
            \[B(x)=\begin{pmatrix}e_1&b_{12}&\cdots&b_{1n}\\b_{21}&\ddots&\ddots&\vdots\\b_{n1}&\cdots&\cdots&b_{nn}\end{pmatrix}\]
            が取れる．
            \item この$B(x)$の第１行・第１列の成分は，すべて$e_1$で割り切れる．
            
            実際，$e_1\not{|}b_{1j}$と仮定すると，$K[x]$は$\deg:K[x]\setminus\{0\}\to\N$をEuclid関数とするEuclid整域だから，ある$r,q\in K[x]$が存在して，$\deg(r)<\deg(e_1)$かつ$b{1j}=e_1q+r$を満たす．
            すると，$b_{1,j}$を$(1,1)$-成分へ移動し，$e_1$の$q$倍を引くと，$B(x)$の取り方に矛盾する．
            こうして，$B(x)$と対等な行列
            \[C(x)=\begin{pmatrix}e_1&0&\cdots&0\\0&c_{22}&\ddots&c_{2n}\\\vdots&\ddots&\ddots&\vdots\\0&c_{n2}&\cdots&c_{nn}\end{pmatrix}\]
            を得る．
            \item 帰納法の仮定より，$(c_{ij})_{2\le i,j\le n}$と対等な行列$\diag(e_2,\cdots,e_r,0,\cdots,0)$が存在する．これについて，$e_1|e_2$を示せば良い．
            $e_2=e_1q+r$かつ$r=0\lor\deg(r)\le\deg(e_1)$である．
            $r\ne 0$ならば，基本変形により，$C(x)$に対等な行列で$(1,1)$-成分が$r$であるものが作れる．これは$e_1$の選び方に矛盾するから，$r=0$である．
        \end{enumerate}
        すなわち，$C(x)$は$D(x)=\diag(e_1,\cdots,e_r,0,\cdots,0)$に対等である．
        \item[一意性] 
        $D(x)$の$n$個の行列式因子は明らかに
        \[d_k(x)\begin{cases}
            e_1(x)\cdots e_k(x),&k\le r,\\
            0,&k>r,
        \end{cases}\]
        である．これより，$\forall_{k\in[r]}\;e_k=\frac{d_k}{d_{k-1}}$と表せるから，$(d_k)$が一意的であるのと同様に，$(e_k)$も一意的である．
    \end{description}
\end{Proof}

\begin{corollary}[$x$-行列の対等性の特徴付け]
    $x$-行列$A(x),B(x)\in M_n(K[x])$について，次の２条件は同値．
    \begin{enumerate}
        \item $A,B$は対等である：基本変形のみを用いて移り合う．
        \item $B=PAQ$となるような２つの可逆行列$P,Q\in\GL_n(K[x])$が存在する．
        \item $A,B$の階数$r$と単因子$e_1,\cdots,e_r$が一致する．
    \end{enumerate}
\end{corollary}

\begin{corollary}[単模行列の特徴付け]
    $A(x)\in M_n(K[x])$について，次の3条件は同値：
    \begin{enumerate}
        \item $A(x)$は可逆である．
        \item 単位行列と対等である．このとき，左・右基本変形のどちらか一方のみで変換できる．
        \item 基本行列の積で表せる．
    \end{enumerate}
\end{corollary}

\subsection{特性行列の対等性による行列の相似性の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    特性方程式＝固有方程式を，$M_n(K[x])$上の等式として本来あるべき捉え方をする．
    すると，$A,B\in M_n(K)$の相似性は，$xE-A,xE-B\in M_n(K[x])$の対等性に同値になる．
\end{tcolorbox}

\begin{definition}[characteristic matrix]
    行列$A\in M_n(K)$に対し，
    \begin{enumerate}
        \item $x$-行列$xE-A\in M_n(K[x])$を，$A$の\textbf{特性$x$-行列}という．
        \item 行列係数多項式としての表示$A(x)=A_0x^k+A_1x^{k-1}+\cdots+A_{k-1}x+A_k,\quad A_0\ne O\in M_n(K)[x]$の最高次数を\textbf{冪次数}という．
    \end{enumerate}
\end{definition}

\begin{lemma}[${M_n(K[x])}$はEuclid整域である]
    $A,B\in M_n(K[x])$について，
    \begin{enumerate}
        \item $B$の最高次係数行列が可逆ならば，$A=BQ_1+R_1$かつ$\deg(R_1)<\deg(B)$を満たすように一意に表示できる．
        \item 全く同様に，$A=Q_2B+R_2\;(\deg(R_2)<\deg(B))$を満たすようにも出来る．
    \end{enumerate}
\end{lemma}

\begin{theorem}
    $A,B\in M_n(K)$について，次は同値．
    \begin{enumerate}
        \item $A,B$は相似である：$A\sim B$．すなわち，$\exists_{P\in\GL_n(K)}\;B=P^{-1}AP$．
        \item それらの特性$x$-行列$xE-A,xE-B$は対等である．
        \item $xI-A,xI-B\in M_n(K[x])$の単因子が(階数も含めて)一致する．
    \end{enumerate}
    そこで，特性行列の単因子を\textbf{相似不変式}という．
\end{theorem}

\begin{corollary}[証明抽出]
    $A\in M_n(K)$は，${}^t\!A$に相似である．
\end{corollary}

\subsection{特性行列の変換行列との対応}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $A$を$B$に変換する行列$P$を考える．
\end{tcolorbox}

\begin{proposition}[${M_n(K)[x]}$上の剰余定理]\mbox{}
    \begin{enumerate}
        \item 冪次数$k$の$x$-行列$P(x)\in M_n(K[x])$が
        \begin{align*}
            P(x)&=P_0x^k+P_1x^{k-1}+\cdots+P_{k-1}x+P_k,\quad P_0\ne O,\\
            P(x)&=P_1(x)(xE-B)+P
        \end{align*}
        と表されるとする．このとき，
        \[P=P_0B^k+P_1B^{k-1}+\cdots+P_{k-1}B+P_k\]
        となる．
        \item 冪次数$k$の$x$-行列$Q(x)\in M_n(K[x])$が
        \begin{align*}
            Q(x)&=Q_0x^l+Q_1x^{l-1}+\cdots+Q_{l-1}x+Q_l,\quad Q_0\ne O,\\
            Q(x)&=(xE-A)Q_1(x)+Q
        \end{align*}
        と表されるとする．このとき，
        \[Q=A^lQ_0+A^{l-1}Q_1+\cdots+AQ_{l-1}+Q_l\]
        となる．
    \end{enumerate}
\end{proposition}

\begin{corollary}[変換行列の対応]
    $A,B\in M_n(K)$を相似とする．特性行列の対等性より，$(xE-A)P=(xE-B)$を満たす$P(x)=P_0x^k+\cdots+P_{k-1}x+P_k\in\GL_n(K)[x]$が存在する．このとき，
    \[P:=P_0B^k+\cdots P_{k-1}B+P_k\in M_n(K)\]
    について$B=P^{-1}AP$が成り立つ．
\end{corollary}
\begin{remark}
    $P$は一意的ではない．$C\in\GL_n(K)$を$A$と交換可能として，$(CP)^{-1}A(CP)=B$が成り立つ．
\end{remark}

\begin{corollary}[最小多項式の特徴付けと有理的に求められること]
    $A\in M_n(K)$の特性行列$tI-A\in M_n(K)[t]$の任意の$n-1$次小行列式のモニックな最大公約式を$d(t)\in K[t]$とする．このとき，$A$の最小多項式$\varphi$は$\varphi=\frac{\Phi_A}{d}$と表せる．
\end{corollary}
\begin{remark}
    実際の計算は最大次数の単因子を探すことの方が簡単であろう．
\end{remark}

\subsection{有理標準形の一致による行列の相似性の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    次に$x$-行列$A(x)\in M_n(K[x])$の共役類の標準形を得ることを考える．
\end{tcolorbox}

\begin{theorem}[固有多項式の特徴付け]
    $A\in M_n(K)$の相似不変式を$e_1,\cdots,e_n\in K[x]$とする．
    \begin{enumerate}
        \item $\forall_{1<i\le n}\;e_{i-1}|e_i$．
        \item $e_i$はモニック．
        \item $e_1(x)e_2(x)\cdots e_n(x)=\det(xI-A)=\Phi_A(x)$．
    \end{enumerate}
    特に，$e_1,\cdots,e_n$の次数の和は$n$に等しく，いずれも零でない．
\end{theorem}

\begin{theorem}[行列の有理標準形と単因子の対応]\mbox{}
    \begin{enumerate}
        \item $\Phi\in K[x]$を$k$次の多項式とする．その同伴行列$C(\Phi)\in M_n(K)$の相似不変式($xI-A$の単因子)は$1,1,\cdots,1,\Phi$である．
        特に，最小多項式は$\Phi$．
        \item $e_1,\cdots,e_n\in K[x]$は定理の3条件を満たすとする．いま$h\ge1$を$\forall_{i\in[h]}\;e_i=1$かつ$e_{h+1}$は定数$1$ではないものとする．
        このとき，同伴行列$A_{k}:=C(e_k)\;(h+1\le k\le n)$に対して$A:=\diag(A_{h+1},\cdots,A_{n})$と定めれば，これは$(e_1,\cdots,e_n)$を相似不変式とする行列である．
    \end{enumerate}
    この$A$の形の行列を，相似不変式$e_1,\cdots,e_n\in K[x]$が定める行列の\textbf{有理標準形}という．
\end{theorem}

\begin{corollary}
    行列$A,B\in M_n(K)$について，
    \begin{enumerate}
        \item 有理標準形は一意に定まる．
        \item $A,B$の有理標準形が等しいことと，$A,B$が共役であることとは同値．
    \end{enumerate}
\end{corollary}

\section{Jordan標準形}

\subsection{Jordan標準形}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    固有空間$V_a$の次元は，$a$に対応するJordan細胞$J(a,-)$の個数に等しい．
\end{tcolorbox}

\begin{lemma}[$x$-行列の直和の標準形]
    $A(x)\in M_n(K[x]),B(x)\in M_m(K[x])$は単因子標準形$A(x)=\diag(1,\cdots,1,f(x)),B(x)=\diag(1,\cdots,1,g(x))$を持つとする．
    \begin{enumerate}
        \item $f(x)|g(x)$ならば，$A(x)\oplus B(x),B(x)\oplus A(x)$はいずれも$\diag(1,\cdots,1,f(x),g(x))$に対等である．
        \item $f,g$が共通因子を持たないならば，$A(x)\oplus B(x)$は$\diag(1,\cdots,1,f(x)g(x))$に対等である．
    \end{enumerate}
\end{lemma}

\begin{corollary}[Jordan標準形の共役類]
    2つのJordan行列(Jordan細胞の直和で表される行列)が相似であることは，一方が他方のJordan細胞を並び替えたものであることに同値．
\end{corollary}

\begin{theorem}[Jordan標準形]
    任意の$A\in M_n(K)$に対して，Jordan細胞の並び替えを除いて唯一のJordan行列$J$に相似である．
\end{theorem}

\begin{corollary}[対角化可能性の単因子による特徴付け]
    $A\in M_n(K)$について，
    \begin{enumerate}
        \item $A$は対角化可能である．
        \item $A$の特性行列$xE-A\in M_n(K[x])$の最後の(最大次数の)単因子$e_n(x)$が，相異なる一次式の積に分解される(重根を持たない)．
    \end{enumerate}
\end{corollary}

\subsection{実行列がJordan標準形を持つ場合}

\begin{theorem}
    実行列$A\in M_n(\R)$について，次の2条件は同値．
    \begin{enumerate}
        \item $P\in\GL_n(\R)$によってJordan標準形に変形される．
        \item $A$の固有値が全て実数である．
    \end{enumerate}
\end{theorem}

\subsection{最小多項式}

\begin{theorem}
    $A\in M_n(K)$の最小多項式は，特性行列$xI-A\in M_n(K[x])$の最大次数の単因子に他ならない．
\end{theorem}

\begin{proposition}[直和の最小多項式]
    $A_1,A_2\in M_n(K)$について，直和$A_1\oplus A_2$の最小多項式は$\lcm(\varphi_{A_1}(x),\varphi_{A_2}(x))$である．
\end{proposition}

\begin{proposition}
    $A_1,\cdots,A_k\in M_n(K)$の最小多項式は，どの2つも共通因数を持たないとする．このとき，各$A_i$の多項式として得られる行列$B_i\in M_n(K)$について，$B_1\oplus\cdots\oplus B_k$も$A_1\oplus\cdots\oplus A_k$の多項式として得られる．
\end{proposition}

\subsection{Jordan分解}

\begin{theorem}
    $A\in M_n(\C)$について，次の条件を満たす$S,N\in M_n(\C)$がただ一組存在する：
    \begin{enumerate}
        \item $A=S+N,SN=NS$．
        \item $S$は対角化可能で$N$は冪零．
        \item $S,N$は共に$A$の多項式で表せる．
    \end{enumerate}
    特に，$A$が実であるとき，$S,N$も実である．
\end{theorem}

\section{行列式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    行列式の代数的本質は外積代数で，特に正規化した歪対称な多重線型写像として特徴付けられる．
    また，Lie群の準同型$\GL_n(\R)\to\R$としても$\pm\abs{\det X}^s\;(s\in\R)$まで特徴付けられる．
    行列式はあまり作用素には一般化されないが，固有値の積のことである．
    跡が固有値の和であるので，対称式のような関係がある．
\end{tcolorbox}

\begin{history}
    Cramerが1750に連立方程式を解くのに行列式を用いた．
    関孝和も1683に独自に見つけていた．行列式は1800年代にGaussがドイツ語Determinanteと命名し，行列はSylvesterが1850年ごろにmatrixと命名した．
    全く語源的関連はなく，日本でも初めはデテルミナントと母式と訳したが，高木貞治が行列式と行列と命名し直した．
\end{history}

\subsection{定義と特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    行列式を
    \begin{enumerate}
        \item 小行列による計算法則（手でやるのが良いアルゴリズム）
        \item 規格化された多重交代線型形式（公理論で採用するもの）
        \item 符号による計算法則（還元主義的）
    \end{enumerate}
    によって定義する．
    これにより，行列式の性質と置換の符号の性質を導く．
    置換の符号は行列式によって定義できるからである．
    これは置換の行列表現と呼び得る，遠回りに見えてもしかしたら極めて有効な代数的手段である：$P(\sigma\circ\tau)=P(\sigma)P(\tau)$．
\end{tcolorbox}

\begin{definition}[determinant]
    $A\in M_n(K)$に対して，\textbf{行列式}$\det:M_n(K)\to K$を次のように帰納的に定義する．
    \begin{enumerate}
        \item $n=0$の時，$M_0(K)=0$であり，$\det\; 0=1$とする．
        \item $A=(a_{ij})\in M_n(K)$の行列式は，$A_i\in M_{n-1}(K)$を$A$の第$n$列と第$i$行を除いて得られる行列として，
        \[ \det A:=\sum^n_{i=1}(-1)^{n-i}\det A_i\cdot a_{in} \]
        と定める．
    \end{enumerate}
\end{definition}

\begin{proposition}[行列式の特徴付け１：交代多重線型形式]\label{prop-characterization-of-determinant}
    写像$d:M_n(K)\to K$について，次の４条件は全て同値である．
    \begin{enumerate}
        \item $\forall A\in M_n(K),\;d(A)=d(1)\det A$．
        \item $\forall A\in M_n(K),\;d(A)=d(1)\sum_{\sigma\in\mathfrak{S}_n}\sgn(\sigma)\cdot a_{\sigma(1)1}a_{\sigma(2)2}\cdots a_{\sigma(n)n}$．
        \item 次の二条件を満たす．
        \begin{enumerate}[(1)]
            \item (多重線型性)  $A$の第$j$列$a_j$を，$b\in K^n$で置き換えたものを$B$，$a_j+b$で置き換えたものを$C$，$ca_j$で置き換えたものを$D$とすると，次が成り立つ：
            \begin{align*}
                d(C)&=d(A)+d(B),&d(D)&=c\cdot d(A).
            \end{align*}
            \item (交代性)  $A$のある２列が等しいならば$d(A)=0$．
        \end{enumerate}
        \item 次も含めて三条件を満たす．
        \begin{enumerate}[(1)]\setcounter{enumii}{2}
            \item (歪対称性)  $B$を$A$のある二列$a_j,a_{j'}$を入れ替えて得られる行列とすると，$d(A)+d(B)=0$．
        \end{enumerate}
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(3)$\Rightarrow$(4)] 
        $A$に対して，$E$を第$i,j'$列をいずれも$a_j+a_{j'}$としたものとすると，$d(A)+d(B)=d(E)=0$．
        \item[(1)$\Rightarrow$(3)]
        $d=\det$として示す．$n=\dim A$についての帰納法で示す．
        \item[(4)$\Rightarrow$(2)]
        $\mathfrak{P}_n:=\Map([n],[n])$をモノイドとし，
        \[\xymatrix@R-2pc{
            P:\mathfrak{P}_n\ar[r]&M_n(K)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            f\ar@{|->}[r]&P(f)=(e_{f(1)}\;\cdots\;e_{f(n)})
        }\]
        とする．(1)の多重線形性より，
        \[d(A)=\sum_{f\in\mathfrak{P}_n}d(P(f))a_{f(1)1}\cdots a_{f(n)n}\]
        が従う．(2)の交代性より，$f\in\mathfrak{P}_n\setminus\mathfrak{S}_n$の時は$d(P(f))=0$が従う．
        あとは，(3)の歪対称性から，$\sigma\in\mathfrak{S}_n$に対し，$d(P(\sigma))=\sgn(\sigma)d(1)$を導けば良い．
        $\{i\in[n]\mid \sigma(i)\ne i\}\cup\{n\}$の最小値$m=m(\sigma)$に関する上からの帰納法で示す．
        $m=n$の時は$\sigma=1$だから明らか．いま，$1\le i<j\le n$に対して(3)から$d(P(\sigma\circ(i\;j)))=-d(P\sigma)$であるが，(1)$\Rightarrow$(4)より特に$d=\det$の時を考えて
        $\sgn(\sigma\circ(i\;j))=-\sgn(\sigma)$である．これを使うと，$m<n$の時，$\sigma'=\sigma\circ(m\;\sigma^{-1}(m))$とおけば，$m(\sigma')>m$と退避される．よって帰納法の家庭より，
        \[d(P(\sigma))=-d(P(\sigma'))=-\sgn(\sigma')=-\sgn(\sigma')d(1)=\sgn(\sigma)d(1)\]を得る．
        \item[(2)$\Rightarrow$(1)]
        (1)$\Rightarrow$(2)より，
        \[\det A=\sum_{\sigma\in\mathfrak{S}_n}\sgn(\sigma)\cdot a_{\sigma(1)1}a_{\sigma(2)2}\cdots a_{\sigma(n)n}.\]
    \end{description}
\end{Proof}
\begin{remarks}
    したがって，交代多重線型形式$f:M_n(K)\to K$は$f(a_1,\cdots,a_n)=\det(a_1,\cdots,a_n)f(e_1,\cdots,e_n)$を満たすので，正規化の違いを除いて行列式を定める．
\end{remarks}

\begin{proposition}[行列式の特徴付け２：群準同型]\mbox{}
    \begin{enumerate}
        \item 行列式の制限
        $\det:\GL_n(K)\to K^\times$は群の準同型である：$\det BA=\det B\cdot\det A$．
        \item 連続写像$\rho:\GL_n(\R)\to\R^\times$が条件$\rho(AB)=\rho(A)\rho(B)$を満たすならば，$\exists_{s\in\R}\;\rho(X)=\abs{\det X}^s$または$\rho(X)=\sgn(\det X)\abs{\det X}^s$である．
    \end{enumerate}
\end{proposition}
\begin{remarks}[置換の符号]
    $\sgn(\sigma):=\det(e_{\sigma(1)}\;\cdots\;e_{\sigma(n)})$と定められるから，
    これは$\sgn(\sigma\circ\tau)=\sgn(\sigma)\sgn(\tau)\;(\sigma,\tau\in\mathfrak{S}_n)$を系として含む．
\end{remarks}

\subsection{$*$-構造と内積との性質}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $M_n(K)$について，
    転置とは$*$-演算であり，跡とは内積である．
\end{tcolorbox}

\begin{proposition}
    $\varphi:R\to R'$を環準同型とする．$M_n(R)$の$*$-代数としての構造は$\varphi$と可換である：
    ただし，$\varphi A$は成分毎に$\varphi$に代入する演算とする．
    \begin{enumerate}
        \item $\varphi(A+B)=\varphi A+\varphi B$．
        \item $\varphi(AB)=(\varphi A)(\varphi B)$．
        \item $\varphi(cA)=\varphi(c)\varphi A$．
        \item $\varphi({}^t\!A)={}^t\!\varphi(A)$．
    \end{enumerate}
    (4)は特に$\det{}^t\!A=\det A$を含意する．
\end{proposition}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item $\Tr(AB)=\Tr(BA)$．
        \item $\norm{A}\le\Tr(A)$．
        \item $A\in M_2(K)$ならば，$\det(A)=\frac{\Tr(A)^2-\Tr(A^2)}{2}$．これは分散公式に近い．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    実際，共分散作用素の跡が2次の中心積率である．
\end{remarks}

\begin{example}[上三角行列の行列式]\label{example-determinant-of-triangular-matrices}
    上三角行列について，$\det (A)=\Tr(A)$である．より一般に，
    $A=\begin{pmatrix}A_{11}&A_{12}\\0&A_{22}\end{pmatrix}$ならば，$\det A=\det A_{11}\det A_{22}$である．
    これはきっとデータ構造自体に内在する機構なのだろう．一つのデータ単位を，一文字$a_{11}$で表すか，ブロック$A_{11}$で表すかの違いで，全く同じ代数的取り扱いが出来るはず．
\end{example}

\subsection{不等式}

\begin{proposition}[Hadamardの不等式]
    任意の$A=(a_1\;\cdots\;a_n)\in M_n(K)$について，
    \begin{enumerate}
        \item $\abs{\det A}\le\norm{a_1}\cdots\norm{a_n}$．
        \item $A\in\GL_n(K)$のとき，等号成立条件は列ベクトル$a_1,\cdots,a_n$が直行すること．
    \end{enumerate}
\end{proposition}

\subsection{Cramerの公式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    置換の符号も行列式で表せるのであったから，置換の符号も加味した小行列の行列式を余因子という．
    これによって$\det A$が表せることが，多重線形性から示せる．
    $A$が可逆な時は，その逆行列を$\det A$と$\Delta(A)$とで表す公式として使用できる．

    行列のデータ構造は不思議なものである．内積が自然とするなら，
    この双対性を横と縦の対として表現するのである．
\end{tcolorbox}

\begin{definition}[minor, first minor, cofactor matrix]\mbox{}
    \begin{enumerate}
        \item 行列から１つ以上の行や列を取り除いて得られる行列を小行列という．その行列式を小行列式という．小行列式は余因子と符号分だけ違う．
        \item 行列$A$の第$ij$成分を$1$，第$i$行と第$j$列のそれ以外の要素を$0$とした行列の行列式$\Delta_{ij}\in K$を\textbf{余因子}と言う．
        \item 余因子を転置させて並べた行列$\Delta(A):=(\Delta_{ji})\in M_n(K)$を$A$の\textbf{余因子行列}という．
    \end{enumerate}
\end{definition}

\begin{proposition}[Cramer]\label{prop-Cramer}
    \[\Delta(A)A=\det A.\]
\end{proposition}
\begin{Proof}
    まず，任意の$j\in[n]$について，$\Delta(A)A$の$jj$成分が$\det A$であることを示す．
    $i\in[n]$について，行列$A$に対して第$j$列を$e_i$で置き換えた行列を$A_{ij}$とすると，多重線形性より
    \[\det A=\sum^n_{i=1}a_{ij}\det A_{ij}\]
    である．実は$\det A_{ij}=\Delta_{ij}$である．多重線形性に含意されているし，また系\ref{cor-signature-expression-of-determinant}.1からもわかる．
    従って，積$\Delta(A)A$の$jj$成分は$\sum^n_{i=1}a_{ij}\Delta{ij}=\det A$．

    次に，$j\ne j'\in[n]$について，$\Delta(A)A$の$jj'$成分が$0$であることを示す．
    第$jj'$成分は，$\Delta(A)$の第$j$行と$A$の第$j'$列の積から来ている．
    従って，$A$の第$j$列を第$j'$列で置き換えて得られる行列を$A'$とすると，行列式の交代性より，
    \[\sum^n_{i=1}\Delta_{ij}a_{ji'}=\sum^n_{i=1}\det A_{ij}a_{ij'}=\det A'=0.\]
\end{Proof}

\begin{example}
    自明な例として，二次行列$A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$の逆行列が$A^{-1}=\frac{1}{ad-bc}\begin{pmatrix}d&-b\\-c&a\end{pmatrix}$とわかる．
\end{example}

\begin{corollary}\label{cor-characterization-of-invertibility}
    次の２条件は同値である．
    \begin{enumerate}
        \item $A$は可逆である．
        \item $\det A\ne 0$．
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{description}
        \item[(1)$\Rightarrow$(2)] 系\ref{cor-determinant-of-product-and-transposition}より，$\det AA^{-1}=\det A\det A^{-1}=\det 1=1$．よって，$\det A\ne 0,\det A^{-1}\ne 0$．
        \item[(2)$\Rightarrow$(1)] Cramerの命題\ref{prop-Cramer}より，$A\cdot\frac{1}{\det A}\Delta(A)=\frac{1}{\det A}\Delta(A)\cdot A=1$．スカラーと行列の積は可換であることがうまく使われている．
    \end{description}
\end{Proof}

\subsection{Vandermondeの行列式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    そもそも行列式の研究は行列の研究とは全く独立に行われていた．
    Vandermonde行列式は，判別式(discriminant)（よく$\Delta$で表される）やWronskianやLagrange補間多項式などで現れる．
    特に，異なる点$x_1,\cdots,x_n$での値が指定された時，これらを通る$n-1$次以下の多項式が一意に定まる所以は，Vandermonde行列式が差積で表せ，したがって零でないことによる．
    
    列ベクトルの成分を巡回させて得られる行列は$c$に依ってはで，そのような行列全体は可換な代数をなす（実はconvolution operatorなる作用素の核であり，$C^*$-代数である）．
\end{tcolorbox}

\begin{definition}[Vandermonde determinant]\mbox{}
    \begin{enumerate}
        \item 各行が公比$x_i$の等比数列となる行列$V(x_1,\cdots,x_n):=\begin{pmatrix}1&x_1&x_1^2&\cdots&x_1^{n-1}\\1&x_2&x_2^2&\cdots&x_2^{n-1}\\\vdots&\vdots&\vdots&\ddots&\vdots\\1&x_n&x_n^2&\cdots&x_n^{n-1}\end{pmatrix}$をVandermonde行列という．
        \item この行列式$\Delta(x_1,\cdots,X_n)$を\textbf{Vandermonde行列式}という．
    \end{enumerate}
\end{definition}

\begin{lemma}[difference product and Vandermonde determinant]
    Vandermonde行列式は，各行の公比の差積に等しい．
    $\Delta(x_1,\cdots,x_n)=\prod_{1\le i<j\le n}(x_i-x_j)$．
\end{lemma}
\begin{remarks}[差積について]
    任意の交代多項式は，対称多項式と差積の積として書け，これが交代多項式の特徴付けとなる．
    なお，Vandermonde行列は同伴行列を対角化する際に用いる基底の変換行列でもある
    \ref{remarks-companion-matrix-and-vandermonde-matrix}．
\end{remarks}

\subsection{Toeplitz行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    対角一定行列(diagonal-constant)のことを，ドイツの函数解析学者の名前をとってToeplitz行列ともいう．
\end{tcolorbox}

\begin{definition}[circulant matrix, associated polynomial]\mbox{}
    \begin{enumerate}
        \item 対角一定行列(diagonal-constant)のことを，ドイツの函数解析学者の名前をとってToeplitz行列ともいう．
        \item 各列ベクトルが，一つ前の列ベクトルを巡回置換したものとして得るToeplitz行列を，\textbf{巡回行列}という．ベクトル$c:=(c_0,\cdots,c_{n-1})^T$を用いて，
        \[C=\begin{bmatrix}c_{0}&c_{n-1}&\dots &c_{2}&c_{1}\\c_{1}&c_{0}&c_{n-1}&&c_{2}\\\vdots &c_{1}&c_{0}&\ddots &\vdots \\c_{n-2}&&\ddots &\ddots &c_{n-1}\\c_{n-1}&c_{n-2}&\dots &c_{1}&c_{0}\\\end{bmatrix}\]
        と表せる．
        \item $f(x):=c_0+c_1x+\cdots+c_{n-1}x^{n-1}$を付随行列という．
    \end{enumerate}
\end{definition}

\begin{lemma}
    １の$n$乗根を$\zeta_j:=e^{2\pi ij/n}\;(j=0,\cdots,n-1)$とする．
    \begin{enumerate}
        \item $\det C=\prod_{j=0,\cdots,n-1}(x_1+\zeta_jx_2+\cdots+\zeta_j^{n-1}x_n)$．
        \item 固有ベクトルは$v_j=\frac{1}{\sqrt{n}}(1,\zeta_j,\zeta_j^2,\cdots,\zeta_j^{n-1})^T$で与えられ，正規直交系をなす．
        \item 巡回行列は可換な代数をなす．
        \item $\rank C=n-d\;(d=\deg\gcd(f(x),x^n-1))$．
    \end{enumerate}
\end{lemma}
\begin{remark}
    実は固有ベクトルは離散フーリエ変換行列によって対角化されるため，高速フーリエ変換によって簡単に計算できるという意味でも大事な対称である．
\end{remark}

\subsection{Hankel行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    対角一定行列をToeplitz行列というならば，その反対概念をHankel行列という．
\end{tcolorbox}

\begin{definition}
    逆対角方向について，成分が全て等しくなっている正方行列を\textbf{Hankel行列}という．
\end{definition}

\begin{example}\mbox{}
    \begin{enumerate}
        \item $n$次の\textbf{Hilbert行列}とは，
        \[H=\begin{pmatrix}1&2&\cdots&\frac{1}{n}\\\frac{1}{2}&\frac{1}{3}&\cdots&\frac{1}{n+1}\\\vdots&\vdots&\ddots&\vdots\\\frac{1}{n}&\frac{1}{n+1}&\cdots&\frac{1}{2n-1}\end{pmatrix}\]
        をいう．
        \item その行列式は
        \[\det H=\frac{((n-1)!(n-2)!\cdots 3!2!)^3}{(2n-1)!(2n-2)!\cdots(n+1)!n!}.\]
    \end{enumerate}
\end{example}

\subsection{Wronskian}

\begin{definition}[Hoene-Wronski (1812)]
    区間$I$上の$n-1$階可微分関数
    $f_1,\cdots,f_n\in D^{n-1}(I;\bF)$の定める\textbf{Wronskian}とは，次の$x$-行列$M_n(\bF)[x]$の行列式$W\in \bF[x]$である：
    \[W(f_1,\cdots,f_n)(x):=\det \begin{pmatrix}f_1(x)&f_2(x)&\cdots&f_n(x)\\f'_1(x)&f_2'(x)&\cdots&f'_n(x)\\\vdots&\vdots&\ddots&\vdots\\f_1^{(n-1)}(x)&f_2^{(n-1)}(x)&\cdots&f^{(n-1)}_n(x)\end{pmatrix}\]
\end{definition}
\begin{remarks}
    $f_1,\cdots,f_n$が線型従属ならば，そのWronskianは消えるため，可微分関数の組が区間上で線形独立であることを示すのに使われる．
\end{remarks}

\subsection{Hadamard行列}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    任意の$k\in\N^+$について，$4k$次のHadamard行列が存在する，という予想は未解決である．
\end{tcolorbox}

\begin{definition}
    要素が$\pm1$のいずれかである直交行列
    $A\in\mathrm{O}_n(\Brace{\pm1})$を\textbf{Hadamard行列}という．
    すなわち，$H_nH_n=nI_n$を満たす$H_n\in M_n(\Brace{\pm1})$をいう．
\end{definition}

\begin{proposition}
    Hadamard行列の次数は4の倍数である．
\end{proposition}

\section{固有多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    最小多項式は一般の線型写像に定義されるが，
    固有多項式は，行列式の概念を通じて有限次元線型空間にしか定義されない：
    $\Phi_A:=\det(X-A)\in K[X]$．
    したがってまずこれが行列表示に依らない，線型写像の特徴量であることを見る必要がある．
    しかし固有多項式は初等的で，また安定部分空間上では最小多項式に一致するため，
    十分な代用になる．
\end{tcolorbox}

\subsection{線型写像の固有多項式}

\begin{definition}[characteristic polynomial, trace]
    $A\in M_n(K)$について，monicな多項式$\Phi_A:=\det(X-A)\in K[X]$を$A$の\textbf{固有多項式}という．
\end{definition}

\begin{remark}[固有方程式の最高次係数と定数項としての特徴付け]
    \[ \Phi_A=\det\begin{pmatrix}X-a_{11}&-a_{12}&\cdots&-a_{1n}\\-a_{21}&X-a_{22}&\ddots&\vdots\\\vdots&\ddots&\ddots&-a_{(n-1)n}\\-a_{n1}&\cdots&-a_{n(n-1)}&X-a_{nn}\end{pmatrix} \]
    より，$X^{n-1}$の係数は$-\Tr A$であり，定数項は$(-1)^n\det A$である．
\end{remark}

\begin{example}\mbox{}\label{example-eigenpolynomial}
    \begin{enumerate}
        \item $A=\begin{pmatrix}a&b\\c&d\end{pmatrix}$とすると，注より，$\Phi_A=X^2-(a+d)X+ad-bc$．
        \item $A$が上三角行列ならば，固有多項式は対角成分に関する積$\Phi_A=(X-a_{11})\cdots(X-a_{nn})$．$a_{11},\cdots,a_{nn}$が全て相異なる時，これは最小多項式に一致する．
        \item $A$がJordan行列$J(a,n)$ならば，$\Phi_A=(X-a)^n$である．これも最小多項式でもある．
        \item $A$を$F\in K[X]$の同伴行列とすると，固有多項式は$\Phi_A=F$．これは最小多項式でもある．
    \end{enumerate}
\end{example}

\begin{proposition}[線型写像の特徴量としてのwell-definedness]\label{prop-行列の特徴量は線型写像について定まっている}
    $A,B\in M_n(K)$が共役ならば，$A$と$B$の
    \begin{enumerate}
        \item 行列式
        \item トレース
        \item 固有多項式
    \end{enumerate}
    は等しい．
\end{proposition}
\begin{Proof}
    共役の定義\ref{def-conjugate}より，任意の$P\in\GL_n(K)$を取って考えると良い．
    $X$はスカラー行列より，系\ref{cor-determinant-of-product-and-transposition}から，
    \begin{align*}
        \Phi_{P^{-1}AP}&=\det(X-P^{-1}AP)=\det(P^{-1}(X-A)P)=\det(X-A)=\Phi_A
    \end{align*}
    である．
\end{Proof}

\subsection{固有多項式の遺伝}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    最小多項式よりも強い条件を満たすクラスが固有多項式であるはずが，その違いは最小多項式よりも冪が大きくなり得るのみであり，
    根が固有値であることは変わらない．
    遺伝性についても，最小多項式と同じものが成り立つ．
\end{tcolorbox}

\begin{proposition}[固有値であることの特徴付け]
    $V\in\FVS_K,f\in\End(V)$とする．次の２条件は同値である．
    \begin{enumerate}
        \item $a$は$f$の固有値である．
        \item $\Phi_f(a)=0$．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    定義\ref{def-eigenpolynomial-of-linear-mapping}より，
    2は$\det(f-a)=0$と同値．系\ref{cor-characterization-of-invertibility}より，これは$f-a$が可逆でないことと同値．
    $V$が有限次元であることより，次元定理\ref{cor-thm-of-dimention}から特に$f-a$が単射でないことと同値．
    よって，$V_a=\Ker(f-a)\ne 0$より，$a$は$f$の固有値である．
\end{Proof}

\begin{proposition}[固有多項式の遺伝]\label{prop-eigenpolynomial-as-patching}
    $V\in\FVS_K,f\in\End(V)$とする．
    \begin{enumerate}
        \item $W\subset V$を$f$-安定部分空間とする：$f(W)\subset W$．$f|_W$の固有多項式は$f$の固有多項式を割り切る．
        \item $g\in\End(W)$とする．全射$p:V\to W$が存在して次が可換になるならば，$g$の固有多項式は$f$の固有多項式を割り切る．
        \[\xymatrix{
            V\ar[r]^-p\ar[d]_-f&W\ar[d]^-g\\
            V\ar[r]^-p&W
        }\]
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $B'=(x_1,\cdots,x_m)$を$W$の基底とし，$B=(x_1,\cdots,x_n)$をその$V$の基底への延長とする．この時，$f$の$B$に関する行列表示は\[A=\begin{pmatrix}A_{11}&A_{12}\\0&A_{22}\end{pmatrix}\]と置ける．いま，$f|_W:W\to W$の行列表示が$A_{11}$である．
        これについて，例\ref{example-determinant-of-triangular-matrices}より，
        \[\det(X-f)=\det(X-A)=\det(X-A_{11})\det(X-A_{22})\]
        であるから，$f|_W$の固有多項式$\det(X-A_{11})$はこれを割り切る．
        \item $x_1,\cdots,x_m$を$\Ker p$の基底とし，$B=(x_1,\cdots,x_n)$をその$V$の基底への延長とすると，$B'=(p(x_{m+1}),\cdots,p(x_n))$が$W$の基底になる．
        いま，図式が可換であることより，$p(f(x_i))=g(p(x_i))=g(0)=0\;(1\le i\le m)$であるから，$f(x_i)\;(1\le i\le n)$の基底$x_{m+1},\cdots,x_n$に関する係数は$0$であるから，$f$の基底$B$に関する行列表示は，
        \[A=\begin{pmatrix}A_{11}&A_{12}\\0&A_{22}\end{pmatrix}\]と置ける．
        この時，$g$の$B'$に関する行列表示が$A_{22}$である．なぜならば，$A=(a_{ij})_{1\le i,j\le n}$と置くと，図式が可換であることより，
        \[p(\sum^n_{i=1}a_{ij}x_i)=p(f(x_j))=g(p(x_j))\;\;(m+1\le j\le n)\]
        だから，$f(x_j)$の$B$に関する行列表示の部分行列と，$g(x_j)$の$B'$に関する行列表示が一致する．
        よって，$\det(X-g)=\det(X-A_{22})$は$\det(X-f)=\det(X-A)$を割り切る．
    \end{enumerate}
\end{Proof}

\begin{proposition}
    $A,B\in M_{n}(K)$について，
    \begin{enumerate}
        \item $A$とその半単純部分$S$との固有多項式は一致する．
        \item $AB,BA$の固有多項式は一致する．
        したがって，2つの行列の固有値は重複度も含めて一致する．
    \end{enumerate}
\end{proposition}

\subsection{最小多項式と固有多項式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    非自明な$f$-安定部分空間が存在しないとき(ある$x\in V$が存在して$(f^n(x))_{n\in\N}$が$V$の生成元になるとき)，$f$の固有多項式は最小多項式に一致する．
    存在するとき，張り合わせて全体の固有多項式を得る際に，冪が余分に増えてしまう．
\end{tcolorbox}

\begin{lemma}
    $V\in\FVS_K,f\in\End(V)$とする．
    $V$の$f$-安定部分空間$W$への制限$f|_W$は，最小多項式と固有多項式とが一致する．
\end{lemma}
\begin{Proof}
    $x\in V$に対し，$x$が生成する$f$-安定部分空間を$W_x$とする．
    $V$が有限次元より，制限$f|_{W_x}:W_x\to W_x$には最小多項式が存在し，これを$\varphi_x$とする．
    命題\ref{prop-stable-subspace}より，$W_x$の基底であって，それに関する$f|_{W_x}$の行列表示$A$が$\varphi_x$の同伴行列となるもの，$x,f(x),\cdots,f^{m-1}(x)\in W_x$がある．
    例\ref{example-eigenpolynomial}.4より，$A$の固有方程式も$\varphi_x$である．
\end{Proof}

\begin{theorem}[Cayley-Hamilton]\label{thm-Cayley-Hamilton}
    $V\in\FVS_K,f\in\End(V)$とする．$\Phi\in K[X]$を$f$の固有多項式とし，$\dim V=n$とする．
    \begin{enumerate}
        \item (Cayley-Hamilton) $f$の最小多項式$\varphi$は，固有多項式$\Phi$を割り切る．特に，$\Phi(f)=0$．
        \item $f$の固有多項式$\Phi$は，$\varphi^n$なら割り切る．
    \end{enumerate}
\end{theorem}
\begin{Proof}
        $x_1,\cdots,x_n$を$V$の基底とする．
    \begin{enumerate}
        \item $V=W_{x_1}+\cdots+W_{x_n}$だから，命題\ref{prop-algorithm-for-minimal-polynomials-in-the-terms-of-ideal}より，$f$の最小多項式$\varphi$は$\varphi=\lcm\{\varphi_{x_1},\cdots,\varphi_{x_n}\}$．
        命題\ref{prop-eigenpolynomial-as-patching}.1より，最小公倍式は$\Phi$を割り切る．
        \item $\varphi_{x_1}\cdots\varphi_{x_n}$は$\varphi$を割り切るから，$\Phi$が$\varphi_{x_1}\cdots\varphi_{x_n}$を割り切ることを示す．
        直和$W_{x_1}\oplus\cdots\oplus W_{x_n}$の自己準同型$f|_{W_{x_1}}\oplus\cdots\oplus f|_{W_{x_n}}$の固有多項式は，
        積$\varphi_{x_1}\cdots\varphi_{x_n}$である．
        ここで，全射$W_{x_1}\oplus\cdots\oplus W_{x_n}\to V=W_{x_1}+\cdots+W_{x_n}$に命題\ref{prop-eigenpolynomial-as-patching}.2を適用すれば，$f$の固有多項式$\Phi$は$\varphi_{x_1}\cdots\varphi_{x_n}$を割り切ることがわかる．
    \end{enumerate}
\end{Proof}


\begin{corollary}[最小多項式の代用]
    $V\in\FVS_K,f\in\End(V)$とする．
    \begin{enumerate}
        \item 次の条件は同値である．\begin{enumerate}[(1)]
            \item $f$は三角化可能である．
            \item $f$の固有多項式は一次式の積に分解する．
        \end{enumerate}
        \item $n=\dim V$とする．\begin{enumerate}
            \item $f$は冪零である．
            \item $f$の固有多項式は$X^n$である．
        \end{enumerate}
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item Cayley-Hamiltonの定理\ref{thm-Cayley-Hamilton}より，(2)と最小多項式が一次式の積に分解することは同値である．
        （1より，固有多項式が一次式の積に分解するなら，それを割り切る最小多項式も一次式の積である．2より，最小多項式が一次式の積なら，$\varphi^n$を割り切る固有多項式もそうである）．
        よって，系\ref{cor-triangulability}より従う．
        \item $\exists m\in[n],\;f^m=0$の時，系\ref{cor-Jordan-form-of-nilpotents}より$f$はJordan行列の直和としての行列表示をもち，例\ref{example-eigenpolynomial}のように，
        $\det(f-X)=X^n$である．逆に，$\Phi_f=X^n$である時，Cayley-Hamiltonの定理\ref{thm-Cayley-Hamilton}.1より，$\varphi$はこれを割り切る$X^m\;(m\in[n])$だから，$f$は冪零である．
    \end{enumerate}
\end{Proof}

\subsection{対角化可能性の特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    固有多項式の根の重複度を固有値の重複度といい，これは一般化固有空間の次元を表している．
    一般化固有空間の全てが固有空間に一致するとき，最小多項式は互いに異なる一次式の積となっており，対角化可能になる．
\end{tcolorbox}

\begin{definition}[multiplicity of an eigenvalue of a linear mapping]
    $V\in\FVS_K,f\in\End(V)$とする．$\Phi_f$の根$a$の重複度を，固有値$a$の重複度という．
\end{definition}

\begin{proposition}[一般固有空間の次元は，固有値の重複度に等しい]
    $V\in\FVS_K,f\in\End(V)$とする．$f$の固有値$a\in K$の重複度を$m$とすると，$\dim\widetilde{V}_{a}=m$である．
\end{proposition}
\begin{Proof}
    $d$を$f$の最小多項式$\varphi$の根$a$の重複度とすると，$\varphi=(X-a)^dF$と置ける．$W=\Ker F(f)$と定めると，$V=W\oplus\widetilde{V}_a$である．（$V=\Ker\varphi(f)=\Ker(f-a)^dF(f)$かつ$F(a)\ne 0$なので，補題\ref{lemma-for-triangulization}.2と同じ状況である）．
    $f|_W$の固有多項式を$\Psi$とする．$f|_{\widetilde{V}_a}$の固有多項式は$\dim\widetilde{V}_a=:l$を用いて$(X-a)^l$である（命題\ref{prop-algorithm-for-making-triangular-matrices}）．
    $V=\widetilde{V}_a\oplus W$だから，$\Phi=(X-a)^l\Psi$である．補題\ref{lemma-for-triangulization}より，$(f-a)|_W$は同型だから，$\Psi(a)\ne 0$である．よって，$\Psi$の根$a$の重複度$m$は$l=\dim\widetilde{V}_a$とわかる．
\end{Proof}
\begin{remarks}
    一般化固有空間は$f$-安定であるから，その上で最小多項式と固有多項式とは一致する．
\end{remarks}

\begin{corollary}
    $A\in M_n(K)$の固有多項式$\Phi$の根$a_1,\cdots,a_r\;(r\le n)$の重複度を$m_1,\cdots,m_r$とする．次の2条件は同値：
    \begin{enumerate}
        \item $A$は対角化可能である．
        \item $\forall_{i\in[r]}\;V_{a_i}=\wt{V}_{a_i}$が成り立つ．
        \item $\forall_{i\in[r]}\;\dim V_{a_i}=m_i$が成り立つ．
    \end{enumerate}
\end{corollary}

\section{行列の関数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    最小多項式とは，行列の多項式を考えている．
    これを冪級数にしてみることを考える．適当な基底変換を施すことにより，収束半径の中にあるかどうかは固有値について考えれば良い．
\end{tcolorbox}

\subsection{行列の多項式}

\begin{theorem}[固有多項式]
    $A\in M_n(K)$，固有多項式は$\Phi_A(t)=\prod^n_{i=1}(t-\lambda_i)$とする．
    任意の多項式$f\in K[X]$に対して，$f(A)\in M_n(K)$の固有多項式は$\Phi_{f(A)}(t)=\prod^n_{i=1}(t-f(\lambda_i))$と表せる．
\end{theorem}

\subsection{行列の冪級数の収束}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $x$-行列は$K^{n^2}$-値関数とも見れるが，行列係数多項式と見れるのであった：$M_n(K[x])\simeq M_n(K)[x]$．
    そこで，行列係数の冪級数の収束性を考えれば，ベクトル値関数への示唆にもなるとも考えられる．
    こうして，環$M_n(K)[x]$の考察から，行列値解析関数$K\to M_n(K)$が定義される．
\end{tcolorbox}

\begin{theorem}[行列の冪級数の収束性]
    形式的冪級数を$\sum_{p=0}^\infty a_pX^p$と定め，$X=z\in\C$のときの収束半径を$\rho:=(\limsup\abs{a_p}^{1/n})^{-1}$とする．
    $X\in M_n(\C)$としたとき，この級数は
    \begin{enumerate}
        \item 行列$X$の全ての固有値の絶対値が$\rho$より小さければ収束する．
        \item 行列$X$の固有値の絶対値が1つでも$\rho$を超えれば発散する．
    \end{enumerate}
\end{theorem}

\begin{corollary}
    形式的冪級数$\sum_{p=0}^\infty a_pX^p$について，
    \begin{enumerate}
        \item $X\in M_n(\C)$のとき収束するならば，$X=P^{-1}XP$のときも収束し，和は$P^{-1}\paren{\sum_{p\in\N}a_pX^p}P$に等しい．
        \item $X$の固有値を$\al_1,\cdots,\al_n$とすれば，冪級数$\sum_{p\in\N}a_pX^p$の固有値は$\sum_{p\in\N}a_p\al_i^p\;(i=1,2,\cdots,n)$である．
    \end{enumerate}
\end{corollary}

\subsection{行列の指数関数}

\begin{definition}
    $a_p=1/p!$としたとき，任意の$X\in M_n(\C)$について収束する．
    このとき，次の写像を\textbf{行列の指数関数}という：
    \[\xymatrix@R-2pc{
        \exp:M_n(\C)\ar[r]&\GL_n(\C)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        X\ar@{|->}[r]&\exp X:=\sum_{p\in\N}\frac{1}{p!}X^p
    }\]
    系より，$\exp(P^{-1}XP)=P^{-1}(\exp X)P$であるから，$\exp X$の固有値は$e^{\al_1},\cdots,e^{\al_n}$である．
    よって，$\det(\exp X)=\exp(\Tr X)\ne0$で，必ず正則．
\end{definition}
\begin{remarks}[$t$-行列の指数関数]
    ここで，形式的冪級数$\sum_{p\in\N}\frac{1}{p!}X^p$に$t$-行列$X=tX\in M_n(\C[t])\simeq M_n(\C)[t]$を代入すると，ベクトル値の解析関数$\exp:\C\to\GL_n(\C);t\mapsto\exp tX$を定める．
    微分可能な行列値関数$A(t)$が，ある行列$X\in M_n(\R)$に関して
    \[A'(t)=XA(t),\quad A(0)=E\]
    を満たすならば，連立微分方程式系の解の存在と一意性より，$A(t)=\exp tX$となる．
    こうして，線型連立微分方程式の解は，$\exp tA$の列ベクトルが与える．
\end{remarks}

\begin{proposition}[加法定理]\mbox{}
    \begin{enumerate}
        \item ２つの行列$X,Y$が可換ならば，$\exp(X+Y)=\exp X\cdot\exp Y$．特に，任意の行列$X$について，$\exp(-X)=(\exp X)^{-1}$．
        \item $X$が交代行列ならば，$\exp X$は直交行列である．逆に，任意の$t\in\R$に関して$\exp tX$が直交行列ならば，$X$は交代行列である．
        \item $X$が実対称行列ならば，$\exp X$は正値対称行列である．逆に，任意の$t\in\R$に関して$\exp tX$が実対称行列ならば，$X$は実対称行列である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $\exp t(X+Y),\exp tX,\exp tY$は共に$t$の正則関数であるから，Maclauren展開の係数比較より．
        \item ${}^t\!X=-X$ならば，${}^t\!\exp X=\exp{}^t\!X=e^{-X}=(\exp X)^{-1}$より，$\exp X$は直交行列である．逆に，任意の
        $\exp{}^ttX$が全て直交行列ならば，$(\exp t({}^t\!X))(\exp tX)=E$．両辺の$0$における微分係数を比較すれば，${}^t\!X+X=O$を得る．
    \end{enumerate}
\end{Proof}

\begin{example}[行列式1の直交行列の指数関数としての表示]
    $X=\begin{pmatrix}0&-\al\\\al&0\end{pmatrix}$ならば，$X^2=\begin{pmatrix}-\al^2&0\\0&-\al^2\end{pmatrix}$と続いていくから，$\exp X=\begin{pmatrix}\cos\al&-\sin\al\\\sin\al&\cos\al\end{pmatrix}$となる．
    行列式$1$の任意の直交行列は，ある交代行列$X$によって，$\exp X$と表される．
\end{example}

\subsection{行列の正則関数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\GL_n(\R)$の作用素ノルムはEuclidノルムに一致してしまう．
\end{tcolorbox}

\begin{proposition}[その他の冪級数]\mbox{}
    \begin{enumerate}
        \item $\log(E+X):=\sum_{p=1}^\infty(-1)^{p-1}\frac{1}{p}X^p$は$\Sp(X)\subset\Delta$ならば収束する．
        \item $(E-X)^{-1}=\sum^\infty_{p=0}X^p$は$\Sp(X)\subset\Delta$ならば収束する．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    これにより，解素$R_A:\C\to M_n(\C)$を$(zI-A)^{-1}$として定義出来る．
    ここから，一般の正則関数$f:\C\to\C$に対して，延長$f:M_n(\C)\to M_n(\C)$を
    \[f(A)=\frac{1}{2\pi i}\int_Cf(z)R_A(z)dz=\frac{1}{2\pi i}\int_C\frac{f(z)dz}{zI-A}\]
    で定めることが出来る．
\end{remarks}

\begin{theorem}\mbox{}
    \begin{enumerate}
        \item 零でない連続写像$\rho:\GL_n(\R)\to\R$が群準同型性$\rho(XY)=\rho(X)\rho(Y)$を満たすならば，$\exists_{s\in\R}\;\rho(X)=\abs{\det(X)}^s$または$\rho(X)=\sgn(\det(X))\abs{\det}^s$．
        \item 零でない連続写像$\rho:\GL_n(\C)\to\C$が群準同型性$\rho(XY)=\rho(X)\rho(Y)$を満たすならば，$\exists_{k\in\Z}\;\exists_{s\in\R}\;\rho(X)=e^{ik\arg(\det X)}\abs{\det X}^s$．
    \end{enumerate}
\end{theorem}

\section{定数係数線型常微分方程式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    漸化式を満たす数列と定数係数線型常微分方程式は線型代数的には全く同じ構造を持つ．
\end{tcolorbox}

\begin{notation}[多項式環へと情報を移す]\mbox{}
    \begin{enumerate}
        \item 例\ref{example-space-of-sequences}の数列の空間$\Hom_\R(\N,\R)$と，例\ref{example-difference-operator}の
        その上の自己準同型
        \[\xymatrix@R-2pc{
            D:\Hom_\R(\N,\R)\ar[r]&\Hom_\R(\N,\R)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            a\ar@{|->}[r]&b(n):=a(n+1)
        }\]を考える．
        \item $m+1\ge 1$項間漸化式$a_{n+m}=p_1a_{n+m-1}+\cdots+p_{m-1}a_{n+1}+p_ma_n$
        を満たす数列全体からなる部分空間を$W$と置く：
        \[ W=\{a\in\R^\N\mid\forall n\ge 0,\; a(n+m)=p_1a(n+m-1)+\cdots+p_{m-1}a(n+1)+p_ma(n)\}. \]
        \item 実係数多項式を$P=X^m-(p_1X^{m-1}+\cdots+p_{m-1}X+p_m)\in\R[X]$と置くと，$W=\Ker(P(D))$と表せる．
        \item 例\ref{example-difference-operator}で見た通り，$W$は初期条件を与えることで数列が決まる．つまり，次の同型がある：\[\xymatrix@R-2pc{
            G:W\ar[r]&\R^m\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            a=(a_n)\ar@{|->}[r]&{\begin{pmatrix}a_0\\\vdots\\a_{m-1}\end{pmatrix}}
        }\]
    \end{enumerate}
\end{notation}

\begin{theorem}[定数係数線型常微分方程式の解の存在と一意性]
    $m\in\N,p_1,\cdots,p_m,a_0,\cdots,a_{m-1}\in\R$とする．
    $C^\infty$級関数$f:\R\to\R$であって，微分方程式$f^{(m)}=p_1f^{(m-1)}+\cdots+p_{m-1}f'+p_mf$の解であり，初期条件$f(0)=a_0,f'(0)=a_1,\cdots,f^{(m-1)}(0)=a_{m-1}$を満たすものが，ただ一つ存在する．
\end{theorem}

\section{解素}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=解素は指数関数の$M_n(\C)$値への拡張である]
    $A\in M_n(\C)$の解素$R_A:\C\to M_n(\C)$なる有理型関数を$R_A(z):=(zI-A)^{-1}$と定めると，固有値とは$R_A$の極である．
    $R_A$は整級数展開
    \[R_A(z)=\sum_{m=0}^\infty\frac{A^m}{z^{m+1}}=\frac{I}{z}+\frac{A}{z^2}+\frac{A^2}{z^3}+\cdots.\]
    を持つ．
    極$\al$に属する一般固有空間$\wt{V}_\al$への射影$P_\al\in M_n(\C)$は，$\al$における$R_A(z)$の留数となる．
\end{tcolorbox}

\subsection{解素の表示}

\begin{theorem}[解素の整級数展開]
    $A\in M_n(\C)$の最小多項式を$\varphi(t)=\prod_{i=1}^r(t-\al_i)^{k_i}$とし，幾何的重複度は$m_i$とする．
    \begin{enumerate}
        \item $n-1$次以下の多項式の環$K[X]_n$の元を成分とする$z$行列$C\in M_n(K[X]_n)$で$\C$上で消えないものが存在して，$R=\frac{C}{\varphi}$と表せる．
        \item $R(\infty)=0$を満たすから，結局$\hatC$上で定義されている．開集合$\abs{z}>\sup\abs{\sigma(A)}$上で次の整級数展開を持つ：
        \[R_A(z)=\sum_{m=0}^\infty\frac{A^m}{z^{m+1}}=\frac{I}{z}+\frac{A}{z^2}+\frac{A^2}{z^3}+\cdots.\]
        \item $\al_i$は$R_A$の$k_i$-位の極である．
    \end{enumerate}
\end{theorem}

\subsection{一般固有空間分解}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    解素の極=固有値の周りのLaurent展開係数として，一般化固有空間への射影が得られる．
\end{tcolorbox}

\begin{theorem}
    $A\in M_n(\C)$の最小多項式を$\varphi(t)=\prod_{i=1}^r(t-\al_i)^{k_i}$とし，
    一般化固有空間分解$\C^n=V_{\al_1}\oplus\cdots\oplus V_{\al_r}$の各$V_{\al_i}$への射影を$P_j$とすると，
    \[R_A(z)=\sum_{j=1}^r\paren{\frac{1}{z-\al_j}P_j+\sum_{m=1}^{k_j-1}\frac{1}{(z-\al_j)^{m+1}}M_j^m}\]
    と表せる．ただし，$N_j=(A-\al_j I)P_j$である．
    特に，$P_j=\Res_{z=\al_j}R_A(z),N_j=\Res_{z=\al_j}(z-\al_j)R_A(z)$．
\end{theorem}

\subsection{行列値正則関数}

\begin{theorem}
    $f(z)=\sum_{m=0}^\infty a_mz^m$は正の収束半径$R$を持つとする．
    \begin{enumerate}
        \item $A\in M_n(\C)$が$\sigma(A)\subset\Delta(0,R)$を満たすとき，$f(A)=\sum_{m=0}^\infty a_mA^m$が成り立つ．
        \item $A\setminus\Delta(0,R)\ne\emptyset$ならば，級数$\sum_{m=0}^\infty a_mA^m$は収束しない．
    \end{enumerate}
\end{theorem}

\begin{theorem}[スペクトル写像定理]
    $\sigma(A)$の近傍で正則な関数$f$について，$f(\sigma(A))=\sigma(f(A))$．
\end{theorem}

\chapter{半双線型形式}

\begin{quotation}
    対角化の理論を極めるには直交の概念が必要であり，直交はペアリングが定める関係である．
    なお，双線型形式$(V\otimes V^*)^*$と半双線型形式$(V\otimes V')^*$とは，極めて一般的に見ればテンソル積上の線型形式として，本質的に同じ対象である．
    \begin{enumerate}
        \item $K$の標数が2でない限り，対称な(半)双線型形式と二次形式とは一対一対応する．後者のほうが歴史上先に出現した，直観の効く幾何学的対象である．
        $x$-行列の行列式が不変式である．
        Riemann計量の考え方もここに返ってくる．
        \item 線型空間を結ぶものは半双線型形式であり，「直交」などの幾何学的概念はこの構造に起因する．
    \end{enumerate}
\end{quotation}


\section{双線型形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    双線型形式は線型空間論の最重要概念であり，行列はペアリングを人間の認知に埋め込む．
    \textbf{行列はペアリングの直和である}．
\end{tcolorbox}

\subsection{双線型形式の行列表示}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    双線型形式と半双線型形式のそれぞれに「対称性」が考えられるが，前者は後者の特殊な場合と考えられるため，まとめて自己共役性と言える．
    双線型形式の行列表示は，標準的なペアリング$\brac{-,-}$を通じて，$b_A(-,-)=\brac{-,A-}$で与えられるから，基底変換$x'=xP,y'=yQ$について，$b_A(-,-)=\brac{P-,QA-}=\brac{-,{}^t\!PAQ-}$と変換される．
\end{tcolorbox}

\begin{definition}
    $V,W\in\Vect_K$について，
    \begin{enumerate}
        \item テンソル積上の線型形式$b:V\otimes W\to K$を\textbf{双線型形式}という．
        \item カリー化$r_b:W\to V^*,l_b:V\to W^*$を\textbf{メイト}といい，それぞれの核$\Ker r_b,\Ker l_b$を右・左\textbf{根基}という．
        \item 右・左根基が$0$である，すなわちメイト$r_b,l_b$が単射であるとき，\textbf{非退化}であるという．環上の加群については\textbf{単模}であるという．
        \item メイト$r_b:W\to V^*$が同型を定めるとき，$b$は\textbf{完全なペアリング}であるという．有限次元線型空間の間の評価が定めるペアリングは完全である．
    \end{enumerate}
\end{definition}

\begin{proposition}[非退化であることと完全であることは同値]
    $V,W\in\FVS_K$，$b\in(V\otimes W)^*$．
    \begin{enumerate}
        \item $\rank r_b=\rank l_b$．
        \item $\dim V=\dim W$のとき，次は同値：
        \begin{enumerate}[(a)]
            \item $b$は非退化．
            \item $b$は$W$で非退化．
            \item $V,W$の基底に関する$b$の行列表示が可逆．
            \item $l_b:V\to W^*$は同型．
        \end{enumerate}
    \end{enumerate}
\end{proposition}

\begin{definition}[双線型形式の行列表示]\label{def-matrix-representation-of-bilinear-forms}
    双線型形式$b:V\times W\to K$の，
    基底$x_1,\cdots,x_m\in V$と$y_1,\cdots,y_n\in W$に関する\textbf{行列表示}とは，
        \[(b(x_i,y_j))_{1\le i\le m\\1\le j\le n}=\begin{pmatrix}b(x_1,y_1)&\cdots&b(x_1,y_n)\\\vdots&\ddots&\vdots\\b(x_m,y_1)&\cdots&b(x_m,y_n)\end{pmatrix}\in M_{mn}(K)\]
        を指す．$W$の成分表示$K^n$が右から作用出来るようになっている．
        すなわち，$b_A:=(x,Ay)$について，次の図式が可換になる：
        \[\xymatrix{
            K^n\times K^m\ar[r]^-{b_A}\ar[d]_-{x\times y}&K\ar[d]^-{\id_K}\\
            V\times W\ar[r]_-b&K
        }\]
        すなわち，次が成り立つ：
        \[\forall_{x\in K^n,y\in K^m}\quad b(g(x),g'(y))=b_A(x,y)={}^t\!xAy.\]
\end{definition}
\begin{remarks}
    添字規則は通常の行列$(a_{ij})$と同様．すると第二引数である$W$の成分ベクトルが右から作用するようになる．
\end{remarks}

\begin{proposition}[行列表示との全単射対応]
    $V,W\in\FVS_K$とする．
    次の写像は可逆である：
        \[\xymatrix@R-2pc{
            \{b\in K^{V\times W}\mid b:V\times W\to Kは双線型形式\}\ar[r]&M_{mn}(K)\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            b_A\ar@{|->}[r]&A
        }.\]
    これにより，任意の双線型形式は，標準的内積との類推から$\brac{-,-}:V\times W\to K$を表すことが示唆される．
\end{proposition}



\subsection{双線型形式の変換}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    双線型形式$b:V\times W\to K$について，左右のメイトの行列表示は互いに転置になる．
    これは，$b^*(x,y):=\o{(y,x)}$を「共役」と呼ぶことに対応する．
\end{tcolorbox}

\begin{proposition}[双線型形式の行列表示の特徴付け]\label{prop-characterization-of-matrix-representation-of-bilinar-form}
    $b:V\times W\to K$を双線型形式とする．
    \begin{enumerate}
        \item 写像$r_b(y):V\to K$は線型形式である．
        \item $r_b:W\to V^*$は線型写像である．
        \item $V,W\in\FVS_K$とする．$B=(x_1,\cdots,x_m),B'=(y_1,\cdots,y_n)$をそれぞれ$V,W$の基底とし，$B^*=(f_1,\cdots,f_m)$を双対基底とする．$b$の$B,B'$に関する行列表示は，線型写像$r_b:W\to V^*$の基底$B',B^*$に関する行列表示に等しい．
    \end{enumerate}
\end{proposition}

\begin{proposition}[双線型形式の変換]
    $b:V\times W\to K$を双線型形式とする．
    $V$の基底$B=(x_1,\cdots,x_m)$から$B'=(x_1',\cdots,x_m')$への底の変換行列を$P\in\GL_m(K)$とし，
    $W$の基底$D=(y_1,\cdots,y_n)$から$D'=(y_1',\cdots,y_n')$への底の変換行列を$Q\in\GL_n(K)$とする．
    $B,D$に関する$b$の行列表示を$A$とし，$B',D'$に関する$b$の行列表示を$A'$とすると，$A'={}^t\!PAQ$である．
\end{proposition}
\begin{Proof}
    $B,D$に関する行列表示
    $A:W\to V^*$を用いて，$b=(-,A-)$と表せる．基底変換$y'=yQ,x'=xP$を考えると，
    $B',D'$に関する行列表示は$b=(P-,AQ-)=(-,{}^t\!PAQ-)$．
\end{Proof}

\subsection{随伴と行列の転置}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    ペアリング$b:V\times W\to K$はメイト$r_b:W\to V^*$を通じて，線型写像の空間の間の線型対応$r_b^*:\End(V^*)\to\End(W)$を定める．これを\textbf{(右)随伴}という．
    これは，$b(f(x),y)=b(x,f^*(y))$を意味する．特に$V=W=K^n$のとき，随伴対応${}^t\!:M_n(K)\to M_n(K)$は\textbf{転置}である．
\end{tcolorbox}

\begin{definition}[right adjoint]
    $V,W\in\Vect_K$とし，$b:V\times W\to K$を$W$上で非退化な双線型形式とする．
    このとき，$r_b:W\to V^*$は単射だから，
    $f\in\End_K(V)$に対して唯一の$g\in\End_K(W)$が対応して次の図式を可換にする．
    \[\xymatrix{
            W\ar[r]^-{r_b}\ar[d]_-g&V^*\ar[d]^-{f^*}\\
            W\ar[r]^-{r_b}&V^*
        }\]
    $g$は$f$の\textbf{右随伴写像}という．$g$のことも$f^*$で表す．
\end{definition}
\begin{remark}[記号の混用]
    $f^*$は随伴写像と双対写像で混用されることになるが，厳密に同一視できるのは$\dim V=\dim W$の時，$r_b:W\to V^*$が同型の時に限る．
\end{remark}



\begin{proposition}[随伴写像の行列表示]
    $V,W\in\FVS$，$b:V\times W\to K$を非退化な双線型形式とする．このとき，$\dim V=\dim W$．
    $f:V\to V$を線型写像とし，$f^*:W\to W$をその右随伴写像とする．
    $B,B'$をそれぞれ$V,W$の基底とし，$B,B'$に関する$b$の行列表示を$P\in\GL_n(K)$とする．
    $f$の$B$に関する行列表示が$A\in M_n(K)$ならば，$B'$に関する随伴写像$f^*$の行列表示は，
    $P^{-1}{}^t\!AP\in M_n(K)$
    である．
\end{proposition}
\begin{Proof}
    $b$の行列表示が$P$であるから，標準的なペアリング$(-,-):K^n\times K^n\to K$について，
    \[b(f(-),-)=(A-,P-)=(-,{}^t\!AP-)=(-,P(P^{-1}{}^t\!AP)-)=b(-,f^*(-))\]
    より，$f^*$の行列表示は$P^{-1}{}^t\!AP$．
\end{Proof}

\begin{proposition}[随伴は作用の方向を変えることに相当する]
    双線型形式$b:M_{nm}(K)\times M_{mn}(K)\to K$を$b(A,B)=\Tr AB$で定める．
    \begin{enumerate}
        \item $b$は非退化である，即ち$r_b:M_{mn}(K)\to M_{nm}(K)^*$同型である．
        \item $C\in M_n(K)$について，$C$倍写像$C\times:M_{nm}(K)\to M_{nm}(K)$の右随伴写像は，右から$C$をかける写像$\times C:M_{mn}(K)\to M_{mn}(K)$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $E_{ij}\in M_{mn}(K)$を標準基底とする（$1\le i\le m,1\le j\le n$）．
        \[b(E_{j'i'},E_{ij})=\begin{cases}
            1&(i,j)=(i',j')\\
            0&\mathrm{otherwise}
        \end{cases}\]
        より，$r_b(E_{ij})=b(-,E_{ij})$は$E_{ji}$の双対基底である．基底を基底に写すから，命題\ref{prop-characterization-of-isomorphism}より，$r_b:M_{mn}(K)\to M_{nm}(K)^*$は同型であり，$b$は非退化である．

    \end{enumerate}
\end{Proof}
\begin{remarks}
    一般の$*$-代数について，左作用$M_n(K)\times M_{nm}(K)\to M_{nm}(K)$から右作用$M_{mn}(K)\times M_{n}(K)\to M_{mn}(K)$が定まるが，これは随伴になっている．
    これを駆使すれば，半双線型写像も自然に理解出来る\ref{def-sesquilinear-form}．
\end{remarks}

\section{評価の定めるペアリング}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
    title=]
    特別な双線型形式：
    評価の定めるペアリング$\brac{-,-}:V\times V^*\to K$は必然的に非退化(有限次元のときは完全でもある)で，あらゆる(半)双線型形式の模範となる．
    このペアリングが定める「(右)直交補空間」を\textbf{零化空間}という．
    すると，再双対の手続きと再零化の手続きは一致し，ペアリングの概念が双対性を一般化するものであることが分かる．
\end{tcolorbox}

\subsection{双対空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    一度話は逸れる．
    任意の$V\in\FVS_K$は回帰的である．
\end{tcolorbox}

\begin{definition}[dual module]
    $R$-加群$M$に対して，$M^*:=\Hom_R(M,R)$は再び加群をなし，これを\textbf{双対加群}という．
\end{definition}

\begin{theorem}[双対空間への対応]
    $V\in\FVS_K$の基底を$x_1,\cdots,x_n$とする．任意の$(\al_1,\cdots,\al_n)\in K^n$に対して，唯一の線型形式$y\in V^*$が存在して，$(x_i,y)=\al_i$を満たす．
\end{theorem}
\begin{definition}[dual basis]
    これが定める対応$V\iso V^*$について，$V$の基底と$K^n$の標準基底に対応する基底を\textbf{双対基底}という．
\end{definition}

\begin{proposition}[双対基底の特徴付け]
    $V\in\FVS_K$とする．線型形式$f_1,\cdots,f_n:V\to K$について，次の３条件は同値である．
    \begin{enumerate}
        \item $f_1,\cdots,f_n$は$V^*$の基底である．
        \item 積写像$(f_1,\cdots,f_n):V\to K^n$は線型同型．
        \item $x_1,\cdots,x_n$を$V$の基底とすると，行列$A=(f_i(x_j))\in M_n(K)$は可逆である．
    \end{enumerate}
\end{proposition}

\subsection{零化と被零化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    標準内積$K^n\times K^n\to K$の一般化として，
    $V,V^*$の間には評価による標準的なペアリングが存在する．
    これにより，部分空間の間に対応が見つかり，内積に関する直交空間の一般化になっている．
\end{tcolorbox}

\begin{proposition}[annihilator, annihilated]
    $V$を線型空間，$V^*$をその双対空間とする．
    \begin{enumerate}
        \item $W\subset V$に対して，$W^\bot:=\{f\in V^*\mid f(W)=0\}=\cap_{x\in W}\Ker\ev_x$は$V^*$の部分空間である．これを\textbf{零化空間}という．
        \item $W\subset V^*$に対して，$W^\top:=\{x\in V\mid f\in W\Rightarrow f(x)=0\}=\cap_{f\in W}\Ker f$は$V$の部分空間である．これを\textbf{被零化空間}という．
    \end{enumerate}
\end{proposition}
\begin{remark}
    ペアリング$\brac{-,-}:V\times V^*\to K$を前面に出すと，$\forall_{y\in V^*}\;\brac{-,y}=0$という「右直交補空間」と捉えられる．
    補空間と言っても，空間を$V$と$V^*$に分けて考えて「評価」と捉えている点が肝要である(必ず非退化になる)が，次の命題のように，たしかにある種の「補空間」と捉えられる．
    自己共役な半双線型形式について，左右の直交補空間は一致する．
\end{remark}

\begin{proposition}[FVSでは零化空間は補空間を与える]
    $V\in\FVS_K$，$W\subset V$を部分空間とする．
    \begin{enumerate}
        \item $\dim W^\perp=\dim V-\dim W$．
        \item $\dim W^\top=\dim V-\dim W$．
    \end{enumerate}
\end{proposition}

\begin{corollary}[TVSでは再零化空間は元に戻る]
    $V\in\FVS_K$とする．
    \begin{enumerate}
        \item $\forall_{W\in S(V)}\;W=(W^\perp)^\top$．
        \item $\forall_{W\in S(V^*)}\;W=(W^\top)^\perp$．
    \end{enumerate}
\end{corollary}

\begin{proposition}[双対空間の零化空間への分解]\label{prop-annihilator-space-and-direct-sum}
    $W,W'\subset V\in\Vect$を部分空間とする．
    \begin{enumerate}
        \item $W^\bot\cap W'^\bot=(W+W')^\bot$．
        \item $W^\bot+W'^\bot=(W\cap W')^\bot$．
        \item $V=W\oplus W'$ならば，$V^*=W^\bot\oplus W'^\bot$．
    \end{enumerate}
\end{proposition}

\subsection{再双対空間}

\begin{proposition}[評価写像と再双対]\label{prop-eV-is-monic}
    $V\in\Vect_K$とする．
    \begin{enumerate}
        \item $\ev_x:V^*\to K$は線型写像である．
        \item $e_V:V\to V^{**}$は線型写像である．
        \item $V$の基底$x_1,\cdots,x_n$の双対基底$f_1,\cdots,f_n\in V^*$の双対基底は$e_V(x_1),\cdots,e_V(x_n)\in V^{**}$である．
        \item $e_V:V\to V^{**}$は単射である．$V$が有限次元ならば可逆である．
    \end{enumerate}
\end{proposition}

\begin{corollary}[再双対は再零化空間の例である]\label{cor-biannihilator-subspace}
    $W\subset V\in\Vect$を部分空間とする．
    \begin{enumerate}
        \item $W=e_V^{-1}((W^\bot)^\bot)$，$W=(W^\bot)^\top$．
        \item $V$が有限次元ならば，同型$e_V:V\to V^{**}$は同型$W\to(W^\bot)^\bot$を引き起こす．
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 部分空間$W\subset V$の補空間を$W'$とすると，$V^*=W^\bot\oplus W'^\bot$であり，$V^{**}=(W^\bot)^\bot\oplus(W'^\bot)^\bot$である．この時，$W$上の点$x$の値写像$\ev_x\in e_V(W)$とは，$W$の零化子$f\in W^\bot$を零化する$\ev_x(f)=f(x)=0$から，$e_V(W)\subset(W^\bot)^\bot,e_V(W')\subset (W^\bot)$であるから，標準単射$e_V:V\to V^{**}$は２つの単射$e_V|_{W}:W\to(W^\bot)^\bot,e_V|_{W'}:W'\to(W'^\bot)^\bot$の直和である．
        \[\xymatrix{
            W\ar[d]_-{e_V|_W}&V\ar[l]_-{\pr_1}\ar[r]^-{\pr_2}\ar[d]^-{e_V}&W'\ar[d]^-{e_V|_{W'}}\\
            (W^\bot)^\bot&V^{**}\ar[l]^-{\pr_1}\ar[r]_-{\pr_2}&(W'^\bot)^\bot
        }\]
        $(W^\bot)^\bot$の$e_V$による逆像とは，$e_V|_W$による逆像に等しく，$W$である．

        $(W^\bot)^\top=\{x\in V\mid f\in W^\bot\Rightarrow f(x)=0\}=\{x\in V\mid f\in W^\bot\Rightarrow\ev_x(f)=0\}=\{x\in V\mid \ev_x|_{W^\bot}=0\}=\{x\in V\mid \ev_x\in(W^\bot)^\bot\}$より，$(W^\bot)^\top$も$e_V$による$(W^\bot)^\bot$の逆像である．
        \item $V$が有限次元ならば$e_V$は同型だから，その制限$e_V|_W:W\to e_V(W)=(W^\bot)^\bot$も同型である．
    \end{enumerate}
\end{Proof}

\subsection{双対と零化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    \begin{enumerate}
        \item 部分空間の双対空間は，双対空間の零化空間による商空間と同型である．
        \item 商空間の双対空間は，零化空間と同型である．
    \end{enumerate}
\end{tcolorbox}

\begin{proposition}[零化空間は包含写像の双対の核かつ商写像の双対の像]\label{prop-fundamental-theorem-of-dual-maps}
    $V\in\Vect_K$とし，$W$を部分空間とする．$W$の零化空間$W^\bot$について，次が成り立つ．
    \begin{enumerate}
        \item 包含写像$i:W\to V$の双対写像$i^*:V^*\to W^*$は，同型$V^*/W^\bot\to W^*$を引き起こす．
        \item 標準全射$p:V\to V/W$の双対写像$p^*:(V/W)^*\to V^*$は同型$(V/W)^*\to W^\bot$を定める．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 系\ref{cor-duality-of-dual-map}より$i^*$は全射であり，その核が$W^\bot$であるから，これに準同型定理を適用すれば良い．
        \item 命題\ref{prop-universality-of-quotient-spaces}より，$p^*$の像は$W$を潰す線型形式$f(W)=0$からなる集合$W^\bot$であり，またその対応$p^*$は単射であるから．
    \end{enumerate}
\end{Proof}

\section{双対写像という$*$-作用素}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    零化空間というペアリングの方法で，双対空間の性質を調べた．続いて，双対基底の一般化として射影子を基軸に，より一般の双対を考える．
    射影$p:V\to W$の双対写像$p^*:W^*\to V^*$として双対空間の射影子が得られる．これが定める直和分解が$V^*=W^\bot\oplus W'^\bot$だったのである．
    随伴に対する振る舞いを主に調べ，$B(V)$の中身については次章に回す．
\end{tcolorbox}

\subsection{双対写像}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    反変関手$-^*:=\Hom(-,K)$を$*$-作用素として，$\End(V)\simeq\End(V^*)$は$*$-代数をなす．$M_n(K)$とみると，これは転置作用素である．
\end{tcolorbox}

\begin{proposition}[dual mapping]
    $f:V\to W$を$K$-線型写像とする．
    \begin{enumerate}
        \item $g\in W^*$を線型形式$g\circ f:V\to K$に写す写像$f^*:W^*\to V^*$は線型写像である．これを\textbf{双対写像}という．
        \item この対応$-^*:\Hom(V,W)\to\Hom(W^*,V^*)$は反変Hom関手$-^*=\Hom(-,K)$に他ならない．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    命題\ref{prop-Hom-sets-are-linear-spaces}として一般的に示せる．
\end{Proof}

\begin{proposition}[$\Hom(-,K)$は反変関手である]\mbox{}\label{prop-Hom-K-is-contravariant}
    \begin{enumerate}
        \item $V$を線型空間とすると，$\id^*_V=\id_{V^*}$である．
        \item 線型写像$f,g:V\to W,a\in K$に対し，$(f+g)^*=f^*+g^*$，$(af)^*=af^*$．
        \item 線型写像$f:U\to V,g:V\to W$に対し，$(g\circ f)^*=f^*\circ g^*$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $\id^*_V:V^*\to V^*$は線型形式に$\id_V$を合成する関手で，$\id_{V^*}$に等しい．
        \item[2.] 結局双対写像が線型写像である理由と同じ理由でこの関手性が成り立つ．$h\in W^*$に対して$f+g$を合成させるのと，$f,g$を別々に合成させて話を取るのは等しい．$af$を右から合成するのと，$f$を合成して$a$倍するのとは可換である．
        \item[3.] $h\in W^*$とすると，$h\circ(g\circ f)=(h\circ g)\circ f=(g^*(h))\circ f=f^*(g^*(h))$．
    \end{description}
\end{Proof}

\subsection{双対写像と表現行列の転置}

\begin{proposition}[双対写像の行列表示は転置行列]\label{prop-matrix-representation-of-dual-map}
    $V,W\in\FVS$とし，$B=(x_1,\cdots,x_n),B'=(y_1,\cdots,y_m)$をそれぞれ$V,W$の基底とする．
    $B^*=(f_1,\cdots,f_n),B'^*=(g_1,\cdots,g_m)$をそれぞれ双対基底とする．
    \begin{enumerate}
        \item $n=m$とし，$f:V\to W$を$x_1,\cdots,x_n$と$y_1,\cdots,y_n$とが定める同型とする．この時，双対写像$f^*:W^*\to V^*$は$g_1,\cdots,g_n$を$f_1,\cdots,f_n$に写す同型である．
        \item $f:V\to W$を線型写像とする．$f$の$B,B'$に関する行列表示を$A\in M_{mn}(K)$とする．双対写像$f^*:W^*\to V^*$の双対基底$B'^*,B^*$に関する行列表示は，転置${}^t\!A\in M_{nm}(K)$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $f^*(g_i)=g_i\circ f:V\to K$と言う線型形式についてだが，$g_i\circ f(x_j)=g_i(y_j)=\delta_{ij}$より，$g_i\circ f=f_i$である．
        \item[2.] $h:K^n\to(K^n)^*,h':K^m\to(K^m)^*$を例\ref{eg-induced-morphism}に言うような，$a$を${}^t\!a$倍写像$f_a$に写す線型写像とする．
        \[\xymatrix{
            W^*\ar[rrr]^-{f^*}\ar[dr]^-{g^*_{B'}}&&&V^*\ar[dl]_-{g^*_B}\\
            &(K^m)^n\ar[r]^-{(A\times)^*}&(K^n)^*\\
            K^m\ar[uu]^-{g_{B'^*}}\ar[ur]^-{h'}\ar[rrr]^-{{}^t\!A\times}&&&K^n\ar[uu]_-{g_{B^*}}\ar[ul]^-h
        }\]
        の大外周りが可換であることを示せば良い．上の台形が可換であるのは，行列表示の可換図式$f\circ g_B=g_{B'}\circ(A\times)$を命題\ref{prop-Hom-K-is-contravariant}
        より反変Hom関手$\Hom(-,K)$で写した結果である．左右の三角形が可換なのは，$h,h'$が$K^n$の標準基底$e_1,\cdots,e_n$とその双対基底${}^t\!e_1,\cdots,{}^t\!e_n$とが定める同型だからである．
        実際，$g^*_B(g_{B^*}(e_i))=g^*_B(f_i)=f_i\circ g_B:K^n\to K$は，$f_i\circ g_B(e_j)=f_i(x_j)=\delta_{ij}$より，確かに$e_i$の双対基底である．

        最後に，下の台形が可換であることを示せば良い．
        ここまで論理を簡約したところで，図式追跡をすると，行列積の計算に落ちる．
        $a\in K^m$を任意に取る．これを２通りに図式追跡した結果の$(K^n)^*$上での方程式$(A\times)^*(h'(a))=h({}^t\!A\times(a))$を示せば良い．
        そのために，$x\in K^n$を任意に取れば，体$K$上の方程式に落ち着く．
        左辺は$(A\times)^*(h'(a))=h'(a)\circ(A\times)$だから，この$x$での値は$h'(a)(Ax)={}^taAx\in K$．
        右辺も$h({}^t\!Aa)(x)={}^t\!({}^t\!Aa)x={}^taAx$．
    \end{description}
\end{Proof}

\begin{corollary}
    $V\in\Vect$とし，$B=(x_1,\cdots,x_n),B'=(x'_1,\cdots,x'_n)$を$V$の基底とする．$P\in\GL_n(K)$を$B$から$B'$への底の変換行列とすると，
    双対基底$B^*$から$B'^*$への底の変換行列は${}^tP^{-1}$である．
\end{corollary}
\begin{Proof}
    命題\ref{prop-transformation-matrix}より，（$P$とは基底$B'$を基底$B$で成分表示したものを列ベクトルにもつ行列だから，）$P$とは$1_V$の基底$B,B'$に関する行列表示である．
    命題より，$(1_V)^*=1_{V^*}$の$B^*,B'^*$に関する行列表示は${}^t\!P$である．
    よって，基底$B'^*,B^*$に関する行列表示は${}^t\!P^{-1}$である．
\end{Proof}

\subsection{双対写像と零化空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Hilbでは，$T\in B(H)$について(1)は引き続き成り立つが，(2)は$(\Ker T)^\perp=\oo{\Im T^*}$までしか成り立たない．
    一方でFVSでは双対の言葉によって，単射性・全射性が特徴付けられる．
\end{tcolorbox}

\begin{proposition}[双対写像の核と像]
    $f:V\to W$を線型写像，$f^*:W^*\to V^*$を双対写像とする．
    \begin{enumerate}
        \item $\Ker f^*=(\Im f)^\bot$．
        \item $\Im f^*=(\Ker f)^\bot$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $g\in\Ker f^*=\{g\in W^*\mid g\circ f=0\in V^*\}$であるためには，$g(\Im f)=0$であれば良い．即ち，$g\in(\Im f)^\bot$．
        \item $h\in\Im f^*=\{g\circ f\in V^*\mid g\in W^*\}$を取ると，$\exists g\in W^*,\;h=g\circ f$だから$h(\Ker f)=g\circ f(\Ker f)=g(0)=0$より，$h\in(\Ker f)^\bot$．
        
        問題は逆である．$h\in(\Ker f)^\bot$とする．$V'$を$\Ker f$の補空間（$V=V'\oplus\Ker f$）とすると，$\overline{h}:V'\to K$を$\overline{h}=h|_{V'}$と置けば，$h=\overline{h}\oplus 0$と表せる．
        この直和分解については，$f$も次のように命題\ref{prop-pre-homomorphism-thm}から，標準分解により同型$\overline{f}:V'\to\Im f$を定める．これについて，$f=\overline{f}\oplus 0$と表せる．$\Im f$の補空間を$W'$（$W=\Im f\oplus W'$）とすると，次の図式は可換である．
        \[\xymatrix{
            \Im f\ar[d]_-i&V'\ar[l]_-{\overline{f}}\ar[r]^-{\overline{h}}&h(V)\ar[d]^-i\\
            W&V\ar[l]^-f\ar[r]_-h\ar[u]^-{\pr_1}\ar[d]_-{\pr_2}&K\\
            W'\ar[u]^-j&\Ker f\ar[l]^-0\ar[r]_-0&0\ar[u]_-j
        }\]
        これに対して，この図を可換するように$g:W\to K$を構成すれば，$h=g\circ f$が成り立つ．即ち，$\overline{g}:\Im\to h(V)$を$\overline{g}=\overline{h}\circ\overline{f}^{-1}$とし，$g':W'\to K$を零写像$g'=0$などとし，$g=\overline{g}\oplus g'$とすれば，$g\in W^*$で$h=g\circ f$だから，$h\in\Im f^*$．
    \end{enumerate}
\end{Proof}

\begin{lemma}
    $k$を体とする．$\varphi:V\to W$を$k$-線型空間の間の線型写像とし，$\varphi^*:W^\vee\to V^\vee$をその双対写像とする．
    この時，
    \begin{enumerate}
        \item $\varphi$が単射であることは，$\varphi^*$が全射であることと同値である．
        \item $\varphi$が全射であることは，$\varphi^*$が単射であることと同値である．
    \end{enumerate}
\end{lemma}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $0\to\Ker\varphi\to V\to W\to\Coker\varphi\to 0$は完全列である．
        \item $k$は$k$加群として入射的．即ち，関手$\Hom(-,k)$は完全となる．
        \item $0\to(\Coker\varphi)^\vee\to W^\vee\to V^\vee\to(\Ker\varphi)^\vee\to 0$は完全列である．
    \end{enumerate}
\end{Proof}
\begin{remarks}[欲しかった概念：入射的対象]
    このことが，全単射\[\xymatrix@R-2pc{
        \paren{\F_2^{\oplus S}}^\vee\ar[r]&P(S)\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        g\ar@{|->}[r]&\{s\in S\mid g([s])=1\}
    }\]
    を介して，写像$f:V\to W$に対して逆像写像$f^*$の全射／単射性を示す．
\end{remarks}



\begin{proposition}[直交と双対]\label{cor-duality-of-dual-map}
    $V,W\in\Vect_K$，$f:V\to W$を線型写像とする．
    \begin{enumerate}
        \item $f$が定める全射$p:V\to \Im f$の双対$p^*$は同型$(\Im f)^*\to\Im(f^*)$を定める．
        特に，$f,f^*$の階数は一致する．
        \item $V=W\oplus W'$とし，$p:V\to W,p':V\to W'$を射影とする．この時，$p^*,p'^*$は，同型$W^*\to W'^\bot,W'^*\to W^\bot$を定める．したがって，$p^*\oplus p'^*:W^*\oplus W'^*\iso V^*$．
    \end{enumerate}
\end{proposition}

\subsection{作用素の空間の間の射}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $*$-作用素$\Hom(-,K)$だけでなく，一般のHom作用素$\Hom(-,-)$を考える．
\end{tcolorbox}

\begin{proposition}[Vectは豊穣圏]
    $\Hom_K(V,W)=\{f\in W^V\mid fは線型写像\}$は$K$-線型部分空間である．
\end{proposition}

\begin{proposition}[Hom作用素のwell-definedness]\label{prop-Hom-sets-are-linear-spaces}
    $V,V',W,W'\in\Vect_K$とする．
    \begin{enumerate}
        \item 線型写像$g:W\to W'$が定める共変Hom関手$g_*:\Hom(V,W)\to\Hom(V,W')$は再び線型写像である$g_*\in\Vect_K$．
        \item 線型写像$h:V'\to V$が定める共変Hom関手$h^*:\Hom(V,W)\to\Hom(V',W)$は再び線型写像である$h^*\in\Vect_K$．
    \end{enumerate}
\end{proposition}
\begin{Proof}
    2を示す．$f,g\in\Hom_{\Vect_K}(V,W),a\in K$とする．
    \begin{align*}
        h^*(f+g)&=(f+g)\circ h=f\circ h+g\circ h=h^*(f)+h^*(g)\\
        h^*(af)&=(af)\circ h=a(f\circ h)=a\cdot h^*(f)
    \end{align*}
    が成り立つのは，結局$x\in V'$について，
    \begin{align*}
        (f+g)\circ h(x)&=(f+g)(h(x))=f(h(x))+g(h(x))=(f\circ  h+g\circ h)(x)\\
        (af)\circ h(x)&=(af)(h(x))=a\cdot f(h(x))=a\cdot (f\circ h)(x)
    \end{align*}
    だからである．
\end{Proof}


\begin{proposition}[直和分解が引き起こすHom空間の直交分解]\label{prop-characterization-of-direct-sum}
    $V,W\in\Vect_K$について，
    \begin{enumerate}
        \item $i_1:V_1\to V,i_2:V_2\to V$を包含とする．このとき，$i^*_1\oplus i^*_2:\Hom(V_1\oplus V_2,W)\iso\Hom(V_1,W)\oplus\Hom(V_2,W)$は線型同型．
        \item $p_1:W\to W_1,p_2\to W_2$を$W=W_1\oplus W_2$を定める射影とする．このとき，$p_{1*}\oplus p_{2*}:\Hom(V,W_1\oplus W_2)\iso\Hom(V,W_1)\oplus\Hom(V,W_2)$．
    \end{enumerate}
\end{proposition}

\subsection{完全系列のHom関手による特徴付け}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    完全系列をHom関手の言葉で特徴付けると，
    驚くべきことが証明できる．これが私が求めていたものである．
\end{tcolorbox}

\begin{proposition}[完全系列の普遍性]\label{proposition-universality-of-exact-sequence}
    線型写像の列$V'\xrightarrow{f}V\xrightarrow{g}V''$について，次の４条件は全て同値である．
    \begin{enumerate}
        \item $V'\xrightarrow{f}V\xrightarrow{g}V''$は完全系列である．
        \item 任意の$K$-線型空間$W$に対し，$\Hom(W,V')\xrightarrow{f_*}\Hom(W,V)\xrightarrow{g_*}\Hom(W,V'')$は完全系列である．
        \item 任意の$K$-線型空間$W$に対し，$\Hom(V'',W)\xrightarrow{g^*}\Hom(V,W)\xrightarrow{f^*}\Hom(V',W)$は完全系列である．
        \item $V''^*\xrightarrow{g^*}V^*\xrightarrow{f^*}V'^*$は完全系列である．
    \end{enumerate}
\end{proposition}


\begin{lemma}
    $K$を体とし，$f:V\to W$を$K$-線型空間の間の線型写像とする．このとき，任意の$K$-線型空間$Z$に対して，
    \begin{enumerate}
        \item $f:V\to W$が単射であることは，$f^*:\Hom_K(W,Z)\to\Hom_K(V,Z)$が全射であることと同値である．
        \item $f:V\to W$が全射であることは，$f^*:\Hom_K(W,Z)\to\Hom_K(V,Z)$が単射であることと同値である．
        \item $f:V\to W$が単射であることは，$f_*:\Hom_K(Z,V)\to\Hom_K(Z,W)$が単射であることと同値である．
        \item $f:V\to W$が全射であることは，$f_*:\Hom_K(Z,V)\to\Hom_K(Z,W)$が全射であることと同値である．
    \end{enumerate}
\end{lemma}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.,2.] 線型写像$f:V\to W$について，次の系列
        \begin{equation}
            \xymatrix@1
            {
            0\ar[r]&\Ker f\ar[r]&V\ar[r]^-f&W\ar[r]&\Coker f\ar[r]&0
            }
            \label{eq-1}
        \end{equation}
        が完全であることと，
        \[\xymatrix@1{
            0\ar[r]&\Hom_K(\Coker f,Z)\ar[r]&\Hom_K(W,Z)\ar[r]^-{f^*}&\Hom_K(V,Z)\ar[r]&\Hom_K(\Ker f,Z)\ar[r]&0
        }\]
        が完全であることとは同値であることから従う．
        \item[3.,4.] 系列\ref{eq-1}が完全であることと，
        \[\xymatrix@1{
            0\ar[r]&\Hom_K(Z,\Ker f)\ar[r]&\Hom_K(Z,V)\ar[r]^-{f_*}&\Hom_K(Z,W)\ar[r]&\Hom_K(Z,\Coker f)\ar[r]&0
        }\]
        が完全であることとは同値であることから従う．
    \end{description}
\end{Proof}

\begin{corollary}[同型の普遍性]\label{cor-characterization-of-isomorphism}
    線型写像$f:V\to W$に対し，次の条件は同値．
    \begin{enumerate}
        \item $f$は同型．
        \item 任意の線型空間$W'$に対し，$f^*:\Hom(W,W')\to\Hom(V,W')$は同型．
        \item 任意の線型空間$V'$に対し，$f_*:\Hom(V',V)\to\Hom(V',W)$は同型．
    \end{enumerate}
\end{corollary}

\section{半双線型形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $V$とその共役$V'$上の双線型形式$V\times V'\to\bF$を調べる．
    これはどこか標準的なペアリング$\brac{-,-}:V\times V^*\to\bF$に似ており，その零化空間に対応する概念を\textbf{直交}という．
    一般に双線型形式は二次形式を定めるが，半双線型形式の定める二次形式をノルムという．
\end{tcolorbox}

\subsection{定義と性質}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    Hilbert空間とは，Banach空間であって，ノルムが中線定理を満たすような空間である．

    双線型形式が関数$x^2$であるとしたら，半双線型形式がノルム$\abs{x^2}$を定める．
\end{tcolorbox}

\begin{definition}[sesquilinear form, adjoint form, self-adjoint, positive, semi-inner product, inner product]
    $\bF$-線型空間$X$について，
    \begin{enumerate}
        \item 写像$(-|-):X\times X\to\bF$が\textbf{半双線型形式}であるとは，第一引数について線型で，第二引数について共役線型であることをいう．\footnote{数理物理では逆．}$\bF=\R$のときは双線型性に同値．
        \item 半双線型形式$(-|-)$の\textbf{随伴形式}$(-|-)^*$とは，$(x|y)^*:=\o{(y|x)}$で定まる半双線型形式をいう．
        \item $(-|-)^*=(-|-)$を満たす半双線型形式を\textbf{自己共役}という．$\bF=\R$であるときは対称ともいう．
        \item $\forall_{x\in X}\;(x|x)\ge 0$を満たすとき，$(-|-)$を\textbf{半正定値}という．
        \item 半正定値な自己共役半双線型形式を，$X$上の\textbf{半内積}という．
        \item $(x|x)=0\Rightarrow x=0$を満たす半内積を，$X$上の\textbf{内積}という．
    \end{enumerate}
\end{definition}

\begin{definition}[sesquilinear form]\label{def-sesquilinear-form}
    $A$を$*$-代数，$V$を左$A$-加群とする．
    $\rho_l:A\otimes V\to V$をその演算とすると，自然な共役$\rho_r(v,a):=a^*v$によって右加群とも見れる．
    この見方の下では，半双線型形式も，$(V\otimes_AV)^*=V^*\otimes_AV^*$の元に他ならない．
\end{definition}
\begin{remarks}[正定値ならば非退化]
    自己共役な双線型・半双線型形式$(-|-)$について，正定値ならば非退化である．そこで，非退化な対称双線型形式を内積と定義する流儀もある．
\end{remarks}
\begin{example}[ヘッシアン]
    Hessianは接空間上に対称双線型形式を定め，関数の二次の情報を包含する(関数の微分$df$とは切空間上の線型形式である)．
    Hessianが正定値ならば極小になる．この意味ではたしかに数の一般化であるが，これを観るためには固有値の理論が必要である．
\end{example}

\subsection{自己共役形式に関する直交}

\begin{definition}[orthogonal]
    $b:=(-|-):X\times X\to\bF$を半双線型形式とする．
    \begin{enumerate}
        \item ベクトル$x,y$が直交する$x\perp y$とは，$(x|y)=0$を満たすことをいう．
        \item $X$の基底$x_1,\cdots,x_n$に関する$b$の行列表示が対角になるとき，\textbf{$b$-直交基底}，特に単位行列になるとき\textbf{$b$-正規直交基底}という．
        \item 部分集合$Y,Z\subset X$が直交する$Y\perp Z$とは，$\forall_{y\in Y,z\in Z}\;y\perp z$を満たすことをいう．
        \item 部分集合$Y\subset X$について，$Y^\perp:=\Brace{x^\perp\in X\mid x^\perp\perp Y}$を\textbf{直交}という．$Y^\perp$は閉部分空間である．
        \item 全空間の直交$X^\perp$を$(-|-)$の\textbf{根基}または\textbf{核}といい，任意の直交の部分空間である．
    \end{enumerate}
\end{definition}

\begin{remark}[直交と零化空間，直交の核としての表示]\label{remark-orthogonal-as-kernel}\mbox{}
    \begin{enumerate}
        \item $W\subset V$の$b:V\times V\to K$に関する直交$W^\perp$は，$b$のcurrying $r_b:V\to V^*$
        による零化空間$W^\bot\subset V^*$の逆像$W^\perp=r_b^{-1}(W^\bot)$である．
        $b$が$V$上で定まっているとき$r_b:V\to V^*$は同型になっているから，これは綺麗な同一視である．
        \item 零化空間は包含写像$i:W\to V$の双対$i^*:V^*\to W^*$を用いて$W^\bot=\Ker i^*$と表せたから（注\ref{remark-annihilator-as-kernel}），直交$W^\perp$は合成写像
        \[V\xrightarrow{r_b}V^*\xrightarrow{i^*}W^*\]
        の核である．こっちの方がわかりやすい，直交とは零化空間の「$r_b$による引き戻し」である．
    \end{enumerate}
\end{remark}

\begin{proposition}[直交が補空間を与えることは非退化であることに同値]\label{prop-decomposition-along-orthogonal-space}
    $V\in\FVS$とし，$b$をその上の対称形式とする．$W\subset V$を部分空間とし，$b_W:W\times W\to K$をそこへの制限とする．
    \begin{enumerate}
        \item 次の３条件は同値．
        \begin{enumerate}[(1)]
            \item $b_W$は非退化である．
            \item $V=W\oplus W^\perp$．
            \item $W\cap W^\perp=0$．
        \end{enumerate}
        特に，$b$が非退化であることは，$V^\perp=0$によって特徴付けられる．
        \item $b$が非退化ならば，$\dim V=\dim W+\dim W^\perp$．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{description}
        \item[1.] $i:W\to V$を包含写像とする．
        \item[(1)$\Rightarrow$(2)]
        直交$W^\perp$は，注\ref{remark-orthogonal-as-kernel}の通り，$i^*\circ r_b:V\to V^*\to W^*$の核である．
        $b_W$が非退化とは，$r_{b_W}:W\to\Hom_K(W,K)$が単射であるから，合成$V\xrightarrow{r_b}V^*\xrightarrow{i^*}W^*$の$W$への制限が同型であるということである．
        標準分解が次の通りだからである：
        \[\xymatrix{
            W\ar[r]^-{r_b}\ar[dr]_-{\overline{r_b}}&V^*\ar[r]^-{i^*}&W^*\\
            &r_b(W)\ar@{.>}[u]_-j\ar[ur]_-{\overline{i^*}}
        }\]
        従って命題\ref{prop-pre-homomorphism-thm}より，$V=W\oplus\Ker (i^*\circ r_b)=W\oplus W^\perp$．
        \item[(2)$\Rightarrow$(3)] は明らか．今回$W,W^\perp\subset V$であるから，$V=W\oplus W^\perp$であって， $V\simeq W\oplus W^\perp$ではない，ということだろうか．内部直和？
        \item[(3)$\Rightarrow$(1)] $W\cap W^\perp$とは，合成$W\xrightarrow{i} V\xrightarrow{r_b}V^*\xrightarrow{i^*}W^*$の核が$0$（単射）ということと同値．
        また$\dim W=\dim W^*$（命題\ref{prop-dimention-of-dual-space}）より，これは次元定理\ref{cor-thm-of-dimention}より，全射でもあるから，従って$r_{b_W}$は可逆である（系\ref{cor-invertible-if-全単射}）．よって，$b_W$は非退化である．
        \item[2.]
        1.より．\footnote{\cite{斎藤毅-線型代数}は(1)$\Rightarrow$(2)の議論を部分的に再現している．何故だろうか．内部直和からすぐに$\dim V=\dim W+\dim W^\perp$を結論づけてはいけない理由があるのだろうか．}
    \end{description}
\end{Proof}
\begin{remarks}
    思った以上に主張が強い．対象線型形式を備えた空間$(V,b)$は，任意のその上では$b_W$が非退化な部分空間$W$について，それとそれに直交する部分とに分解できる．
\end{remarks}

\begin{corollary}\label{cor-existence-of-orthogonal-basis}
    $V\in\FVS$とし，$b$をその上の対称形式とする．
    \begin{enumerate}
        \item $W$を$V$の部分空間とし，$W^\perp$をその直交とする．$b,b_W$がいずれも非退化ならば，$b_{W^\perp}$も非退化である．
        \item $K$の標数が$2$でなければ，$b$の直交基底が存在する．
        \item $V=W\oplus W'$かつ$W'\subset V^\perp$とすると，次の２条件は同値である．
        \begin{enumerate}[(1)]
            \item $b_W$が非退化．
            \item $W'=V^\perp$．
        \end{enumerate}
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $b_W$が非退化だから，$V=W\oplus W^\perp$となる．すると，直和の普遍性より，（あるいは単に合成$j^*\circ r_b\circ j$と考えることより）$r_b|_{W^\perp}=j^*\circ r_b\circ j:W^\perp\to W^{\perp*}$も同型である．
        \[\xymatrix{
            W\ar[d]_-i\ar[r]^-{r_b|_W}_-{\sim}&W^*\\
            V=W\oplus W^\perp\ar[r]^-{r_b}_-{\sim}&V^*\ar[u]_-{i^*}\ar[d]^-{j^*}\\
            W^\perp\ar[u]^-j\ar[r]^-{r_b|_{W^\perp}}&W^{\perp*}
        }\]
        \item $\dim V$に関する帰納法で示す．$b=0$ならば任意の基底は直交基底であるから，$b\ne 0$とする．すると，$K$の標数が$2$でないならば，$b(x,x)\ne 0$を満たす$x\in V$が存在する．
        すると，$b|_{Kx}$は非退化だから，命題より$V=Kx\oplus(Kx)^\perp$である．帰納法の仮定より，$(Kx)^\perp$には直交基底がある．これに$x$を加えて延長することで$V$の直交基底を得る．\footnote{対角行列になることを言っていない気がする}
        \item $r_b=r_{b_W}\oplus 0$だから，$\Ker r_b=\Ker r_{b_W}\oplus W'$である．よって，$W'=V\perp$と$r_{b_W}$が非退化であることが同値．
        \[\xymatrix{
            W\ar[r]^-{r_{b_W}}\ar[d]_-i&W^*\\
            V\ar[r]^-{r_b}&V^*\ar[u]_-{i^*}\ar[d]^-{j^*}\\
            W'\ar[u]^-{j}\ar[r]^-0&W'^*
        }\]
    \end{enumerate}
\end{Proof}

\begin{lemma}
    $K$の標数が$2$でないとする．
    $b\ne 0$ならば，$\exists x\in V,\;b(x,x)\ne 0$．
\end{lemma}
\begin{Proof}
    $b(x,y)=\frac{1}{2}(b(x+y,x+y)-b(x,x)-b(y,y))$だから，とだけ書いてある．
\end{Proof}

\subsection{随伴と直交変換}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    対称変換は直交の概念と（基底の中でも）正規直交基底の概念とを定めた．
    引き続いて，随伴写像を介することによって，対称変換と直交変換なる概念が定まる．
\end{tcolorbox}

\begin{definition}[adjoint mapping]
    $V\in\Vect$とし，$b$をその上の非退化対象形式とする．$f\in\End(V)$に対して，
    $r_b=l_b$であるから，右随伴写像$f^*_r$と左随伴写像$f^*_l$が一致する．これを\textbf{随伴写像}という．
    \[\xymatrix{
        V\ar[r]^-{r_b}\ar[d]_-{f_r^*}&V^*\ar[d]^-{f^*}&V\ar[l]_-{l_b}\ar[d]^-{f^*_l}\\
        V\ar[r]^-{r_b}&V^*&V\ar[l]_-{l_b}
    }\]
\end{definition}

\begin{definition}[symmetric transformation, orthogonal transformation]
    $V\in\Vect$とし，$b$をその上の非退化対称形式とする．
    \begin{enumerate}
        \item $f\in\End(V)$が随伴写像$f^*$と等しい時，$f$は$b$に関して\textbf{対称変換}であるという：$\forall_{x,y\in V}\;b(f(x),y)=b(x,f(y))$．
        \item $f\in\End(V)$が随伴写像$f^*$の逆写像である時，$f$は$b$に関して\textbf{直交変換}であるという：$\forall_{x,y\in V}\;b(f(x),f(y))=b(x,y)$．ただしこの特徴付けは，対称変換の場合と違って有限次元の場合に限る．
    \end{enumerate}
\end{definition}
\begin{remark}[随伴と双対]
    これが対称行列と直交行列を生み出す理論か！
    随伴写像と双対写像の同一視がなされたら転置の理論も合流して，
    なんと綺麗な模様か．
    $f$に対して，双対写像$f^*:V^*\to V^*$の双対基底に関する行列表示は転置になる．
    随伴写像$f^*:V\to V$の行列表示はさらにその転置と，共軛になる．
    従って確かに対合的に戻ってきていて，$f=f^*$や$f^{*-1}$となる可能性がある．
    しかし，直接図式を可換にする関係があるのは随伴と双対で，随伴と元の$f$とでは使い方の向きが違うと思われる．
\end{remark}
\begin{remarks}[固有ベクトルの存在の幾何学的な理解]
    半双線型形式は内積の一般化で，特に（正規化すれば）「類似度」を測っているともみれる．
    対称の場合はさらに踏み込んで（正規化すれば）「向き」のようなものを測っているとみれる．
    それが対称であるとは，任意のベクトルの組$(x,y)$に対して，引かれあうなら引かれ合う，離れあうなら離れあうと，対称な変換を施すことになる．
    したがって固有ベクトルの存在はある種の不動点定理の帰結のように理解できる．

    実固有ベクトルの存在を示したい．$\partial B$上の点に注目すれば，有限次元のときこれはコンパクトだから，
    どこかで最大値$\norm{A}=:\al\in\R_+$を取る．
    この点$x\in\partial B$について，$\al^2=(Ax|Ax)=(x|AAx)$となるから，$\al\in\R_+$が固有値であるか，$A$が向きに関して対合であるだけで
    真の固有ベクトルは$\al x+Ax$であるかである：$\al Ax+AAx=\al(Ax+\al x)$．

    また，対称形式は直交性を保存するので，固有ベクトルの中から直交基底を選び出せる．
    $x\in\partial B$を固有ベクトルとすると，その直交補空間の元$u\in (\R x)^\top$について$(Ax|u)=(x|Au)$より，$(\R x)^\top$は$A$-不変部分空間である．
    よって対称形式$b$は$(\R x)^\top$に制限できて，再びここには固有ベクトルが存在する．
\end{remarks}

\begin{example}[標準内積に関する随伴は転置]
    $V=K^n$とし，$b:K^n\times K^n\to K$を，単位行列が定める非退化対称形式$b(x,y)={}^t\!xy$とする．
    双対基底が定める同型を$\varphi:V\to V^*$とすると，双対空間の間の$A$倍写像$\times A:V^*\to V^*$の随伴写像は${}^t\!A$倍写像となる．
    \[\xymatrix{
        V\ar[r]^-{r_b=\varphi}\ar@{.>}[d]&V^*\ar[d]^-{A\times}\\
        V\ar[r]_-{r_b=\varphi}&V^*
    }\]
    これは${}^t\!(Ax)y={}^t\!x({}^t\!Ay)$ということである．
    従って，$A$倍写像が対称変換であるための条件は，$A$が対称行列であることと同値である．
    直交変換であるための条件は${}^t\!AA=1$である．これは，$A$の列ベクトル$Ae_1,\cdots,Ae_n$が$K^n$の正規直交基底であることに同値である．\footnote{$b$の表現行列が$1$になることと結びつかない}
\end{example}

\subsection{実数上の対称形式と符号数}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    対称行列は対角化可能で，固有値が$n$個定まる．
    この符号の組は不変である．言い換えれば，
    $\FVS_\R$上の対称形式＝$\R$の二次形式には，
    符号数が定まる．
\end{tcolorbox}

\begin{proposition}[直交基底とlaw of inertia]
    $V\in\FVS_\R$とし，$b$をその上の対称形式とする．
    \begin{enumerate}
        \item $b$に関する直交基底$x_1,\cdots,x_n$であって，$b(x_i,x_i)\in\{0,\pm 1\}\;(i\in[n])$を満たすものが存在する．
        \item (慣性律) $x_1,\cdots,x_n$と$y_1,\cdots,y_n$を$b$に関する直交基底であって，
        \begin{align*}
            b(x_i,x_i)&=\begin{cases}
                1&1\le i\le rのとき,\\
                -1&r<i\le r+sのとき,\\
                0&r+s<i\le nのとき,
            \end{cases}\\
            b(y_i,y_i)&=\begin{cases}
                1&1\le i\le r'のとき,\\
                -1&r'<i\le r'+s'のとき,\\
                0&r'+s'<i\le nのとき,
            \end{cases}
        \end{align*}
        を満たすものとする．このとき，$r=r',s=s'$である．
    \end{enumerate}
\end{proposition}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item 系\ref{cor-existence-of-orthogonal-basis}.2より，直交基底$x_1,\cdots,x_n\in V$が存在する．$b(x_i,x_i)\ne 0$なる$i\in[n]$に対して，$x_i$を$\frac{x_i}{\sqrt{|b(x_i,x_i)|}}$で置き換えれば良い．
        \item $V$の部分空間を次のように定める．\begin{align*}
            V_+&=\langle x_1,\cdots,x_n\rangle,&V_-&=\langle x_{r+1},\cdots,x_{r+s}\rangle,&V_0&=\langle x_{r+s+1},\cdots,x_n\rangle\\
            V'_+&=\langle y_1,\cdots,y_n\rangle,&V'_-&=\langle y_{r+1},\cdots,y_{r+s}\rangle,&V'_0&=\langle y_{r+s+1},\cdots,y_n\rangle
        \end{align*}
        系\ref{cor-existence-of-orthogonal-basis}.3より，$V_+\oplus V_-$と$V'_+,V'_-$上で$b$は非退化だから，
        $V_0=V'_0=V^\perp$．従って，$\dim V_++\dim V_-=\dim V'_++\dim V'_-=\dim V-\dim V^\perp$．
        
        今，$V_+\supset V_+\cap(V'_-\oplus V^\perp)=0$である．何故なら，この元$x\in V_+\cap(V'_-\oplus V^\perp)$は$x\in V_+$より$b(x,x)\ge 0$で，$x\in V'_-\oplus V^\perp$より$b(x,x)\le 0$なので，$b(x,x)=0$よって$x\in\Ker b=0$である．
        同様に$V_-\supset V_-\cap(V'_+\oplus V^\perp)=0$であるから，
        \begin{align*}
            \dim V_++\dim V'_-&\le\dim V-\dim V^\perp,&\dim V'_++\dim V_-&\le\dim V-\dim V^\perp
        \end{align*}
        ２式の左辺の和は$2(\dim V-\dim V^\perp)$であるから，これは等号が成り立つ．以上より，$\dim V_+=\dim V'_+,\dim V_-=\dim V'_-$
    \end{enumerate}
\end{Proof}

\begin{definition}[positive definite, negative definite, signature]
    $V\in\Vect_\R$とし，$b$をその上の対称形式とする．
    \begin{enumerate}
        \item 次が成り立つとき，$b$を\textbf{正定値}という：$\forall x\in V\setminus\{0\},\;b(x,x)>0$．$-b$が正定値であることを，\textbf{負定値}であるという．
        \item 命題の条件を満たす$b$に関する直交基底$B=(x_1,\cdots,x_n)$について，自然数の対$(r,s)\in\N^2$のことを，$b$の\textbf{符号数}という．
        \item $b$の符号数が$(r,s)$であるとは，$b$を次のように表現する$V$の基底が存在するということである：\[\begin{pmatrix}1_r&0&0\\0&-1_s&0\\0&0&0\end{pmatrix}.\]
        \item 従って，$b$が正定値とは，符号数が$(\dim V,0)$であり，$b$を単位行列に表現する$V$の基底が存在するような非退化対称形式をいう．
    \end{enumerate}
\end{definition}
\begin{remarks}
    $(n,0)$の場合はEuclid空間，$(n-1,1)$の場合をLaurentz空間という．
\end{remarks}

\begin{proposition}[内積空間には正規直交基底が存在する]
    $V\in\FVS_\R$について，
    \begin{enumerate}
        \item $V$上の正定値対称双線型形式は非退化である．これを\textbf{内積}という．
        \item $b$が正定値ならば，$V$には正規直交基底が存在する．
    \end{enumerate}
\end{proposition}


\subsection{二次形式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    内積をノルムで表した式を極化不等式と呼んだが，これには双線型形式と二次形式との間の一般論がある．
    これが，２という数字が重要たる所以であろうか？
\end{tcolorbox}

\begin{definition}[quadratic form, quadratic refinement]\mbox{}
    \begin{enumerate}
        \item $V\in\Vect_K$上の\textbf{二次形式}とは，関数$q:V\to K$であって，２次の斉次性をもち，さらにその極化$(v,w)\mapsto q(v+w)-q(v)-q(w)$が双線型形式を定めることをいう．
        \item 双線型形式$\brac{-,-}:V\otimes V\to k$が\textbf{定める二次形式}とは，$\forall_{v,w\in V}\;\brac{v,w}=q(v,w)-q(v)-q(w)+q(0)$を満たすものをいう．\footnote{$2\in k$が可逆ならば常に存在する．}
    \end{enumerate}
\end{definition}
\begin{remark}[二次形式と双線型形式の一対一対応]\mbox{}
    \begin{enumerate}
        \item $b(x,x)=4q(x)-q(x)-q(x)=2q(x)$より，$K$の標数が２でなければ$V$の二次形式と$V$の対称形式とは一対一に対応する．
        \item 対称形式については，第一成分と第二成分で非退化になる条件が同値になるから，「非退化」の概念は退化して１つになる．
    \end{enumerate}
\end{remark}


\begin{theorem}[対称行列の対角化の二次形式の言葉による消息]
    ２次形式$F(x)=A[x]$に対し，ある直交行列$P$が存在して，$x=Py$と$A$の固有値$a_1,\cdots,a_n$に対して
    \[
        F(x)=G(y)=a_1y_1^2+a_2y_2^2+\cdots+a_ny_n^2
    \]
    が成り立つ．
\end{theorem}

\begin{definition}
    ２次形式$F(x)$の\textbf{標準形}を，$F(x)=H(z)=z_1^2+\cdots+z_p^2-z^2_{p+1}-\cdots-z^2_{p+q}$とする．ただし，$p+q$は$A$の階数である．
\end{definition}

\begin{theorem}[Sylvester's law of inertia (1852)]
    ２次形式の標準形は一意的である．
    すなわち，任意の正則な線型変換について，$p,q$は一定である．
\end{theorem}

\begin{definition}
    実対称行列，等価だが二次形式について，
    \begin{enumerate}
        \item $+1$の数$p$を\textbf{正の慣性指数}といい，$-1$の数$q$を負の慣性指数という．
        \item 組$(p,q)$を二次形式$F(x)=A[x]$の\textbf{符号}という．
        \item 差$\sgn(A):=q-p$を\textbf{符号数}という．
    \end{enumerate}
\end{definition}

\subsection{極化恒等式}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    一般に（共役）対称形式は二次形式を定めるが，二次形式から対称性を復元する際に必要な条件を極化恒等式という．
    なお，特に半双線型形式の場合，付随する二次形式とはノルムである．
\end{tcolorbox}

\begin{notation}
    $R$を可換環とし，$V,W$を$R$上の加群とする．
    $m:V\times V\to W$を双線型写像とし，$Q(x):=m(x,x)$をこれが定める二次形式とする．
    $m:V\otimes V\to W$は$R$-加群の準同型であるが，$Q:V\to W$はそうではない．
    
    この設定の下で，次が成り立つ．
\end{notation}

\begin{proposition}\mbox{}
    \begin{enumerate}
        \item 中線定理：$2Q(x)+2Q(y)=Q(x+y)+Q(x-y)$．
        \item 極化恒等式：$2m(x,y)+2m(y,x)=Q(x+y)-Q(x-y)$．
    \end{enumerate}
    中線定理と和差を取ったり，$W$上で２が可逆であるかによって，極化不等式は他の表現も持つ．
\end{proposition}

\begin{proposition}[極化不等式の一般形]
    $\sum_{i\in I}a_i^2c_i=\sum_{i\in I}b_i^2c_i=0$を満たす$R^3$の有限列$(a_i,b_i,c_i)$について，$k:=\sum_{i\in I}a_ib_ic_i$とおいたとき，
    \[kxy+kyx=\sum_{i\in I}c_i(a_ix+b_iy)^2.\]
\end{proposition}

$m$が対称であるとき，極化不等式を通じて，$Q(x)=x^2$から，$m(x,y)=xy$の値を復元できる．

\begin{proposition}[polarization identity, parallellogram law]\label{prop-polarization-identity}
    半内積$(-|-):X\times X\to\bF$について，
    \begin{enumerate}
        \item 関数$\norm{-}:X\to\R_+$を$\norm{x}:=(x|x)^{1/2}$で定めると，これは斉次関数である．
        \item 次の\textbf{極化恒等式}が成り立つ：
        \begin{enumerate}[(a)]
            \item $\bF=\C$のとき，$4(x|y)=\sum^3_{k=0}i^k\norm{x+i^ky}^2$．
            \item $\bF=\R$のとき，$4(x|y)=\norm{x+y}^2-\norm{x-y}^2$．
            \item $\bF=\C$のとき，実部と虚部に分けて$\norm{x+y}^2=\norm{x}^2+2\Re\brac{x,y}+\norm{y}^2$も極化恒等式と呼ぶ．
        \end{enumerate}
        \item (Cauchy-Bunyakowsky-Schwarz) $\abs{(x|y)}\le\norm{x}\norm{y}$．
        特に，$\norm{-}:X\to\R_+$は劣加法的であり，$X$上のセミノルムを定める．
        $(-|-)$が内積であるとき，$\norm{-}$はノルムを定める．
        \item セミノルム$\norm{-}$について中線定理が成り立つ：$\norm{x+y}^2+\norm{x-y}^2=2(\norm{x}^2+\norm{y}^2)$．
        \item (Frechet-von Neumann-Jordan) ノルム$\norm{-}$が中線定理を満たすとき，(2)の極化恒等式によって定まる半双線型形式は内積を定める．
    \end{enumerate}
\end{proposition}
\begin{remarks}
    本質的には次の4式のみである：
    \begin{align*}
        (x+y|x+y)&=(x|x)+(y|y)+2\Re(x|y),&(x-y|x-y)&=(x|x)+(y|y)-2\Re(x|y),\\
        (x-y|x+y)&=(x|x)-(y|y)+2\Im(x|y)i,&(x+y|x-y)&=(x|x)-(y|y)-2\Im(x|y)i,\\
        (x+iy|x+iy)&=(x|x)+(y|y)+2\Im(x|y),&(x-iy|x-iy)&=(x|x)+(y|y)-2\Im(x|y).
    \end{align*}
    第2行も同じくらい示唆的ではあるが，ノルムは作り出せないのであろう．
\end{remarks}


\section{Hermite形式と複素内積空間}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    対称形式を複素化する．
    自己共役な半双線型形式をエルミート形式という．
    さらに正定値であるとき，内積という．
    %$\C$の内積を考える．すると，「対称」の語が「エルミート」となり，「直交」の語が「ユニタリー」となる．
    %自然を説明する力が増すのと同時に，用語にも神秘性が帯びる．
    %これは，$V$の共軛を考えることで双線型形式に帰着される，
    %双線型性を複素共役によって崩した概念である．
    %でも何故か対称行列の方がHermite共軛の退化した概念だと思えるのが複素数の不思議なところである．
    %対角化の理論はエルミート形式において決着する．
    %右側が崩れていることがHom関手の流儀と異なる点が気になる．
\end{tcolorbox}

\subsection{エルミート形式の行列表示}

\begin{example}[対称形式の複素化]
    $V\in\Vect_\R$とし，$b$をその上の対称形式とする．複素化$V_\C$上の写像$h$を
    \[\xymatrix@R-2pc{
        h:V_\C\times V_\C\ar[r]&\C\\
        \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
        (x+iy,x'+iy')\ar@{|->}[r]&b(x,x')+b(y,y')+i(b(y,x')-b(x,y'))
    }\]
    で定めると，$h$はHermite形式である．このHermite形式$h$を対称行列$b$の\textbf{複素化}と呼ぶ．
    $b$が正定値なら，$h$も正定値になる．
\end{example}

\begin{definition}[Hermite形式とHermite行列]\mbox{}\label{def-matrix-representation-of-Hermitian-forms}
    \begin{enumerate}
        \item $h:V\times V\to\C$を$\C$-線型空間$V$上のHermite形式とする．$V$の基底$B=(x_1,\cdots,x_n)$に対し，Hermite行列
        \[A=\begin{pmatrix}h(x_1,x_1)&\cdots&h(x_1,x_n)\\\vdots&\ddots&\vdots\\h(x_n,x_1)&\cdots&h(x_x,y_n)\end{pmatrix}\in M_{n}(\C)\]
        を，$h$の基底$B$に関する行列表示という．
        \item $g:\C^n\to V$を基底$B$が定める同型として，$x,y\in\C,\;h(g(x),g(y))={}^t\!xA\overline{y}$となる．
        \item $P\in\GL_n(\C)$を$B$から$B'$への底の変換行列とする．基底$B'$に関する$h$の行列表示は${}^t\!PA\overline{P}$である．
        \item $A$が単位行列であると聞い，$x_1,\cdots,x_n$を正規直交基底という．
        \item 次の写像は可逆である：\[\xymatrix@R-2pc{
            \{V上の\mathrm{Hermite}形式\}\ar[r]&\{A\in M_n(\C)\mid Aは\mathrm{Hermite}行列\}\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            h_A\ar@{|->}[r]&A
        }\]
        \item $\R$-線型写像$r_h:V\to V^*$を\[\xymatrix@R-2pc{
            V\ar[r]&V^*\\
            \rotatebox[origin=c]{90}{$\in$}&\rotatebox[origin=c]{90}{$\in$}\\
            x\ar@{|->}[r]&h(x,-)
        }\]
        と定めると，$r_h(ay)=\overline{a}r_h(y)$である．
    \end{enumerate}
\end{definition}

\subsection{随伴}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    この共軛の概念が随伴写像より先に歴史的に出現したのだろうか．
    源霊性を此処に感じる．
\end{tcolorbox}

\begin{definition}[adjoint, hermitian / self adjoint transformation, unitary transformation]
    $V\in\Vect_\C$とし，$h$をその上のHermite形式とする．
    \begin{enumerate}
        \item $\R$-線型写像$r_h:V\to V^*$が単射である時，$h$は\textbf{非退化}であるという．
        \item 非退化Hermite形式$h$について，$h(f(x),y)=h(x,g(y))$であるとき，$g$を$f$の\textbf{随伴写像}または\textbf{共軛}ともいい，双対写像と同様$f^*$と表す．
        \item $h$が非退化であるとする．$V$の自己準同型$f$が随伴写像$f^*$と等しい時，$f$は$h$に関して\textbf{エルミート変換}または\textbf{自己共軛変換}という．
        \item $f^*$が$f$の逆写像であるとき，$f$は$h$に関して\textbf{ユニタリ変換}であるという．有限次元では内積を保つことに同値，一般にはこれに加えて等長性が必要．
    \end{enumerate}
\end{definition}
\begin{remarks}[随伴写像の行列表示]
    非退化Hermite形式$h$の行列表示が$A\in\GL_n(\C)$で，自己準同型$f$の行列表示を$C\in M_n(\C)$とする．
    この時，随伴写像$f^*$の行列表示は$\overline{A}^{-1}C^*\overline{A}\in M_n(\C)$である．
\end{remarks}

\subsection{正規直交系による一斉対角化}\label{subsec-可換性と対角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    正定値な半双線型形式(=内積)には正規直交基底が存在する．
    一般に対角化可能行列の可換系は一斉対角化可能であるが，
    内積空間では，可換系が正規直交基底(=ユニタリ行列)によって一斉に対角化出来る．
    特に，単独の正規行列，実対称行列は，正規直交系(=それぞれユニタリ行列，実直交行列)を用いて対角化ができる．
\end{tcolorbox}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white, breakable]
    自己準同型の対角化の理論を内積空間にて深化させる．
    その順序は，
    Hermite形式が備わった空間から一般理論を始めて，
    対称形式の備わった空間での理論に退化させる．
    此処でも複素数の神秘性とは一体何なのであろうか．
    複素化とは一体なんだろうか．

    この一般論より，
    Hermite変換はunitary行列により一斉対角化可能である．
    正規行列，実対称変換
    はそれぞれ，unitary行列，実直交行列を用いて対角化できる．
    互いに可換なものを選べば一斉対角化可能である．
    こうすると，可換性がもう一歩解った気がする．
\end{tcolorbox}

\begin{theorem}[正規直交基底による一斉対角化可能な十分条件]\label{prop-Hermite-diagonalizability}
    $V\in\FVS_\C$とし，$h$を$V$の上の正定値Hermite形式とする．
    $S\subset\End_\C(V)$は，次の２条件を満たすとする．
    \begin{enumerate}[(1)]
        \item $f,g\in S\Rightarrow f\circ g=g\circ f$．
        \item $f\in S\Rightarrow f\circ f^*=f^*\circ f$．
    \end{enumerate}
    この時，$V$の正規直交基底であって，それに関する$f\in S$の行列表示が全て対角行列になるものが存在する．
\end{theorem}
\begin{Proof}まず，$S$が(1)と次の(3)を満たすならば結論を満たすことを示す．
    \begin{enumerate}[(1)]\setcounter{enumi}{2}
        \item $f\in S\Rightarrow f^*\in S$．
    \end{enumerate}
    \begin{description}
        \item[(1),(3)$\Rightarrow$結論] 
        $\dim V$に関する帰納法で示す．
        系\ref{cor-existence-of-orthogonal-basis}の対称形式の場合と同様，$V$の直交基底が存在し，これを正規化できる．
        $\dim V\le 1$の時，$S$の元は全てスカラー倍写像であるから，その元の行列表示は全て対角写像である．
        $\dim >2$とする．$f\in S$はスカラー倍でないとすると，$f$のある固有値$a\in\C$について，$W=V_a$を固有空間とすれば，$0\subsetneq W\subsetneq V$である．
        今，$W^\perp$を$W$の直交とすると，任意の$g\in S$について，$W,W^\perp$は$g$-安定だと示す：$\forall g\in S,\;g(W)\subset W,g(W^\perp)\subset W^\perp$．
        \begin{quotation}
            $x\in W,g\in S$とすると，(1)より$f\circ g=g\circ f$だから，$f(g(x))=g(f(x))=g(ax)=ag(x)$より，$g(x)\in W$である．

            $x\in W^\perp,g\in S$とすると，(3)より$g^*\in S$だから，(1)より同様にして，任意の$y\in W$について$g^*(y)\in W$．
            よって，$\forall y\in W,\;h(g(x),y)=h(x,g^*(y))=0$だから，$g(x)\in W^\perp$．
        \end{quotation}
        $\dim W,\dim W^\perp<\dim V$だから，帰納法の仮定より，$W$の基底と$W^\perp$の基底で，それに関する$f\in S$の行列表示が全て対角行列になるようなものが存在する．
        此処で，正定値なHermite形式$h$は非退化で，
        $W$への制限も非退化だから，命題\ref{prop-decomposition-along-orthogonal-space}.1より，$V=W\oplus W^\perp$．
        よって，$W$の基底と$W^\perp$の基底とを並べれば良い．
        \item[命題の(3)を用いた証明]
        $S$が条件(1),(2)を満たすとする．$S^*:=\{f^*\mid f\in S\},\tilde{S}:=S\cup S^*$と置くと，$\tilde{S}$は条件(3)を満たす．
        この$\tilde{S}$は条件(1)も満たすことを示す．
        \begin{quotation}
            $f\in S$とすると，(2)より$S_f:=\{f,f^*\}$は条件(1),(3)を満たすから，$V$の正規直交基底$B$が存在して，$f$の$B$に関する行列表示が$D$となる．
            この時，$f^*$の行列表示は対角行列$D^*=\overline{D}$である．

            $a_1,\cdots,a_m\in\C$を$f$の固有値とすると，$P(a_i)=\overline{a_i}\;(i\in[m])$を満たす多項式$P\in\C[X]$が存在する（補題）．
            この$P$を用いると$P(D)=\overline{D}=D^*$だから，$P(f)=f^*$．
            従って，$g\in S$ならば，自己準同型の合成は分配則を満たすから，
            \[f^*\circ g=P(f)\circ g=g\circ P(f)=g\circ f.\]
            であるから，
            \[f^*\circ g^*=(g\circ f)^*=(f\circ g)^*=g^\circ f^*.\]
            よって，$\tilde{S}$は条件(3)も満たす．
        \end{quotation}
        従って，$\tilde{S}$は命題の結論を満たすから，その部分集合$S\subset\tilde{S}$も命題の結論を満たす．
    \end{description}
\end{Proof}


\begin{corollary}[Hermite変換の対角化]
    $V\in\FVS_\C$とし，$h$をその上の正定値Hermite形式とする．$f\in\End_\C(V)$をHermite変換とする．
    \begin{enumerate}
        \item $f$の固有値は全て実数である．
        \item $V$の正規直交基底であって，その基底に関する$f$の行列表示が実対角行列であるようなものが存在する．
    \end{enumerate}
\end{corollary}
\begin{Proof}\mbox{}
    \begin{enumerate}
        \item $a\in\C$を$f$の固有値とすると，固有ベクトル$x\in V_a\setminus\{0\}$について，$ah(x,x)=h(ax,x)=h(f(x),x)=h(x,f^*(x))=h(x,f(x))=h(x,ax)=\overline{a}h(x,x)$であるが，$h(x,x)>0$より，$a\in\R$である．
        \item 命題\ref{prop-Hermite-diagonalizability}より，$V$の直交基底であって，それに関するHermite変換$f$の行列表示が全て対角行列であるものが存在する．$f$の固有値が全て実数だから対角成分は全て実数である．
    \end{enumerate}
\end{Proof}

\subsection{正規行列の対角化}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    理論を別の観点から特殊化してみたい．
    交換可能な自己準同型には共通の固有ベクトルが存在し，そこを起点に共通の三角化する正規直交基底を編み上げることができる．
\end{tcolorbox}

\begin{theorem}[可換な線形変換に対して空間上で起こっている消息]
    $n$次元複素内積空間$V\in\FVS_\C$上の互いに可換な線型自己同型$T,S\in\GL(V)$については，
    \begin{enumerate}
        \item $T,S$は共通の固有ベクトルを持つ．
        \item $T$-不変かつ$S$-不変な部分空間のみを用いて，$0$から$V$まで次元が1ずつ増えていく部分空間の増大列$0=W_0\subset W_1\subset\cdots\subset W_{n-1}\subset W_n=V$が取れる．
    \end{enumerate}
    よって，Schmidtの直交化より，共通の正規直交基底を用いて三角化される．
\end{theorem}

\begin{corollary}[正規性の対角化可能性による特徴付け]
    正方行列$A\in M_n(\C)$について，
    \begin{enumerate}
        \item $U^{-1}AU$が上三角行列になるようなユニタリ行列$U$が存在する．
        \item $A,B$が交換可能ならば，$A+B$の固有値は$A,B$の固有値の和になり，$AB$の固有値はそれぞれの積になる．
        \item 次の2条件は同値である：
        \begin{enumerate}[(a)]
            \item $A$は正規直交基底によって対角化可能である．
            \item $A$は正規である．
        \end{enumerate}
    \end{enumerate}
\end{corollary}

\begin{corollary}[スペクトル定理の系]
    $T\in\End_\bF(V)$を正規変換とする．
    \begin{enumerate}
        \item $T$がエルミートであることと，固有値が全て実数であることとは同値．
        \item $T$がユニタリであることと，固有値が全て絶対値1であることは同値．
    \end{enumerate}
\end{corollary}

\subsection{エルミート変換の極分解}

\begin{proposition}
    エルミート変換$T\in\End_\C(V)$について，次の
    2条件は同値．
    \begin{enumerate}
        \item $T$の固有値は全て正である．
        \item $\forall_{x\in V}\;x\ne0\Rightarrow(Tx|x)>0$．
    \end{enumerate}
\end{proposition}

\begin{corollary}
    Hermite変換$T\in\End_\C(V)$について，
    \begin{enumerate}
        \item $T^2$は半正定値Hermite変換である．
        \item $T$が正則なHermite変換ならば，$T^2$は正定値Hermite変換である．
        \item $T$が［半］正定値Hermite変換ならば，$S^2=T$を満たす［半］正定値Hermite変換が唯一つ存在する．
    \end{enumerate}
\end{corollary}

\begin{theorem}
    $V\in\FVS_\C$を内積空間，$T\in\GL(V)$を正則とする．このとき，正定値Hermite変換$H$とユニタリ変換$U$とが存在して，$T=HU$と一意的に表せる．
\end{theorem}
\begin{Proof}
    $H:=\sqrt{TT^*}$とおく．
\end{Proof}

\section{対称形式と実内積空間}

\subsection{実内積空間の場合}

\begin{tcolorbox}[colframe=ForestGreen, colback=ForestGreen!10!white,breakable,colbacktitle=ForestGreen!40!white,coltitle=black,fonttitle=\bfseries\sffamily,
title=]
    $\bF=\R$の場合を観ると，
    対角化可能性は\textbf{対称性}によって特徴付けられ，実正規行列は対角化不可能である！
\end{tcolorbox}

\begin{proposition}[対称変換の対角化]
    $V\in\FVS_\R$とし，$b$をその上の正定値対称形式とする．$S\subset\End_\R(V)$は次の２条件を満たすとする．
    \begin{enumerate}[(1)]
        \item $f,g\in S\Rightarrow f\circ g=g\circ f$．
        \item $f\in S$ならば，$f$は$b$に関して対称変換である．
    \end{enumerate}
    この時，$V$の正規直交基底であって，それに関する$f\in S$の行列表示が全て対角行列になるようなものが存在する．
\end{proposition}
\begin{Proof}
    $V,b,f$の複素化を$V_\C,b_\C,f_\C$とすると，$h:=b_\C$はHermite形式で，$f_\C$は$h$に関してHermite変換になるから，
    系より固有値は全て実数．従って，$V\ne 0$ならば，$f$の固有値$a\in\R$が存在する．
    以降，命題\ref{prop-Hermite-diagonalizability}と同様に証明できる．
\end{Proof}

\begin{example}[対称行列の一斉対角化]
    $A_1,\cdots,A_m\in M_n(\R)$が互いに可換な対称行列ならば，
    命題より，直交行列$T\in M_n(\R)$によって一斉に対角化される．
\end{example}

\begin{theorem}[実正規行列は対角化不可能！]\mbox{}
    \begin{enumerate}
        \item 実正規行列$A\in M_n(\R)$は，ある直交行列$Q$によって，2次の正方行列$A_1,\cdots,A_m\in M_2(\R)$を用いて$Q^{-1}AQ=\diag(A_1,\cdots,A_m,a_{2m+1},\cdots,a_n)$と変形出来る．
        \item 特に$A$が直交行列であるときは，$A_1,\cdots,A_m$は回転行列，$a_{2m+1},\cdots,a_n\in\{\pm1\}$に取れる．
    \end{enumerate}
\end{theorem}
\begin{remarks}[3次元回転変換]
    $\R^3$の回転を表す行列は，行列式1の直交行列であるから，ある正規直交座標について
    \[Q^{-1}AQ=\begin{pmatrix}\cos\al&-\sin\al&0\\\sin\al&\cos\al&0\\0&0&1\end{pmatrix}\]
    と表せる．
\end{remarks}

\subsection{対称変換の定める固有空間分解}

\begin{theorem}
    対称変換$T\in\End(V)$の相異なる固有値を$\beta_1,\cdots,\beta_k$とし，対応する固有空間を$W_1,\cdots,W_k$とする．
    \begin{enumerate}
        \item $W_1,\cdots,W_k$は互いに直交する．
        \item $V=W_1\oplus\cdots\oplus W_k$．
    \end{enumerate}
\end{theorem}

\begin{corollary}
    次の２条件は同値．
    \begin{enumerate}
        \item $T\in\End(V)$は適当な正規直交基底に関して対角行列で表せる．
        \item $T\in\End(V)$は対称変換である．
    \end{enumerate}
    特に，実正方行列$A$について，次の２条件は同値．
    \begin{enumerate}
        \item 直交行列$P$が存在して，$P^{-1}AP$は対角行列になる．
        \item $A$は対称行列である．
    \end{enumerate}
\end{corollary}

\chapter{参考文献}

\bibliography{../../StatisticalSciences.bib,../../SocialSciences.bib,../../mathematics.bib,../../statistics.bib}
\begin{thebibliography}{99}
    \item
    斎藤毅 (2007) 『線形代数の世界』（東京大学出版会，大学数学の入門7）．
    \item
    伊理正夫 (1993) 『線形代数I, II』（岩波講座応用数学，基礎1）．
    \item
    斎藤正彦 (1966) 『線型代数入門』（東京大学出版会，基礎数学1）．
\end{thebibliography}

\end{document}